/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends,GcSpread;(function(n){(function(n){function t(n,t){var i,r;for(typeof n=="string"?i=(t||document).querySelectorAll(n):n&&(i=n instanceof Array||n instanceof HTMLCollection?n:[n]),this.elements=[],r=0;i&&r<i.length;r++)this.elements.push(i[r])}n.GC$=function(n,i){return new t(n,i)};n.GC$.prototype={elements:[],getElement:function(n){return this.elements[n]},getAllElements:function(){return this.elements},length:function(){return this.elements.length},bind:function(t,i,r){var u=this;return typeof r==typeof undefined&&(r=i,i=undefined),u.elements.forEach(function(u,f){var e=n.GC$._data(u,"events"),s,h;e||(e={},n.GC$._data(u,"events",e));var l=t.split("."),c=l[0],a=l[1]||"_nonamespace",o=e[a];o||(o=e[a]={});s=function(n){typeof i!=typeof undefined&&(n.data=i);var t=r.apply(u,arguments);n.result=t;t===!1&&(n.preventDefault?(n.preventDefault(),n.stopPropagation()):(n.cancelBubble=!1,n.returnValue=!1))};s.original=r;h=o[c];h||(h=o[c]=[]);h.push(s);u.addEventListener(c,s)}),u},unbind:function(t,i){var r=this;return r.elements.forEach(function(r,u){var a=t.split("."),o=a[0],v=a[1]||"_nonamespace",c=n.GC$._data(r,"events"),s=c&&c[v],l,f,e,h;if(i){if(s&&o&&(f=s[o],f))for(e=0,h=f.length;e<h;e++)if(f[e].original===i){r.removeEventListener(o,f[e]);f.splice(e,1);break}}else if(s)if(o){if(f=s[o],f)for(e=0,h=f.length;e<h;e++)r.removeEventListener(o,f[e]);s[o]=undefined}else{for(l in s)if(f=s[l],f)for(e=0,h=f.length;e<h;e++)r.removeEventListener(l,f[e]);c[v]=undefined}}),r},trigger:function(t,i){var r=this;return r.elements.forEach(function(r,u){var o=n.GC$._data(r,"events"),l,s,f,e,a;if(o){var h=t.split("."),c=h[0],v=h[1]||"_nonamespace";for(l in o)if(s=o[l],f=s&&s[c],f)for(e=0,a=f.length;e<a;e++)f[e].apply(r,[{type:c},i])}}),r},css:function(t,i){var u=this,o=u.elements,f,r,e;if(arguments.length===1)if(typeof t=="object")o.forEach(function(i,r){for(var u in t)i.style[u]=n.GC$._fixCssValue(u,t[u])});else return f=u.getElement(0),r=n.GC$.cssHooks[t],r&&"get"in r?r.get(f):(e=getComputedStyle(f),e&&e[t]);else arguments.length===2&&(i=n.GC$._fixCssValue(t,i),o.forEach(function(n,r){n.style[t]=i}));return u},width:function(n){return arguments.length===0?Math.round(parseFloat(this.css("width")))||0:(this.css("width",n),this)},height:function(n){return arguments.length===0?Math.round(parseFloat(this.css("height")))||0:(this.css("height",n),this)},innerWidth:function(){return this.width()+parseFloat(this.css("padding-left"))+parseFloat(this.css("padding-right"))},innerHeight:function(){return this.height()+parseFloat(this.css("padding-top"))+parseFloat(this.css("padding-bottom"))},outerWidth:function(n){var t=this.innerWidth();return t+=parseFloat(this.css("border-left-width"))+parseFloat(this.css("border-right-width")),n&&(t+=parseFloat(this.css("margin-left"))+parseFloat(this.css("margin-right"))),t},outerHeight:function(n){var t=this.innerHeight();return t+=parseFloat(this.css("border-top-width"))+parseFloat(this.css("border-bottom-width")),n&&(t+=parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom"))),t},append:function(t){var r=[t],i,u;return t instanceof n.GC$&&(r=t.getAllElements()),i=this,u=i.getElement(0),r.forEach(function(n,t){n&&u.appendChild(n)}),i},appendTo:function(t){var r=t,i;return t instanceof n.GC$&&(r=t.getElement(0)),i=this,i.elements.forEach(function(n,t){r.appendChild(n)}),i},prepend:function(n){var t=this,i=t.getElement(0);return i.insertBefore(n,i.firstChild),t},insertBefore:function(n){var t=this,i=n.parentElement;return t.elements.forEach(function(t,r){i.insertBefore(t,n)}),t},addClass:function(t){for(var i,r,u,o,f=0,s=this.elements.length,h=/\S+/g,c=/[\t\r\n]/g,e=(t||"").match(h)||[];f<s;f++)if(i=this.elements[f],r=i.nodeType===1&&(i.className?(" "+i.className+" ").replace(c," "):" "),r){for(o=0;u=e[o++];)r.indexOf(" "+u+" ")<0&&(r+=u+" ");i.className=n.GC$.trim(r)}return this},removeClass:function(t){for(var r,i,u,o,f=0,s=this.elements.length,h=/\S+/g,c=/[\t\r\n]/g,e=(t||"").match(h)||[];f<s;f++)if(r=this.elements[f],i=r.nodeType===1&&(r.className?(" "+r.className+" ").replace(c," "):""),i){for(o=0;u=e[o++];)while(i.indexOf(" "+u+" ")>=0)i=i.replace(" "+u+" "," ");r.className=t?n.GC$.trim(i):""}return this},hasClass:function(n){for(var n=" "+n+" ",t=0,r=this.elements.length,u=/[\t\r\n]/g,i;t<r;t++)if(i=this.elements[t],i.nodeType===1&&(" "+i.className+" ").replace(u," ").indexOf(n)>=0)return!0;return!1},toggle:function(){var n=this,t=n.getElement(0);return t.style.display==="none"?n.show():n.hide(),n},show:function(n){return this.elements.forEach(function(t,i){t.style.display="block";n&&n.apply(t)}),this},hide:function(){return this.elements.forEach(function(n,t){n.style.display="none"}),this},attr:function(n,t){var i=this,r=i.elements;if(arguments.length===1)if(typeof n=="object")r.forEach(function(t,i){for(var r in n)t.setAttribute(r,n[r])});else return i.getElement(0).getAttribute(n);else arguments.length===2&&r.forEach(function(i,r){i.setAttribute(n,t)});return i},removeAttr:function(n){return this.elements.forEach(function(t,i){t.removeAttribute(n)}),this},prop:function(t,i){var r=this,u=r.elements;if(arguments.length===1)if(typeof t=="object")u.forEach(function(i,r){for(var u in t)n.GC$.internalProp(i,u,t[u])});else return n.GC$.internalProp(r.getElement(0),t);else arguments.length===2&&u.forEach(function(r,u){n.GC$.internalProp(r,t,i)});return r},removeProp:function(t){t=n.GC$.propFix[t]||t;var i=this,r=i.elements;return r.forEach(function(n,i){try{n[t]=undefined;delete n[t]}catch(r){}}),i},text:function(n){var t=this,i=t.elements;return arguments.length===0?t.getElement(0).textContent:(i.forEach(function(t,i){t.textContent=n}),t)},val:function(t){var f=this,i,u,r,e;return arguments.length?(e=n.GC$.isFunction(t),f.elements.forEach(function(r,u){var f;r.nodeType===1&&(f=e?t.call(r,u,n.GC$(r).val()):t,f==null?f="":typeof f=="number"?f+="":n.GC$.isArray(f)&&(f=n.GC$.map(f,function(n){return n==null?"":n+""})),i=n.GC$.valHooks[r.type]||n.GC$.valHooks[r.nodeName.toLowerCase()],i&&"set"in i&&i.set(r,f,"value")!==undefined||(r.value=f))}),f):(u=f.getElement(0),u)?(i=n.GC$.valHooks[u.type]||n.GC$.valHooks[u.nodeName.toLowerCase()],i&&"get"in i&&(r=i.get(u,"value"))!==undefined)?r:(r=u.value,typeof r=="string"?r.replace(/\r/g,""):r==null?"":r):void 0},position:function(){var r=this.getElement(0),u,t,f,i;if(r)return t={top:0,left:0},n.GC$(r).css("position")==="fixed"?u=r.getBoundingClientRect():(f=this.offsetParent(),u=this.offset(),i=f.getElement(0),n.GC$.nodeName(i,"html")||(t=f.offset(),t.left-=i.scrollLeft,t.top-=i.scrollTop),t.top+=parseFloat(n.GC$(i).css("borderTopWidth")),t.left+=parseFloat(n.GC$(i).css("borderLeftWidth"))),{top:u.top-t.top-parseFloat(n.GC$(r).css("marginTop")),left:u.left-t.left-parseFloat(n.GC$(r).css("marginLeft"))}},offsetParent:function(){var t=n.GC$.map(this.elements,function(t,i){for(var r=t.offsetParent||document.documentElement;r&&!n.GC$.nodeName(r,"html")&&n.GC$(r).css("position")==="static";)r=r.offsetParent;return r||document.documentElement});return n.GC$(t)},offset:function(){var t,r,u={top:0,left:0},i=this.getElement(0),f=i&&i.ownerDocument;if(f)return t=f.documentElement,typeof i.getBoundingClientRect!=typeof undefined&&(u=i.getBoundingClientRect()),r=n.GC$.getWindow(f),{top:u.top+(r.pageYOffset||t.scrollTop)-(t.clientTop||0),left:u.left+(r.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}},scrollLeft:function(t){var u=this,r=u.getElement(0),i=n.GC$.getWindow(r);return t===undefined?i?"pageXOffset"in i?i.pageXOffset:i.document.documentElement.scrollLeft:r.scrollLeft:(i?i.scrollTo(t,n.GC$(i).scrollTop()):r.scrollLeft=t,u)},scrollTop:function(t){var u=this,r=u.getElement(0),i=n.GC$.getWindow(r);return t===undefined?i?"pageYOffset"in i?i.pageYOffset:i.document.documentElement.scrollTop:r.scrollTop:(i?i.scrollTo(n.GC$(i).scrollLeft(),t):r.scrollTop=t,u)},html:function(n){var t=this,i=t.elements;return arguments.length===0?t.getElement(0).innerHTML:(i.forEach(function(t,i){t.innerHTML=n}),t)},remove:function(){var t=this.elements;t.forEach(function(t,i){var r=t.parentElement;r&&(r.removeChild(t),n.GC$.cleanData([t]))})},empty:function(){return this.elements.forEach(function(t,i){n.GC$(t.children).remove()}),this},find:function(t){var i=[];return typeof t=="string"&&this.elements.forEach(function(r,u){var f=r.querySelectorAll(t);n.GC$.merge(i,f)}),n.GC$(i)},parent:function(){var t=[];return this.elements.forEach(function(n,i){n.parentElement&&t.push(n.parentElement)}),n.GC$(t)},index:function(t){var i=this.getElement(0);return t?typeof t=="string"?n.GC$.inArray(i,n.GC$(t).getAllElements()):n.GC$.inArray(t,this.elements):i&&i.parentElement?n.GC$.inArray(i,i.parentElement.children):-1},focus:function(){var t=this,n=t.getElement(0);return n!==document.activeElement&&n.focus&&n.focus(),t},isVisible:function(){var n=0;return this.elements.forEach(function(t,i){var r=getComputedStyle(t);r.visibility!=="hidden"&&r.display!=="none"&&n++}),n>0},data:function(t,i){var r=this;return n.GC$.each(this.elements,function(u,f){var e=n.GC$.internalData(f,t,i);if(typeof i==typeof undefined)return r=e,!1}),r},removeData:function(t){return n.GC$.each(this.elements,function(i,r){n.GC$.internalRemoveData(r,t)}),this}};n.GC$.each=function(t,i){var u,o=n.GC$.isArraylike(t),r,e,f;if(o){for(r=0,e=t.length;r<e;r++)if(u=i.call(t[r],r,t[r]),u===!1)break}else for(f in t)if(u=i.call(t[f],f,t[f]),u===!1)break;return t};n.GC$.isEmptyObject=function(n){for(var t in n)return!1;return!0};n.GC$.isFunction=function(t){return n.GC$.getType(t)==="function"};n.GC$.isArray=function(t){return Array.isArray?Array.isArray(t):n.GC$.getType(t)==="array"};n.GC$.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};n.GC$.getType=function(n){var t,i;return n==null?String(n):(t={},"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(n,i){t["[object "+n+"]"]=n.toLowerCase()}),i=t.toString,typeof n=="object"||typeof n=="function"?t[i.call(n)]||"object":typeof n)};n.GC$.inArray=function(n,t,i){var r,u;if(t){if(u=[].indexOf,u)return u.call(t,n,i);for(r=t.length,i=i?i<0?Math.max(0,r+i):i:0;i<r;i++)if(i in t&&t[i]===n)return i}return-1};n.GC$.trim=function(n){if(n.trim)return n.trim();else{var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return n==null?"":(n+"").replace(t,"")}};n.GC$.merge=function(n,t){var u=t.length,r=n.length,i=0;if(typeof u=="number")for(;i<u;i++)n[r++]=t[i];else while(t[i]!==undefined)n[r++]=t[i++];return n.length=r,n};n.GC$.map=function(t,i,r){var f,u=0,s=t.length,h=n.GC$.isArraylike(t),e=[],o;if(h)for(;u<s;u++)f=i(t[u],u,r),f!=null&&(e[e.length]=f);else for(u in t)f=i(t[u],u,r),f!=null&&(e[e.length]=f);return o=[].concat,o.apply([],e)};n.GC$.extend=function(){for(var a=[],e=0;e<arguments.length-0;e++)a[e]=arguments[e+0];var r,o,i,f,s,h,t=arguments[0]||{},u=1,l=arguments.length,c=!1;for(typeof t=="boolean"&&(c=t,t=arguments[1]||{},u=2),typeof t=="object"||n.GC$.isFunction(t)||(t={}),l===u&&(t=this,--u);u<l;u++)if((s=arguments[u])!=null)for(f in s)(r=t[f],i=s[f],t!==i)&&(c&&i&&(n.GC$.isPlainObject(i)||(o=n.GC$.isArray(i)))?(o?(o=!1,h=r&&n.GC$.isArray(r)?r:[]):h=r&&n.GC$.isPlainObject(r)?r:{},t[f]=n.GC$.extend(c,h,i)):i!==undefined&&(t[f]=i));return t};n.GC$.isPlainObject=function(t){var i,r;if(!t||n.GC$.getType(t)!=="object"||t.nodeType||n.GC$.isWindow(t))return!1;i={}.hasOwnProperty;try{if(t.constructor&&!i.call(t,"constructor")&&!i.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(u){return!1}for(r in t);return r===undefined||i.call(t,r)};n.GC$.isArraylike=function(t){var i=t.length,r=n.GC$.getType(t);return n.GC$.isWindow(t)?!1:t.nodeType===1&&i?!0:r==="array"||r!=="function"&&(i===0||typeof i=="number"&&i>0&&i-1 in t)};n.GC$.isWindow=function(n){return n!=null&&n==n.window};n.GC$.getWindow=function(t){return n.GC$.isWindow(t)?t:t.nodeType===9?t.defaultView||t.parentWindow:!1};n.GC$.nodeName=function(n,t){return n.nodeName&&n.nodeName.toLowerCase()===t.toLowerCase()};n.GC$.makeArray=function(t,i){var r=i||[];return t!=null&&(n.GC$.isArraylike(Object(t))?n.GC$.merge(r,typeof t=="string"?[t]:t):[].push.call(r,t)),r};n.GC$._fixCssValue=function(n,t){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(n)>=0&&isFinite(t)?("width height".split(" ").indexOf(n)>=0&&t<0&&(t=0),t+"px"):t};n.GC$.cssHooks={};["height","width"].forEach(function(t,i){n.GC$.cssHooks[t]={get:function(n){var e=getComputedStyle(n),i=n.style,s={position:"absolute",visibility:"hidden",display:"block"},h={position:i.position,visibility:i.visibility,display:i.display},c=n.offsetWidth===0&&/^(none|table(?!-c[ea]).+)/.test(e.display),f,r,u,o;if(c)for(r in s)i[r]=s[r];if(f=e&&e[t],c)for(r in h)i[r]=h[r];if(f===""){for(u=n.parentElement,o=document.body;u&&u!==o;)u=u.parentElement;u!==o&&(f=i[t])}return f}}});n.GC$.propFix={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};n.GC$.propHooks={tabIndex:{get:function(n){var t=n.getAttributeNode("tabindex"),i=/^(?:input|select|textarea|button|object)$/i,r=/^(?:a|area)$/i;return t&&t.specified?parseInt(t.value,10):i.test(n.nodeName)||r.test(n.nodeName)&&n.href?0:undefined}}};n.GC$.internalProp=function(t,i,r){var f,u,o,e=t.nodeType;if(t&&e!==3&&e!==8&&e!==2)return o=e!==1,o&&(i=n.GC$.propFix[i]||i,u=n.GC$.propHooks[i]),r!==undefined?u&&"set"in u&&(f=u.set(t,r,i))!==undefined?f:t[i]=r:u&&"get"in u&&(f=u.get(t,i))!==null?f:t[i]};n.GC$.valHooks={option:{get:function(n){var t=n.attributes.value;return!t||t.specified?n.value:n.text}},select:{get:function(t){for(var e,i,o=t.options,r=t.selectedIndex,u=t.type==="select-one"||r<0,s=u?null:[],h=u?r+1:o.length,f=r<0?h:u?r:0;f<h;f++)if(i=o[f],(i.selected||f===r)&&!i.disabled&&(!i.parentNode.disabled||!n.GC$.nodeName(i.parentNode,"optgroup"))){if(e=n.GC$(i).val(),u)return e;s.push(e)}return s},set:function(t,i){var r=n.GC$.makeArray(i),u=n.GC$(t).find("option").getAllElements();return u.forEach(function(t,i){t.selected=n.GC$.inArray(n.GC$(t).val(),r)>=0}),r.length||(t.selectedIndex=-1),r}}};n.GC$.cache={};n.GC$.expando="GC$"+(""+Math.random()).replace(/\D/g,"");n.GC$.guid=1;n.GC$.noData={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0};n.GC$.acceptData=function(t){if(t.nodeType&&t.nodeType!==1&&t.nodeType!==9)return!1;var i=t.nodeName&&n.GC$.noData[t.nodeName.toLowerCase()];return!i||i!==!0&&t.getAttribute("classid")===i};n.GC$.noop=function(){};n.GC$.camelCase=function(n){return n.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(n,t){return t.toUpperCase()})};n.GC$.internalData=function(t,i,r,u){if(n.GC$.acceptData(t)){var o,s,h=n.GC$.expando,l=typeof i=="string",c=t.nodeType,e=c?n.GC$.cache:t,f=c?t[h]:t[h]&&h;if(f&&e[f]&&(u||e[f].data)||!l||r!==undefined)return f||(c?t[h]=f=n.GC$.guid++:f=h),e[f]||(e[f]={},c||(e[f].toJSON=n.GC$.noop)),(typeof i=="object"||typeof i=="function")&&(u?e[f]=n.GC$.extend(e[f],i):e[f].data=n.GC$.extend(e[f].data,i)),o=e[f],u||(o.data||(o.data={}),o=o.data),r!==undefined&&(o[n.GC$.camelCase(i)]=r),l?(s=o[i],s==null&&(s=o[n.GC$.camelCase(i)])):s=o,s}};n.GC$.internalRemoveData=function(t,i,r){if(n.GC$.acceptData(t)){var h=function(t){for(var i in t)if((i!=="data"||!n.GC$.isEmptyObject(t[i]))&&i!=="toJSON")return!1;return!0},o,c,e,s=t.nodeType,u=s?n.GC$.cache:t,f=s?t[n.GC$.expando]:n.GC$.expando;if(u[f]){if(i&&(e=r?u[f]:u[f].data,e)){for(n.GC$.isArray(i)?i=i.concat(n.GC$.map(i,n.GC$.camelCase)):(i in e)?i=[i]:(i=n.GC$.camelCase(i),i=i in e?[i]:i.split(" ")),o=0,c=i.length;o<c;o++)delete e[i[o]];if(!(r?h:n.GC$.isEmptyObject)(e))return}(r||(delete u[f].data,h(u[f])))&&(s?n.GC$.cleanData([t],!0):u!=u.window?delete u[f]:u[f]=null)}}};n.GC$.cleanData=function(t,i){for(var r,w,u,h,a=0,v=n.GC$.expando,c=n.GC$.cache,f,l,e,y,o,s,p;(r=t[a])!=null;a++)if((i||n.GC$.acceptData(r))&&(u=r[v],h=u&&c[u],h)){if(f=h.events,f)for(l in f)if(e=f[l],e)for(y in e)if(o=e[y],o)for(s=0,p=o.length;s<p;s++)r.removeEventListener(l,o[s]);c[u]&&(delete c[u],delete r[v])}};n.GC$._data=function(t,i,r){return n.GC$.internalData(t,i,r,!0)};n.GC$._removeData=function(t,i){return n.GC$.internalRemoveData(t,i,!0)};t.prototype=n.GC$.prototype})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={})),function(n){(function(n){function r(n,t){if(i.ensure(n),t&&t.length>0&&!i.check(t)){var r=window.console;r&&r.error&&r.error("["+n+"]: One or more dependency in ["+t+"] are not found!")}}var t=null,i=function(){function i(n,t,i){this.prop=n;this.getter=t;this.setter=i}return i.parse=function(r){var f,u,o,e;if(r!==undefined&&r!==t&&r.length>0){f=r.split(".");u=t;do o=f.shift(),e=new i(o,function(){var t=this;return t.base?t.base.getter()[t.prop]:n.features[t.prop]},function(i){var r=this,u;r.base?(u=r.base.getter(),(u===t||u===undefined)&&r.base.setter(u={}),u[r.prop]=i):n.features[r.prop]=i}),u&&(e.base=u),u=e;while(f.length>0);return u}return t},i.ensure=function(n){var t=i.parse(n);t&&t.setter(!0)},i.check=function(t){var r=!0;return n.GC$.each(t,function(n,t){var u=i.parse(t);return u&&!u.getter()?r=!1:!0}),r},i}();n.feature=r;n.features=function(n){return n?n:{core:{stringResource:!1,common:!1,imageLoader:!1,theme:!1,globalize:!1,spreadpanelex:!1,basecelltype:!1,sheet_model:!1,sheet_action:!1,sheet_event:!1,sheet_border:!1,sheet_render:!1,sheet_ui:!1,sheet:!1,spread:!1,spread_ui:!1,cultureInfo:!1},calc:{common:!1,functions:!1,functions_db:!1,functions_eng:!1,functions_fin:!1,functions_lookup:!1,functions_stat:!1},filter:!1,filter_ui:!1,sparkline:!1,table:!1,binding:!1,group:!1,celltype:!1,conditionalFormat:!1,dataValidator:!1,fill:!1,fill_ui:!1,formatter:!1,search:!1,touch:!1,floatingObject:!1,comment:!1,sparklineEx:!1,formulatextbox:!1,formulatextbox_resource:!1,basedialog:!1,slicer:!1,tableSlicer:!1,print:!1}}(n.features)})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){t.feature("core.stringResource");var i=function(){function t(){}return t.getHelpFuncs=function(){var t=n.Sheets.FormulaTextBoxResource_EN;return t?t.Functions:null},t.getHelpTableFuncs=function(){var t=n.Sheets.FormulaTextBoxResource_EN;return t?t.Table_Functions:null},t.Exp_InvalidArgument="Invalid argument",t.Exp_InvalidCast="InvalidCastException",t.Exp_NotSupport="NotSupportException",t.Exp_FormulaInvalid="The formula you typed contains an invalid char: '{0}' at index on {1}.",t.Exp_InvalidTokenAt="invalid token at {0}.",t.Exp_InvalidArrayAt="Invalid array at {0}.",t.Exp_InvalidCellReference="Invalid cell reference or name at {0}.",t.Exp_InvalidFunctionName="Invalid function name",t.Exp_InvalidOverrideFunction="Cannot override built-in function",t.Exp_OverrideNotAllowed="Attempt to override function while override is not allowed",t.Exp_NoSyntax="no syntax '{0}' to match the syntax '{1}'.",t.Exp_IsValid="'{0}' is invalid.",t.Exp_InvalidArray="Invalid array",t.Exp_InvalidParameters="Invalid function parameters at {0}.",t.Exp_InvalidArrayColumns="The length of array columns are unequal at {0}.",t.Exp_ExprIsNull="The argument 'expr' is null",t.Exp_RuleIsNull="The argument 'rule' is null",t.CopyCells="Copy Cells",t.FillSeries="Fill Series",t.FillFormattingOnly="Fill Formatting Only",t.FillWithoutFormatting="Fill Without Formatting",t.Exp_NumberOnly="Only works for Numbers",t.Exp_RangeContainsMergedCell="Range should not have merged cell.",t.Exp_ChangeMergedCell="Cannot change part of merged cell.",t.Exp_TargetContainsMergedCells="Target range should not have merged cells.",t.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",t.SortAscending="Sort Ascending",t.SortDescending="Sort Descending",t.OK="OK",t.Cancel="Cancel",t.Search="Search",t.CheckAll="Check all",t.UncheckAll="Uncheck all",t.Blanks="(Blanks)",t.ls=["","506f776572656420627920477261706543697479205370726561642e53686565747320547269616c2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],t.Exp_FilterItemIsNull="FilterItem is null.",t.Exp_InvalidColumnIndex="Invalid column index.",t.Exp_TokenIsNull="token is null",t.Exp_InvalidBackslash="the '\\' cannot be evaluated",t.Exp_FormatIllegal="format is illegal.",t.Exp_ValueIsNull="value is null",t.Exp_PartIsNull="part is null",t.Exp_DuplicatedDescriptor="The type of descriptor was added.",t.Exp_TokenIllegal="token is illegal.",t.Exp_ValueIllegal="value is illegal.",t.Exp_StringIllegal="string is illegal.",t.Exp_InvalidNull="InvalidNullException",t.Exp_InvalidOperation="InvalidOperationException",t.Exp_ArgumentNull="ArgumentNullException",t.Exp_CriteriaIsNull="criteria is null",t.Exp_InvalidString="Invalid string",t.Exp_InvalidDateFormat="Invalid date format pattern",t.Exp_InvalidExponentFormat="invalid exponent format",t.Exp_InvalidSemicolons="invalid format: too many semicolons",t.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9.",t.Exp_BadFormatSpecifier="Bad Format Specifier",t.Exp_InvalidNumberFormat="Invalid number format pattern",t.Exp_InvalidIndex="Invalid index",t.Exp_InvalidCount="Invalid count",t.Exp_InvalidLevel="Invalid level",t.Exp_GroupInfoIsNull="groupInfo is null",t.Exp_SheetIsNull="sheet is null.",t.Exp_DestSheetIsNull="destSheet is null",t.Exp_PasteExtentIsNull="pasteExtent is null",t.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",t.Exp_ChangePartOfArray="Cannot change part of an array.",t.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",t.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",t.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",t.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",t.Exp_FillCellsReadOnly="The cells you are trying to fill is protected and therefore read-only.",t.Exp_OverlappingSpans="This operation will cause overlapping spans.",t.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",t.Exp_SrcIsNull="The argument 'src' is null",t.Exp_DestIsNull="The argument 'dest' is null",t.Exp_InvalidCustomFunction="invalid custom function",t.Exp_InvalidCustomName="invalid custom name",t.Exp_IndexOutOfRange="Index is out of range!",t.Exp_InvalidRange="Invalid range",t.Exp_RangeIsNull="range is null",t.Exp_NotAFunction="{0}is not a function",t.Exp_Format="Format",t.Exp_BraceMismatch="format: brace mis-match",t.Exp_InvalidFormat="invalid format",t.Exp_ArgumentOutOfRange="ArgumentOutOfRange",t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableStyleAddCustomStyleError="The style with the same name already exists in the styles.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count and table cannot be resize out of the sheet.",t.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",t.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",t.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",t.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",t.Tip_Row="Row: ",t.Tip_Column="Column: ",t.Tip_Height="Height: {0} pixels",t.Tip_Width="Width: {0} pixels",t.NewTab="New...",t.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",t.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",t.Exp_FloatingObjectNameEmptyError="Floating object must have name",t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill",t.Exp_ArrayFromulaPart="You cannot change part of an array.",t.Exp_ArrayFromulaSpan="Array formulas are not valid in merged cells.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Fbx_Summary="Summary",t.Fbx_TableName_Description="Table name for ",t.Fbx_CustomName_Description="Custom name for ",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Blank="(blank)",t.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info.",t.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",t.Exp_SlicerNameInvalid="The slicer name is not valid.",t.Exp_SlicerNameExist="The slicer name is already in use,please enter an unique name.",t}();t._ENStringResource=i;t.SR=i})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){function ri(n){var e=!1,t=window,f,r,u;if(typeof n=="string"){for(f=n.split("."),r=0,u=f.length;r<u;r++){if(!t)break;t=t[f[r]]}t&&r===u&&u>0&&(e=!0)}return e?t:i}function ui(n){return t.GC$(n).data("spread")}function et(n){if(s.browser.safari)return n.font;var t="",i="normal",r="400";return n.fontStyle!==i&&(t=n.fontStyle),n.fontVariant!==i&&(t+=(t?" ":"")+n.fontVariant),n.fontWeight!==i&&n.fontWeight!==r&&(t+=(t?" ":"")+n.fontWeight),t+=(t?" ":"")+n.fontSize,n.lineHeight!==i&&(t+="/"+n.lineHeight),t+(" "+n.fontFamily)}function ku(n){var i=document.createElement("span");return t.GC$(i).css("visibility","hidden").css("top","-10000px").css("left","-10000px").css("position","absolute").css("lineHeight","normal").attr("className","gcFontDetectSpanStyle").attr("gcUIElement","gcFontDetectSpan"),document.body.insertBefore(i,r),{span:i,dispose:function(){document.body.removeChild(i);delete this.span}}}var s,h,l,d,a,fi,g,nt,tt,it,rt,ei,oi,si,hi,ci,li,ai,vi,yi,ut,pi,w,wi,bi,ki,di,gi,nr,tr,ir,rr,ur,fr,er,or,sr,hr,cr,lr,ar,vr,yr,pr,wr,br,kr,dr,gr,nu,tu,iu,ru,uu,fu,eu,ou,su,hu,cu,lu,au,vu,yu,pu,wu,bu,c,ft,ot,du,gu,nf,st,p,ht,ct,lt,at,b,vt,yt,pt,wt,tf,rf,bt,kt,u,dt,k,uf;t.feature("core.common",["core.stringResource"]);var gt="boolean",ni="date",e="undefined",i=undefined,r=null,ti=Math.abs,v=Math.floor,y=Math.ceil,o=Math.min,f=Math.max,ii=function(){function n(){}return n.productVersion="9.40.20153.0",n}();t.productInfo=ii;t.DefaultFontSize="11pt";t.getTypeFromString=ri;t.findControl=ui;s=function(){function n(){}return n.createEventHandler=function(n,t){return function(){return t.apply(n,arguments)}},n.cancelDefault=function(n){return n.preventDefault?(n.preventDefault(),n.stopPropagation()):(n.cancelBubble=!1,n.returnValue=!1),!1},n.preventDefault=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},n._isStandardCanvas=function(){return typeof n.canvasApiFound===e&&(n.canvasApiFound=typeof document.createElement("canvas").getContext!==e),n.canvasApiFound},n._isSilverlightCanvas=function(){return n._isStandardCanvas()?!0:(typeof n.slCanvasApiFound===e&&(n.slCanvasApiFound=typeof window.slcanvas!==e),n.slCanvasApiFound)},n._useDoubleBuffer=function(){var t=n;return t._isStandardCanvas()||t._isSilverlightCanvas()},n.getHAlignByValueType=function(n,i,r){if(n===3){var u=t.GC$.getType(i);n=r&&r==="@"?0:u==="boolean"?1:u==="number"||u==="date"?2:0}return n},n.inArray=function(n,t,i){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,n,i);var r=t.length;for(i=i?i<0?f(0,r+i):i:0;i<r;i++)if(i in t&&t[i]===n)return i}return-1},n.parseColorString=function(i){var h=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,l=/^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,v=/^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,y=function(n){var r,i;return n?function(n){if(!i){var t=window.document.createElement("canvas");t&&t.getContext&&(i=t.getContext("2d"))}return i?(i.fillStyle=n,i.fillStyle):n}:function(n){return typeof r===e&&(r=t.GC$(document.createElement("span"))),r.css("color",n),r.css("color")}}(n._isStandardCanvas()),p=function(n){return parseInt(n,16)},w=function(n){return parseInt(n+n,16)},s=function(n){return n.indexOf("%")>0?parseFloat(n)*2.55:n|0},f=y(i),u=RegExp,o;if(h.test(f))return a.map([u.$1,u.$2,u.$3],p);else if(v.test(f))return o=a.map([u.$1,u.$2,u.$3],s),o.splice(0,0,parseFloat(u.$4)*255),o;else if(l.test(f))return a.map([u.$1,u.$2,u.$3],s);else if(c.test(f))return a.map([u.$1,u.$2,u.$3],w);return r},n.hasCalc=function(){return t.features.calc&&t.features.calc.common},n.toString=function(n){return n===r||n===i?"":t.GC$.getType(n)===gt?n.toString().toUpperCase():t.GC$.getType(n)===ni?n.getHours()===0&&n.getMinutes()===0&&n.getSeconds()===0&&n.getMilliseconds()===0?new t._DateTimeHelper(n).format("M/d/yyyy"):new t._DateTimeHelper(n).format("M/d/yyyy h:mm:ss"):n.toString()},n._applyBackgroundImageLayout=function(n,i,r,u,f,e){var h=t.GC$(n),o=i,s=r,c="background-position",l="background-size",a,v;switch(e){case 0:h.css(c,"0% 0%").css(l,"100% 100%");break;case 1:a="50%";v="50%";u>o&&(a="0%");f>s&&(v="0%");h.css(c,a+" "+v).css(l,"auto auto");break;case 2:var y=0,p=0,w=o,b=s;s>0&&f>0&&o/s>u/f?(w=u/f*s,y=y+o/2-w/2):o>0&&u>0&&s/o>f/u&&(b=f/u*o,p=p+s/2-b/2);h.css(c,y+"px "+p+"px").css(l,w+"px "+b+"px");break;case 3:h.css(c,"0% 0%").css(l,"auto auto");break;default:break}},n.device=function(){var i=navigator.userAgent,t=i.match(/iPad/i),n,u,r,f;return t&&(n=t[0],n&&(u=n.toLowerCase()==="ipad")),t=i.match(/iPhone/i),t&&(n=t[0],n&&(r=n.toLowerCase()==="iphone")),t=i.match(/android/i),t&&(n=t[0],n&&(r=n.toLowerCase()==="android")),{ipad:u,iphone:r,android:f}},n.isMacOS=function(){var n=navigator.platform;return n&&n.indexOf("Mac")>-1},n.initPaint=function(u){var h=n._isStandardCanvas(),o,f,e,s;h||(o=document.getElementById(u),f=t.GC$(o).data("spread"),f)&&(f._initPaintTimeout!==i&&f._initPaintTimeout!==r&&window.clearTimeout(f._initPaintTimeout),e=f.canvas.firstChild,e&&e.loaded?(s=e.Content.SpreadsheetObject,f.attachSpreadsheetObject(s)):f._initPaintTimeout=window.setTimeout(function(){n.initPaint(u)},10))},n.isType=function(n,t){var u,f;if(n===i||n===r)return t==="null";if(!t)return!1;if(typeof n===t||t==="function"&&/^\s*\bfunction\b/.test(""+n)||Object.prototype.toString.call(n).slice(8,-1).toLowerCase()===t.toLowerCase())return!0;if(n&&n._classNames){for(u=0;u<n._classNames.length;u++)if(f=n._classNames[u],f===t)return!0;return!1}else{if(n===i||n===r)return!1;if(t==="DateTime"||t==="TimeSpan")return n instanceof Date}return typeof t=="string"&&"undefined number boolean string".indexOf(t)>-1?!1:n instanceof t},n.isCustomType=function(n,t){var u,f;if(n===i||n===r)return t==="null";if(!t)return!1;if(n&&n._classNames){for(u=0;u<n._classNames.length;u++)if(f=n._classNames[u],f===t)return!0;return!1}else if(t==="DateTime"||t==="TimeSpan")return n instanceof Date;return t==="function"&&/^\s*\bfunction\b/.test(""+n)?!0:Object.prototype.toString.call(n).slice(8,-1).toLowerCase()===t.toLowerCase()?!0:n instanceof t},n.asCustomType=function(t,i){var u,f;if(t&&t._classNames){for(u=0;u<t._classNames.length;u++)if(f=t._classNames[u],f===i)return t;return r}return n.isType(t,i)?t:r},n.isStringNumber=function(n){if(n===i||n===r)return!1;var t=n.toString();return!isNaN(Number(t.trim()===""?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},n.parseText2Value=function(u,f,e,o){var s=r,c,h,y;if(u&&(u.formatter?(s=u.formatter,typeof s=="string"&&(s=new t.GeneralFormatter(s))):s=u._autoFormatter),!s||s instanceof t.AutoFormatter){if(e){var l=f,a=t._NumberHelper.replaceCultureSymbolToNormal(f),v=n.isStringNumber(a);v&&(l=a);h={};y=r;try{y=(new t.GeneralFormatter).GetPreferredDisplayFormatter(l,h)}catch(p){}return typeof h.value=="number"?f=l:v&&(h.value=f),o&&(o.value=y),h.hasOwnProperty("value")&&h.value!==i&&h.value!==r?h.value:f}}else{c=r;try{var l=f,a=t._NumberHelper.replaceCultureSymbolToNormal(f),v=n.isStringNumber(a);if(v&&(l=a),c=s.Parse(l),typeof c=="number")return c}catch(p){}return c===i||c===r?f:c}return f},n.getPreferredZIndex=function(n){for(var i=n,r,u;i&&i.parentElement&&i.parentElement!==document.body;)i=i.parentElement;return r=1e3,i&&i.parentElement===document.body&&(u=parseInt(t.GC$(i).css("z-index")),isNaN(u)||(r+=u)),r},n.getLinearGradientColors=function(n){var s,r,h,t,c;if(!n)return[];var y=n.indexOf("("),p=n.lastIndexOf(")"),i=n.substring(y+1,p);if(!i)return[];for(var e=[],o=0,l="",s=0,r=0;r<i.length;)s=i.indexOf("rgb",o),r=i.indexOf("rgb",o+1),r===-1&&(r=i.length),l=i.substring(s,r),e.push(l),o=s=r;for(h=[],t=0,c=e.length;t<c;t++){var f=e[t],a=f.indexOf(")"),v=f.substring(0,a+1),u=parseFloat(f.substring(a+1,f.length));(isNaN(u)&&(t===c-1?u=100:t<=1&&(u=0)),v||t!==0)&&(u=u/100,h.push({color:v,point:u}))}return h},n.getColumnAutoFitValue=function(t,i,r,u){var ft=this,b=i._render,c=0,l=[r],a,e,k,p,h,nt,tt;for(u==1&&(r==3?l.push(1):r==2&&l.push(0)),a=0;a<l.length;a++)for(var f=0,r=l[a],it=i.getRowCount(r);f>=0&&f<it;){if(e=i._getSpanModel(r).find(f,t),e&&(e.col<t||e.colCount>1||e.row<f)){f=e.row+e.rowCount;continue}var s=i.getActualStyle(f,t,r),v=0,w=s.cellType||i.getDefaultCellType(r);if(w){k=s.font||b._getDefaultFont(r);s.font=b._getZoomFont(k);p=!!(i.rowFilter()&&i.rowFilter().isFilterHeader(f,t,r));p||r!==3||(h=i.findTable(f,t),h&&h.showHeader()&&h.headerIndex()===f&&h.rowFilter()&&h.filterButtonVisible(t-h.range().col)&&(p=!0));var rt=s.formatter?s.formatter:s._autoFormatter,d={sheet:i,row:f,col:t,sheetArea:r},g=i.getValue(f,t,r),ut=w.format(g,rt,d);v=w.getAutoFitWidth(g,ut,s,i._zoomFactor,d);p&&(nt=o(i._zoomFactor,1),tt=parseInt((i.defaults.rowHeight*nt).toString(),10),v+=tt)}v>c&&(c=v);r===3?f=n._nextAutoFitRow(f,t,i,r):f++}return c===0?c=i.defaults.colWidth:c+=y(3/i._zoomFactor),c},n._nextAutoFitRow=function(n,t,i,r){for(var o,e,f=-1,s=i.getRowCount(r),u=n+1;u<s;u++){if(o=i.getText(u,t,r),o){f=u;break}if(e=i.getActualStyle(u,t,r),e&&e.cellType){f=u;break}}return f},n.getRowAutoFitValue=function(t,i,r,u){var g=this,v=i._render,o=0,s=[r],h,f,p,nt,e,c,w,l,a;for(u==1&&(r==3?s.push(2):r==1&&s.push(0)),h=0;h<s.length;h++)for(r=s[h],f=0,p=i.getColumnCount(r);f>=0&&f<p;){if(e=i._getSpanModel(r).find(t,f),e&&(e.row<t||e.rowCount>1||e.col<f)){f=e.col+e.colCount;continue}if(c=i.getActualStyle(t,f,r),w=c.font||v._getDefaultFont(r),c.font=v._getZoomFont(w),l=0,a=i.getCellType(t,f,r),a){var b=i.getText(t,f,r),k=i.getValue(t,f,r),d={sheet:i,row:t,col:f,sheetArea:r};l=a.getAutoFitHeight(k,b,c,i._zoomFactor,d)}l>o&&(o=l);r===3?f=n._nextAutoFitColumn(t,f,i,r):f++}return o===0?o=i.defaults.rowHeight:o+=y(3/i._zoomFactor),o},n._nextAutoFitColumn=function(n,t,i,r){for(var s,h=r===1,f=i._nextNonNullColumn(n,t,h),u=-1,c=i.getColumnCount(r),e=t+1;e<c;e++)if(s=i.getActualStyle(n,e,r),s&&s.cellType){u=e;break}return f>=0&&u>=0?o(f,u):f>=0?f:u>=0?u:-1},n.formatValue2Text=function(u,f,e){var s,h,v,c;if(e){var l=e._activeRowIndex,a=e._activeColIndex,o=u.formatter?u.formatter:u._autoFormatter;if(t.features.formatter&&f!==r&&f!==i)if(o instanceof t.AutoFormatter&&o._innerFormatter instanceof t.GeneralFormatter)s=typeof f=="number",h=n.isStringNumber(f),!s&&h&&(f=t._NumberHelper.replaceCultureSymbolToNormal(f)),f=o._innerFormatter.GetPreferredEditingFormatter(f).Format(f),h&&(f=t._NumberHelper.replaceNormalToCultureSymble(f));else if(typeof o=="string"&&(o=new t.GeneralFormatter(o)),o)try{v=o.GetFormatType(f);v===2&&(c=t.Calc.Convert.DT(f),c&&(f=c),o=f.getHours()===0&&f.getMinutes()===0&&f.getSeconds()===0&&f.getMilliseconds()===0?new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern):new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern+" "+t.DefaultTokens.DateTimeFormatInfo().longTimePattern),e._editingTimeValue=!0,f=o.Format(f));s=typeof f=="number";s&&(f=t._NumberHelper.replaceNormalToCultureSymble(f.toString()))}catch(y){f=e.getText(l,a)}else f=e.getText(l,a)}return f!==r&&f!==i&&(f=n.toString(f)),f},n.browser=function(){var e=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}},i=e(navigator.userAgent),n={},r,u,t,f;return i.browser&&(n[i.browser]=!0,n.version=i.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),r=navigator.userAgent.toLowerCase(),u=r.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(r)!==null,u&&n&&(n.mozilla=undefined,n.msie=!0),t=/Edge\/\d+/.exec(navigator.userAgent),t!==null&&t.length>0&&n&&(n.webkit=undefined,n.chrome=undefined,n.msie=!0,n.version=t[0].substr(t[0].indexOf("/")+1)),f=function(){var t=null,n=null;try{new ActiveXObject("")}catch(i){t=i.name}try{n=!!new ActiveXObject("htmlfile")}catch(i){n=!1}return n=t!="ReferenceError"&&n==!1?!1:!0,!n},n.msie&&f()&&(n.metroMode=!0),n}(),n}();t.util=s;h=function(){function n(){}return n.showSelection=function(t){n._showSelectionImp(t)},n.hideSelection=function(t){n._hideSelectionImp(t)},n.isActiveElement=function(t){return n.getActiveElement()===t},n.getActiveElement=function(){return window.gcGlobal.activeElement},n.setActiveElement=function(t){var i=n.getActiveElement();n._setActiveElementImp(t);t!==i&&(i&&(i.endEdit(),n._hideSelectionImp(i)),n._showSelectionImp(t))},n._setActiveElementImp=function(n){window.gcGlobal.activeElement=n},n._showSelectionImp=function(n){n&&n._render.repaintSelection()},n._hideSelectionImp=function(t){var u,l,f,e;if(t&&!n.isActiveElement(t)&&t.parent&&t.parent.hideSelection()){var o=t._getSheetLayout(),r=t._render,s=r._getCtx(),h=t.getSelections(),c,i;for(u=0,l=h.length;u<l;u++)c=h[u],i=t._getRangeRect2(c),i.width>=0&&i.height>=0&&(i.x-=9,i.y-=9,i.width+=18,i.height+=30,r.copyDoubleBufferRect(i));for(i=o.headerCornerRect(),t._dirty=!0,r.paintBody(s,i),f=0;f<=2;f++)(i=o.rowHeaderRect(f),i&&i.width!==0&&i.height!==0)&&(t._dirty=!0,r.paintBody(s,i));for(e=0;e<=2;e++)(i=o.colHeaderRect(e),i&&i.width!==0&&i.height!==0)&&(t._dirty=!0,r.paintBody(s,i))}},n}();t.FocusHelper=h;l=function(){function n(){this._eventSuspended=0;typeof window.gcGlobal==e&&this._init()}return n.prototype._isIELessThan9=function(n){return s.browser.msie&&(typeof n===e||n<9)},n.prototype._createDummyObjects=function(){var t=n.prototype;t.getDummyHeader();t.getDummyContent();t.getDummyHover();t.getDummyHighlight()},n.prototype.createSpan=function(n,t){var i=document.createElement("span");return i.className=n,t&&(i.id=t),i.style.display="none",document.body.insertBefore(i,r),i},n.prototype.getDummyHeader=function(){var i=n.prototype,u="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",f="span."+u.split(" ").join(".");return i._dummyHeader?t.GC$(document).find(f).length()<=0&&document.body.insertBefore(i._dummyHeader,r):i._dummyHeader=i.createSpan(u),i._dummyHeader},n.prototype.getDummyContent=function(){var i=n.prototype,u="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",f="span."+u.split(" ").join(".");return i._dummyContent?t.GC$(document).find(f).length()<=0&&document.body.insertBefore(i._dummyContent,r):i._dummyContent=i.createSpan(u),i._dummyContent},n.prototype.getDummyHover=function(){var i=n.prototype,u="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",f="span."+u.split(" ").join(".");return i._dummyHover?t.GC$(document).find(f).length()<=0&&document.body.insertBefore(i._dummyHover,r):i._dummyHover=i.createSpan(u),i._dummyHover},n.prototype.getDummyHighlight=function(){var i=n.prototype,u="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",f="span."+u.split(" ").join(".");return i._dummyHighlight?t.GC$(document).find(f).length()<=0&&document.body.insertBefore(i._dummyHighlight,r):i._dummyHighlight=i.createSpan(u),i._dummyHighlight},n.prototype.getDummyElement=function(){var i=n.prototype,f="gc-theme-version",u="gcDummyElement";return i._dummyElement?t.GC$(document).find("#"+u).length()<=0&&document.body.insertBefore(i._dummyElement,r):i._dummyElement=i.createSpan(f,u),i._dummyElement},n.prototype._init=function(){window.gcGlobal=this;this._eventSuspended=0;var i=n.prototype;window.addEventListener&&(window.addEventListener("keydown",i.keyDown,!0),window.addEventListener("keyup",i.keyUp,!0),window.addEventListener("compositionstart",i.compositionStart,!0),document.addEventListener("selectstart",i.docSelectStart,!0));"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(n,u){t.GC$(document).bind(n,function(n){var t=h.getActiveElement(),u,c,f,l,o,e;t&&(u=i.getUIElement(n.target),c=u&&u.getAttribute("gcUIElement")==="gcAttachedFormulaTextBox",u||!t.endEdit||c||(f=k.formulatextboxAcrossSheetInstance,f&&f.dom&&(l=f.sheet,t._formulaTextBox.destroy(),t._formulaTextBox=r,f.clear()),t.endEdit(),o=s.device(),(o.ipad||o.iphone)&&(e=t._eventHandler,e&&e.setFocusToReadonlyFocusElem&&e.setFocusToReadonlyFocusElem())),!u&&t._disposeValidationUI&&t._disposeValidationUI(),u||h.setActiveElement(r))})});t.GC$(document).bind("DOMContentLoaded",function(){n.prototype._createDummyObjects()})},n.prototype.keyDown=function(n){var f=window.gcGlobal,i,r,u;f._eventSuspended>0||(i=h.getActiveElement(),r=i&&i._validationSelect,r&&(u=t.GC$(r),u.isVisible()))||i&&i.doKeyDown&&(i.doKeyDown(n),i.isEditing()||((n.keyCode===90||n.keyCode===89)&&n.ctrlKey&&!n.altKey?s.cancelDefault(n):n.keyCode===86&&n.ctrlKey&&!n.altKey&&n.stopPropagation&&n.stopPropagation()))},n.prototype.keyUp=function(n){var i=window.gcGlobal,t;i._eventSuspended>0||(t=h.getActiveElement(),t&&t.doKeyUp&&t.doKeyUp(n))},n.prototype.compositionStart=function(n){var i=window.gcGlobal,t;i._eventSuspended>0||(t=h.getActiveElement(),t&&t.doCompositionStart&&t.doCompositionStart(n))},n.prototype.docSelectStart=function(n){return document.all===i&&h.getActiveElement()&&s.cancelDefault(n),!1},n.prototype.getUIElement=function(n){for(var t=n,i;t&&t.tagName!=="BODY";){if(typeof t.getAttribute!="function")break;if(i=t.getAttribute("gcUIElement"),i||(i=t.gcUIElement),i)return t;t=t.parentNode}return r},n.prototype.getExternalThemeStyle=function(r,u){var s=n.prototype,o=s.getDummyHeader(),h,f,c,e;return r===1||r===2?o=s.getDummyHighlight():r===4&&(o=s.getDummyHover()),h=o.className,t.GC$(o).removeClass(h).addClass(u),f=o.currentStyle,document.defaultView&&document.defaultView.getComputedStyle&&(f=document.defaultView.getComputedStyle(o,"")),c={backgroundColor:f.backgroundColor,backgroundImage:f.backgroundImage},t.GC$(o).addClass(h),document.defaultView&&document.defaultView.getComputedStyle&&(f=document.defaultView.getComputedStyle(o,"")),e={backgroundColor:f.backgroundColor,backgroundImage:f.backgroundImage,color:f.color,zIndex:f.zIndex},e.borderLeftColor=f.borderLeftColor,e.borderRightColor=f.borderRightColor,e.borderBottomColor=f.borderBottomColor,e.borderBottomWidth=f.borderBottomWidth,e.borderTopColor=f.borderTopColor,e.borderRightWidth=f.borderRightWidth,e.backgroundImage===c.backgroundImage&&e.backgroundColor!==c.backgroundColor&&(e.backgroundImage=i),t.GC$(o).removeClass(u),e},n.prototype.getStyleByCssClass=function(i){var f=n.prototype,r=f.getDummyElement(),u=r.currentStyle;return t.GC$(r).removeClass(r.className).addClass("gc-theme-version "+i),document.defaultView&&document.defaultView.getComputedStyle&&(u=document.defaultView.getComputedStyle(r,"")),t.GC$.extend({},u)},n.prototype.getThemeContentStyle=function(i){var r=n.prototype.getDummyContent(),u=r.currentStyle;return t.GC$(r).removeClass(r.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+i),document.defaultView&&document.defaultView.getComputedStyle&&(u=document.defaultView.getComputedStyle(r,"")),t.GC$.extend({},u)},n.prototype.suspendEvent=function(){var n=window.gcGlobal;n._eventSuspended++},n.prototype.resumeEvent=function(){var n=window.gcGlobal;n._eventSuspended--;n._eventSuspended<0&&(n._eventSuspended=0)},n}();t.Global=l;window.gcGlobal=new l;d=function(){function n(){}return n.getVisualStateThemeStyle=function(t,i){var r=ut[t]+i,u=n.styleCache;return u[r]||(u[r]=l.prototype.getExternalThemeStyle(t,i)),u[r]},n.getCssClassThemeStyle=function(t){var i=t,r=n.styleCache;return r[i]||(r[i]=l.prototype.getStyleByCssClass(t)),r[i]},n.getContentThemeStyle=function(t){var i="content"+t,r=n.styleCache;return r[i]||(r[i]=l.prototype.getThemeContentStyle(t)),r[i]},n.clearCache=function(){n.styleCache={}},n.styleCache={},n}();t.ThemeStyleHelper=d;a=function(){function n(){}return n.insert=function(n,t,i){n.splice(t,0,i)},n.add=function(n,t){n[n.length]=t},n.contains=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1},n.remove=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t){n.splice(i,1);return}},n.removeByIndex=function(n,t){return n.slice(0,t).concat(n.slice(t+1))},n.indexOf=function(n,t,i){if(typeof t===e)return-1;i=i||0;for(var r=i;r<n.length;r++)if(n[r]===t)return r;return-1},n.map=function(n,i,r){var s,e,u,f,o,h,c;if(!Array.prototype.map){if(f=window.Object(n),o=f.length>>>0,typeof i!="function")throw new TypeError(t._StringHelper.format(t.SR.Exp_NotAFunction,[i]));for(r&&(s=r),e=new Array(o),u=0;u<o;)u in f&&(h=f[u],c=i.call(s,h,u,f),e[u]=c),u++;return e}return n.map(i,r)},n.clear=function(n,t,i){var f,u;if(!(t<0))for(f=0,u=0;f<i&&u<n.length;u++)n[t+u]=r,f++},n.nextNonEmptyIndex=function(n,t){var f,u;for(t<0&&(t=-1),f=t+1,u=f;u<n.length;u++)if(n[u]!==i&&n[u]!==r)return u;return-1},n.isEquals=function(n,t){var u,i,r;if(n==null&&t==null)return!0;if(n==null&&t!=null||n!=null&&t==null||n!=null&&t!=null&&(!(n instanceof Array)||!(t instanceof Array))||n.length!==t.length)return!1;for(u=[],i=0,r=n.length;i<r;i++)u[n[i]]=!0;for(i=0,r=t.length;i<r;i++)if(!u[t[i]])return!1;return!0},n}();t.ArrayHelper=a,function(n){n[n.left=37]="left";n[n.right=39]="right";n[n.up=38]="up";n[n.down=40]="down";n[n.tab=9]="tab";n[n.enter=13]="enter";n[n.shift=16]="shift";n[n.ctrl=17]="ctrl";n[n.space=32]="space";n[n.altkey=18]="altkey";n[n.home=36]="home";n[n.end=35]="end";n[n.pup=33]="pup";n[n.pdn=34]="pdn";n[n.backspace=8]="backspace";n[n.del=46]="del";n[n.esc=27]="esc";n[n.a=65]="a";n[n.c=67]="c";n[n.v=86]="v";n[n.x=88]="x";n[n.z=90]="z";n[n.y=89]="y"}(t.Key||(t.Key={}));fi=t.Key;g=function(){function n(n,t,i,r,u,f){var e=this;e.key=n;e.ctrl=t;e.shift=i;e.alt=r;e.meta=f&&u||!1;e.action=f||u}return n}();t.KeyMap=g;nt=function(){function n(n,t){this.x=n;this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n}();t.Point=nt;tt=function(){function n(n,t,i,r){var u=this;u.x=n;u.y=t;u.width=i;u.height=r}return n.prototype.intersect=function(n,t,i,r){var u=this;return n<u.x+u.width&&u.x<n+i&&t<u.y+u.height&&u.y<t+r},n.prototype.intersectRect=function(n){var t=this;return n.x<t.x+t.width&&t.x<n.x+n.width&&n.y<t.y+t.height&&t.y<n.y+n.height},n.prototype.contains=function(n,t){var i=this;return n<i.x+i.width&&i.x<n&&t<i.y+i.height&&i.y<t},n.prototype.containsRect=function(n){var t=this;return t.x<n.x&&n.x+n.width<t.x+t.width&&t.y<n.y&&n.y+n.height<t.y+t.height},n.prototype.getIntersectRect=function(n){return this.getIntersect(n.x,n.y,n.width,n.height)},n.prototype.getIntersect=function(t,i,u,e){var s=this,v=s.x,y=s.y,p=s.x+s.width,w=s.y+s.height,b=t,k=i,d=t+u,g=i+e,h=f(v,b),c=f(y,k),nt=o(p,d),tt=o(w,g),it=h,rt=c,l=nt-h,a=tt-c;return l>0&&a>0?new n(it,rt,l,a):r},n.prototype.round=function(){var n=this;n.x=v(n.x);n.y=v(n.y);n.width=y(n.width);n.height=y(n.height)},n.empty=function(){return new n(0,0,0,0)},n}();t.Rect=tt;it=function(){function n(n,t,i,r){var u=this;u.row=n;u.rowCount=i;u.col=t;u.colCount=r}return n.prototype.intersect=function(n,t,i,r){var u=this;return(n===-1||u.row===-1||u.row<n+i&&n<u.row+u.rowCount)&&(t===-1||u.col===-1||u.col<t+r&&t<u.col+u.colCount)},n.prototype.getIntersect=function(t,i,u){var e;if(t==r||(e=this,!e.intersect(t.row,t.col,t.rowCount,t.colCount)))return r;var c=e.col==-1?u:e.col+e.colCount-1,l=t.col==-1?u:t.col+t.colCount-1,a=e.row==-1?i:e.row+e.rowCount-1,v=t.row==-1?i:t.row+t.rowCount-1,s=f(e.col,t.col),y=o(c,l),h=f(e.row,t.row),p=o(a,v),w=h==-1?-1:p-h+1,b=s==-1?-1:y-s+1;return new n(h,s,w,b)},n.prototype.contains=function(t,i,r,u){var f=this;if(arguments.length===2)return(f.row===-1||f.row<=t&&t<f.row+f.rowCount)&&(f.col===-1||f.col<=i&&i<f.col+f.colCount);else if(arguments.length===4)return f.containsRange(new n(t,i,r,u));return!1},n.prototype.containsRange=function(n){var t=this;return(t.row===-1||t.row<=n.row&&n.row+n.rowCount<=t.row+t.rowCount)&&(t.col===-1||t.col<=n.col&&n.col+n.colCount<=t.col+t.colCount)},n.prototype.offset=function(t,i){var r=this,u=r.col,f=r.row;return r.col!==-1&&(u+=t),r.row!==-1&&(f+=i),new n(f,u,r.rowCount,r.colCount)},n.prototype.union=function(t){var i=this,r=o(i.row,t.row),u=o(i.col,t.col),e=f(i.row+i.rowCount-1,t.row+t.rowCount-1),s=f(i.col+i.colCount-1,t.col+t.colCount-1);return new n(r,u,e-r+1,s-u+1)},n.prototype.equals=function(t){var i=this;return t instanceof n?i.row===t.row&&i.col===t.col&&i.rowCount===t.rowCount&&i.colCount===t.colCount:!1},n}();t.Range=it;rt=function(){function n(n,t){this.row=n;this.col=t}return n}();t.CellPosition=rt,function(n){n[n.DragDrop=0]="DragDrop";n[n.DragFill=1]="DragFill";n[n.Clear=2]="Clear";n[n.Paste=3]="Paste";n[n.Sort=4]="Sort";n[n.SetArrayFormula=5]="SetArrayFormula";n[n.EvaluateFormula=6]="EvaluateFormula"}(t.RangeChangedAction||(t.RangeChangedAction={}));ei=t.RangeChangedAction,function(n){n[n.up=1]="up";n[n.down=2]="down";n[n.left=3]="left";n[n.right=4]="right";n[n.first=5]="first";n[n.last=6]="last"}(t.Direction||(t.Direction={}));oi=t.Direction,function(n){n[n.left=0]="left";n[n.center=1]="center";n[n.right=2]="right";n[n.general=3]="general"}(t.HorizontalAlign||(t.HorizontalAlign={}));si=t.HorizontalAlign,function(n){n[n.top=0]="top";n[n.center=1]="center";n[n.bottom=2]="bottom"}(t.VerticalAlign||(t.VerticalAlign={}));hi=t.VerticalAlign,function(n){n[n.left=0]="left";n[n.center=1]="center";n[n.right=2]="right";n[n.nearest=3]="nearest"}(t.HorizontalPosition||(t.HorizontalPosition={}));ci=t.HorizontalPosition,function(n){n[n.top=0]="top";n[n.center=1]="center";n[n.bottom=2]="bottom";n[n.nearest=3]="nearest"}(t.VerticalPosition||(t.VerticalPosition={}));li=t.VerticalPosition,function(n){n[n.blank=0]="blank";n[n.numbers=1]="numbers";n[n.letters=2]="letters"}(t.HeaderAutoText||(t.HeaderAutoText={}));ai=t.HeaderAutoText,function(n){n[n.All=0]="All";n[n.Values=1]="Values";n[n.Formatting=2]="Formatting";n[n.Formulas=3]="Formulas"}(t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}));vi=t.ClipboardPasteOptions,function(n){n[n.None=0]="None";n[n.IncludeRowHeader=1]="IncludeRowHeader";n[n.IncludeColumnHeader=2]="IncludeColumnHeader";n[n.UnFormatted=8]="UnFormatted";n[n.ImportFormula=16]="ImportFormula"}(t.TextFileOpenFlags||(t.TextFileOpenFlags={}));yi=t.TextFileOpenFlags,function(n){n[n.Normal=0]="Normal";n[n.Highlight=1]="Highlight";n[n.Selected=2]="Selected";n[n.Active=3]="Active";n[n.Hover=4]="Hover"}(t.VisualState||(t.VisualState={}));ut=t.VisualState,function(n){n[n.A1=0]="A1";n[n.R1C1=1]="R1C1"}(t.ReferenceStyle||(t.ReferenceStyle={}));pi=t.ReferenceStyle,function(n){n[n.empty=0]="empty";n[n.thin=1]="thin";n[n.medium=2]="medium";n[n.dashed=3]="dashed";n[n.dotted=4]="dotted";n[n.thick=5]="thick";n[n.double=6]="double";n[n.hair=7]="hair";n[n.mediumDashed=8]="mediumDashed";n[n.dashDot=9]="dashDot";n[n.mediumDashDot=10]="mediumDashDot";n[n.dashDotDot=11]="dashDotDot";n[n.mediumDashDotDot=12]="mediumDashDotDot";n[n.slantedDashDot=13]="slantedDashDot"}(t.LineStyle||(t.LineStyle={}));w=t.LineStyle,function(n){n[n.corner=0]="corner";n[n.colHeader=1]="colHeader";n[n.rowHeader=2]="rowHeader";n[n.viewport=3]="viewport"}(t.SheetArea||(t.SheetArea={}));wi=t.SheetArea,function(n){n[n.Value=1]="Value";n[n.Formula=2]="Formula";n[n.Comment=4]="Comment";n[n.RangeGroup=8]="RangeGroup";n[n.Sparkline=16]="Sparkline";n[n.Span=32]="Span";n[n.Style=64]="Style";n[n.Tag=128]="Tag";n[n.BindingPath=256]="BindingPath";n[n.ConditionalFormat=512]="ConditionalFormat";n[n.All=1023]="All"}(t.CopyToOption||(t.CopyToOption={}));bi=t.CopyToOption,function(n){n[n.Single=0]="Single";n[n.Range=1]="Range";n[n.MultiRange=2]="MultiRange"}(t.SelectionPolicy||(t.SelectionPolicy={}));ki=t.SelectionPolicy,function(n){n[n.Cell=0]="Cell";n[n.Row=1]="Row";n[n.Column=2]="Column"}(t.SelectionUnit||(t.SelectionUnit={}));di=t.SelectionUnit,function(n){n[n.CopyCells=0]="CopyCells";n[n.FillSeries=1]="FillSeries";n[n.FillFormattingOnly=2]="FillFormattingOnly";n[n.FillWithoutFormatting=3]="FillWithoutFormatting";n[n.ClearValues=4]="ClearValues";n[n.Auto=5]="Auto"}(t.AutoFillType||(t.AutoFillType={}));gi=t.AutoFillType,function(n){n[n.Left=0]="Left";n[n.Right=1]="Right";n[n.Up=2]="Up";n[n.Down=3]="Down"}(t.FillDirection||(t.FillDirection={}));nr=t.FillDirection,function(n){n[n.Column=0]="Column";n[n.Row=1]="Row"}(t.FillSeries||(t.FillSeries={}));tr=t.FillSeries,function(n){n[n.Data=1]="Data";n[n.Style=2]="Style";n[n.Comment=4]="Comment";n[n.Tag=8]="Tag";n[n.Sparkline=16]="Sparkline";n[n.Axis=32]="Axis";n[n.BindingPath=64]="BindingPath"}(t.StorageType||(t.StorageType={}));ir=t.StorageType,function(n){n[n.Left=0]="Left";n[n.Right=1]="Right";n[n.Up=2]="Up";n[n.Down=3]="Down";n[n.LeftClear=4]="LeftClear";n[n.UpClear=5]="UpClear"}(t.DragFillDirection||(t.DragFillDirection={}));rr=t.DragFillDirection,function(n){n[n.Ready=0]="Ready";n[n.Enter=1]="Enter";n[n.Edit=2]="Edit"}(t.EditorStatus||(t.EditorStatus={}));ur=t.EditorStatus,function(n){n[n.AnyValue=0]="AnyValue";n[n.WholeNumber=1]="WholeNumber";n[n.DecimalValues=2]="DecimalValues";n[n.List=3]="List";n[n.Date=4]="Date";n[n.Time=5]="Time";n[n.TextLength=6]="TextLength";n[n.Custom=7]="Custom"}(t.CriteriaType||(t.CriteriaType={}));fr=t.CriteriaType,function(n){n[n.ForceApply=0]="ForceApply";n[n.Discard=1]="Discard";n[n.Retry=2]="Retry"}(t.DataValidationResult||(t.DataValidationResult={}));er=t.DataValidationResult,function(n){n[n.Stop=0]="Stop";n[n.Warning=1]="Warning";n[n.Information=2]="Information"}(t.ErrorStyle||(t.ErrorStyle={}));or=t.ErrorStyle,function(n){n[n.EqualsTo=0]="EqualsTo";n[n.NotEqualsTo=1]="NotEqualsTo";n[n.GreaterThan=2]="GreaterThan";n[n.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo";n[n.LessThan=4]="LessThan";n[n.LessThanOrEqualsTo=5]="LessThanOrEqualsTo"}(t.GeneralCompareType||(t.GeneralCompareType={}));sr=t.GeneralCompareType,function(n){n[n.Or=0]="Or";n[n.And=1]="And"}(t.RelationCompareType||(t.RelationCompareType={}));hr=t.RelationCompareType,function(n){n[n.EqualsTo=0]="EqualsTo";n[n.NotEqualsTo=1]="NotEqualsTo";n[n.GreaterThan=2]="GreaterThan";n[n.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo";n[n.LessThan=4]="LessThan";n[n.LessThanOrEqualsTo=5]="LessThanOrEqualsTo";n[n.Between=6]="Between";n[n.NotBetween=7]="NotBetween"}(t.ComparisonOperator||(t.ComparisonOperator={}));cr=t.ComparisonOperator,function(n){n[n.Contains=0]="Contains";n[n.DoesNotContain=1]="DoesNotContain";n[n.BeginsWith=2]="BeginsWith";n[n.EndsWith=3]="EndsWith"}(t.TextComparisonOperator||(t.TextComparisonOperator={}));lr=t.TextComparisonOperator,function(n){n[n.EqualsTo=0]="EqualsTo";n[n.NotEqualsTo=1]="NotEqualsTo";n[n.BeginsWith=2]="BeginsWith";n[n.DoesNotBeginWith=3]="DoesNotBeginWith";n[n.EndsWith=4]="EndsWith";n[n.DoesNotEndWith=5]="DoesNotEndWith";n[n.Contains=6]="Contains";n[n.DoesNotContain=7]="DoesNotContain"}(t.TextCompareType||(t.TextCompareType={}));ar=t.TextCompareType,function(n){n[n.BackgroundColor=0]="BackgroundColor";n[n.ForegroundColor=1]="ForegroundColor"}(t.ColorCompareType||(t.ColorCompareType={}));vr=t.ColorCompareType,function(n){n[n.Empty=0]="Empty";n[n.NonEmpty=1]="NonEmpty";n[n.Error=2]="Error";n[n.NonError=3]="NonError";n[n.Formula=4]="Formula"}(t.CustomValueType||(t.CustomValueType={}));yr=t.CustomValueType,function(n){n[n.EqualsTo=0]="EqualsTo";n[n.NotEqualsTo=1]="NotEqualsTo";n[n.Before=2]="Before";n[n.BeforeEqualsTo=3]="BeforeEqualsTo";n[n.After=4]="After";n[n.AfterEqualsTo=5]="AfterEqualsTo"}(t.DateCompareType||(t.DateCompareType={}));pr=t.DateCompareType,function(n){n[n.Top=0]="Top";n[n.Bottom=1]="Bottom"}(t.Top10ConditionType||(t.Top10ConditionType={}));wr=t.Top10ConditionType,function(n){n[n.Today=0]="Today";n[n.Yesterday=1]="Yesterday";n[n.Tomorrow=2]="Tomorrow";n[n.Last7Days=3]="Last7Days";n[n.ThisMonth=4]="ThisMonth";n[n.LastMonth=5]="LastMonth";n[n.NextMonth=6]="NextMonth";n[n.ThisWeek=7]="ThisWeek";n[n.LastWeek=8]="LastWeek";n[n.NextWeek=9]="NextWeek"}(t.DateOccurringType||(t.DateOccurringType={}));br=t.DateOccurringType,function(n){n[n.Quarter1=0]="Quarter1";n[n.Quarter2=1]="Quarter2";n[n.Quarter3=2]="Quarter3";n[n.Quarter4=3]="Quarter4"}(t.QuarterType||(t.QuarterType={}));kr=t.QuarterType,function(n){n[n.None=0]="None";n[n.Ascending=1]="Ascending";n[n.Descending=2]="Descending"}(t.SortState||(t.SortState={}));dr=t.SortState,function(n){n[n.Above=0]="Above";n[n.Below=1]="Below";n[n.EqualOrAbove=2]="EqualOrAbove";n[n.EqualOrBelow=3]="EqualOrBelow";n[n.Above1StdDev=4]="Above1StdDev";n[n.Below1StdDev=5]="Below1StdDev";n[n.Above2StdDev=6]="Above2StdDev";n[n.Below2StdDev=7]="Below2StdDev";n[n.Above3StdDev=8]="Above3StdDev";n[n.Below3StdDev=9]="Below3StdDev"}(t.AverageConditionType||(t.AverageConditionType={}));gr=t.AverageConditionType,function(n){n[n.Number=0]="Number";n[n.LowestValue=1]="LowestValue";n[n.HighestValue=2]="HighestValue";n[n.Percent=3]="Percent";n[n.Percentile=4]="Percentile";n[n.Automin=5]="Automin";n[n.Formula=6]="Formula";n[n.Automax=7]="Automax"}(t.ScaleValueType||(t.ScaleValueType={}));nu=t.ScaleValueType,function(n){n[n.LeftToRight=0]="LeftToRight";n[n.RightToLeft=1]="RightToLeft"}(t.BarDirection||(t.BarDirection={}));tu=t.BarDirection,function(n){n[n.Automatic=0]="Automatic";n[n.CellMidPoint=1]="CellMidPoint";n[n.None=2]="None"}(t.DataBarAxisPosition||(t.DataBarAxisPosition={}));iu=t.DataBarAxisPosition,function(n){n[n.ThreeArrowsColored=0]="ThreeArrowsColored";n[n.ThreeArrowsGray=1]="ThreeArrowsGray";n[n.ThreeTriangles=2]="ThreeTriangles";n[n.ThreeStars=3]="ThreeStars";n[n.ThreeFlags=4]="ThreeFlags";n[n.ThreeTrafficLightsUnrimmed=5]="ThreeTrafficLightsUnrimmed";n[n.ThreeTrafficLightsRimmed=6]="ThreeTrafficLightsRimmed";n[n.ThreeSigns=7]="ThreeSigns";n[n.ThreeSymbolsCircled=8]="ThreeSymbolsCircled";n[n.ThreeSymbolsUncircled=9]="ThreeSymbolsUncircled";n[n.FourArrowsColored=10]="FourArrowsColored";n[n.FourArrowsGray=11]="FourArrowsGray";n[n.FourRedToBlack=12]="FourRedToBlack";n[n.FourRatings=13]="FourRatings";n[n.FourTrafficLights=14]="FourTrafficLights";n[n.FiveArrowsColored=15]="FiveArrowsColored";n[n.FiveArrowsGray=16]="FiveArrowsGray";n[n.FiveRatings=17]="FiveRatings";n[n.FiveQuarters=18]="FiveQuarters";n[n.FiveBoxes=19]="FiveBoxes"}(t.IconSetType||(t.IconSetType={}));ru=t.IconSetType,function(n){n[n.Number=1]="Number";n[n.Percent=4]="Percent";n[n.Formula=7]="Formula";n[n.Percentile=5]="Percentile"}(t.IconValueType||(t.IconValueType={}));uu=t.IconValueType,function(n){n[n.Backward=0]="Backward";n[n.Forward=1]="Forward"}(t.RangeGroupDirection||(t.RangeGroupDirection={}));fu=t.RangeGroupDirection,function(n){n[n.None=0]="None";n[n.Column=1]="Column";n[n.Row=2]="Row";n[n.Both=3]="Both"}(t.ShowResizeTip||(t.ShowResizeTip={}));eu=t.ShowResizeTip,function(n){n[n.None=0]="None";n[n.Horizontal=1]="Horizontal";n[n.Vertical=2]="Vertical";n[n.Both=3]="Both"}(t.ShowScrollTip||(t.ShowScrollTip={}));ou=t.ShowScrollTip,function(n){n[n.Cell=0]="Cell";n[n.CellWithHeader=1]="CellWithHeader"}(t.AutoFitType||(t.AutoFitType={}));su=t.AutoFitType,function(n){n[n.Stretch=0]="Stretch";n[n.Center=1]="Center";n[n.Zoom=2]="Zoom";n[n.None=3]="None"}(t.ImageLayout||(t.ImageLayout={}));hu=t.ImageLayout,function(n){n[n.SetFormula=0]="SetFormula";n[n.CopyPaste=1]="CopyPaste";n[n.DragFill=2]="DragFill";n[n.DragDrop=3]="DragDrop";n[n.ChangePartOfArrayFormula=4]="ChangePartOfArrayFormula";n[n.ChangeSheetName=5]="ChangeSheetName"}(t.InvalidOperationType||(t.InvalidOperationType={}));cu=t.InvalidOperationType,function(n){n[n.CurrentCulture=0]="CurrentCulture";n[n.CurrentCultureIgnoreCase=1]="CurrentCultureIgnoreCase";n[n.InvariantCulture=2]="InvariantCulture";n[n.InvariantCultureIgnoreCase=3]="InvariantCultureIgnoreCase";n[n.Ordinal=4]="Ordinal";n[n.OrdinalIgnoreCase=5]="OrdinalIgnoreCase"}(t.StringComparison||(t.StringComparison={}));lu=t.StringComparison,function(n){n[n.Underline=1]="Underline";n[n.LineThrough=2]="LineThrough";n[n.Overline=4]="Overline";n[n.None=0]="None"}(t.TextDecorationType||(t.TextDecorationType={}));au=t.TextDecorationType,function(n){n[n.Filter=0]="Filter";n[n.Unfilter=1]="Unfilter"}(t.FilterActionType||(t.FilterActionType={}));vu=t.FilterActionType,function(n){n[n.Auto=1]="Auto";n[n.Active=2]="Active";n[n.Inactive=4]="Inactive";n[n.Disabled=0]="Disabled"}(t.ImeMode||(t.ImeMode={}));yu=t.ImeMode,function(n){n[n.Active=1]="Active";n[n.Edit=2]="Edit";n[n.Normal=3]="Normal"}(t.CommentState||(t.CommentState={}));pu=t.CommentState,function(n){n[n.DataModified=0]="DataModified";n[n.DataAdded=1]="DataAdded";n[n.DataRemoved=2]="DataRemoved"}(t.SlicerDataChangeReason||(t.SlicerDataChangeReason={}));wu=t.SlicerDataChangeReason,function(n){n[n.Default=0]="Default";n[n.Enhanced=1]="Enhanced"}(t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}));bu=t.ResizeZeroIndicator;c=function(){function n(n,t){this.color=n||"black";this.style=t||0}return n.prototype.width=function(n){var t=w;if(n&&n.style)switch(n.style){case 9:case 1:case 3:case 4:case 7:case 11:return 1;case 2:case 10:case 12:case 8:case 13:return 2;case 5:case 6:return 3}return 0},n.getLineWeight=function(t){var i=n._styleWeightCache,r;return i||(i=[],n._styleWeightCache=i,r=w,i[9]=100,i[3]=100,i[4]=100,i[11]=100,i[7]=100,i[1]=101,i[13]=198,i[8]=198,i[10]=198,i[12]=198,i[2]=199,i[5]=300,i[6]=90,i[0]=0),i[t]},n.prototype.toJSON=function(){var n={};return(this.color!=="black"&&(n.color=this.color),this.style!==0&&(n.style=this.style),t.GC$.isEmptyObject(n))?i:n},n.prototype.fromJSON=function(n,t){n&&(n.color!==i&&(this.color=n.color),n.style!==i&&(this.style=n.style))},n}();t.LineBorder=c;ft=function(){var n={};return n["font-style"]=function(n,i){n&&t.GC$(i).css("fontStyle",n)},n["font-variant"]=function(n,i){n&&t.GC$(i).css("fontVariant",n)},n["font-weight"]=function(n,i){n&&t.GC$(i).css("fontWeight",n)},n["font-size"]=function(n,i){n&&t.GC$(i).css("fontSize",n)},n["line-height"]=function(n,i){n&&t.GC$(i).css("lineHeight",n)},n["font-family"]=function(n,i){n&&t.GC$(i).css("fontFamily",n)},n}();ot=function(){function n(n){this._sheet=n}return n.prototype.buildFont=function(n,i){var e="",u,f;if(n){u=ku(this._sheet);try{i&&t.GC$(u.span).css("font",i);t.GC$.each(ft,function(t,i){i(n.hasOwnProperty(t)?n[t]:r,u.span)})}finally{f=u.span.currentStyle;document.defaultView&&document.defaultView.getComputedStyle&&(f=document.defaultView.getComputedStyle(u.span,""));e=et(f);u.dispose()}}return e},n}();t.FontFactory=ot,function(n){n[n.BaseCellType=0]="BaseCellType";n[n.TextCellType=1]="TextCellType";n[n.ColumnHeaderCellType=2]="ColumnHeaderCellType";n[n.RowHeaderCellType=3]="RowHeaderCellType";n[n.CornerCellType=4]="CornerCellType";n[n.CheckBoxCellType=5]="CheckBoxCellType";n[n.ButtonCellType=6]="ButtonCellType";n[n.ComboBoxCellType=7]="ComboBoxCellType";n[n.HyperLinkCellType=8]="HyperLinkCellType"}(t.CellTypeKind||(t.CellTypeKind={}));du=t.CellTypeKind,function(n){n[n.Never=0]="Never";n[n.Always=1]="Always";n[n.Auto=2]="Auto"}(t.FocusPolicy||(t.FocusPolicy={}));gu=t.FocusPolicy,function(n){n[n.Excel2007=2007]="Excel2007";n[n.Excel2013=2013]="Excel2013";n[n.Excel2016=2016]="Excel2016"}(t.ThemeVersion||(t.ThemeVersion={}));nf=t.ThemeVersion;st=function(){function u(n,t,r,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut){if(this._id=u._styleId++,arguments.length!==0){var ft=this;ft.backgroundImage=b;ft.backgroundImageLayout=d;ft.backColor=n;ft.foreColor=t;ft.hAlign=r;ft.vAlign=f;ft.font=e;ft.themeFont=o;ft.formatter=s;ft.borderLeft=h;ft.borderTop=c;ft.borderRight=l;ft.borderBottom=a;ft.locked=v;ft.textIndent=y;ft.wordWrap=p;ft.shrinkToFit=w;ft.validator=i;ft.cellType=k;ft.tabStop=g;ft.textDecoration=nt;ft.imeMode=tt;ft.name=it;ft.parentName=rt;ft.watermark=ut}}return u.prototype._initDefault=function(){var n=this;n.backgroundImage=i;n.backgroundImageLayout=i;n.backColor=i;n.foreColor=i;n.hAlign=i;n.vAlign=i;n.font=i;n.themeFont=i;n.formatter=i;n.validator=i;n.borderLeft=i;n.borderTop=i;n.borderRight=i;n.borderBottom=i;n.locked=i;n.textIndent=i;n.wordWrap=i;n.shrinkToFit=i;n.cellType=i;n.name=i;n.parentName=i;n.tabStop=i;n.textDecoration=i;n.imeMode=i;n.watermark=i},u.prototype.copyFrom=function(n){this.fromJSON(n.toJSON());n._autoFormatter&&(this._autoFormatter=n._autoFormatter)},u.prototype._copyFormat=function(i){var r=i,u,f;return t.features.formatter&&r&&r.constructor===Object&&(u=i.typeName,u?(f=n.Sheets.getTypeFromString(u),f&&(r=new f,r.fromJSON(i))):r=new t.GeneralFormatter(i.formatCached,i.formatModeType,i.customerCultureName)),r},u.prototype._cloneLineBorder=function(n){return n&&n instanceof c?new c(n.color,n.style):n},u.prototype.compose=function(n,t){var r=this,u=r._cloneLineBorder,f,e,o,s;t?(r._autoFormatter=n._autoFormatter,r.backgroundImage=n.backgroundImage,r.backgroundImageLayout=n.backgroundImageLayout,r.backColor=n.backColor,r.foreColor=n.foreColor,r.hAlign=n.hAlign,r.vAlign=n.vAlign,r.font=n.font,r.themeFont=n.themeFont,r.formatter=n.formatter,f=n.borderLeft,r.borderLeft=f&&u(f)||f,e=n.borderTop,r.borderTop=e&&u(e)||e,o=n.borderRight,r.borderRight=o&&u(o)||o,s=n.borderBottom,r.borderBottom=s&&u(s)||s,r.locked=n.locked,r.textIndent=n.textIndent,r.wordWrap=n.wordWrap,r.shrinkToFit=n.shrinkToFit,r.validator=n.validator,r.cellType=n.cellType,r.name=n.name,r.parentName=n.parentName,r.tabStop=n.tabStop,r.textDecoration=n.textDecoration,r.imeMode=n.imeMode,r.watermark=n.watermark):(r.backgroundImage===i&&(r.backgroundImage=n.backgroundImage),r.backgroundImageLayout===i&&(r.backgroundImageLayout=n.backgroundImageLayout),r.backColor===i&&(r.backColor=n.backColor),r.foreColor===i&&(r.foreColor=n.foreColor),r.hAlign===i&&(r.hAlign=n.hAlign),r.vAlign===i&&(r.vAlign=n.vAlign),r.themeFont===i&&r.font===i?(r.themeFont=n.themeFont,r.font=n.font):r.themeFont!==i&&r.font===i&&(r.font=n.font),r.formatter===i&&(r.formatter=n.formatter),r.validator===i&&(r.validator=n.validator),r._autoFormatter===i&&(r._autoFormatter=n._autoFormatter),r.borderLeft===i&&(f=n.borderLeft,r.borderLeft=f&&u(f)||f),r.borderTop===i&&(e=n.borderTop,r.borderTop=e&&u(e)||e),r.borderRight===i&&(o=n.borderRight,r.borderRight=o&&u(o)||o),r.borderBottom===i&&(s=n.borderBottom,r.borderBottom=s&&u(s)||s),r.locked===i&&(r.locked=n.locked),r.textIndent===i&&(r.textIndent=n.textIndent),r.wordWrap===i&&(r.wordWrap=n.wordWrap),r.shrinkToFit===i&&(r.shrinkToFit=n.shrinkToFit),r.cellType===i&&(r.cellType=n.cellType),r.tabStop===i&&(r.tabStop=n.tabStop),r.textDecoration===i&&(r.textDecoration=n.textDecoration),r.imeMode===i&&(r.imeMode=n.imeMode),r.name===i&&(r.name=n.name),r.parentName===i&&(r.parentName=n.parentName),r.watermark===i&&(r.watermark=n.watermark))},u.prototype.clear=function(n){if(arguments.length===0){this._initDefault();return}n==="dataValidator"&&(n="validator");this[n]=i},u.prototype.clone=function(n){var t=this,i=t._cloneLineBorder,r=new u(t.backColor,t.foreColor,t.hAlign,t.vAlign,t.font,t.themeFont,t.formatter,t.borderLeft&&!n&&i(t.borderLeft)||t.borderLeft,t.borderTop&&!n&&i(t.borderTop)||t.borderTop,t.borderRight&&!n&&i(t.borderRight)||t.borderRight,t.borderBottom&&!n&&i(t.borderBottom)||t.borderBottom,t.locked,t.textIndent,t.wordWrap,t.shrinkToFit,t.backgroundImage,t.cellType,t.backgroundImageLayout,t.tabStop,t.textDecoration,t.imeMode,t.name,t.parentName,t.watermark);return r._autoFormatter=t._autoFormatter,t.validator&&t.validator.clone&&(r.validator=t.validator.clone()),r},u.prototype._normalize=function(n){var t=this,i,f,u,e,r;if(n&&n.getColor)for(i=t.foreColor,i&&(i=n.getColor(i),i&&(t.foreColor=i)),i=t.backColor,i&&(i=n.getColor(i),i&&(t.backColor=i)),f=[t.borderLeft,t.borderTop,t.borderRight,t.borderBottom],u=0,e=f.length;u<e;u++)r=f[u],r&&r.color&&(i=n.getColor(r.color),i&&(r.color=i));return n&&n.getFont&&(t.themeFont?t.font=p.composeFont(t.font,n.getFont(t.themeFont)):t.font||(t.font=p.composeFont(t.font,n.bodyFont()))),t},u.prototype._setActualAutoFormatter=function(n){var t=this;if(t&&t._autoFormatter&&t._autoFormatter._innerFormatter&&n!==r){var i=t._autoFormatter._innerFormatter,f=i.formatCached,u=i.GetPreferredEditingFormatter(n);f!==u.formatCached&&(t._autoFormatter._innerFormatter=u)}},u.prototype._getCellTypeKinds=function(){var i={};return i[0]=n.Sheets.BaseCellType,i[1]=n.Sheets.TextCellType,i[2]=n.Sheets.ColumnHeaderCellType,i[3]=n.Sheets.RowHeaderCellType,i[4]=n.Sheets.CornerCellType,t.features.celltype&&(i[5]=n.Sheets.CheckBoxCellType,i[6]=n.Sheets.ButtonCellType,i[7]=n.Sheets.ComboBoxCellType,i[8]=n.Sheets.HyperLinkCellType),i},u.prototype.toJSON=function(n,r){var u=this,s={backgroundImage:u.backgroundImage,backgroundImageLayout:u.backgroundImageLayout,backColor:u.backColor,foreColor:u.foreColor,hAlign:u.hAlign,vAlign:u.vAlign,font:u.font,themeFont:u.themeFont,formatter:u.formatter,locked:u.locked,textIndent:u.textIndent,wordWrap:u.wordWrap,shrinkToFit:u.shrinkToFit,validator:u.validator?u.validator.toJSON():i,cellType:u.cellType?u.cellType.toJSON():i,name:u.name,parentName:u.parentName,tabStop:u.tabStop,textDecoration:u.textDecoration,imeMode:u.imeMode,borderLeft:u.borderLeft?u.borderLeft.toJSON():i,borderRight:u.borderRight?u.borderRight.toJSON():i,borderTop:u.borderTop?u.borderTop.toJSON():i,borderBottom:u.borderBottom?u.borderBottom.toJSON():i,watermark:u.watermark,autoFormatter:u._autoFormatter?u._autoFormatter.toJSON():i},o={},f,e;for(f in s)e=s[f],e===i||r&&u._isDefaultValue(f,e,n)||(o[f]=e);return t.GC$.isEmptyObject(o)?i:o},u.prototype._isDefaultValue=function(n,t,r){switch(n){case"hAlign":return r===2?t===1:r===1?t===1:t===3;case"vAlign":return r===2?t===1:r===1?t===1:t===0;case"imeMode":return t===1;case"autoFormatter":return t===i}},u.prototype.fromJSON=function(u,f){var e,h,s,a,v,y,p,w;if(u){if(e=this,u.backgroundImage!==i&&(e.backgroundImage=u.backgroundImage),u.backgroundImageLayout!==i&&(e.backgroundImageLayout=u.backgroundImageLayout),u.backColor!==i&&(e.backColor=u.backColor),u.foreColor!==i&&(e.foreColor=u.foreColor),u.hAlign!==i&&(e.hAlign=u.hAlign),u.vAlign!==i&&(e.vAlign=u.vAlign),u.font!==i&&(e.font=u.font),u.themeFont!==i&&(e.themeFont=u.themeFont),u.formatter!==i&&(e.formatter=this._copyFormat(u.formatter)),u.locked!==i&&(e.locked=u.locked),u.textIndent!==i&&(e.textIndent=u.textIndent),u.wordWrap!==i&&(e.wordWrap=u.wordWrap),u.shrinkToFit!==i&&(e.shrinkToFit=u.shrinkToFit),u.validator!==i&&(h=new n.Sheets.DefaultDataValidator,h.fromJSON(u.validator),e.validator=h),s=u.cellType,s!==i){var l,b=e._getCellTypeKinds(),d=s.type,k=s.typeName,o=b[d];o||(o=b[k]);o||(o=n.Sheets.getTypeFromString(k));o&&(l=new o,l.fromJSON(s,f));e.cellType=l}u.name!==i&&(e.name=u.name);u.parentName!==i&&(e.parentName=u.parentName);u.tabStop!==i&&(e.tabStop=u.tabStop);u.textDecoration!==i&&(e.textDecoration=u.textDecoration);u.imeMode!==i&&(e.imeMode=u.imeMode);u.borderLeft!==i&&(a=new c,a.fromJSON(u.borderLeft,f),e.borderLeft=a);u.borderRight!==i&&(v=new c,v.fromJSON(u.borderRight,f),e.borderRight=v);u.borderTop!==i&&(y=new c,y.fromJSON(u.borderTop,f),e.borderTop=y);u.borderBottom!==i&&(p=new c,p.fromJSON(u.borderBottom,f),e.borderBottom=p);u.watermark!==i&&(e.watermark=u.watermark);u.autoFormatter!==i&&(w=new t.AutoFormatter(r),w.fromJSON(u.autoFormatter),e._autoFormatter=w)}},u._styleId=0,u}();t.Style=st;p=function(){function n(){}return n.composeFont=function(t,i){return i?n.normalizeFont(t,i):t},n.splitFont=function(n){if(!n)return{};var i,t;return i=document.createElement("div"),i.style.font=n,t=i.style,{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight}},n.normalizeFont=function(i,r){var f,e,o,u,s;if(!i&&!r)return i;if(f=n,f.measureSpan?f._resetMeasureSpan():f._createMeasureSpan(),e=f.measureSpan,i){if(o=r?i+"+"+r:i,u=f._fontStringCatch[o],u)return u;t.GC$(e).css("font",i)}else{if(o=r,u=f._fontStringCatch[o],u)return u;t.GC$(e).css("fontSize",t.DefaultFontSize)}return r&&t.GC$(e).css("fontFamily",r),s=e.currentStyle,document.defaultView&&document.defaultView.getComputedStyle&&(s=document.defaultView.getComputedStyle(e,"")),u=et(s),f._fontStringCatch[o]=u,f._fontStringCatch[u]=u,u},n._scaleFont=function(t,i,r,u){var h=n,y=h.scaleFontInfoCache[i],e,o,p,w,c,s,l,a,b;if(!u)if(y){if(e=y[t],e)return e}else y=h.scaleFontInfoCache[i]={};return h.measureSpan?h._resetMeasureSpan():h._createMeasureSpan(),o=h.measureSpan,o.style.font=t,p=o.currentStyle,w=document.defaultView,w&&w.getComputedStyle&&(p=w.getComputedStyle(o,"")),c=p.fontSize,s="px",c.indexOf(s)!==-1&&(l=f(1,v(parseFloat(c.replace(s,""))*i)),r&&l===1&&(r.value=!0),c=l+s),a=p.lineHeight,a.indexOf(s)!==-1&&(b=f(1,v(parseFloat(a.replace(s,""))*i)),a=b+s),i===1?e={font:t,fontSize:l}:(o.style.fontSize=c,o.style.lineHeight=a,e={font:o.style.font,fontSize:l}),u||(y[t]=e),e},n.composeTextDecoration=function(n){if(n<=0)return"none";var t="";return(n|1)===n&&(t+="underline "),(n|2)===n&&(t+="line-through "),(n|4)===n&&(t+="overline "),t.trim()},n._createMeasureSpan=function(){var t=document.createElement("span"),n=t.style;n.visibility="hidden";n.top="-10000px";n.left="-10000px";n.lineHeight="normal";document.body.insertBefore(t,r);this.measureSpan=t;this.measureSpanOriginalStyleText=n.cssText},n._resetMeasureSpan=function(){this.measureSpan.style.cssText=this.measureSpanOriginalStyleText},n._disposeMeasureSpan=function(){var n=this.measureSpan;n&&(t.GC$(n).remove(),this.measureSpan=i,this.measureSpanOriginalStyleText=i)},n.setStringFont=function(t,i){var r,u,f;if(!t)return"";r=n;r.measureSpan?r._resetMeasureSpan():r._createMeasureSpan();u=r.measureSpan;u.style.font=t;for(f in i)i.hasOwnProperty(f)&&(u.style[f]=i[f]);return u.style.font},n._fontStringCatch={},n.scaleFontInfoCache={},n}();t.StyleHelper=p;ht=function(){function n(n,t,i,r){var u=this;u._name=n;u._baseRow=i;u._baseColumn=r;u._expr=t}return n.prototype.getName=function(){return this._name},n.prototype.getRow=function(){return this._baseRow},n.prototype.getColumn=function(){return this._baseColumn},n.prototype.getExpression=function(){return this._expr},n.prototype.setExpression=function(n){this._expr=n},n}();t.NameInfo=ht;ct=function(){function n(){}return n.getColor=function(n,t){if(n&&t){var i=n._currentTheme;if(i)return i.getColor(t)}return t},n.getFont=function(n,t){if(n&&t){var i=n._currentTheme;return i?i.getFont(t):t}return r},n}();t._ThemeContext=ct;lt=function(){function n(n){var t=this;t.host=n;t.interval=r;t.action=r;t.intervalId=r;t.result=r;t.working=!1;t._needIncrease=!1}return n.prototype.setAction=function(n){typeof n=="function"&&(this.action=n)},n.prototype.setInterval=function(n){var t=this,i;isNaN(n)||n===0?t.stop():(t._needIncrease=n>0?!0:!1,n=ti(n),i=t.interval,t.interval=n,i!==n&&t.start())},n.prototype.start=function(){var n=this;n.clear();isNaN(n.interval)||(n.intervalId=setInterval(function(){n.run()},n.interval))},n.prototype.run=function(){var n=this;n.working=!0;typeof n.action=="function"&&(n.result=n.action.call(n.host,n._needIncrease))},n.prototype.stop=function(){var n=this;n.clear();n.interval=r;n.intervalId=r;n.result=r;n.working=!1},n.prototype.clear=function(){this.intervalId&&clearInterval(this.intervalId)},n.prototype._dispose=function(){this.stop()},n}();t.Timer=lt;at=function(){function n(){}return n.ValidationError="ValidationError",n.CellClick="CellClick",n.CellDoubleClick="CellDoubleClick",n.EnterCell="EnterCell",n.LeaveCell="LeaveCell",n.ValueChanged="ValueChanged",n.TopRowChanged="TopRowChanged",n.LeftColumnChanged="LeftColumnChanged",n.InvalidOperation="InvalidOperation",n.RangeFiltering="RangeFiltering",n.RangeFiltered="RangeFiltered",n.TableFiltering="TableFiltering",n.TableFiltered="TableFiltered",n.RangeSorting="RangeSorting",n.RangeSorted="RangeSorted",n.ClipboardChanging="ClipboardChanging",n.ClipboardChanged="ClipboardChanged",n.ClipboardPasting="ClipboardPasting",n.ClipboardPasted="ClipboardPasted",n.ColumnWidthChanging="ColumnWidthChanging",n.ColumnWidthChanged="ColumnWidthChanged",n.RowHeightChanging="RowHeightChanging",n.RowHeightChanged="RowHeightChanged",n.DragDropBlock="DragDropBlock",n.DragDropBlockCompleted="DragDropBlockCompleted",n.DragFillBlock="DragFillBlock",n.DragFillBlockCompleted="DragFillBlockCompleted",n.EditStarting="EditStarting",n.EditStarted="EditStarted",n.EditChange="EditChange",n.EditEnding="EditEnding",n.EditEnd="EditEnd",n.EditEnded="EditEnded",n.RangeGroupStateChanging="RangeGroupStateChanging",n.RangeGroupStateChanged="RangeGroupStateChanged",n.SelectionChanging="SelectionChanging",n.SelectionChanged="SelectionChanged",n.SheetTabClick="SheetTabClick",n.SheetTabDoubleClick="SheetTabDoubleClick",n.SheetNameChanging="SheetNameChanging",n.SheetNameChanged="SheetNameChanged",n.UserZooming="UserZooming",n.UserFormulaEntered="UserFormulaEntered",n.CellChanged="CellChanged",n.ColumnChanged="ColumnChanged",n.RowChanged="RowChanged",n.ActiveSheetChanging="ActiveSheetChanging",n.ActiveSheetChanged="ActiveSheetChanged",n.SparklineChanged="SparklineChanged",n.RangeChanged="RangeChanged",n.ButtonClicked="ButtonClicked",n.EditorStatusChanged="EditorStatusChanged",n.CultureChanged="SpreadJSCultureChanged",n.FloatingObjectChanged="FloatingObjectChanged",n.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",n.PictureChanged="PictureChanged",n.FloatingObjectRemoving="FloatingObjectRemoving",n.FloatingObjectRemoved="FloatingObjectRemoved",n.PictureSelectionChanged="PictureSelectionChanged",n.CustomFloatingObjectLoaded="CustomFloatingObjectLoaded",n.TouchToolStripOpening="TouchToolStripOpening",n.CommentChanged="CommentChanged",n.CommentRemoving="CommentRemoving",n.CommentRemoved="CommentRemoved",n.SlicerChanged="SlicerChanged",n}();t.Events=at;b=function(){function n(){return Array.apply(this,arguments),[]}return n.prototype.pop=function(){return r},n.prototype.push=function(n){return 0},n.prototype.splice=function(n,t){for(var u=[],i=0;i<arguments.length-2;i++)u[i]=arguments[i+2];return r},n.prototype.slice=function(n,t){return null},n}();t._XArray=b;b.prototype=[];vt=function(){function n(n){this._sheet=n}return n.prototype.getCellOverflowBuilder=function(n,t,i){var u=this._cellOverflowBuilderCache,f=n<<4+t,r;return u?(r=u[f],r||(r=i(),u[f]=r),r):i()},n.prototype.getConditionalFormat=function(n,t){var r=this._conditionalFormatCache,i;return r?(i=r[n],i)?i[t]:null:null},n.prototype.setConditionalFormat=function(n,t,i,r){var f=this._conditionalFormatCache,u;f&&(u=f[n],u||(u={},f[n]=u),u[t]={d:i,i:r})},n.prototype.getValue=function(n,t,i){var e=this._valueCache,r,u,f;return e?(i===undefined&&(i=3),r=e[i],r||(r={},e[i]=r),u=r[n],u||(u={},r[n]=u),f=u[t],f===undefined&&(f=this._sheet.getValue(n,t,i),u[t]=f),f):this._sheet.getValue(n,t,i)},n.prototype.getActualStyle=function(n,t,i){var e=this._styleCache,r,u,f;return e?(i===undefined&&(i=3),r=e[i],r||(r={},e[i]=r),u=r[n],u||(u={},r[n]=u),f=u[t],f||(f=this._sheet.getActualStyle(n,t,i,!1,!0),u[t]=f),f.clone(!0)):this._sheet.getActualStyle(n,t,i,!1,!1)},n.prototype.getZoomRowHeight=function(n){var i=this._rowHeightCache,t;return i?(t=i[n],t===undefined&&(t=i[n]=this._sheet._getZoomRowHeight(n)),t):this._sheet._getZoomRowHeight(n)},n.prototype.getZoomColWidth=function(n){var i=this._colWidthCache,t;return i?(t=i[n],t===undefined&&(t=i[n]=this._sheet._getZoomColumnWidth(n)),t):this._sheet._getZoomColumnWidth(n)},n.prototype.getRowGroups=function(n){var t=this;return t._valueCache?(t._rowGroups||(t._rowGroups=n()),t._rowGroups):n()},n.prototype.getColGroups=function(n){var t=this;return t._valueCache?(t._colGroups||(t._colGroups=n()),t._colGroups):n()},n.prototype.startCacheBeforPan=function(){var n=this;n._isCaching=!0;n._cellOverflowBuilderCache={};n._conditionalFormatCache={};n._valueCache={};n._styleCache={};n._rowHeightCache={};n._colWidthCache={}},n.prototype.endCache=function(){this._isCaching=!1},n.prototype.clearCacheEndPan=function(){var n=this;n._isCaching=!1;n._cellOverflowBuilderCache=null;n._conditionalFormatCache=null;n._valueCache=null;n._styleCache=null;n._colWidthCache=null;n._rowHeightCache=null;n._rowGroups=null;n._colGroups=null},n.prototype.isCaching=function(){return this._isCaching},n}();t._CachePool=vt;yt=function(){function n(){}return n.startCache=function(t,i,r,u,f){var h=n,c,o,s,e;if(h._cached=!0,c=t.getRowCount(),t._hasTable(i,r,u-i+1,f-r+1))for(o=-1,s=h._visibleRowIndexCache=[],e=0;e<=u;e++)t.getRowVisible(e)?(o++,s[e]=o):s[e]=-1},n.clearCache=function(){n._visibleRowIndexCache=null;n._cached=!1},n.getFormatter=function(i){var u=n,r=u._formatterCache[i];return r||(r=new t.GeneralFormatter(i),u._formatterCache[i]=r),r},n.getFormattedText=function(i,u,f){var c=n,v=c._formattedTextCache,e,s,o,a;if(t.features.formatter){if(e=v[u],e||(e={},v[u]=e),s=e[i],s)return f&&(f.value=s.color),s.text;o=r;o=c._formatterCache[u];o||(o=new t.GeneralFormatter(u),c._formatterCache[u]=o);var y=typeof i=="number",l={},h=o.Format(i,l);return y&&(h=t._NumberHelper.replaceNormalToCultureSymble(h)),a=e[i]={},a.text=h,a.color=l.value,f&&(f.value=l.value),h}else return i.toString()},n.getFormattedTextByStyle=function(n,t,i,u){var f=t.cellType||n.getDefaultCellType(),e=t.formatter||t._autoFormatter;return f.format(i,e,u,r)},n.clearFormatCache=function(){n._formatterCache={};n._formattedTextCache={}},n._cached=!1,n._formatterCache={},n._formattedTextCache={},n}();t._CacheMgr=yt;pt=function(){function n(){}return n.setStyle=function(t,i,r,u){var e,f;t&&(e=n,e.removeDataValidator(i,r,u),f=t.validator&&t.validator.condition,f&&f.getFormulas&&f.getFormulas().length>0&&e.addDataValidator(t.validator,i,r,u))},n.addDataValidator=function(t,i,r,u){var s=i._id,h=n._cache,e=h[t.id],f,o;e||(e=h[t.id]={validator:t,sheet:i});f=e[s];f||(f=e[s]={});o=r+"_"+u;f[o]||(f[o]=!0)},n.removeDataValidator=function(t,i,r){var e=t._id,o=n._cache,s,u,f,h,c;for(s in o)if(u=o[s],u&&(f=u[e],f||(f=u[e]={}),h=i+"_"+r,f[h])){delete f[h];for(c in f)return;delete u[e];for(c in u)return;delete o[s];return}},n.removeSheet=function(t){var r=n._cache,u,i,f;for(u in r)if(i=r[u],i[t]){delete i[t];for(f in i)return;delete r[u]}},n.getAllValidators=function(){var t=[],i=n._cache;for(var r in i)t.push(i[r]);return t},n.clear=function(){this._cache={}},n._cache={},n}();t._DataValidatorCache=pt;wt=function(){function n(){}return n.addElements=function(n,t,i,r){var f,o,u,e,s;if(n&&0<=i&&i<t){for(f=[],u=i;u<t;u++)typeof n[u]!="undefined"&&f.push(u);for(o=f.length,u=0;u<o;u++)e=f[o-u-1],s=n[e],n[e]=null,n[Math.floor(e)+r]=s}},n.deleteElements=function(n,t,i,r){var f,s,o,u,e,h;if(n&&0<=i&&i<t){for(f=[],o=i+r,u=i;u<t;u++)typeof n[u]!="undefined"&&(i<=u&&u<o?n[u]=null:u>=o&&f.push(u));for(s=f.length,u=0;u<s;u++)e=f[u],h=n[e],n[e]=null,n[Math.floor(e)-r]=h}},n}();t._ModelHelper=wt,function(n){n[n.None=0]="None";n[n.Normal=1]="Normal";n[n.Knockout=2]="Knockout";n[n.DataView=3]="DataView";n[n.CellBinding=4]="CellBinding"}(t._DataSourceType||(t._DataSourceType={}));tf=t._DataSourceType,function(n){n[n.normal=0]="normal";n[n.arrayFormula=1]="arrayFormula";n[n.sharedFormula=2]="sharedFormula"}(t.EndEditType||(t.EndEditType={}));rf=t.EndEditType;bt=function(){function n(){}return n}();t.FormulaInformation=bt;kt=function(){function n(){}return n.getReg=function(t){var i=n.regDict[t];return i||(i=n.regDict[t]=new RegExp(t,"g")),i.lastIndex=0,i},n.getRegIgnoreCase=function(t){var i=n.regDictIgnoreCase[t];return i||(i=n.regDictIgnoreCase[t]=new RegExp(t,"gi")),i.lastIndex=0,i},n.getWildcardCriteria=function(t){if(n.wildcardParseRecord[t])return n.wildcardParseResultBuffer[t];if(n.getReg("[~?*]+").test(t)){var i=t,f=n.getReplaceSymbol("asterisk",i),e=n.getReplaceSymbol("question",i),o=n.getReplaceSymbol("tilde",i);return i=u.replace(i,"~~",o),i=u.replace(i,"~*",f),i=u.replace(i,"~?",e),i=i.replace(n.getReg("([.+$^\\[\\](){}|/])"),"\\$1"),i=u.replace(i,"*",".*"),i=u.replace(i,"?","."),i=u.replace(i,f,"\\*"),i=u.replace(i,e,"\\?"),i=u.replace(i,o,"~"),n.wildcardParseResultBuffer[t]=i,n.wildcardParseRecord[t]=!0,i}return r},n.getWildcardCriteriaFullMatch=function(t){var i=n.getWildcardCriteria(t);return i&&(i="^"+i+"$"),i},n.getReplaceSymbol=function(n,t){for(var i="#"+n+"0#",r=1;r<1e4;r++){if(t.indexOf(i)>0){i=u.replace(i,"#"+n+(r-1)+"#","#"+n+r+"#");continue}return i}},n.regDict={},n.regDictIgnoreCase={},n.wildcardParseRecord={},n.wildcardParseResultBuffer={},n}();t.RegUtil=kt;u=function(){function n(){}return n.replace=function(n,t,i){return n.split(t).join(i)},n.startsWith=function(n,t){return n.indexOf(t)===0},n.endsWith=function(n,t){var i=n.length-t.length;return i>=0&&n.indexOf(t,i)===i},n.leftBefore=function(n,t){var i=n.indexOf(t);return i<0||i>=n.length?n:n.substr(0,i)},n.contains=function(n,t){return n.indexOf(t)>=0},n.count=function(n,t){for(var r=0,i=n.indexOf(t);i>=0;)r+=1,i=n.indexOf(t,i+1);return r},n}();t.StringUtil=u;dt=function(){function n(){}return n.getDevicePixel=function(){var t=window.devicePixelRatio||window.screen.deviceXDPI&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,n=t*20,i=Math.round(n),r=i-n;return Math.round(n)-n>.82?i/20:Math.round(t*100)/100},n.adjustDevicePixel=function(t,i,r,u){var e=n,a,l,s,o,h,c,f;if(e.setScaleX(t,t.getContext("2d"),1),e.setScaleY(t,t.getContext("2d"),1),a=e.getDevicePixel(),a!==1||e.dpr!==1){if(e.dpr=a,l=i?i:r&&r.parent,l){for(s=e._spreadConvasCaches,f=0;f<s.length;f++)if(l===s[f].spread){o=s[f];break}if(o||(o={spread:l,sheets:[],canvases:[]},s.push(o)),i)o.canvases.push(t);else{for(c=o.sheets,f=0;f<c.length;f++)if(c[f].sheet===r){h=c[f];break}h||(h={sheet:r,canvases:[]},c.push(h));h.canvases.push(t)}}return}},n.getScaleX=function(n){return n?n._gcDPIScaleX||1:1},n.getScaleY=function(n){return n?n._gcDPIScaleY||1:1},n.setScaleX=function(n,t,i){n&&(n._gcDPIScaleX=i,t._gcDPIScaleX=i)},n.setScaleY=function(n,t,i){n&&(n._gcDPIScaleY=i,t._gcDPIScaleY=i)},n.getLogicWidth=function(n){return n._gcLogicWidth},n.getLogicHeight=function(n){return n._gcLogicHeight},n.setLogicWidth=function(n,t){n._gcLogicWidth=t},n.setLogicHeight=function(n,t){n._gcLogicHeight=t},n.setSize=function(t,i,r){var u=n,f=u.dpr,c=u.getScaleX(t),l=u.getScaleY(t),e,o,h;u.setLogicWidth(t,i);u.setLogicHeight(t,r);f===1&&c===1&&l===1?(t.width=i,t.height=r):(e=t.getContext("2d"),e.scale(1/c,1/l),s.browser.mozilla?(t.width=Math.ceil(i*f),t.height=Math.ceil(r*f)):(t.width=Math.round(i*f),t.height=Math.round(r*f)),t.style.width=i+"px",t.style.height=r+"px",o=t.width/i,h=t.height/r,(o!==c||h!==l)&&(u.setScaleX(t,e,o),u.setScaleY(t,e,h)),e.scale(o,h))},n.disposeCanvasForSheet=function(t,i){for(var r,u,s=n._spreadConvasCaches,h=t.parent,f,e,o=0;o<s.length;o++)if(!h||s[o].spread===h)for(f=s[o].sheets,r=0;r<f.length;r++)if(f[r].sheet===t){for(e=f[r].canvases,u=0;u<e.length;u++)if(e[u]===i){e.splice(u,1);break}break}},n.disposeCanvasForSpread=function(t,i){for(var r,e=n._spreadConvasCaches,u,f=0;f<e.length;f++)if(e[f].spread===t)for(u=e[f].canvases,r=0;r<u.length;r++)if(u[r]===i){u.splice(r,1);break}},n.disposeSheet=function(t){for(var i,f=n._spreadConvasCaches,e=t.parent,r,u=0;u<f.length;u++)if(!e||f[u].spread===e){for(r=f[u].sheets,i=0;i<r.length;i++)r[i].sheet===t&&r.splice(i,1);return}},n.disposeSpread=function(t){for(var r=n._spreadConvasCaches,i=0;i<r.length;i++)if(r[i].spread===t){r.splice(i,1);return}},n.updateDPI=function(t,i){var r=n,l=r.getDevicePixel(),c,o,s,u,h,e,f;if(r.dpr!=l)for(c=r._spreadConvasCaches,r.dpr=l,h=0;h<c.length;h++){for(s=c[h],f=0;f<s.canvases.length;f++)u=s.canvases[f],r.setSize(u,r.getLogicWidth(u),r.getLogicHeight(u));for(o=s.sheets,e=0;e<o.length;e++)for(f=0;f<o[e].canvases.length;f++)u=o[e].canvases[f],r.setSize(u,r.getLogicWidth(u),r.getLogicHeight(u))}},n.dpr=1,n._spreadConvasCaches=[],n}();t.DPIHelper=dt;k=function(){function n(){}return n.handleFormulatextboxAcrossSheetBeforeTabChange=function(n,t){},n.handleFormulatextboxAcrossSheetAfterTabChange=function(n,t){},n}();t.IFormulatextboxAcrossSheetSingleton=k,function(n){n[n.Cell=0]="Cell";n[n.ExternalCell=1]="ExternalCell";n[n.Range=2]="Range";n[n.ExternalRange=3]="ExternalRange";n[n.Double=4]="Double";n[n.String=5]="String";n[n.Boolean=6]="Boolean";n[n.Function=7]="Function";n[n.Name=8]="Name";n[n.ExternalName=9]="ExternalName";n[n.BinaryOperator=10]="BinaryOperator";n[n.UnaryOperator=11]="UnaryOperator";n[n.Error=12]="Error";n[n.ExternalError=13]="ExternalError";n[n.Parentheses=14]="Parentheses";n[n.Array=15]="Array";n[n.SheetRange=16]="SheetRange";n[n.StructReference=17]="StructReference";n[n.BangName=18]="BangName";n[n.SheetRangeError=19]="SheetRangeError";n[n.BangError=20]="BangError";n[n.MissingArgument=21]="MissingArgument";n[n.BangCell=22]="BangCell";n[n.BangRange=23]="BangRange";n[n.Expand=24]="Expand";n[n.NameIdentity=25]="NameIdentity";n[n.ExternalNameIdentity=26]="ExternalNameIdentity"}(t.ExpressionType||(t.ExpressionType={}));uf=t.ExpressionType})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(n){n.feature("core.imageLoader",["core.common"]);var t=function(){function t(n){this._imageCount=0;this._loadedCount=0;this.onLoadedComplete=n}return t.prototype.dispose=function(){this.onLoadedComplete=null},t.prototype.addImage=function(t){var i=this,f=i._imgs,r,u;f||(f=i._imgs={});r=f[t];r||(r={},u=n.GC$(document.createElement("img")),u.bind("load",function(){i.imageLoaded(t)}),u.bind("error",function(){i.imageLoaded(t)}),u.bind("abort",function(){i.imageLoaded(t)}),i._imageCount++,r.state=!1,r.img=u,f[t]=r,u.getElement(0).src=t)},t.prototype.getImage=function(n){return this._imgs[n].img.getElement(0)},t.prototype.getState=function(n){var t=this._imgs,i=t&&t[n];return i?i.state:!1},t.prototype.imageLoaded=function(n){var t=this;t._loadedCount++;t._imgs[n].state=!0;t.isAllImagesLoaded()&&t.onLoadedComplete&&t.onLoadedComplete()},t.prototype.isAllImagesLoaded=function(){return this._loadedCount>=this._imageCount},t}();n._GcImageLoader=t})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(n){var t,i,r,u;n.feature("core.cultureInfo");t=function(){function n(){this.currencyDecimalDigits=2;this.currencyDecimalSeparator=".";this.currencyGroupSeparator=",";this.currencyGroupSizes=[3];this.currencyNegativePattern=0;this.currencyPositivePattern=0;this.currencySymbol="\u00a4";this.digitSubstitution=1;this.isReadOnly=!0;this.nanSymbol="NaN";this.nativeDigits=["0","1","2","3","4","5","6","7","8","9"];this.negativeInfinitySymbol="-Infinity";this.negativeSign="-";this.numberDecimalDigits=2;this.numberDecimalSeparator=".";this.numberGroupSeparator=",";this.numberGroupSizes=[3];this.numberNegativePattern=1;this.percentDecimalDigits=2;this.percentDecimalSeparator=".";this.percentGroupSeparator=",";this.percentGroupSizes=[3];this.percentNegativePattern=0;this.percentPositivePattern=0;this.percentSymbol="%";this.perMilleSymbol="\u2030";this.positiveInfinitySymbol="Infinity";this.positiveSign="+";this.abbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];this.abbreviatedMonthGenitiveNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""];this.abbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""];this.amDesignator="AM";this.calendarIsReadOnly=!0;this.calendarWeekRule=0;this.dateSeparator="/";this.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.firstDayOfWeek=0;this.fullDateTimePattern="dddd, dd MMMM yyyy HH:mm:ss";this.longDatePattern="dddd, dd MMMM yyyy";this.longTimePattern="HH:mm:ss";this.monthDayPattern="MMMM dd";this.monthGenitiveNames=["January","February","March","April","May","June","July","August","September","October","November","December",""];this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December",""];this.nativeCalendarName="Gregorian Calendar";this.pmDesignator="PM";this.rfc1123Pattern="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'";this.shortDatePattern="MM/dd/yyyy";this.shortestDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"];this.shortTimePattern="HH:mm";this.sortableDateTimePattern="yyyy'-'MM'-'dd'T'HH':'mm':'ss";this.timeSeparator=":";this.universalSortableDateTimePattern="yyyy'-'MM'-'dd HH':'mm':'ss'Z'";this.yearMonthPattern="yyyy MMMM";this.listSeparator=",";this.arrayListSeparator=",";this.arrayGroupSeparator=";"}return n}();n.CultureInfo=t;i=function(n){function t(){n.apply(this,arguments);this.currencySymbol="$";this.isReadOnly=!1;this.fullDateTimePattern="dddd, MMMM dd, yyyy h:mm:ss tt";this.longDatePattern="dddd, MMMM dd, yyyy";this.longTimePattern="h:mm:ss tt";this.shortDatePattern="M/d/yyyy";this.shortTimePattern="h:mm tt";this.yearMonthPattern="MMMM, yyyy";this.calendarIsReadOnly=!1}return __extends(t,n),t}(t);n._ENCultureInfo=i;r=function(n){function t(){n.apply(this,arguments);this.currencyDecimalDigits=0;this.currencyNegativePattern=1;this.currencySymbol="\uffe5";this.isReadOnly=!1;this.nanSymbol="NaN (\u975e\u6570\u5024)";this.negativeInfinitySymbol="-\u221e";this.percentNegativePattern=1;this.percentPositivePattern=1;this.positiveInfinitySymbol="+\u221e";this.abbreviatedDayNames=["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"];this.abbreviatedMonthGenitiveNames=["1","2","3","4","5","6","7","8","9","10","11","12",""];this.abbreviatedMonthNames=["1","2","3","4","5","6","7","8","9","10","11","12",""];this.amDesignator="\u5348\u524d";this.calendarIsReadOnly=!1;this.dayNames=["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"];this.fullDateTimePattern="yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss";this.longDatePattern="yyyy'\u5e74'M'\u6708'd'\u65e5'";this.longTimePattern="H:mm:ss";this.monthDayPattern="M'\u6708'd'\u65e5'";this.monthGenitiveNames=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""];this.monthNames=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""];this.nativeCalendarName="\u897f\u66a6 (\u65e5\u672c\u8a9e)";this.pmDesignator="\u5348\u5f8c";this.shortDatePattern="yyyy/MM/dd";this.shortestDayNames=["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"];this.shortTimePattern="H:mm";this.yearMonthPattern="yyyy'\u5e74'M'\u6708'"}return __extends(t,n),t}(t);n._JACultureInfo=r;u=function(n){function t(){n.apply(this,arguments);this.currencyNegativePattern=2;this.currencySymbol="\uffe5";this.isReadOnly=!1;this.nanSymbol="\u975e\u6570\u5b57";this.negativeInfinitySymbol="\u8d1f\u65e0\u7a77\u5927";this.percentNegativePattern=1;this.percentPositivePattern=1;this.positiveInfinitySymbol="\u6b63\u65e0\u7a77\u5927";this.abbreviatedDayNames=["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"];this.abbreviatedMonthGenitiveNames=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""];this.abbreviatedMonthNames=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""];this.amDesignator="\u4e0a\u5348";this.calendarIsReadOnly=!1;this.dayNames=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"];this.firstDayOfWeek=1;this.fullDateTimePattern="yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss";this.longDatePattern="yyyy'\u5e74'M'\u6708'd'\u65e5'";this.longTimePattern="H:mm:ss";this.monthDayPattern="M'\u6708'd'\u65e5'";this.monthGenitiveNames=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""];this.monthNames=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""];this.nativeCalendarName="\u516c\u5386";this.pmDesignator="\u4e0b\u5348";this.shortDatePattern="yyyy/M/d";this.shortestDayNames=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"];this.shortTimePattern="H:mm";this.yearMonthPattern="yyyy'\u5e74'M'\u6708'"}return __extends(t,n),t}(t);n._ZHCultureInfo=u;n.cultureInfoDict={"":new t,"en-us":new i,"ja-jp":new r,"zh-cn":new u};n.CR=n.cultureInfoDict["en-us"];n.dateTimeFormats=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d","hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy hh:mm:s","MM/dd/yyyy hh:m:ss","MM/dd/yyyy hh:m:s","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy h:mm:s","MM/dd/yyyy h:m:ss","MM/dd/yyyy h:m:s","MM/dd/yyyy hh:mm:ss tt","MM/dd/yyyy hh:mm:s tt","MM/dd/yyyy hh:m:ss tt","MM/dd/yyyy hh:m:s tt","MM/dd/yyyy h:mm:ss tt","MM/dd/yyyy h:mm:s tt","MM/dd/yyyy h:m:ss tt","MM/dd/yyyy h:m:s tt","MM/d/yyyy hh:mm:ss","MM/d/yyyy hh:mm:s","MM/d/yyyy hh:m:ss","MM/d/yyyy hh:m:s","MM/d/yyyy hh:mm:ss","MM/d/yyyy h:mm:s","MM/d/yyyy h:m:ss","MM/d/yyyy h:m:s","MM/d/yyyy hh:mm:ss tt","MM/d/yyyy hh:mm:s tt","MM/d/yyyy hh:m:ss tt","MM/d/yyyy hh:m:s tt","MM/d/yyyy h:mm:ss tt","MM/d/yyyy h:mm:s tt","MM/d/yyyy h:m:ss tt","MM/d/yyyy h:m:s tt","M/dd/yyyy hh:mm:ss","M/dd/yyyy hh:mm:s","M/dd/yyyy hh:m:ss","M/dd/yyyy hh:m:s","M/dd/yyyy hh:mm:ss","M/dd/yyyy h:mm:s","M/dd/yyyy h:m:ss","M/dd/yyyy h:m:s","M/dd/yyyy hh:mm:ss tt","M/dd/yyyy hh:mm:s tt","M/dd/yyyy hh:m:ss tt","M/dd/yyyy hh:m:s tt","M/dd/yyyy h:mm:ss tt","M/dd/yyyy h:mm:s tt","M/dd/yyyy h:m:ss tt","M/dd/yyyy h:m:s tt","M/d/yyyy hh:mm:ss","M/d/yyyy hh:mm:s","M/d/yyyy hh:m:ss","M/d/yyyy hh:m:s","M/d/yyyy hh:mm:ss","M/d/yyyy h:mm:s","M/d/yyyy h:m:ss","M/d/yyyy h:m:s","M/d/yyyy hh:mm:ss tt","M/d/yyyy hh:mm:s tt","M/d/yyyy hh:m:ss tt","M/d/yyyy hh:m:s tt","M/d/yyyy h:mm:ss tt","M/d/yyyy h:mm:s tt","M/d/yyyy h:m:ss tt","M/d/yyyy h:m:s tt","yy/MM/dd hh:mm:ss","yy/MM/dd hh:mm:s","yy/MM/dd hh:m:ss","yy/MM/dd hh:m:s","yy/MM/dd h:mm:ss","yy/MM/dd h:mm:s","yy/MM/dd h:m:ss","yy/MM/dd h:m:s","yy/MM/dd hh:mm:ss tt","yy/MM/dd hh:mm:s tt","yy/MM/dd hh:m:ss tt","yy/MM/dd hh:m:s tt","yy/MM/dd h:mm:ss tt","yy/MM/dd h:mm:s tt","yy/MM/dd h:m:ss tt","yy/MM/dd h:m:s tt","yy/MM/d hh:mm:ss","yy/MM/d hh:mm:s","yy/MM/d hh:m:ss","yy/MM/d hh:m:s","yy/MM/d hh:mm:ss","yy/MM/d h:mm:s","yy/MM/d h:m:ss","yy/MM/d h:m:s","yy/MM/d hh:mm:ss tt","yy/MM/d hh:mm:s tt","yy/MM/d hh:m:ss tt","yy/MM/d hh:m:s tt","yy/MM/d h:mm:ss tt","yy/MM/d h:mm:s tt","yy/MM/d h:m:ss tt","yy/MM/d h:m:s tt","yy/M/dd hh:mm:ss","yy/M/dd hh:mm:s","yy/M/dd hh:m:ss","yy/M/dd hh:m:s","yy/M/dd hh:mm:ss","yy/M/dd h:mm:s","yy/M/dd h:m:ss","yy/M/dd h:m:s","yy/M/dd hh:mm:ss tt","yy/M/dd hh:mm:s tt","yy/M/dd hh:m:ss tt","yy/M/dd hh:m:s tt","yy/M/dd h:mm:ss tt","yy/M/dd h:mm:s tt","yy/M/dd h:m:ss tt","yy/M/dd h:m:s tt","yy/M/d hh:mm:ss","yy/M/d hh:mm:s","yy/M/d hh:m:ss","yy/M/d hh:m:s","yy/M/d hh:mm:ss","yy/M/d h:mm:s","yy/M/d h:m:ss","yy/M/d h:m:s","yy/M/d hh:mm:ss tt","yy/M/d hh:mm:s tt","yy/M/d hh:m:ss tt","yy/M/d hh:m:s tt","yy/M/d h:mm:ss tt","yy/M/d h:mm:s tt","yy/M/d h:m:ss tt","yy/M/d h:m:s tt","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd hh:mm:s","yyyy/MM/dd hh:m:ss","yyyy/MM/dd hh:m:s","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd h:mm:s","yyyy/MM/dd h:m:ss","yyyy/MM/dd h:m:s","yyyy/MM/dd hh:mm:ss tt","yyyy/MM/dd hh:mm:s tt","yyyy/MM/dd hh:m:ss tt","yyyy/MM/dd hh:m:s tt","yyyy/MM/dd h:mm:ss tt","yyyy/MM/dd h:mm:s tt","yyyy/MM/dd h:m:ss tt","yyyy/MM/dd h:m:s tt","yyyy/MM/d hh:mm:ss","yyyy/MM/d hh:mm:s","yyyy/MM/d hh:m:ss","yyyy/MM/d hh:m:s","yyyy/MM/d hh:mm:ss","yyyy/MM/d h:mm:s","yyyy/MM/d h:m:ss","yyyy/MM/d h:m:s","yyyy/MM/d hh:mm:ss tt","yyyy/MM/d hh:mm:s tt","yyyy/MM/d hh:m:ss tt","yyyy/MM/d hh:m:s tt","yyyy/MM/d h:mm:ss tt","yyyy/MM/d h:mm:s tt","yyyy/MM/d h:m:ss tt","yyyy/MM/d h:m:s tt","yyyy/M/dd hh:mm:ss","yyyy/M/dd hh:mm:s","yyyy/M/dd hh:m:ss","yyyy/M/dd hh:m:s","yyyy/M/dd hh:mm:ss","yyyy/M/dd h:mm:s","yyyy/M/dd h:m:ss","yyyy/M/dd h:m:s","yyyy/M/dd hh:mm:ss tt","yyyy/M/dd hh:mm:s tt","yyyy/M/dd hh:m:ss tt","yyyy/M/dd hh:m:s tt","yyyy/M/dd h:mm:ss tt","yyyy/M/dd h:mm:s tt","yyyy/M/dd h:m:ss tt","yyyy/M/dd h:m:s tt","yyyy/M/d hh:mm:ss","yyyy/M/d hh:mm:s","yyyy/M/d hh:m:ss","yyyy/M/d hh:m:s","yyyy/M/d hh:mm:ss","yyyy/M/d h:mm:s","yyyy/M/d h:m:ss","yyyy/M/d h:m:s","yyyy/M/d hh:mm:ss tt","yyyy/M/d hh:mm:s tt","yyyy/M/d hh:m:ss tt","yyyy/M/d hh:m:s tt","yyyy/M/d h:mm:ss tt","yyyy/M/d h:mm:s tt","yyyy/M/d h:m:ss tt","yyyy/M/d h:m:s tt","MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","MM-dd-yyyy hh:mm:s","MM-dd-yyyy hh:m:ss","MM-dd-yyyy hh:m:s","MM-dd-yyyy hh:mm:ss","MM-dd-yyyy h:mm:s","MM-dd-yyyy h:m:ss","MM-dd-yyyy h:m:s","MM-dd-yyyy hh:mm:ss tt","MM-dd-yyyy hh:mm:s tt","MM-dd-yyyy hh:m:ss tt","MM-dd-yyyy hh:m:s tt","MM-dd-yyyy h:mm:ss tt","MM-dd-yyyy h:mm:s tt","MM-dd-yyyy h:m:ss tt","MM-dd-yyyy h:m:s tt","MM-d-yyyy hh:mm:ss","MM-d-yyyy hh:mm:s","MM-d-yyyy hh:m:ss","MM-d-yyyy hh:m:s","MM-d-yyyy hh:mm:ss","MM-d-yyyy h:mm:s","MM-d-yyyy h:m:ss","MM-d-yyyy h:m:s","MM-d-yyyy hh:mm:ss tt","MM-d-yyyy hh:mm:s tt","MM-d-yyyy hh:m:ss tt","MM-d-yyyy hh:m:s tt","MM-d-yyyy h:mm:ss tt","MM-d-yyyy h:mm:s tt","MM-d-yyyy h:m:ss tt","MM-d-yyyy h:m:s tt","M-dd-yyyy hh:mm:ss","M-dd-yyyy hh:mm:s","M-dd-yyyy hh:m:ss","M-dd-yyyy hh:m:s","M-dd-yyyy hh:mm:ss","M-dd-yyyy h:mm:s","M-dd-yyyy h:m:ss","M-dd-yyyy h:m:s","M-dd-yyyy hh:mm:ss tt","M-dd-yyyy hh:mm:s tt","M-dd-yyyy hh:m:ss tt","M-dd-yyyy hh:m:s tt","M-dd-yyyy h:mm:ss tt","M-dd-yyyy h:mm:s tt","M-dd-yyyy h:m:ss tt","M-dd-yyyy h:m:s tt","M-d-yyyy hh:mm:ss","M-d-yyyy hh:mm:s","M-d-yyyy hh:m:ss","M-d-yyyy hh:m:s","M-d-yyyy hh:mm:ss","M-d-yyyy h:mm:s","M-d-yyyy h:m:ss","M-d-yyyy h:m:s","M-d-yyyy hh:mm:ss tt","M-d-yyyy hh:mm:s tt","M-d-yyyy hh:m:ss tt","M-d-yyyy hh:m:s tt","M-d-yyyy h:mm:ss tt","M-d-yyyy h:mm:s tt","M-d-yyyy h:m:ss tt","M-d-yyyy h:m:s tt","yy-MM-dd hh:mm:ss","yy-MM-dd hh:mm:s","yy-MM-dd hh:m:ss","yy-MM-dd hh:m:s","yy-MM-dd h:mm:ss","yy-MM-dd h:mm:s","yy-MM-dd h:m:ss","yy-MM-dd h:m:s","yy-MM-dd hh:mm:ss tt","yy-MM-dd hh:mm:s tt","yy-MM-dd hh:m:ss tt","yy-MM-dd hh:m:s tt","yy-MM-dd h:mm:ss tt","yy-MM-dd h:mm:s tt","yy-MM-dd h:m:ss tt","yy-MM-dd h:m:s tt","yy-MM-d hh:mm:ss","yy-MM-d hh:mm:s","yy-MM-d hh:m:ss","yy-MM-d hh:m:s","yy-MM-d hh:mm:ss","yy-MM-d h:mm:s","yy-MM-d h:m:ss","yy-MM-d h:m:s","yy-MM-d hh:mm:ss tt","yy-MM-d hh:mm:s tt","yy-MM-d hh:m:ss tt","yy-MM-d hh:m:s tt","yy-MM-d h:mm:ss tt","yy-MM-d h:mm:s tt","yy-MM-d h:m:ss tt","yy-MM-d h:m:s tt","yy-M-dd hh:mm:ss","yy-M-dd hh:mm:s","yy-M-dd hh:m:ss","yy-M-dd hh:m:s","yy-M-dd hh:mm:ss","yy-M-dd h:mm:s","yy-M-dd h:m:ss","yy-M-dd h:m:s","yy-M-dd hh:mm:ss tt","yy-M-dd hh:mm:s tt","yy-M-dd hh:m:ss tt","yy-M-dd hh:m:s tt","yy-M-dd h:mm:ss tt","yy-M-dd h:mm:s tt","yy-M-dd h:m:ss tt","yy-M-dd h:m:s tt","yy-M-d hh:mm:ss","yy-M-d hh:mm:s","yy-M-d hh:m:ss","yy-M-d hh:m:s","yy-M-d hh:mm:ss","yy-M-d h:mm:s","yy-M-d h:m:ss","yy-M-d h:m:s","yy-M-d hh:mm:ss tt","yy-M-d hh:mm:s tt","yy-M-d hh:m:ss tt","yy-M-d hh:m:s tt","yy-M-d h:mm:ss tt","yy-M-d h:mm:s tt","yy-M-d h:m:ss tt","yy-M-d h:m:s tt","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd hh:mm:s","yyyy-MM-dd hh:m:ss","yyyy-MM-dd hh:m:s","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd h:mm:s","yyyy-MM-dd h:m:ss","yyyy-MM-dd h:m:s","yyyy-MM-dd hh:mm:ss tt","yyyy-MM-dd hh:mm:s tt","yyyy-MM-dd hh:m:ss tt","yyyy-MM-dd hh:m:s tt","yyyy-MM-dd h:mm:ss tt","yyyy-MM-dd h:mm:s tt","yyyy-MM-dd h:m:ss tt","yyyy-MM-dd h:m:s tt","yyyy-MM-d hh:mm:ss","yyyy-MM-d hh:mm:s","yyyy-MM-d hh:m:ss","yyyy-MM-d hh:m:s","yyyy-MM-d hh:mm:ss","yyyy-MM-d h:mm:s","yyyy-MM-d h:m:ss","yyyy-MM-d h:m:s","yyyy-MM-d hh:mm:ss tt","yyyy-MM-d hh:mm:s tt","yyyy-MM-d hh:m:ss tt","yyyy-MM-d hh:m:s tt","yyyy-MM-d h:mm:ss tt","yyyy-MM-d h:mm:s tt","yyyy-MM-d h:m:ss tt","yyyy-MM-d h:m:s tt","yyyy-M-dd hh:mm:ss","yyyy-M-dd hh:mm:s","yyyy-M-dd hh:m:ss","yyyy-M-dd hh:m:s","yyyy-M-dd hh:mm:ss","yyyy-M-dd h:mm:s","yyyy-M-dd h:m:ss","yyyy-M-dd h:m:s","yyyy-M-dd hh:mm:ss tt","yyyy-M-dd hh:mm:s tt","yyyy-M-dd hh:m:ss tt","yyyy-M-dd hh:m:s tt","yyyy-M-dd h:mm:ss tt","yyyy-M-dd h:mm:s tt","yyyy-M-dd h:m:ss tt","yyyy-M-dd h:m:s tt","yyyy-M-d hh:mm:ss","yyyy-M-d hh:mm:s","yyyy-M-d hh:m:ss","yyyy-M-d hh:m:s","yyyy-M-d hh:mm:ss","yyyy-M-d h:mm:s","yyyy-M-d h:m:ss","yyyy-M-d h:m:s","yyyy-M-d hh:mm:ss tt","yyyy-M-d hh:mm:s tt","yyyy-M-d hh:m:ss tt","yyyy-M-d hh:m:s tt","yyyy-M-d h:mm:ss tt","yyyy-M-d h:mm:s tt","yyyy-M-d h:m:ss tt","yyyy-M-d h:m:s tt"]})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(n){function a(n){return n.split("\u00a0").join(" ").toUpperCase()}function s(n){for(var i=[],t=0,r=n.length;t<r;t++)i[t]=a(n[t]);return i}function k(t,i,r){var f=a(t),u=n.ArrayHelper.indexOf(i,f);return u===-1&&(u=n.ArrayHelper.indexOf(r,f)),u}function tt(i){if(arguments.length===0)return n._currentCulture;typeof i!==o&&i!==t&&(n.switchCulture(i),n._CacheMgr.clearFormatCache(),ct(i))}function ot(t){var i=t.toLowerCase(),u,f;if(n._currentCulture!==i){n._currentCultureResouce=l(i);n.CR=n._currentCultureResouce;switch(i){case"ja-jp":u=n._JAStringResource;u&&(n.SR=u);r.currentCulture("ja-jp");break;case"en-us":n.SR=n._ENStringResource;r.currentCulture("en-us");break;case"zh-cn":f=n._ZHStringResource;f&&(n.SR=f);r.currentCulture("zh-cn");break;default:n.SR=n._ENStringResource;r.currentCulture(i);break}n._currentCulture=i}}function st(t,i){var r=i.numberDecimalSeparator,f=i.arrayGroupSeparator,u=i.arrayListSeparator,e=i.listSeparator;if(r===e||r===u||u===f)throw n.SR.Exp_Separator;n.cultureInfoDict[t.toLowerCase()]=i}function ht(t){var r=l(t),i=new n.CultureInfo;return n.GC$.extend(i,r),i}function l(t){t=t.toLowerCase();var i=n.cultureInfoDict[t];return i||(i=n.cultureInfoDict[""]),i}function ct(t){n.GC$("div[gcUIElement='gcSpread']").trigger(n.Events.CultureChanged,[{CultureInfo:t}])}var y,p,w,b,r,h,d,v,it,rt;n.feature("core.globalize",["core.stringResource","core.cultureInfo"]);var t=null,i=undefined,lt=Math.max,ut=Math.min,ft=Math.ceil,e=Math.floor,u=Math.abs,f=Math.pow,o="undefined",c=function(){function n(n){this._value={};this._len=0;this._init(n)}return n.prototype._init=function(n){this._parts=typeof n!==o&&n!==t&&n!==""?[n.toString()]:[];this._value={};this._len=0},n.prototype._insert=function(n){this._parts.splice(0,0,n)},n.prototype.insert=function(n,r){var u=this,f,e,o;if((r===i||r===t)&&(r=0),r===0){u._insert(n);return}if(f=u.toString(),r>=f.length){u.append(n);return}e=f.substring(0,r);o=f.substr(r);u._init(e+n+o)},n.prototype.append=function(n){this._parts[this._parts.length]=n},n.prototype.appendLine=function(n){this._parts[this._parts.length]=typeof n===o||n===t||n===""?"\r\n":n+"\r\n"},n.prototype.clear=function(){this._init()},n.prototype.isEmpty=function(){return this._parts.length===0?!0:this.toString()===""},n.prototype.toString=function(n){var u=this,i,f,r;if(n=n||"",i=u._parts,u._len!==i.length&&(u._value={},u._len=i.length),f=u._value,typeof f[n]===o){if(n!=="")for(r=0;r<i.length;)typeof i[r]===o||i[r]===""||i[r]===t?i.splice(r,1):r++;f[n]=u._parts.join(n)}return f[n]},n}();n._StringBuilder=c;y=function(){function t(){var t=this,i=n._currentCultureResouce;t.currencyDecimalDigits=i.currencyDecimalDigits;t.currencyDecimalSeparator=i.currencyDecimalSeparator;t.currencyPositivePattern=i.currencyPositivePattern;t.currencyGroupSeparator=i.currencyGroupSeparator;t.currencySymbol=i.currencySymbol;t.currencyGroupSizes=i.currencyGroupSizes;t.currencyNegativePattern=i.currencyNegativePattern;t.digitSubstitution=i.digitSubstitution;t.isReadOnly=i.isReadOnly;t.numberGroupSizes=i.numberGroupSizes;t.nanSymbol=i.nanSymbol;t.nativeDigits=i.nativeDigits;t.numberNegativePattern=i.numberNegativePattern;t.negativeInfinitySymbol=i.negativeInfinitySymbol;t.negativeSign=i.negativeSign;t.numberDecimalDigits=i.numberDecimalDigits;t.numberDecimalSeparator=i.numberDecimalSeparator;t.numberGroupSeparator=i.numberGroupSeparator;t.positiveInfinitySymbol=i.positiveInfinitySymbol;t.positiveSign=i.positiveSign;t.percentDecimalDigits=i.percentDecimalDigits;t.percentDecimalSeparator=i.percentDecimalSeparator;t.percentGroupSeparator=i.percentGroupSeparator;t.percentSymbol=i.percentSymbol;t.perMilleSymbol=i.perMilleSymbol;t.percentPositivePattern=i.percentPositivePattern;t.percentNegativePattern=i.percentNegativePattern;t.percentGroupSizes=i.percentGroupSizes}return t}();n._NumberFormatInfo=y;p=function(){function n(){var n=this;n.MinSupportedDateTime="@-62135568000000@";n.MaxSupportedDateTime="@253402300799999@";n.AlgorithmType=1;n.CalendarType=1;n.Eras=[1];n.TwoDigitYearMax=2029;n.isReadOnly=!0}return n}();n._Calendar=p;w=function(){function t(){var t=this,i=n._currentCultureResouce;t.amDesignator=i.amDesignator;t.abbreviatedMonthNames=i.abbreviatedMonthNames;t.abbreviatedDayNames=i.abbreviatedDayNames;t.abbreviatedMonthGenitiveNames=i.abbreviatedMonthGenitiveNames;t.Calendar=new p;t.calendarWeekRule=i.calendarWeekRule;t.dateSeparator=i.dateSeparator;t.dayNames=i.dayNames;t.firstDayOfWeek=i.firstDayOfWeek;t.fullDateTimePattern=i.fullDateTimePattern;t.isReadOnly=i.isReadOnly;t.longDatePattern=i.longDatePattern;t.longTimePattern=i.longTimePattern;t.monthDayPattern=i.monthDayPattern;t.monthNames=i.monthNames;t.monthGenitiveNames=i.monthGenitiveNames;t.nativeCalendarName=i.nativeCalendarName;t.pmDesignator=i.pmDesignator;t.rfc1123Pattern=i.rfc1123Pattern;t.shortDatePattern=i.shortDatePattern;t.shortTimePattern=i.shortTimePattern;t.sortableDateTimePattern=i.sortableDateTimePattern;t.shortestDayNames=i.shortestDayNames;t.timeSeparator=i.timeSeparator;t.universalSortableDateTimePattern=i.universalSortableDateTimePattern;t.yearMonthPattern=i.yearMonthPattern;t.Calendar.isReadOnly=i.calendarIsReadOnly}return t}();n._DateTimeFormatInfo=w;b=function(){function n(){}return n.isValidEraDate=function(n){return n<this.getEraMin()||n>this.getEraMax()?!1:!0},n.getEraDates=function(){var t=window.spreadJSEras,r,n,u;if(t!=i){for(r=[],n=0;n<t.length;n++)u=new Date(t[n].startDate.replace(/-/g,"/")),r[n]=u;return r}return this.EraDates},n.getEraNames=function(){var r=window.spreadJSEras,t=[],n;if(r!=i){for(n=0;n<r.length;n++)t[n]=r[n].name;return t}for(n=0;n<this.EraCount;n++)t[n]=this.EraNames[n+2*this.EraCount];return t},n.getEraSymbols=function(){var r=window.spreadJSEras,t=[],n;if(r!=i){for(n=0;n<r.length;n++)t[n]=r[n].symbol;return t}for(n=0;n<this.EraCount;n++)t[n]=this.EraNames[n];return t},n.getEraAbbreviations=function(){var r=window.spreadJSEras,t=[],n;if(r!=i){for(n=0;n<r.length;n++)t[n]=r[n].abbreviation;return t}for(n=0;n<this.EraCount;n++)t[n]=this.EraNames[n+this.EraCount];return t},n.getEraShortcuts=function(){var r=window.spreadJSEras,t=[],n;if(r!=i){for(n=0;n<r.length;n++)t[n]=r[n].shortcuts.split(",")[0];return t}for(n=0;n<this.EraCount;n++)t[n]=this.EraKeys[n];return t},n.getEraMax=function(){var n=window.spreadJSEras,t;return n!=i&&n.length>0?(t=new Date(n[n.length-1].startDate.replace(/-/g,"/")),t.setFullYear(t.getFullYear()+99),t):this.EraMax},n.getEraMin=function(){var n=window.spreadJSEras;return n!=i&&n.length>0?new Date(n[0].startDate.replace(/-/g,"/")):this.EraMin},n.getEraCount=function(){var n=window.spreadJSEras;return n!=i?n.length:this.EraCount},n.getEraYears=function(){var t=window.spreadJSEras,r,n,u,f;if(t!=i){for(r=[],n=1;n<t.length;n++)u=new Date(t[n-1].startDate.replace(/-/g,"/")),f=new Date(t[n].startDate.replace(/-/g,"/")),r[n-1]=f.getFullYear()-u.getFullYear()+1;return r[n-1]=99,r}return this.EraYears},n.getEraDate=function(n){var r={},t,i,u;if(r.era=-1,r.eraYear=-1,t=this,!t.isValidEraDate(n))return r;for(i=0;i<t.getEraCount();i++)if(u=i+1!=t.getEraCount()?t.getEraDates()[i+1]:t.addMilliseconds(t.getEraMax(),1),n<u){r.era=i;r.eraYear=n.getFullYear()-t.getEraDates()[i].getFullYear()+1;break}return r},n.addMilliseconds=function(n,t){var i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());return i.setMilliseconds(i.getMilliseconds()+t),new Date(i.valueOf())},n.getYearFromEra=function(t,i){var r=n.getEraDates()[t].getFullYear();return r+i-1},n.parseEraPart=function(t,i){var u,f,e,o,r;i=i.toUpperCase();u=n;switch(t){case"g":for(f=u.getEraSymbols(),r=0;r<f.length;r++)if(f[r]===i)return r;break;case"gg":for(e=u.getEraAbbreviations(),r=0;r<e.length;r++)if(e[r]===i)return r;break;case"ggg":for(o=u.getEraNames(),r=0;r<o.length;r++)if(o[r]===i)return r;break}return-1},n.formatEraPart=function(t,i){var f=n,r=f.getEraDate(i),e,u;switch(t){case"g":if(r.era<0)break;return f.getEraSymbols()[r.era];break;case"gg":if(r.era<0)break;return f.getEraAbbreviations()[r.era];break;case"ggg":if(r.era<0)break;return f.getEraNames()[r.era];break;case"ee":if(r.eraYear<0)break;return u=r.eraYear.toString(),u.length===1&&(u="0"+u),u;break;case"e":if(r.eraYear<0)break;return r.eraYear.toString();break}return""},n.EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],n.EraCount=4,n.EraYears=[45,15,64,99],n.EraMax=new Date(2087,11,31,23,59,59),n.EraMin=new Date(1868,8,8),n.EraKeys=["1","2","3","4","m","t","s","h"],n.EraIndices=[0,1,2,3,0,1,2,3],n.EraNames=["M","T","S","H","\u660e","\u5927","\u662d","\u5e73","\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210"],n.EraYearMax=99,n}();n._EraHelper=b;r=function(){function t(t){var i=this;t=t?t:"";i.name=t;n._currentCultureResouce=l(t);i.numberFormat=new y;i.dateTimeFormat=new w}return t.prototype.Name=function(){return this.name},t.prototype.NumberFormat=function(){return this.numberFormat},t.prototype.DateTimeFormat=function(){return this.dateTimeFormat},t.prototype._getDateTimeFormats=function(){return this._dateTimeFormats||(this._dateTimeFormats=n.dateTimeFormats),this._dateTimeFormats},t.prototype._getMonthIndex=function(n){var t=this;return t._upperMonths||(t._upperMonths=s(t.dateTimeFormat.monthNames),t._upperMonthsGenitive=s(t.dateTimeFormat.monthGenitiveNames)),k(n,t._upperMonths,t._upperMonthsGenitive)},t.prototype._getAbbrMonthIndex=function(n){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=s(t.dateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=s(t.dateTimeFormat.abbreviatedMonthGenitiveNames)),k(n,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},t.prototype._getDayIndex=function(t){var i=this;return i._upperDays||(i._upperDays=s(i.dateTimeFormat.dayNames)),n.ArrayHelper.indexOf(i._upperDays,a(t))},t.prototype._getAbbrDayIndex=function(t){var i=this;return i._upperAbbrDays||(i._upperAbbrDays=s(i.dateTimeFormat.abbreviatedDayNames)),n.ArrayHelper.indexOf(i._upperAbbrDays,a(t))},t.invariantCulture=function(){var n=t;return n._invariantCulture||(n._invariantCulture=new t("")),n._invariantCulture},t.currentCulture=function(n){if(typeof n=="undefined")return t._currentCulture;var i=t;return i._currentCulture=i.getCulture(n),i._currentCulture},t.enCulture=function(){var n=t;return n._enCulture||(n._enCulture=new t("en-US")),n._enCulture},t.jaCulture=function(){var n=t,i;return n._jaCulture||(i=new t("ja-JP"),i.dateTimeFormat.eras=b,n._jaCulture=i),n._jaCulture},t.zhCulture=function(){var n=t;return n._zhCulture||(n._zhCulture=new t("zh-CN")),n._zhCulture},t.customCulture=function(n){var i=t,r;return i._customCulture&&i._customCulture.Name()===n||(r=new t(n),i._customCulture=r),i._customCulture},t.getCulture=function(i){i=i?i:"";i=i.toLowerCase();n._currentCultureResouce=l(i);switch(i){case"ja-jp":return t.jaCulture();case"en-us":return t.enCulture();case"zh-cn":return t.zhCulture();default:return t.customCulture(i)}},t}();n._CultureInfo=r;h=function(){function i(n){this._str=n}return i.__toFormattedString=function(i,r){for(var c,e,v,f,h="",s=r[0],u=0;;){if(c=s.indexOf("{",u),e=s.indexOf("}",u),c<0&&e<0){h+=s.slice(u);break}if(e>0&&(e<c||c<0)){if(s.charAt(e+1)!=="}")throw new Error(n.SR.Exp_BraceMismatch);h+=s.slice(u,e+1);u=e+2;continue}if(h+=s.slice(u,c),u=c+1,s.charAt(u)==="{"){h+="{";u++;continue}if(e<0)throw new Error(n.SR.Exp_BraceMismatch);var l=s.substring(u,e),a=l.indexOf(":"),y=parseInt(a<0?l:l.substring(0,a),10)+1;if(isNaN(y))throw new Error(n.SR.Exp_InvalidFormat);v=a<0?"":l.substring(a+1);f=r[y];(typeof f===o||f===t)&&(f="");h+=f.toFormattedString?f.toFormattedString(v):i&&f.localeFormat?f.localeFormat(v):f.format?f.format(v):f.toString();u=e+1}return h},i.prototype.startsWith=function(n){return this._str.substr(0,n.length)===n},i.prototype.endsWith=function(n){return this._str.indexOf(n,this._str.length-n.length)!==-1},i.prototype.trim=function(){return this._str.replace(/^\s+|\s+$/g,"")},i.prototype.trimEnd=function(){return this._str.replace(/\s+$/,"")},i.prototype.trimStart=function(){return this._str.replace(/^\s+/,"")},i.format=function(n,t){var u=[],r;for(u.push(n),r=0;r<t.length;r++)u.push(t[r]);return i.__toFormattedString(!1,u)},i}();n._StringHelper=h;d=function(){function n(){}return n.Contains=function(n,t){return t===""||n.indexOf(t)>=0},n.IndexOf=function(n,t,i){if(i)if(i===1){var r=n.toLowerCase(),u=t.toLowerCase();return r.indexOf(u)}else return n.indexOf(t);else return n.indexOf(t)},n.TrimStart=function(n,t){if(!t)return n;for(var i=n;;){if(i.substr(0,t.length)!==t)break;i=i.substr(t.length)}return i},n.TrimEnd=function(n,t){if(!t)return n;for(var i=n;;){if(i.substr(i.length-t.length,t.length)!==t)break;i=i.substr(0,i.length-t.length)}return i},n.Trim=function(t,i){var r=i;return i||(r=" "),t=n.TrimStart(t,r),n.TrimEnd(t,r)},n.Insert=function(n,r,u){if(r<0||r>n.length||u===t||u===i)throw new Error;var f=n.substr(0,r),e=n.substr(r,n.length-r);return f+u+e},n.Remove=function(n,r,u){if((u===i||u===t)&&(u=n.length-r),r<0||u<0||r+u>n.length)throw new Error;var f=n.substr(0,r),e=n.substr(r+u,n.length-r-u);return f+e},n.StartsWith=function(n,t,i){if(!t)throw new Error;if(t==="")return!0;if(t.length>n.length)return!1;var r=n,u=t;return i===1&&(r=r.toLowerCase(),u=u.toLowerCase()),r.search(new RegExp("^"+u))>-1},n.EndsWith=function(n,t,i){if(!t)throw new Error;if(t==="")return!0;if(t.length>n.length)return!1;var r=n,u=t;return i===1&&(r=r.toLowerCase(),u=u.toLowerCase()),r.search(new RegExp(u+"$"))>-1},n.Replace=function(n,t,i){if(!t||t==="")throw new Error;i=(""+i).replace(/\$/g,"$$$$");var r=new RegExp(t,"g");return n.replace(r,i)},n}();n.StringHelper=d;v=function(){function f(n){this._date=n}return f.prototype.Hour=function(){return this._date.getHours()},f.prototype.Minute=function(){return this._date.getMinutes()},f.prototype.Second=function(){return this._date.getSeconds()},f.prototype.Millisecond=function(){return this._date.getMilliseconds()},f.prototype.TotalDays=function(){return e(this.toOADate())},f.prototype.toOADate=function(){return f.___toOADate(this._date)},f.prototype.format=function(n){return this._toFormattedString(n,r._currentCulture)},f.prototype.customCultureFormat=function(n,t){return t||(t=r._currentCulture),this._toFormattedString(n,t)},f.prototype.localeFormat=function(n){return this._toFormattedString(n,r._currentCulture)},f.prototype._toFormattedString=function(i,r){function ft(){return w||rt?w:(w=ut.test(i),rt=!0,w)}function v(n,t){if(l)return l[t];switch(t){case 0:return n.getFullYear();case 1:return n.getMonth();case 2:return n.getDate()}}var o=this,h=r.DateTimeFormat(),k=h.Calendar.convert,a,it,s,c,w,rt,ut,d,g,l,y;if(!i||!i.length||i==="i")return r&&r.Name().length?k?o._toFormattedString(h.fullDateTimePattern,r):o._date.toLocaleString():o._date.toString();a=h.eras;it=i==="s";i=f.__expandFormat(h,i);s="";ut=/([^d]|^)(d|dd)([^d]|$)/g;d=0;g=f.__getTokenRegExp();!it&&k&&(l=k.fromGregorian(o._date));var st=t,b=-2,nt=-2,tt={value:""};for(y=0;;y++){var et=g.lastIndex,p=g.exec(i),ot=i.slice(et,p?p.index:i.length);if(tt.value="",d+=f.__appendPreOrPostMatch(ot,tt),s+=tt.value,!p)break;if(d%2==1){s+=p[0];continue}switch(p[0]){case"dddd":s+=h.dayNames[o._date.getDay()];break;case"ddd":s+=h.abbreviatedDayNames[o._date.getDay()];break;case"dd":w=!0;s+=f.___addLeadingZero(v(o._date,2));break;case"d":w=!0;s+=v(o._date,2);break;case"MMMM":s+=h.monthGenitiveNames&&ft()?h.monthGenitiveNames[v(o._date,1)]:h.monthNames[v(o._date,1)];break;case"MMM":s+=h.abbreviatedMonthGenitiveNames&&ft()?h.abbreviatedMonthGenitiveNames[v(o._date,1)]:h.abbreviatedMonthNames[v(o._date,1)];break;case"MM":s+=f.___addLeadingZero(v(o._date,1)+1);break;case"M":s+=v(o._date,1)+1;break;case"yyyy":case"yyy":s+=b>=0?a.formatEraPart("ee",o._date):f.___padYear(l?l[0]:o._date.getFullYear());break;case"yy":s+=b>=0?a.formatEraPart("ee",o._date):f.___addLeadingZero((l?l[0]:o._date.getFullYear())%100);break;case"y":s+=b>=0?a.formatEraPart("e",o._date):((l?l[0]:o._date.getFullYear())%100).toString();break;case"hh":c=o._date.getHours()%12;c===0&&(c=12);s+=f.___addLeadingZero(c);break;case"h":c=o._date.getHours()%12;c===0&&(c=12);s+=c;break;case"HH":s+=f.___addLeadingZero(o._date.getHours());break;case"H":s+=o._date.getHours().toString();break;case"mm":s+=f.___addLeadingZero(o._date.getMinutes());break;case"m":s+=o._date.getMinutes().toString();break;case"ss":s+=f.___addLeadingZero(o._date.getSeconds());break;case"s":s+=o._date.getSeconds().toString();break;case"tt":s+=o._date.getHours()<12?h.amDesignator:h.pmDesignator;break;case"t":s+=(o._date.getHours()<12?h.amDesignator:h.pmDesignator).charAt(0);break;case"f":s+=f.___addLeadingZeros(o._date.getMilliseconds()).charAt(0);break;case"ff":s+=f.___addLeadingZeros(o._date.getMilliseconds()).substr(0,2);break;case"fff":s+=f.___addLeadingZeros(o._date.getMilliseconds());break;case"z":c=o._date.getTimezoneOffset()/60;s+=(c<=0?"+":"-")+e(u(c));break;case"zz":c=o._date.getTimezoneOffset()/60;s+=(c<=0?"+":"-")+f.___addLeadingZero(e(u(c)));break;case"zzz":c=o._date.getTimezoneOffset()/60;s+=(c<=0?"+":"-")+f.___addLeadingZero(e(u(c)))+":"+f.___addLeadingZero(u(o._date.getTimezoneOffset()%60));break;case"g":case"gg":case"ggg":if(!a)break;if(b===y-1){b=y;break}else s+=a.formatEraPart(p[0],o._date),b=y;break;case"e":case"ee":if(a)if(nt===y-1){nt=y;break}else s+=a.formatEraPart(p[0],o._date),nt=y;else{s+=f.___padYear(l?l[0]:o._date.getFullYear());break}break;case"/":s+=h.dateSeparator;break;case"[h]":s+="[h]";break;case"[hh]":s+="[hh]";break;case"[mm]":s+="[mm]";break;case"[ss]":s+="[ss]";break;default:throw new Error(n.SR.Exp_InvalidDateFormat);}}return s.toString()},f.parseLocale=function(n,t){var i;return i=t?[n,t]:[n],f._parseDate(n,r._currentCulture,i)},f.parseInvariant=function(n,t){return f._parseDate(n,r.invariantCulture(),[n,t])},f.__appendPreOrPostMatch=function(n,t){for(var u,f=0,i=!1,r=0,e=n.length;r<e;r++){u=n.charAt(r);switch(u){case"'":case'"':i?t.value+="'":f++;i=!1;break;case"\\":i&&(t.value+="\\");i=!i;break;default:t.value+=u;i=!1;break}}return f},f.__expandFormat=function(t,i){i||(i="F");var r=i.length;if(r===1)switch(i){case"d":return t.shortDatePattern;case"D":return t.longDatePattern;case"t":return t.shortTimePattern;case"T":return t.longTimePattern;case"f":return t.longDatePattern+" "+t.shortTimePattern;case"F":return t.fullDateTimePattern;case"M":case"m":return t.monthDayPattern;case"s":return t.sortableDateTimePattern;case"Y":case"y":return t.yearMonthPattern;case"g":return t.shortDatePattern+" "+t.shortTimePattern;case"G":return t.shortDatePattern+" "+t.longTimePattern;case"e":return i;case"R":case"r":return t.rfc1123Pattern;case"u":return t.universalSortableDateTimePattern;case"U":return t.fullDateTimePattern;case"o":case"O":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffff";default:throw new Error(n.SR.Exp_InvalidString);}else r===2&&i.charAt(0)==="%"&&(i=i.charAt(1));return i},f.__expandYear=function(n,t){var u=new Date,r=n.DateTimeFormat().eras,i;return r&&t<100&&(i=r.getEraDate(u).eraYear,t+=i-i%100,t>n.DateTimeFormat().Calendar.TwoDigitYearMax&&(t-=100)),t},f.__getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|ggg|gg|g|ee|e|\[h\]|\[hh\]|\[mm\]|\[ss\]/g},f.__getParseRegExp=function(i,r){var e,p,c,l;if(i._parseRegExp){if(i._parseRegExp[r])return i._parseRegExp[r]}else i._parseRegExp={};e=f.__expandFormat(i,r);e=e.replace("%M","M");e=e.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var u="^",o={value:""},a=[],h=0,v=0,y=f.__getTokenRegExp(),s;(s=y.exec(e))!==t;){if(o.value="",p=e.slice(h,s.index),h=y.lastIndex,v+=f.__appendPreOrPostMatch(p,o),u+=o.value,v%2==1){u+=s[0];continue}switch(s[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":u+="(\\D+)";break;case"tt":case"t":u+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":u+="(\\d\\d?)";break;case"yyy":case"yyyy":u+="(\\d{2}|\\d{4})";break;case"fff":u+="(\\d{3})";break;case"ff":u+="(\\d{2})";break;case"f":u+="(\\d)";break;case"zzz":u+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":u+="([+-]?\\d\\d?)";break;case"/":u+="(\\"+i.dateSeparator+")";break;default:throw new Error(n.SR.Exp_InvalidDateFormat);}n.ArrayHelper.add(a,s[0])}return o.value="",f.__appendPreOrPostMatch(e.slice(h),o),u+=o.value,u+="$",c=u.toString().replace(/\s+/g,"\\s+"),l={regExp:c,groups:a,exp:new RegExp(c)},i._parseRegExp[r]=l,l},f._parseDateExact=function(i,r,u){var b,vt,e,st,ut,d,ht,ct;i=n.GC$.trim(i);var a=u.DateTimeFormat(),lt=f.__getParseRegExp(a,r),at=lt.exp.exec(i);if(at===t)return t;var ft=lt.groups,et=t,o=t,c=t,v=t,y=t,k=0,p,tt=0,it=0,l=0,rt=t,ot=!1,w=!0;for(b=0,vt=ft.length;b<vt;b++)if(e=at[b+1],e)switch(ft[b]){case"dd":case"d":if(w=!1,v=parseInt(e,10),v<1||v>31)return t;break;case"MMMM":if(w=!1,c=u._getMonthIndex(e),c<0||c>11)return t;break;case"MMM":if(w=!1,c=u._getAbbrMonthIndex(e),c<0||c>11)return t;break;case"M":case"MM":case"%M":if(w=!1,c=parseInt(e,10)-1,c<0||c>11)return t;break;case"e":case"ee":if(w=!1,o=f.__expandYear(u,parseInt(e,10)),o<0||o>9999)return t;break;case"y":case"yy":case"yyy":case"yyyy":if(w=!1,o=parseInt(e,10),o<0||o>9999)return t;break;case"h":case"hh":case"H":case"HH":if(k=parseInt(e,10),k<0)return t;break;case"m":case"mm":if(tt=parseInt(e,10),tt<0||tt>59)return t;break;case"s":case"ss":if(it=parseInt(e,10),it<0||it>59)return t;break;case"tt":case"t":if(st=e.toUpperCase(),ot=st===a.pmDesignator.toUpperCase(),!ot&&st!==a.amDesignator.toUpperCase())return t;break;case"f":if(l=parseInt(e,10)*100,l<0||l>999)return t;break;case"ff":if(l=parseInt(e,10)*10,l<0||l>999)return t;break;case"fff":if(l=parseInt(e,10),l<0||l>999)return t;break;case"dddd":if(w=!1,y=u._getDayIndex(e),y<0||y>6)return t;break;case"ddd":if(w=!1,y=u._getAbbrDayIndex(e),y<0||y>6)return t;break;case"zzz":if((ut=e.split(/:/),ut.length!==2)||(p=parseInt(ut[0],10),p<-12||p>13)||(d=parseInt(ut[1],10),d<0||d>59))return t;rt=p*60+(new h(e).startsWith("-")?-d:d);break;case"z":case"zz":if(p=parseInt(e,10),p<-12||p>13)return t;rt=p*60;break;case"g":case"gg":case"ggg":if((ht=e,!ht||!a.eras)||(et=a.eras.parseEraPart(ft[b],ht),et<0))return t;break}var yt=/^(\d|\d\d):/.test(i),s=yt?new Date(1899,11,30):new Date,g,nt=a.Calendar.convert;if(nt&&(g=nt.fromGregorian(s)),nt||(g=[s.getFullYear(),s.getMonth(),s.getDate()]),o===t?o=g[0]:o<100&&(a.eras?o=a.eras.getYearFromEra(et||0,o):o+=o>=30?1900:2e3),c===t&&(c=g[1]),v===t&&(v=g[2]),nt){if(s=nt.toGregorian(o,c,v),s===t)return t}else if((s.setFullYear(o,c,v),s.getDate()!==v)||y!==t&&s.getDay()!==y)return t;return ot&&k<12&&(k+=12),s.setHours(k,tt,it,l),rt!==t&&(ct=s.getMinutes()-(rt+s.getTimezoneOffset()),s.setHours(s.getHours()+ct/60,ct%60)),s},f.___addLeadingZero=function(n){return n<10?"0"+n:n.toString()},f.___addLeadingZeros=function(n){return n<10?"00"+n:n<100?"0"+n:n.toString()},f.___padYear=function(n){return n<10?"000"+n:n<100?"00"+n:n<1e3?"0"+n:n.toString()},f._parseDate=function(n,i,r){for(var e,s,h,c=!1,u=1,o=r.length;u<o;u++)if(s=r[u],s&&(c=!0,e=f._parseDateExact(n,s,i),e))return e;if(!c)for(h=i._getDateTimeFormats(),u=0,o=h.length;u<o;u++)if(e=f._parseDateExact(n,h[u],i),e)return e;return t},f.___toOADate=function(n){return n===i||n===t?0:(typeof n=="number"&&(n=new Date(n)),(n.getTime()*1440+3181192704e6-n.getTimezoneOffset()*864e5)/124416e6)},f._fromOADate=function(n){var t=n-25569,i=new Date(t*864e5),r=t>=0?1:-1;return new Date((n*124416e6+r-3181192704e6+i.getTimezoneOffset()*864e5)/1440)},f.parseExact=f._parseDateExact,f.fromOADate=f._fromOADate,f}();n._DateTimeHelper=v;var et=function(){function n(n,t,i){this.normal=n;this.negative=t;this.zero=i}return n}(),g=function(){function n(){var n=this;n.intPart=t;n.decPart=t;n.group=!1;n.scale=0;n.percent=0;n.permile=0;n.exponent=t}return n}(),nt=function(){function o(n){this._num=n}return o.prototype.format=function(n){return this._toFormattedString(n,r.invariantCulture())},o.prototype.localeFormat=function(n){return this._toFormattedString(n,r._currentCulture)},o.prototype.customCultureFormat=function(n,t){return t||(t=r._currentCulture),this._toFormattedString(n,t)},o.prototype._toFormattedString=function(n,t){var i=this;return!n||n.length===0||n==="i"?t&&t.Name().length>0?i._num.toLocaleString():i._num.toString():o.__getStandardTokenRegExp().test(n)?i._toStandardFormattedString(n,t.NumberFormat()):i._toCustomFormattedString(n,t.NumberFormat())},o.prototype._toStandardFormattedString=function(t,i){var s=this,f=u(s._num).toString(),r,e,h,a,v,c,y,l;t||(t="D");r=-1;t.length>1&&(r=parseInt(t.slice(1),10));switch(t.charAt(0)){case"d":case"D":e="n";r!==-1&&(f=o.___zeroPad(""+f,r,!0));s._num<0&&(f="-"+f);break;case"c":case"C":e=s._num<0?o.___currencyNegativePattern[i.currencyNegativePattern]:o.___currencyPositivePattern[i.currencyPositivePattern];r===-1&&(r=i.currencyDecimalDigits);f=o.___expandNumber(u(s._num),r,i.currencyGroupSizes,i.currencyGroupSeparator,i.currencyDecimalSeparator,i.negativeSign);break;case"n":case"N":e=s._num<0?o.___numberNegativePattern[i.numberNegativePattern]:"n";r===-1&&(r=i.numberDecimalDigits);f=o.___expandNumber(u(s._num),r,i.numberGroupSizes,",",".",i.negativeSign);break;case"p":case"P":e=s._num<0?o.___percentNegativePattern[i.percentNegativePattern]:o.___percentPositivePattern[i.percentPositivePattern];r===-1&&(r=i.percentDecimalDigits);f=o.___expandNumber(u(s._num)*100,r,i.percentGroupSizes,i.percentGroupSeparator,i.percentDecimalSeparator,i.negativeSign);break;case"F":case"f":h=s._toFixedPoint(f,e,t,r,i);f=h[0];e=h[1];break;case"e":case"E":h=s._toScientificNotation(f,e,t,r,i);f=h[0];e=h[1];break;case"x":case"X":e="n";f=o.___toHexString(s._num,t.charAt(0)==="x",r===-1?0:r);break;case"g":case"G":a=s._num.toString();h=[];h=a.indexOf("e")===-1&&a.indexOf("E")===-1?s._toFixedPoint(f,e,t,r,i):s._toScientificNotation(f,e,t.replace("g","e").replace("G","E"),r,i);f=h[0];e=h[1];break;default:throw new Error(n.SR.Exp_BadFormatSpecifier);}for(v=/n|\$|-|%/g,c="";;){if(y=v.lastIndex,l=v.exec(e),c+=e.slice(y,l?l.index:e.length),!l)break;switch(l[0]){case"n":c+=f;break;case"$":c+=i.currencySymbol;break;case"-":/[1-9]/.test(f)&&(c+=i.negativeSign);break;case"%":c+=i.percentSymbol;break;default:throw new Error(n.SR.Exp_InvalidNumberFormat);}}return c},o.prototype._toScientificNotation=function(n,t,i,r,f){return t="n",n=o.___toScientific(u(this._num),i.charAt(0),r===-1?6:r,f.numberGroupSizes,",",".",f.negativeSign),this._num<0&&(n="-"+n),[n,t]},o.prototype._toFixedPoint=function(n,t,i,r,u){t=this._num<0?o.___numberNegativePattern[u.numberNegativePattern]:"n";r===-1&&(r=2);var f=parseFloat(n),s=e(f),h=f-s;return n=o.___expandNumber(h,r,u.numberGroupSizes,",",".",u.negativeSign),n=""+(s+(+n>=1?1:0))+n.substring(1),[n,t]},o.prototype._toCustomFormattedString=function(n,i){var f=o.___parseCustomNumberFormatter(n),u=t,r;return this._num===0?u=f.zero:this._num<0&&(u=f.negative),u||(u=f.normal),r=o.___formatNumber(this._num,u,i)+"",r.indexOf(i.negativeSign)===1&&r.indexOf(i.currencySymbol)===0&&(r=r[1]+r[0]+r.substring(2)),r},o.parseLocale=function(n){return o.__parseNumber(n,r._currentCulture)},o.parseInvariant=function(n){return o.__parseNumber(n,r.invariantCulture())},o.__getStandardTokenRegExp=function(){return/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\d*)$/g},o.___getDigitLength=function(n,t){for(var s=e(u(n)),f={integer:1,decimal:0},l;s>=10;)s=s/10,f.integer++;var r=n.toString(),h=r.search(/e/ig),o=r.indexOf(t),i;if(h!==-1){var a=r.substr(0,h),v=r.substr(h+1),c=0;o!==-1&&(c=a.substr(o+1).length);l=parseFloat(v);i=c-l;i<0&&(i=0);f.decimal=i}else i=0,o!==-1&&(i=r.substr(o+1).length),f.decimal=i;return f},o.___parseExponentFormat=function(t){for(var i={symbol:t.charAt(0),sign:0,exp:0},r="",u=1;u<t.length;u++)if(r=t.charAt(u),r==="+")i.sign=1;else if(r==="-")i.sign=-1;else if(r==="0"){i.exp=t.length-u;break}else throw new Error(n.SR.Exp_InvalidExponentFormat);return i},o.___parseCustomNumberFormatter=function(r){for(var ut,nt,tt,c,l=t,a=t,v=t,s=new g,u="",it=!1,rt=!1,ft=!1,y=!1,p=!1,w=!1,b=!1,k=!1,f=t,h=t,e=[],d=0;d<r.length;d++){if(f=r.charAt(d),it){f!=="'"?u+=f:(e.push(u),u="",it=!1);h=f;continue}else if(rt){f!=='"'?u+=f:(e.push(u),u="",rt=!1);h=f;continue}else if(ft){e.push(u+f);u="";h=f;continue}else if(y){if(h==="E"||h==="e")if(f==="+"||f==="-"||f==="0"){u+=f;continue}else y=!1;else if(h==="+"||h==="-")if(f==="0"){u+=f;continue}else y=!1,e.push(u),u="";else if(h==="0")if(f==="0"){u+=f;continue}else y=!1,b||(b=!0,s.exponent=o.___parseExponentFormat(u)),e.push(u),u=""}else if(f==="0"||f==="#")if(k=!0,h==="0"||h==="#"){u+=f;h=f;continue}else u!==""&&(e.push(u),u="");else(h==="0"||h==="#")&&f!=="0"&&f!=="#"&&(e.push(u),u="");if(f===";"){if(u!==""&&(y&&!b&&(s.exponent=o.___parseExponentFormat(u)),e.push(u),u=""),p?s.decPart=f:s.intPart=e,e=[],l===i||l===t)l=s;else if(a===i||a===t)a=s;else if(v===i||v===t)v=s;else throw new Error(n.SR.Exp_InvalidSemicolons);p=!1;k=!1;w&&(s.group=!0,w=!1);s=new g}else if(p||f!==".")if(f==="'")it=!0;else if(f==='"')rt=!0;else if(f==="%")s.percent++,u!==""&&(e.push(u),u=""),e.push(f);else if(f===n.CR.perMilleSymbol)s.permile++,e.push(f);else if(f==="0"||f==="#")u+=f;else if(f===",")if(p)u!==""&&(e.push(u),u="");else{if(u!==""&&(e.push(u),u=""),!k)continue;for(ut=!0,nt="",tt=d+1;tt<r.length;tt++){if(c=r.charAt(tt),nt!==""){(c==="'"||c==='"')&&(nt="");continue}if(c==="'"||c==='"')nt=c;else if(c==="0"||c==="#"){ut=!1;break}else if(c==="."||c===";")break}ut?s.scale++:w=!0}else f==="E"||f==="e"?(y=!0,u!==""&&e.push(u),u=f):u+=f;else h!=="#"&&h!=="0"&&(e.push(u),u="#"),u!==""&&(e.push(u),u=""),s.intPart=e,e=[],p=!0,k=!1,w&&(s.group=!0,w=!1);h=f}return u!==""&&(y&&!b&&(s.exponent=o.___parseExponentFormat(u)),e.push(u)),w&&(s.group=!0),p?s.decPart=e:s.intPart=e,l===i||l===t?l=s:a===i||a===t?a=s:(v===i||v===t)&&(v=s),new et(l,a,v)},o.___zeroPad=function(n,t,i){for(var r=n.length;r<t;r++)n=i?"0"+n:n+"0";return n},o.__insertGroupSeparator=function(t,i,r,u){for(var f=i[0],s=1,e=t.length-1,h=new c(""),o=0,l=!1;e>=0;){if(f<1||f>9)throw new Error(n.SR.Exp_InvalidNumberGroupSize);/\d/ig.test(t[e])?(l&&(h.insert(r,0),l=!1),o++):o=0;h.insert(t[e],0);o===f&&(l=!0,o=0,s<i.length&&(f=i[s],s++));e--}return h.toString()},o.___expandNumber=function(n,t,i,r,u,f,e){var a=o.round10(n,-t),h,s,c,l;return isFinite(a)||(a=n),n=a,h=n.toString(),l=h.split(/e/i),h=l[0],c=l.length>1?parseInt(l[1],10):0,l=h.split("."),h=l[0],s=l.length>1?l[1]:"",c>0?(s=o.___zeroPad(s,c,!1),h+=s.slice(0,c),s=s.substr(c)):c<0&&(c=-c,h=n<0?f+o.___zeroPad(h.replace(f,""),c+1,!0):o.___zeroPad(h,c+1,!0),s=h.slice(-c,h.length)+s,h=h.slice(0,-c)),t>0?(s=s.length>t?s.slice(0,t):o.___zeroPad(s,t,!1),s=u+s):s="",e===!0?h+s:o.__insertGroupSeparator(h,i,r,f)+s},o.___formatNumber=function(n,i,r){var e=new c(""),l,s,h,v,d,b,g,k,y,it,a,ut,nt,dt,rt,ht,p,at,et,vt,gt,ot,ni,yt,pt,kt,w,lt;if(n=n*f(100,i.percent),n=n*f(1e3,i.permile),n=n/f(10,i.scale*3),l=i.intPart,s=i.decPart,!l&&!s)return"";if(h=t,v=t,l)for(h="",d=0;d<l.length;d++)b=l[d],/^(0|#)+/g.test(b)&&(h+=b);if(s)for(v="",g=0;g<s.length;g++)k=s[g],/^(0|#)+/g.test(k)&&(v+=k);if(h||v)v||(v="");else return(l?l.join(""):"")+(s?s.join(""):"");if(it=0,a=o.___getDigitLength(n,"."),i.exponent)if(ut=u(n),nt=h?h.length:1,ut>=1)a.integer>nt?(a.integer-=nt,a.decimal+=nt,n=n/f(10,a.integer),it=a.integer):it=a.integer<nt?0:0,i.exponent.sign===-1&&(i.exponent.sign=0);else if(ut<1&&ut>0){for(i.exponent.sign=-1,a.integer=nt,a.decimal-=nt,dt=f(10,nt);ut*10<dt;)ut*=10,it++;n*=f(10,it)}var ft=v.lastIndexOf("0"),wt=v.lastIndexOf("#"),st=a.decimal;if(ft>=0&&(st=ft+1),wt>ft&&wt<a.decimal&&(st=wt+1),s||(st=0),rt=o.___expandNumber(n,st,r.numberGroupSizes,",",".",r.negativeSign,!0),rt==="")return(l?l.join(""):"")+(s?s.join(""):"");if(ht=!1,l){p=rt.split(".")[0];at=p.substr(0,1);at===r.negativeSign&&(p=p.substr(1));var tt=0,bt="",ct=h.indexOf("0"),ti=ct===-1?p.length:h.length-ct;for(d=l.length-1;d>=0;d--)if(b=l[d],/^(0|#)+/g.test(b))if(bt=b+bt,bt!==h){for(et=b.length,vt=p.length-tt-1;vt>=0&&et>0;vt--)gt=p.charAt(vt),e._insert(gt),et--,tt++;tt>=p.length&&tt<ti&&et>0&&(e._insert(new Array(et+1).join("0")),tt+=et)}else ot=p.substr(0,p.length-tt),ct>=0&&ct<h.length-tt-ot.length&&(ot=new Array(h.length-tt-ct-ot.length+1).join("0")+ot),e._insert(ot);else i.exponent&&!ht&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(b)?(ht=!0,y="",y+=i.exponent.symbol,y+=o.___signs[i.exponent.sign],y+=o.___zeroPad(it.toString(),i.exponent.exp,!0),e._insert(y)):e._insert(b);at===r.negativeSign&&e._insert(at);i.group===!0&&(ni=o.__insertGroupSeparator(e.toString(),r.numberGroupSizes,",",r.negativeSign),e=new c(ni))}if(s)for(yt="",st>0?(pt=rt.indexOf("."),pt!==-1&&(yt=rt.substring(pt+1),h===""&&e.append(rt.substr(0,pt)),e.append("."))):/^(#+)$/ig.test(v)&&s.join("").length===v.length||(ft<=0&&rt.indexOf(".")<0&&h===o.GeneralNumberInt&&v===o.GeneralNumberDec||e.append("."),ft>0&&(yt=new Array(ft+1).join("0"))),kt=0,g=0;g<s.length;g++)k=s[g],/^(0|#)+/g.test(k)?(e.append(yt.substr(kt,k.length)),kt+=k.length):i.exponent&&!ht&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(k)?(ht=!0,y="",y+=i.exponent.symbol,y+=o.___signs[i.exponent.sign],y+=o.___zeroPad(it.toString(),i.exponent.exp,!0),e.append(y)):e.append(k);return w=e.toString(),lt=w.indexOf("0."),lt===0&&(lt+2==w.length&&a.decimal===0?w=w.replace("0.","."):lt+2<w.length&&(/[0-9]+/g.test(w.charAt(lt+2))||(w=w.replace("0.",".")))),w},o.__parseNumberNegativePattern=function(n,t,i){var r=t.negativeSign,u=t.positiveSign,f=new h(n);if((i===4||i===2)&&(r=" "+r,u=" "+u),i===4||i===3){if(f.endsWith(r))return["-",n.substr(0,n.length-r.length)];else if(f.endsWith(u))return["+",n.substr(0,n.length-u.length)]}else if(i===2||i===1){if(f.startsWith(r))return["-",n.substr(r.length)];else if(f.startsWith(u))return["+",n.substr(u.length)]}else if(i===0){if(f.startsWith("(")&&f.endsWith(")"))return["-",n.substr(1,n.length-2)]}else throw new Error("");return["",n]},o.__parseNumber=function(n,r){var k,l,a,s,d,g,nt,u,tt,v,y,b;if(n=n!==i&&n!==t?new h(n).trim():"",n.match(/^[+-]?infinity$/i))return parseFloat(n);if(n.match(/^0x[a-f0-9]+$/i))return parseInt(n,10);var e=r.numberFormat,p=o.__parseNumberNegativePattern(n,e,e.numberNegativePattern),w=p[0],f=p[1];return(w===""&&e.numberNegativePattern!==1&&(p=o.__parseNumberNegativePattern(n,e,1),w=p[0],f=p[1]),w===""&&(w="+"),f[0]===e.currencySymbol&&(f=f.substr(1)),a=f.indexOf("e"),a<0&&(a=f.indexOf("E")),a<0?(l=f,k=t):(l=f.substr(0,a),k=f.substr(a+1)),g=l.indexOf("."),g<0?(s=l,d=t):(s=l.substr(0,g),d=l.substr(g+1)),s=s.split(",").join(""),nt=",".replace(/\u00A0/g," "),","!==nt&&(s=s.split(nt).join("")),u=w+s,d!==t&&(u+="."+d),tt=u[u.length-1],tt===e.percentSymbol&&(u=u.substr(0,u.length-1),u=new h(u).trimEnd(),v=u.indexOf("."),v===-1&&(v=u.length),y=new c(""),y.append(u.substr(0,v-2)),y.append("."),y.append(u.substr(v-2,2)),y.append(u.substr(v+1)),u=y.toString()),k!==t&&(b=o.__parseNumberNegativePattern(k,e,1),b[0]===""&&(b[0]="+"),u+="e"+b[0]+b[1]),u.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/))?parseFloat(u):NaN},o.___toHexString=function(r,f,s){if(u(e(r)-r)!==0)throw new Error(n.SR.Exp_BadFormatSpecifier);var h=r>=0?r.toString(16):(o.___maxInt32+r+1).toString(16);return(h=f?h.toLowerCase():h.toUpperCase(),s!==i&&s!==t&&h.length<s)?o.___zeroPad(h,s,!0):h},o.___toScientific=function(n,t,i,r,e,s,h){for(var c=0,l=n>=1||n===0,a,v;c<1e3;){if(a=f(10,c),l&&n/a<10||!l&&n*a>=1)break;c++}return n=l?u(n)/f(10,c):u(n)*f(10,c),v=o.___expandNumber(n,i,r,e,s,h),v+(t+(l?"+":"-")+o.___zeroPad(c.toString(),3,!0))},o.removeCultureSymbolInNum=function(n){if(n===i||n===t)return n;var r=n.toString();return r=r.replace(new RegExp("[,]","g"),""),r.replace(new RegExp("[.]","g"),".")},o.replaceCultureSymbolToNormal=function(t){return typeof t!="string"?t:(n.CR.numberDecimalSeparator!=="."&&(t=t.replace(n.RegUtil.getReg("["+n.CR.numberDecimalSeparator+"]"),"#dot#")),n.CR.numberGroupSeparator!==","&&(t=t.replace(n.RegUtil.getReg("["+n.CR.numberGroupSeparator+"]"),"#group#")),n.CR.numberDecimalSeparator!=="."&&(t=t.replace(n.RegUtil.getReg("#dot#"),".")),n.CR.numberGroupSeparator!==","&&(t=t.replace(n.RegUtil.getReg("#group#"),",")),t)},o.replaceNormalToCultureSymble=function(t){return typeof t!="string"?t:(n.CR.numberDecimalSeparator!=="."&&(t=t.replace(n.RegUtil.getReg("[.]"),"#dot#")),n.CR.numberGroupSeparator!==","&&(t=t.replace(n.RegUtil.getReg("[,]"),"#group#")),n.CR.numberDecimalSeparator!=="."&&(t=t.replace(n.RegUtil.getReg("#dot#"),n.CR.numberDecimalSeparator)),n.CR.numberGroupSeparator!==","&&(t=t.replace(n.RegUtil.getReg("#group#"),n.CR.numberGroupSeparator)),t)},o.round10=function(n,t){return typeof t===i||+t==0?Math.round(n):(n=+n,t=+t,isNaN(n)||!(typeof t=="number"&&t%1==0))?NaN:(n=n.toString().split("e"),n=Math.round(+(n[0]+"e"+(n[1]?+n[1]-t:-t))),n=n.toString().split("e"),+(n[0]+"e"+(n[1]?+n[1]+t:t)))},o.GeneralNumberInt="##################0",o.GeneralNumberDec="################",o.___signs={"1":"+","0":"","-1":"-"},o.___maxInt32=4294967295,o.___percentPositivePattern=["n %","n%","%n","% n"],o.___percentNegativePattern=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"],o.___numberNegativePattern=["(n)","-n","- n","n-","n -"],o.___currencyPositivePattern=["$n","n$","$ n","n $"],o.___currencyNegativePattern=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],o}();n._NumberHelper=nt;n._currentCulture;n._currentCultureResouce;n.Culture=tt;n.switchCulture=ot;tt("en-us");n.addCultureInfo=st;n.getCultureInfo=ht;n.getCultureInfoCore=l;it=function(){function n(){}return n._getCtx=function(){if(!n._ctx){var t=document.createElement("canvas");t.getContext&&(n._ctx=t.getContext("2d"))}return n._ctx},n._getWrapInfo=function(t,i,r){var s=[],u,f,h,c,e,v,l,o,a;if(t.length===0||(u=n._getCtx(),!u))return s;if(u.font=r,i<=0){for(f=-1,h=!0,c=0;c<t.length;c++)e=t.charAt(c),e===" "||h?e!==" "&&h&&(f=u.measureText(e).width,h=!1):f=ut(f,u.measureText(e).width);i=f}for(v=t.split(/\r\n|\r|\n/),l=0;l<v.length;l++)if(o=n._getWrapInfoByWord(v[l],i),o)if(o.length===0)s.push("");else for(a=0;a<o.length;a++)s.push(o[a]);return s},n._getTextWords=function(n){for(var f,e,t=[],r=0,o=" ",u=0;u<n.length;u++)t[r]===i&&(t[r]=""),f=n.charAt(u),e="",u+1<n.length&&(e=n.charAt(u+1)),f===o&&e!==o?(t[r]+=f,r++):t[r]+=f;return t},n._measureText=function(t,i){var r=n._getCtx();return r?(r.font!==i&&(r.font=i),r.measureText(t).width):0},n._measureTextWithoutEndSpaces=function(t,i){var r=n._getCtx(),u;return r?(i&&(r.font=i),u=n._removeEndSpace(t),r.measureText(u).width):0},n._removeEndSpace=function(n){for(var t=n.length-1;n.charAt(t)===" ";)t--;return t!==n.length-1&&(n=n.substring(0,t+1)),n},n._getWrapInfoByCharacter=function(i,r){var u=[],s=n._getCtx(),c,f,e,l,o;if(!s)return u;var a=s.measureText(i).width,v=a/i.length,h=ft(r/v);if(a>r)for(c=!1;;)if(f=i.substring(0,h),e=s.measureText(f).width,e==r||c&&e<r)return u.push(f),u.push(i.substring(f.length)),u;else if(e>r){if(f.length===1)return l=i.substring(f.length),n._measureTextWithoutEndSpaces(l)!==0?(u.push(f),u.push(l)):u.push(i),u;h-=1;c=!0}else o=(r-e)/v,o=o>=1?o:1,h+=o;else i!=t&&i.length>0&&u.push(i);return u},n._getWrapInfoByWord=function(t,i){var f=[],c=n._getTextWords(t),v=n._getCtx(),a,s,p,h;if(!v)return f;for(var w=v.measureText(t).width,b=w/t.length,k=parseInt(i/b+"",10),l=0,e=0,y=0,u=0,r=[],o=!1;u<c.length;){if(o===!1)if(a=c[u],r.push(a),e+=a.length,e<k){u++;continue}else y=e,e=0;s=n._measureTextWithoutEndSpaces(r.join(""));s>i?(p=r.pop(),r.length===0?(h=n._getWrapInfoByCharacter(p,i),r.push(h[0]),h.length===2?c[u]=h[1]:u++,f[l++]=r.join(""),o=!1,r=[]):(o=!0,u--)):s<i&&o===!0||s===i?(o=!1,f[l++]=n._removeEndSpace(r.join("")),r=[],u++):s<i&&(u++,e=y)}return r.length!==0&&(f[l]=n._removeEndSpace(r.join(""))),f},n}();n._WordWrapHelper=it;rt=function(){function r(){}return r.IsNumber=function(t){return n.util.isType(t,"number")||n.util.isType(t,"DateTime")||n.util.isType(t,"TimeSpan")||t&&!n.util.isType(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&(t.length>=2&&t[0]==="0"&&t[1]==="x"?!1:!0)},r.ToDouble=function(r){return r===t||r===i||r===""?0:n.util.isType(r,"number")?r:n.util.isType(r,"string")&&!isNaN(r)?nt.parseLocale(r):n.util.isType(r,"boolean")?r?1:0:n.util.isType(r,"DateTime")?new v(r).toOADate():n.util.isType(r,"TimeSpan")?new v(r).TotalDays():parseFloat(r)},r.toString=function(n){try{return n===t||n===i?"":typeof n=="boolean"?n?"TRUE":"FALSE":typeof n=="string"?n:n.toString()}catch(r){return""}},r}();n.FormatConverter=rt})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(n){function o(i){var r;if(i instanceof t)return i;var u=0,f=0,e=0,o=0;return i&&i!==""&&(r=n.util.parseColorString(i),r&&(r.length===3?(u=255,f=r[0],e=r[1],o=r[2]):r.length===4&&(u=r[0],f=r[1],e=r[2],o=r[3]))),new t(u,f,e,o)}var g,f,e,nt;n.feature("core.theme",["core.common"]);var i=null,r=undefined,tt=Math.min,it=Math.max,t=function(){function n(n,t,i,r){var u=this;u.a=n;u.r=t;u.g=i;u.b=r}return n.prototype.toString=function(){var n=this;return n.a===255?"#"+n.getColorUnitString(n.r)+n.getColorUnitString(n.g)+n.getColorUnitString(n.b):"rgba("+n.r+","+n.g+","+n.b+","+n.a+")"},n.prototype.getBrightness=function(){return(this.r*299+this.g*587+this.b*114)/1e3},n.prototype.getColorUnitString=function(n){var t=n.toString(16);return t.length===1&&(t="0"+t),t},n.hueToRGB=function(n,t,i){return(i<0&&(i+=240),i>240&&(i-=240),i<40)?n+((t-n)*i+20)/40:i<120?t:i<160?n+((t-n)*(160-i)+20)/40:n},n.fromHLS=function(t,i,r){var e,o,s,f,u;return r===0?e=o=s=parseInt(i*255/240,10):(u=i<=120?(i*(240+r)+120)/240:i+r-(i*r+120)/240,f=2*i-u,e=parseInt((n.hueToRGB(f,u,t+80)*255+120)/240,10),o=parseInt((n.hueToRGB(f,u,t)*255+120)/240,10),s=parseInt((n.hueToRGB(f,u,t-80)*255+120)/240,10)),new n(255,e,o,s)},n.parse=function(n){return o(n)},n.isTwoColorSimilar=function(n,t){var i=255-Math.abs(n.r-t.r),r=255-Math.abs(n.g-t.g),u=255-Math.abs(n.b-t.b),e=Math.abs(n.a-t.a),f;return(i/=255,r/=255,u/=255,f=(i+r+u)/3,f>=.9&&e<=.05)?!0:!1},n.invertColor=function(t){var i=t.r^255,r=t.g^255,u=t.b^255,f=new n(t.a,i,r,u);return f.toString()},n}();n._Color=t;g=function(){function n(n){var t=this,f=n.r,e=n.g,o=n.b,r=it(it(f,e),o),s=tt(tt(f,e),o),u=r+s,i;if(t.luminosity=parseInt((u*240+255)/510,10),i=r-s,i===0)t.saturation=0,t.hue=160;else{t.saturation=t.luminosity<=120?parseInt((i*240+u/2)/u,10):parseInt((i*240+(510-u)/2)/(510-u),10);var h=((r-f)*40+i/2)/i,c=((r-e)*40+i/2)/i,l=((r-o)*40+i/2)/i;t.hue=f===r?parseInt(l-c,10):e===r?parseInt(80+h-l,10):parseInt(160+c-h,10);t.hue<0&&(t.hue+=240);t.hue>240&&(t.hue-=240)}}return n.prototype.toColor=function(){return t.fromHLS(this.hue,this.luminosity,this.saturation)},n.prototype.getLighterColor=function(n){var i=this,r=i.luminosity,u=i.newLuma(i.luminosity,500,!0);return t.fromHLS(i.hue,r+(u-r)*n,i.saturation)},n.prototype.getDrakerColor=function(n){var i=this,r=i.newLuma(i.luminosity,-333,!0);return t.fromHLS(i.hue,r*(1-n),i.saturation)},n.prototype.newLuma=function(n,t,i){return t===0?n:i?t>0?(n*(1e3-t)+241*t)/1e3:n*(t+1e3)/1e3:(n+=t*240/1e3,n<0&&(n=0),n>240&&(n=240),n)},n}();n.HLSColor=g;var rt=function(n,i){if(i===0)return n;var r=new g(n),u=parseInt(i>0?(240-r.luminosity)*i:r.luminosity*i,10);return t.fromHLS(r.hue,r.luminosity+u,r.saturation)},c=0,l=1,a=2,v=3,y=4,p=5,w=6,b=7,k=8,d=9,s=10,h=11,u=function(){function n(n,t,i,r,u,f,e,s,h,c,l,a,v){this._name=n;this._colorList=[o(r),o(u),o(t),o(i),o(f),o(e),o(s),o(h),o(c),o(l),o(a),o(v)]}return n.prototype.name=function(n){return arguments.length===0?this._name:(this._name=n,this)},n.prototype.background1=function(n){return this._property(c,arguments.length===0,n)},n.prototype.background2=function(n){return this._property(l,arguments.length===0,n)},n.prototype.textColor1=function(n){return this._property(a,arguments.length===0,n)},n.prototype.textColor2=function(n){return this._property(v,arguments.length===0,n)},n.prototype.accent1=function(n){return this._property(y,arguments.length===0,n)},n.prototype.accent2=function(n){return this._property(p,arguments.length===0,n)},n.prototype.accent3=function(n){return this._property(w,arguments.length===0,n)},n.prototype.accent4=function(n){return this._property(b,arguments.length===0,n)},n.prototype.accent5=function(n){return this._property(k,arguments.length===0,n)},n.prototype.accent6=function(n){return this._property(d,arguments.length===0,n)},n.prototype.hyperline=function(n){return this._property(s,arguments.length===0,n)},n.prototype.followedHyperline=function(n){return this._property(h,arguments.length===0,n)},n.prototype._property=function(n,t,i){return t?this._colorList[n]:(this._colorList[n]=o(i),this)},n.prototype.getColor=function(n){var t,i,u,r,f;if(n&&(t=n.split(" "),t)){if(i=-1,u=t.length,u>1){if(!t[0])return n;r=t[0].toLowerCase();r==="background"?i=parseInt(t[1],10)-1:r==="text"?i=parseInt(t[1],10)+1:r==="accent"&&(i=parseInt(t[1],10)+3)}else u===1&&(r=t[0].toLowerCase(),r==="hyperlink"?i=s:r==="followedhyperlink"&&(i=h));if(i>=0&&i<=11)return u>2?(f=parseInt(t[2],10)/100,rt(this._colorList[i],f).toString()):this._colorList[i].toString()}return n},n.prototype.toJSON=function(){var t=this,n=t._colorList;return{name:t._name,background1:n[c],background2:n[l],text1:n[a],text2:n[v],accent1:n[y],accent2:n[p],accent3:n[w],accent4:n[b],accent5:n[k],accent6:n[d],hyperlink:n[s],followedHyperlink:n[h]}},n.prototype.fromJSON=function(n,u){var f,ct,e;if(n)if(f=this,u){if(ct=n.name?n.name:n._name,ct!==r&&ct!==i&&(f._name=ct),e=n.colorList?n.colorList:n._colorList,e!==r&&e!==i){var o=e[c],g=e[l],nt=e[a],tt=e[v],it=e[y],rt=e[p],ut=e[w],ft=e[b],et=e[k],ot=e[d],st=e[s],ht=e[h];o!==r&&o!==i&&(f._colorList[c]=new t(o.a,o.r,o.g,o.b));g!==r&&g!==i&&(f._colorList[l]=new t(g.a,g.r,g.g,g.b));nt!==r&&nt!==i&&(f._colorList[a]=new t(nt.a,nt.r,nt.g,nt.b));tt!==r&&tt!==i&&(f._colorList[v]=new t(tt.a,tt.r,tt.g,tt.b));it!==r&&it!==i&&(f._colorList[y]=new t(it.a,it.r,it.g,it.b));rt!==r&&rt!==i&&(f._colorList[p]=new t(rt.a,rt.r,rt.g,rt.b));ut!==r&&ut!==i&&(f._colorList[w]=new t(ut.a,ut.r,ut.g,ut.b));ft!==r&&ft!==i&&(f._colorList[b]=new t(ft.a,ft.r,ft.g,ft.b));et!==r&&et!==i&&(f._colorList[k]=new t(et.a,et.r,et.g,et.b));ot!==r&&ot!==i&&(f._colorList[d]=new t(ot.a,ot.r,ot.g,ot.b));st!==r&&st!==i&&(f._colorList[s]=new t(st.a,st.r,st.g,st.b));ht!==r&&ht!==i&&(f._colorList[h]=new t(ht.a,ht.r,ht.g,ht.b))}}else{n.name!==r&&n.name!==i&&(f._name=n.name);var o=n.background1,g=n.background2,nt=n.text1,tt=n.text2,it=n.accent1,rt=n.accent2,ut=n.accent3,ft=n.accent4,et=n.accent5,ot=n.accent6,st=n.hyperlink,ht=n.followedHyperlink;o!==r&&o!==i&&(f._colorList[c]=new t(o.a,o.r,o.g,o.b));g!==r&&g!==i&&(f._colorList[l]=new t(g.a,g.r,g.g,g.b));nt!==r&&nt!==i&&(f._colorList[a]=new t(nt.a,nt.r,nt.g,nt.b));tt!==r&&tt!==i&&(f._colorList[v]=new t(tt.a,tt.r,tt.g,tt.b));it!==r&&it!==i&&(f._colorList[y]=new t(it.a,it.r,it.g,it.b));rt!==r&&rt!==i&&(f._colorList[p]=new t(rt.a,rt.r,rt.g,rt.b));ut!==r&&ut!==i&&(f._colorList[w]=new t(ut.a,ut.r,ut.g,ut.b));ft!==r&&ft!==i&&(f._colorList[b]=new t(ft.a,ft.r,ft.g,ft.b));et!==r&&et!==i&&(f._colorList[k]=new t(et.a,et.r,et.g,et.b));ot!==r&&ot!==i&&(f._colorList[d]=new t(ot.a,ot.r,ot.g,ot.b));st!==r&&st!==i&&(f._colorList[s]=new t(st.a,st.r,st.g,st.b));ht!==r&&ht!==i&&(f._colorList[h]=new t(ht.a,ht.r,ht.g,ht.b))}},n}();n.ThemeColor=u;f=function(){function n(){}return n.Default=new u("Default","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),n.Office2007=new u("Office2007","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),n.Office=new u("Office","#000000","#44546A","#FFFFFF","#E7E6E6","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),n.Apex=new u("Apex","#000000","#69676D","#FFFFFF","#C9C2D1","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),n.Aspect=new u("Aspect","#000000","#323232","#FFFFFF","#E3DED1","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),n.Concourse=new u("Concourse","#000000","#464646","#FFFFFF","#DEF5FA","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),n.Civic=new u("Civic","#000000","#646B86","#FFFFFF","#C5D1D7","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),n.Oriel=new u("Oriel","#000000","#575F6D","#FFFFFF","#FFF39D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),n.Origin=new u("Origin","#000000","#464653","#FFFFFF","#DDE9EC","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),n.Paper=new u("Paper","#000000","#444D26","#FFFFFF","#FEFAC9","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),n.Solstice=new u("Solstice","#000000","#4F271C","#FFFFFF","#E7DEC9","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),n.Technic=new u("Technic","#000000","#3B3B3B","#FFFFFF","#D4D2D0","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),n.Trek=new u("Trek","#000000","#4E3B30","#FFFFFF","#FBEEC9","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),n.Urban=new u("Urban","#000000","#424456","#FFFFFF","#DEDEDE","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),n.Verve=new u("Verve","#000000","#666666","#FFFFFF","#D2D2D2","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),n.Equity=new u("Equity","#000000","#696464","#FFFFFF","#E9E5DC","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),n.Flow=new u("Flow","#000000","#04617B","#FFFFFF","#DBF5F9","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),n.Foundry=new u("Foundry","#000000","#676A55","#FFFFFF","#EAEBDE","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),n.Median=new u("Median","#000000","#775F55","#FFFFFF","#EBDDC3","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),n.Metro=new u("Metro","#000000","#4E5B6F","#FFFFFF","#D6ECFF","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),n.Module=new u("Module","#000000","#5A6378","#FFFFFF","#D4D4D6","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),n.Opulent=new u("Opulent","#000000","#B13F9A","#FFFFFF","#F4E7ED","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),n}();n.ThemeColors=f;e=function(){function n(n,t,i,r){var f=this;f._name=n;f._themeColor=t?t:new u(n);f._headingFont=i;f._bodyFont=r}return n.prototype.name=function(n){return arguments.length===0?this._name:(this._name=n,this)},n.prototype.colors=function(n){return arguments.length===0?this._themeColor:(this._themeColor=n,this)},n.prototype.headerFont=function(n){return arguments.length===0?this._headingFont:(this._headingFont=n,this)},n.prototype.bodyFont=function(n){return arguments.length===0?this._bodyFont:(this._bodyFont=n,this)},n.prototype.getColor=function(n){return this._themeColor.getColor(n)},n.prototype.getFont=function(n){if(n==="Body")return this.bodyFont();else if(n==="Headings")return this.headerFont();return n},n.prototype.toJSON=function(){var n=this,t=n._name;return nt[t]?t:{name:t,themeColor:n._themeColor?n._themeColor.toJSON():undefined,headingFont:n._headingFont,bodyFont:n._bodyFont}},n}();n.SpreadTheme=e;nt=function(){function n(){}return n.Default=new e("Default",f.Default,"Cambria","Calibri"),n.Office=new e("Office",f.Office,"Calibri Light","Calibri"),n.Office2007=new e("Office2007",f.Office2007,"Cambria","Calibri"),n.Apex=new e("Apex",f.Apex,"Lucida Sans","Book Antiqua"),n.Aspect=new e("Aspect",f.Aspect,"Verdana","Verdana"),n.Concourse=new e("Concourse",f.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),n.Civic=new e("Civic",f.Civic,"Georgia","Georgia"),n.Oriel=new e("Oriel",f.Oriel,"Century Schoolbook","Century Schoolbook"),n.Origin=new e("Origin",f.Origin,"Bookman Old Style","Gill Sans MT"),n.Paper=new e("Paper",f.Paper,"Constantia","Constantia"),n.Solstice=new e("Solstice",f.Solstice,"Gill Sans MT","Gill Sans MT"),n.Technic=new e("Technic",f.Technic,"Franklin Gothic Book","Arial"),n.Trek=new e("Trek",f.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),n.Urban=new e("Urban",f.Urban,"Trebuchet MS","Georgia"),n.Verve=new e("Verve",f.Verve,"Century Gothic","Century Gothic"),n.Equity=new e("Equity",f.Equity,"Franklin Gothic Book","Perpetua"),n.Flow=new e("Flow",f.Flow,"Calibri","Constantia"),n.Foundry=new e("Foundry",f.Foundry,"Rockwell","Rockwell"),n.Median=new e("Median",f.Median,"Tw Cen MT","Tw Cen MT"),n.Metro=new e("Metro",f.Metro,"Consolas","Corbel"),n.Module=new e("Module",f.Module,"Corbel","Corbel"),n.Opulent=new e("Opulent",f.Opulent,"Trebuchet MS","Trebuchet MS"),n}();n.SpreadThemes=nt})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){var tt,wt,bt,it,y;t.feature("core.spreadpanelex",["core.common"]);var r=null,o="undefined",rt="scroll-container",ut="scroll-corner-all",g="scroll-arrow",nt="scrollbar-wrapper",ft="scroll-bar",et="scroll-arrowUp",ot="scroll-arrowDown",st="scroll-arrowLeft",ht="scroll-arrowRight",ct="scrollbar-vertical",lt="scrollbar-horizontal",p="no-user-select",s="width",h="height",w="left",at="right",c="top",vt="bottom",yt="margin-left",pt="margin-top",i=".gcScrollbar",l="mousedown"+i,e="mouseup"+i,b="mousemove"+i,k="mouseover"+i,d="mouseout"+i,a="mousewheel",v="DOMMouseScroll",d="mouseout"+i,u="scroll"+i,f={addHandler:function(n,t,i){n.addEventListener&&n.addEventListener(t,i,!1)},removeHandler:function(n,t,i){n.removeEventListener&&n.removeEventListener(t,i,!1)}};(function(n){n[n.pixels=0]="pixels";n[n.continuous=1]="continuous"})(t.ScrollType||(t.ScrollType={}));tt=t.ScrollType,function(n){n[n.horizontalScroll=0]="horizontalScroll";n[n.verticalScroll=1]="verticalScroll"}(t.ScrollOrientation||(t.ScrollOrientation={}));wt=t.ScrollOrientation,function(n){n[n.smallDecrement=0]="smallDecrement";n[n.smallIncrement=1]="smallIncrement";n[n.largeDecrement=2]="largeDecrement";n[n.largeIncrement=3]="largeIncrement";n[n.thumbPosition=4]="thumbPosition";n[n.thumbTrack=5]="thumbTrack";n[n.endScroll=6]="endScroll"}(t.ScrollEventType||(t.ScrollEventType={}));bt=t.ScrollEventType;it=function(){function n(n,t){var i=this;i._showHorizontalScrollbar=!0;i._showVerticalScrollbar=!0;i._hSmallChange=10;i._vSmallChange=10;i._defaultScrollbarSize=18;i._superPanel=n;i._content=t;i.refreshLayout(!0)}return n.prototype.content=function(n){var t=this;return arguments.length===0?t._content:(n instanceof HTMLElement&&t._content!==n&&(t._content=n,t.refreshLayout(!0)),t)},n.prototype.superPanel=function(n){var t=this;return arguments.length===0?t._superPanel:(n instanceof HTMLElement&&t._superPanel!==n&&(t._superPanel=n,t.refreshLayout(!0)),t)},n.prototype.horizontalSmallChange=function(n){var t=this;return arguments.length===0?t._hSmallChange:(typeof n=="number"&&t._hSmallChange!==n&&(t._hSmallChange=n),t)},n.prototype.verticalSmallChange=function(n){var t=this;return arguments.length===0?t._vSmallChange:(typeof n=="number"&&t._vSmallChange!==n&&(t._vSmallChange=n),t)},n.prototype.showHorizontalScrollbar=function(){return this._showHorizontalScrollbar},n.prototype.showVerticalScrollbar=function(){return this._showVerticalScrollbar},n.prototype.refreshLayout=function(n){var i=this,l,b,p,ut,g,o,ft,et,nt,s,ot;if(i._superPanel&&i._content){var w=t.GC$(i._superPanel),tt=t.GC$(i._content),r=i._defaultScrollbarSize,a=tt.width(),v=tt.height(),h=w.width(),c=w.height(),f=h-r,e=c-r,it=!1;i._container||(i._container=document.createElement("div"),t.GC$(i._container).css({position:"relative",left:0,top:0,overflow:"hidden",border:"none",padding:0,margin:0}),it=!0);l=t.GC$(i._container);l.css({width:h,height:c});i._contentWrapper||(i._contentWrapper=document.createElement("div"),t.GC$(i._contentWrapper).css({position:"absolute",left:0,top:0,display:"inline-block",overflow:"hidden",border:"none",padding:0,margin:0}),l.append(i._contentWrapper));b=t.GC$(i._contentWrapper);i._tempContentWrapper||(i._tempContentWrapper=document.createElement("div"),t.GC$(i._tempContentWrapper).css({position:"relative"}),b.append(i._tempContentWrapper));p=t.GC$(i._tempContentWrapper);n&&p.append(i._content).css({top:0,left:0});t.util.browser.chrome&&(a=Math.round(a),v=Math.round(v),h=Math.ceil(h),c=Math.ceil(c));var rt=i._isNeedScrollbars(a,v,h,c),k=rt.isNeedVScroll,d=rt.isNeedHScroll;d?(k||(f+=r),i._hScrollbar||(i._hScrollbar=new y(!0),ut=i._hScrollbar.getScrollbar(),i._hbarContainer=document.createElement("div"),g=t.GC$(i._hbarContainer),g.css({position:"absolute",left:0,bottom:0,border:"none",padding:0,margin:0}),g.append(ut),l.append(i._hbarContainer)),t.GC$(i._hbarContainer).css({width:f,height:r}),o=i._hScrollbar,ft=t.GC$(i._hScrollbar.getScrollbar()),o.width(f),o.height(r),o.minimum(0),o.maximum(a-f),o.pageValue(f),o.smallChange(i.horizontalSmallChange()),o.largeChange(f),o.refreshLayout(),ft.bind(u,function(n,t){p.css("left",0-t.newValue)}),t.GC$(i._hbarContainer).show(),i._showHorizontalScrollbar=!0):(i._hbarContainer&&t.GC$(i._hbarContainer).hide(),i._showHorizontalScrollbar=!1);k?(d||(e+=r),i._vScrollbar||(i._vScrollbar=new y(!1),et=i._vScrollbar.getScrollbar(),i._vbarContainer=document.createElement("div"),nt=t.GC$(i._vbarContainer),nt.css({position:"absolute",right:0,top:0,border:"none",padding:0,margin:0}),nt.append(et),l.append(i._vbarContainer)),t.GC$(i._vbarContainer).css({width:r,height:e}),s=i._vScrollbar,ot=t.GC$(i._vScrollbar.getScrollbar()),s.width(r),s.height(e),s.minimum(0),s.maximum(v-e),s.pageValue(e),s.smallChange(i.verticalSmallChange()),s.largeChange(e),s.refreshLayout(),ot.bind(u,function(n,t){p.css("top",0-t.newValue)}),t.GC$(i._vbarContainer).show(),i._showVerticalScrollbar=!0):(i._vbarContainer&&t.GC$(i._vbarContainer).hide(),i._showVerticalScrollbar=!1);d||k||(f+=r,e+=r);i._pageWidth=f;i._pageHeight=e;b.css({width:f,height:e});it&&(w.append(i._container),i._initEvent())}},n.prototype.scrollChildIntoView=function(n){var t=this,i=t._getScrollOffset(n),u=i.left,f=i.top;u!==r&&t._hScrollbar&&t.hScrollTo(u);f!==r&&t._vScrollbar&&t.vScrollTo(f)},n.prototype.hScrollTo=function(n){var i=this,r,u;i._hScrollbar.value(n);r=i._pageWidth;u=t.GC$(i._content).width();n>=0&&n<=u-r&&t.GC$(i._tempContentWrapper).css(w,0-n)},n.prototype.vScrollTo=function(n){var i=this,r,u;i._vScrollbar.value(n);r=i._pageHeight;u=t.GC$(i._content).height();n>=0&&n<=u-r&&t.GC$(i._tempContentWrapper).css(c,0-n)},n.prototype._isNeedScrollbars=function(n,t,i,r){var f=this._defaultScrollbarSize,e=i-f,o=r-f,u={isNeedHScroll:!1,isNeedVScroll:!1};return n>i&&(u.isNeedHScroll=!0,u.isNeedVScroll=t>o?!0:!1),t>r&&(u.isNeedVScroll=!0,u.isNeedHScroll=n>e?!0:!1),u},n.prototype._getScrollOffset=function(n){var c=t.GC$(n),e=t.GC$(this._contentWrapper),v=t.GC$(this._tempContentWrapper),i,o,u,s,l,h,a,f={left:r,top:r};return n?(i=c.offset(),o=v.offset(),u=e.offset(),i.leftWidth=i.left+c.outerWidth(),i.topHeight=i.top+c.outerHeight(),u.leftWidth=u.left+e.outerWidth(),u.topHeight=u.top+e.outerHeight(),s=i.left-o.left,i.left<u.left?f.left=s:i.leftWidth>u.leftWidth&&(l=i.leftWidth-o.left-e.innerWidth(),f.left=s<l?s:l),h=i.top-o.top,i.top<u.top?f.top=h:i.topHeight>u.topHeight&&(a=i.topHeight-o.top-e.innerHeight(),f.top=h<a?h:a),f):f},n.prototype._initEvent=function(){var n=this;this._tempContentWrapper&&(n._mousewheelHandler=function(t){n._contentContainerMousewheel(t)},f.addHandler(n._tempContentWrapper,a,n._mousewheelHandler),f.addHandler(n._tempContentWrapper,v,n._mousewheelHandler))},n.prototype._contentContainerMousewheel=function(n){var u=this,i;(typeof n.wheelDelta===o||n.wheelDelta===r)&&(typeof n.detail===o||n.detail===r)&&(n.wheelDelta=n.originalEvent.wheelDelta,n.detail=n.originalEvent.detail);var h=n.detail?n.detail:n.wheelDelta/-40,l=h,a=u._vScrollbar,f=parseInt(t.GC$(u._tempContentWrapper).css(c)),e=u._pageHeight,s=t.GC$(u._content).height();s<e&&(s=e);isNaN(f)&&(f=0);i=f-l*u.verticalSmallChange();i>=0&&(i=0);i<0&&0-i>s-e&&(i=0-(s-e));i!==f&&(t.GC$(u._tempContentWrapper).css(c,i),u._showVerticalScrollbar&&a.value(0-i));t.util.cancelDefault(n)},n.prototype.dispose=function(){var n=this;n._container&&(n._hScrollbar&&n._hScrollbar.dispose(),n._vScrollbar&&n._vScrollbar.dispose(),n._tempContentWrapper&&n._mousewheelHandler&&(f.removeHandler(n._tempContentWrapper,a,n._mousewheelHandler),f.removeHandler(n._tempContentWrapper,v,n._mousewheelHandler)),t.GC$(n._container).remove())},n}();t.ScrollablePanel=it;y=function(){function y(n,t,i,u,f,e,o){var s=this;s._pageValue=10;s._maximum=100;s._minimum=0;s._value=0;s._largeChange=10;s._smallChange=1;s._scrollType=1;s._scrollPosition=0;s._isMousedownInScrollbar=!1;s._isMousedownInArrowButton=!1;s._scrollTimeOutArrow=r;s._scrollTimeOutContainer=r;s._initialDelay=300;s._trackClickPepeatFreq=70;s._isHorizontalScroll=n;s._width=typeof t=="number"?t:0;s._height=typeof i=="number"?i:0;s._pageValue=typeof u=="number"?u:0;s._maximum=typeof f=="number"?f:0;s._minimum=typeof e=="number"?e:0;s._scrollType=typeof o=="number"?o:1;s._isMouseCapture=!1;s._scrollPosition=0;s._value=s._minimum;s.refreshLayout()}return y.prototype.getScrollbar=function(){return this._scrollContainerDiv},y.prototype.smallChange=function(n){var t=this;return arguments.length===0?t._smallChange:(typeof n=="number"&&t._smallChange!==n&&(t._smallChange=n),t)},y.prototype.largeChange=function(n){var t=this;return arguments.length===0?t._largeChange:(typeof n=="number"&&t._largeChange!==n&&(t._largeChange=n),t)},y.prototype.pageValue=function(n){var t=this;return arguments.length===0?t._pageValue:(typeof n=="number"&&t._pageValue!==n&&(n<=0&&(n=1),t._pageValue=n),t)},y.prototype.maximum=function(n){var t=this;return arguments.length===0?t._maximum:(typeof n=="number"&&t._maximum!==n&&(n<=0&&(n=0),t._maximum=n),t)},y.prototype.minimum=function(n){var t=this;return arguments.length===0?t._minimum:(typeof n=="number"&&t._minimum!==n&&(n<=0&&(n=0),t._minimum=n),t)},y.prototype.value=function(n){var t=this,i;return arguments.length===0?t._value:(typeof n=="number"&&n<=t._maximum&&n>=t._minimum&&(t._value=n,i=(n-t._minimum)*t._scrollUnit,t.scrollTo(i,!0)),t)},y.prototype.width=function(n){var t=this;return arguments.length===0?t._width:(typeof n=="number"&&t._width!==n&&(t._width=n),t)},y.prototype.height=function(n){var t=this;return arguments.length===0?t._height:(typeof n=="number"&&t._height!==n&&(t._height=n),t)},y.prototype.scrollType=function(n){var t=this;return arguments.length===0?t._scrollType:(typeof tt[n]!==o&&t._scrollType!==n&&(t._scrollType=n),t)},y.prototype.refreshLayout=function(){var n=this,e=n._height,o=n._width,i=e,y=o-2*e,b=i,l=w,it=at,k=0,d=0,wt=!1,r=2,bt=st,kt=ht,dt=lt,gt=yt,ei="ui-widget ui-corner-all",ni="ui-state-default ui-corner-bl btn btn-default",ti="ui-icon ui-icon-triangle-1-w",ii="scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",ri="ui-icon ui-icon-grip-solid-vertical",ui="ui-state-default ui-corner-br btn btn-default",fi="ui-icon ui-icon-triangle-1-e",u,a,v,f,tt;n._isHorizontalScroll?n._scrollSize=y:(i=o,y=i,b=e-2*o,l=c,it=vt,n._scrollSize=b,bt=et,kt=ot,dt=ct,gt=pt,ni="ui-state-default ui-corner-tr btn btn-default",ti="ui-icon ui-icon-triangle-1-n",ii="scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",ri="ui-icon ui-icon-grip-solid-horizontal",ui="ui-state-default ui-corner-br btn btn-default",fi="ui-icon ui-icon-triangle-1-s");u=n._scrollSize;a=n._maximum-n._minimum;n._scrollbarSize=n._pageValue*u/(a+n._pageValue);n._scrollbarSize>u&&(n._scrollbarSize=u);n._scrollbarSize<10&&(n._scrollbarSize=10);v=n._scrollbarSize;n._scrollUnit=a!==0?(u-v)/a:1;n._isHorizontalScroll?(k=v,d=i):(k=i,d=v);n._scrollContainerDiv||(wt=!0,n._scrollContainerDiv=document.createElement("div"),t.GC$(n._scrollContainerDiv).css({position:"relative",left:0,top:0,overflow:"hidden",outline:"none",border:"none",padding:0,margin:0}).addClass(rt+" "+ut+" "+ei));f=t.GC$(n._scrollContainerDiv);f.css(s,o).css(h,e);n._arrowStartDiv||(n._arrowStartDiv=document.createElement("div"),t.GC$(n._arrowStartDiv).css({position:"absolute",display:"inline-block",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).addClass(g+" "+ni),n._arrowStartSpan=document.createElement("span"),t.GC$(n._arrowStartSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(n._arrowStartSpan).addClass(bt+" "+ti),t.GC$(n._arrowStartDiv).append(n._arrowStartSpan),f.append(n._arrowStartDiv));t.GC$(n._arrowStartDiv).css(l,0).css(s,i-r).css(h,i-r);t.GC$(n._arrowStartSpan).css({width:"100%",height:"100%"});n._scrollbarWrapperDiv||(n._scrollbarWrapperDiv=document.createElement("div"),t.GC$(n._scrollbarWrapperDiv).css({position:"absolute",display:"inline-block",boxSizing:"content-box",border:"none",padding:0,margin:0}).addClass(nt+" "+nt),f.append(n._scrollbarWrapperDiv));tt=t.GC$(n._scrollbarWrapperDiv);tt.css(l,i).css(s,y).css(h,b);n._scrollbarDiv||(n._scrollbarDiv=document.createElement("div"),t.GC$(n._scrollbarDiv).css({position:"absolute",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).attr("unselectable","on").addClass(ft+" "+p+" "+ii),n._scrollbarSpan=document.createElement("span"),t.GC$(n._scrollbarSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(n._scrollbarSpan).addClass(dt+" "+ri),t.GC$(n._scrollbarDiv).append(n._scrollbarSpan),tt.append(n._scrollbarDiv));t.GC$(n._scrollbarDiv).css(l,n._scrollPosition).css(s,Math.round(k-r)).css(h,Math.round(d-r));t.GC$(n._scrollbarSpan).css({width:i-r,height:i-r});t.GC$(n._scrollbarSpan).css(gt,Math.floor((n._scrollbarSize-i)/2));n._arrowEndDiv||(n._arrowEndDiv=document.createElement("div"),t.GC$(n._arrowEndDiv).css({position:"absolute",display:"inline-block",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).addClass(g+" "+ui),n._arrowEndSpan=document.createElement("span"),t.GC$(n._arrowEndSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(n._arrowEndSpan).addClass(kt+" "+fi),t.GC$(n._arrowEndDiv).append(n._arrowEndSpan),f.append(n._arrowEndDiv));t.GC$(n._arrowEndDiv).css(it,0).css(s,i-r).css(h,i-r);t.GC$(n._arrowEndSpan).css({width:"100%",height:"100%"});wt&&n._initEvents()},y.prototype._initEvents=function(){var r=this;t.GC$(r._arrowStartDiv).bind(l,function(n){r._arrowMousedown(n,!0)}).bind(e,function(n){r._arrowMouseup(n,!0)}).bind(k,function(n){r._arrowMouseover(n,!0)}).bind(d,function(n){r._arrowMouseout(n,!0)});t.GC$(r._arrowEndDiv).bind(l,function(n){r._arrowMousedown(n,!1)}).bind(e,function(n){r._arrowMouseup(n,!1)}).bind(k,function(n){r._arrowMouseover(n,!1)}).bind(d,function(n){r._arrowMouseout(n,!1)});t.GC$(r._scrollbarDiv).bind(l,function(n){r._scrollbarMousedown(n)}).bind(b,function(n){r._scrollbarMousemove(n)}).bind(e,function(n){r._scrollbarMouseup(n)}).bind(k,function(n){r._scrollbarMouseover(n)}).bind(d,function(n){r._scrollbarMouseout(n)});t.GC$(r._scrollbarWrapperDiv).bind(l,function(n){var f=t.util.browser&&t.util.browser.mozilla,i,u;f&&(i=(new Date).valueOf(),u=r._lastMouseDownTime,r._lastMouseDownTime=i,u&&i-u<100)||r._scrollbarContainerMousedown(n)}).bind(e,function(n){r._scrollbarContainerMouseup(n)});r._mousewheelHandler=function(n){r._scrollContainerMousewheel(n)};f.addHandler(r._scrollContainerDiv,a,r._mousewheelHandler);f.addHandler(r._scrollContainerDiv,v,r._mousewheelHandler);t.features.touch&&(r._simulateMouseEvents=new n.Sheets._SimulateMouseEvents,r._simulateMouseEvents.bindUnBindTouchEvents(r._scrollContainerDiv,!0,i))},y.prototype.dispose=function(){var n=this,r=n._scrollContainerDiv;n._arrowEndDiv&&t.GC$(n._arrowEndDiv).unbind(i);n._scrollbarDiv&&t.GC$(n._scrollbarDiv).unbind(i);n._arrowStartDiv&&t.GC$(n._arrowStartDiv).unbind(i);n._scrollbarWrapperDiv&&t.GC$(n._scrollbarWrapperDiv).unbind(i);r&&(n._mousewheelHandler&&(f.removeHandler(r,a,n._mousewheelHandler),f.removeHandler(r,v,n._mousewheelHandler)),n._simulateMouseEvents&&n._simulateMouseEvents.bindUnBindTouchEvents(n._scrollContainerDiv,!1,i),t.GC$(r).unbind(i).remove())},y.prototype._handleDocumentMouseMove=function(){var n=this;n._isMouseCapture||(t.GC$(document).bind(b,function(t){n._scrollbarMousemove(t)}).bind(e,function(t){n._scrollbarMouseup(t)}),n._isMouseCapture=!0)},y.prototype._unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,t.GC$(document).unbind(b).unbind(e))},y.prototype._arrowMousedown=function(n,i){var u=0,r=this,e=!0,f;(r._isMousedownInArrowButton=!0,r._scrollTimeOutArrow===null)&&(i?(t.GC$(r._arrowStartDiv).addClass("scrollbar-stateActive ui-state-active"),u=0-r._smallChange,r._scrollEventType=0):(t.GC$(r._arrowEndDiv).addClass("scrollbar-stateActive ui-state-active"),u=r._smallChange,r._scrollEventType=1),f=function(){r.scrollTo(r._scrollPosition+u*r._scrollUnit,!1);r._scrollType===1&&(r._scrollTimeOutArrow=setTimeout(f,e?r._initialDelay:r._trackClickPepeatFreq));e=!1},f(),t.util.preventDefault(n))},y.prototype._arrowMouseup=function(n,i){var r=this,u=t.GC$(r._arrowStartDiv);i||(u=t.GC$(r._arrowEndDiv));u.removeClass("scrollbar-stateActive ui-state-active");r._endArrowScroll();t.util.preventDefault(n)},y.prototype._arrowMouseover=function(n,i){var r=this,u=t.GC$(r._arrowStartDiv);i||(u=t.GC$(r._arrowEndDiv));u.addClass("scroll-arrow-hover ui-state-hover");t.util.preventDefault(n)},y.prototype._arrowMouseout=function(n,i){var r=this,u=t.GC$(r._arrowStartDiv);i||(u=t.GC$(r._arrowEndDiv));u.removeClass("scroll-arrow-hover scrollbar-stateActive ui-state-hover ui-state-active");r._endArrowScroll();t.util.preventDefault(n)},y.prototype._scrollbarMousedown=function(n){var i=this;if(n.button===0){i._isMousedownInScrollbar=!0;i._oldPosition={x:n.pageX,y:n.pageY};i._handleDocumentMouseMove();t.GC$(i._scrollbarDiv).addClass("scrollbar-stateActive ui-state-active");var r=t.GC$(i._scrollbarDiv).offset(),f=t.GC$(i._scrollbarDiv).outerWidth(!0),e=t.GC$(i._scrollbarDiv).outerHeight(!0),u=t.GC$(i._scrollbarWrapperDiv).offset(),o=t.GC$(i._scrollbarWrapperDiv).outerWidth(!0),s=t.GC$(i._scrollbarWrapperDiv).outerHeight(!0);i._edgePosition={isBeyondEdge:!1,startEdgePosition:{x:u.left+n.pageX-r.left,y:u.top+n.pageY-r.top},endEdgePosition:{x:u.left+o-(f-n.pageX+r.left),y:u.top+s-(e-n.pageY+r.top)}}}t.util.preventDefault(n)},y.prototype._scrollbarMousemove=function(n){var i=this;i._isMousedownInScrollbar&&(i._currentPosition={x:n.pageX,y:n.pageY},i._scrollbarDrag(),i._oldPosition=i._currentPosition,t.GC$(document.body).attr("unselectable","on").addClass(p));t.util.preventDefault(n)},y.prototype._scrollbarMouseup=function(n){var i=this,r;i._isMousedownInScrollbar=!1;i._scrollEventType=4;i._edgePosition=null;r={newValue:i._value,oldValue:i._value,scrollOrientation:i._isHorizontalScroll?0:1,scrollEventType:i._scrollEventType};t.GC$(i._scrollContainerDiv).trigger(u,r);var o=i._value,f=(o-i._minimum)*i._scrollUnit,e="left";i._isHorizontalScroll||(e="top");i._scrollPosition=f;t.GC$(i._scrollbarDiv).css(e,f);i._unhandleDocumentMouseMove();t.GC$(document.body).removeClass(p);t.GC$(document.body).attr("unselectable")&&t.GC$(document.body).removeAttr("unselectable");t.GC$(i._scrollbarDiv).removeClass("scrollbar-stateActive ui-state-active");i._scrollEventType=6;r={newValue:i._value,oldValue:i._value,scrollOrientation:i._isHorizontalScroll?0:1,scrollEventType:i._scrollEventType};t.GC$(i._scrollContainerDiv).trigger(u,r);t.util.preventDefault(n)},y.prototype._scrollbarMouseover=function(n){t.GC$(this._scrollbarDiv).addClass("scrollbar-stateHover ui-state-hover");t.util.preventDefault(n)},y.prototype._scrollbarMouseout=function(n){t.GC$(this._scrollbarDiv).removeClass("scrollbar-stateHover ui-state-hover");t.util.preventDefault(n)},y.prototype._scrollContainerMousewheel=function(n){var i=this,e,f,s;(typeof n.wheelDelta===o||n.wheelDelta===r)&&(typeof n.detail===o||n.detail===r)&&(n.wheelDelta=n.originalEvent.wheelDelta,n.detail=n.originalEvent.detail);e=n.detail?n.detail:n.wheelDelta/-40;f=e/3*i._smallChange*i._scrollUnit;i._scrollEventType=f>=0?1:0;i.scrollTo(i._scrollPosition+f,!1);i._scrollEventType=6;s={newValue:i._value,oldValue:i._value,scrollOrientation:i._isHorizontalScroll?0:1,scrollEventType:i._scrollEventType};t.GC$(i._scrollContainerDiv).trigger(u,s);t.util.preventDefault(n)},y.prototype._scrollbarContainerMousedown=function(n){var i=this,f=!0,e=n.pageX,o=n.pageY,r=0,s=t.GC$(i._scrollbarWrapperDiv).offset(),h=i._largeChange,u;i._scrollTimeOutContainer===null&&(r=i._isHorizontalScroll?e-s.left-i._scrollPosition:o-s.top-i._scrollPosition,u=function(){var c=t.GC$(i._scrollbarWrapperDiv).offset(),n=0,s=i._scrollPosition;if(n=i._isHorizontalScroll?e-c.left-s:o-c.top-s,n*r<0||n>=0&&n<i._scrollbarSize){i._endContainerScroll();return}if(r<0)i._scrollEventType=2,i.scrollTo(s-h*i._scrollUnit,!1);else if(r>0)i._scrollEventType=3,i.scrollTo(s+h*i._scrollUnit,!1);else{i._endContainerScroll();return}i._scrollType===1&&(i._scrollTimeOutContainer=setTimeout(u,f?i._initialDelay:i._trackClickPepeatFreq));f=!1},u(),t.util.preventDefault(n))},y.prototype._scrollbarContainerMouseup=function(n){this._endContainerScroll();t.util.preventDefault(n)},y.prototype._endContainerScroll=function(){var n=this,i;n._scrollTimeOutContainer&&clearTimeout(n._scrollTimeOutContainer);n._scrollTimeOutContainer=r;n._scrollEventType=6;i={newValue:n._value,oldValue:n._value,scrollOrientation:n._isHorizontalScroll?0:1,scrollEventType:n._scrollEventType};t.GC$(n._scrollContainerDiv).trigger(u,i)},y.prototype._endArrowScroll=function(){var n=this,i;n._isMousedownInArrowButton&&(n._isMousedownInArrowButton=!1,n._scrollTimeOutArrow&&clearTimeout(n._scrollTimeOutArrow),n._scrollTimeOutArrow=r,n._scrollEventType=6,i={newValue:n._value,oldValue:n._value,scrollOrientation:n._isHorizontalScroll?0:1,scrollEventType:n._scrollEventType},t.GC$(n._scrollContainerDiv).trigger(u,i))},y.prototype._scrollbarDrag=function(){var n=this,r=0,u=n._scrollPosition,i=n._currentPosition,t=n._edgePosition,l,a;if(n._isHorizontalScroll){if(t&&t.isBeyondEdge){var f=t.startEdgePosition.x,e=t.endEdgePosition.x,h=i.x<f,c=i.x>e;if(h||c)return;n._oldPosition.x<f&&(n._oldPosition.x=f);n._oldPosition.x>e&&(n._oldPosition.x=e)}l=i.x-n._oldPosition.x;r=u+l}else{if(t&&t.isBeyondEdge){var o=t.startEdgePosition.y,s=t.endEdgePosition.y,h=i.y<o,c=i.y>s;if(h||c)return}n._oldPosition.y<o&&(n._oldPosition.y=o);n._oldPosition.y>s&&(n._oldPosition.y=s);a=i.y-n._oldPosition.y;r=u+a}r!==u&&(n._scrollEventType=5,n.scrollTo(r,!1))},y.prototype.scrollTo=function(n,i){var r=this,s=c,h=r._scrollSize-r._scrollbarSize,v="",y=r._scrollPosition,p=t.ScrollOrientation,e,f;r._isHorizontalScroll&&(s=w);e=!1;n>h&&(n=h,e=!0);n<0&&(n=0,e=!0);r._edgePosition&&(r._edgePosition.isBeyondEdge=e);var o=Math.round(n/r._scrollUnit)+r._minimum,a=r._value,l=!1;i||(f={newValue:o,oldValue:a,scrollOrientation:r._isHorizontalScroll?0:1,scrollEventType:r._scrollEventType},t.GC$(r._scrollContainerDiv).trigger(u,f),l=f.ignoreUpdatePosition,f.newValue>r._maximum&&(f.newValue=r._maximum),o=f.newValue);r._value=o;r._scrollEventType!==5&&(n=(o-r._minimum)*r._scrollUnit);r._scrollPosition=n;l||t.GC$(r._scrollbarDiv).css(s,n)},y}();t.Scrollbar=y})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){var k,dt,rt,gt,ni,ti;t.feature("core.basecelltype",["core.common","core.globalize","core.theme"]);var ut=window.document,ct="position",lt="absolute",at="margin",ft="font",ii="class",u="left",v="right",d="top",vt="alphabetic",y="center",g="gcUIElement",p="none",ri="tabindex",et="0",hr="#9fa9c5",ui="#f6fafb",h=".gcEditingInput",fi="keydown"+h,ei="keyup"+h,oi="paste"+h,si="mousedown"+h,hi="compositionstart"+h,ci="compositionupdate"+h,li="compositionend"+h,l="width",e="height",yt="padding",ai="padding-left",vi="padding-right",yi="padding-top",pi="padding-bottom",pt="text-align",f="hidden",wi="visibility",c="word-wrap",o="overflow",nt="normal",ot="break-word",wt="overflow-y",bi="resize",ki="border",di="outline",gi="box-shadow",nr="box-sizing",tr="autocomplete",bt="color",ir="border-width",kt="background-color",rr="z-index",ur="text-decoration",st="ime-mode",fr="overline",er="line-through",or="underline",sr=.337,w=16,b="undefined",s=undefined,i=null,tt=Math.floor,a=Math.ceil,it=Math.min,ht=Math.max,r=function(){function n(){}return n.getAutoFitWidth=function(i,r,u,f,e){var o=0,h=e&&e.sheet,a,c,l,s;if(h&&typeof r=="string"&&r!==""){if(u.wordWrap)for(a=0,c=u.textIndent,c>0&&(a=c*8),l=r.split(/\r\n|\r|\n/),s=0;s<l.length;s++)o=ht(o,t._WordWrapHelper._measureTextWithoutEndSpaces(l[s],u.font)/f);else o=h._getStringWidthByCanvas(r,u.font)/f;u.hAlign!==1&&u.textIndent>0&&(o+=u.textIndent*8/f);u.hAlign===0&&n.hasIconSet(h,e.row,e.col,e.sheetArea)&&(o+=w)}return o},n.getAutoFitHeight=function(n,i,r,u,f){var l=0,s=f&&f.sheet,a,v,y,c,w;if(s&&typeof i=="string"&&i!=="")if(a=s._getFontHeight(r.font)/u,r.wordWrap){v=0;y=r.textIndent;y>0&&(v=y*8);var p=f.row,e=f.col,b=f.sheetArea,h=0,o=s._getSpanModel(b).find(p,e);if(o){if(!(o.row<p)&&!(o.rowCount>1)&&!(o.col<e)&&e==o.col&&(h=s.getColumnWidth(e),o.colCount>1))for(c=e+1;c<e+o.colCount;c++)h+=s.getColumnWidth(c)}else h=s.getColumnWidth(e);w=t._WordWrapHelper._getWrapInfo(i,h-3-v,r.font);l=w.length*a}else l=a;return l},n.paintBackground=function(t,i,r,u,f,e,o,s,h){(e||o)&&(t.save(),t.beginPath(),e&&(t.fillStyle!==e&&(t.fillStyle=e),t.fillRect(i,r,u,f)),n.paintBackgroundImage(t,i,r,u,f,o,s,h),t.restore())},n.paintBackgroundImage=function(n,t,i,r,u,f,e,o){if(f&&f!==p&&o)try{if(o.getState(f)){var w=o.getImage(f),s=w.width,h=w.height,d=0,g=0,c=s,l=h,v=r,y=u,b=t,k=i;switch(e){case 0:break;case 1:c=r>=s?s:r;l=u>=h?h:u;b=r>s&&s>0?a(t+r/2-s/2):t;k=u>h&&h>0?a(i+u/2-h/2):i;v=c;y=l;break;case 2:u>0&&h>0&&r/u>s/h?(v=s/h*u,b=t+r/2-v/2):r>0&&s>0&&u/r>h/s&&(y=h/s*r,k=i+u/2-y/2);break;case 3:c=r>=s?s:r;l=u>=h?h:u;v=c;y=l;break;default:break}n.drawImage(w,d,g,c,l,b,k,v,y)}else o.addImage(f)}catch(nt){}},n.paintConditionalFormats=function(n,r,u,f,e,o,s,h){var nt=h.conditionalFormats,b,it,g;if(nt&&!(nt.count()<=0)){var p=h.sheet,v=h.row,y=h.col,c,l,tt=p._cachePool.getConditionalFormat(v,y);if(tt){if(c=tt.i,l=tt.d,!c&&!l)return!1}else{if(b=nt.getRules(v,y),it=b.length,it<=0)return p._cachePool.setConditionalFormat(v,y,l,c),!1;var rt=!1,ut=!1,k=i,d=i,a=i,ft=i;for(b.sort(function(n,t){return n.priority()-t.priority()}),g=0;g<it;g++)if(a=b[g],a&&(!k&&a instanceof t.DataBarRule?k=a:!d&&a instanceof t.IconSetRule&&(d=a),a.stopIfTrue()&&(ft=a.evaluate(p,v,y,r),ft)))break;k&&(l=k.evaluate(p,v,y,r));d&&(c=d.evaluate(p,v,y,r));p._cachePool.setConditionalFormat(v,y,l,c)}return n.save(),n.beginPath(),l&&(t.DataBarRule.paintDataBar(n,l,u,f,e,o),rt=l.showBarOnly),c&&((e<w||o<w)&&(n.rect(u,f,e,o),n.clip(),n.beginPath()),t.IconSetRule.paintIconSet(n,c,u,f,e,o,s,h.imageLoader),ut=c.showIconOnly),n.restore(),rt||ut}},n.paintSparkline=function(n,t,i,r,u,f){f&&f.paintSparkline(n,t,i,r,u)},n.paintSparklineEx=function(n,i,r,u,f,e,o){var s,h;return t.features.sparklineEx&&i instanceof t.SparklineExValue&&(s=o&&o.parent,s&&(h=s.getSparklineEx(i.name),h))?(h._paintSparkline(n,i.value,r,u,f,e,o),!0):!1},n.hasIconSet=function(n,r,u,f){var o,h,e,c;if((f===i||f===s||f===3)&&(o=n._conditionalFormats,o))for(h=o.getRules(r,u),e=0,c=h.length;e<c;e++)if(h[e]instanceof t.IconSetRule)return!0;return!1},n.adjustRectForIconSet=function(t,i,r,u,f,e){t===0&&n.hasIconSet(i,r,u,f)&&(e.x+=w,e.width-=w)},n}();t.CellTypeContext=r;k=function(){function n(){this.allowOverflow=!1;this.typeName="0"}return n.prototype.paintValue=function(n,t,r,u,f,e,o,s){var c={value:i},h;(h=this.format(t,o.formatter||o._autoFormatter,c),h)&&this.paintText(n,t,r,u,f,e,o,s,h,c)},n.prototype.paintText=function(n,i,r,f,e,o,s,h,c,l,a){var k,it,kt,at,yt,pt,ot,fi,ti;n.save();n.beginPath();k=s.foreColor;it=s.font;l.value&&(k=l.value);typeof a!==b&&(kt=t._Color.parse(k),kt.a=a,k=kt.toString());k&&n.fillStyle!==k&&(n.fillStyle=k);it&&n.font!==it&&(n.font=it);var rt=0,ii=s.textIndent,ri=s.wordWrap,d=s.hAlign,dt=s.vAlign,st=s.textDecoration,ht=u,ui=vt,w=2,g=2,gt=0,nt=h.lineHeight,ct=[],lt=0,ut=h.fontInfo.fontSize;ii>0&&(rt=ii*8);d===3&&(d=t.util.getHAlignByValueType(d,i,s.formatter));w+=rt;d===1?(w=e/2,ht=y):d===2&&(w=e-3,w-=rt,ht=v);n.textAlign!==ht&&(n.textAlign=ht);ri&&(ct=t._WordWrapHelper._getWrapInfo(c,e-3-rt,it),lt=ct.length,lt>1&&dt!==0&&(gt=(lt-1)*nt));at=ut>8?tt((ut-8)/5+2):1;yt=nt/2-ut/2+at-1;g+=nt-yt;dt===1?g=(o-gt)/2+nt/2-yt:dt===2&&(g=o-gt-2-yt);n.textBaseline!==ui&&(n.textBaseline=ui);var p={x:r,y:f,width:e-1,height:o},ft=h.cellOverflowLayout,et=ft&&ft.layout;if(et&&(p={x:et.x,y:et.y,width:et.width,height:et.height}),ri)for(n.rect(p.x,p.y,p.width,p.height),n.clip(),n.beginPath(),pt=f+g,ot=0;ot<lt;ot++)n.fillText(ct[ot],r+w,pt),st&&(fi=n.measureText(ct[ot]).width,this._renderTextDecoration(n,st,r+w,pt,fi,ut,at)),pt+=nt;else{var wt=n.measureText(c).width,ni=p.width,ei=p.height,bt=wt>ni||nt>ei;bt||(d===1?ft&&(ti=wt/2,(ti>ft.backgroundLeftWidth||ti>ft.backgroundRightWidth)&&(bt=!0)):wt+rt>ni&&(bt=!0));bt&&(n.rect(p.x,p.y,ni,ei),n.clip(),n.beginPath());n.fillText(c,r+w,f+g);st&&this._renderTextDecoration(n,st,r+w,f+g,wt,ut,at)}n.restore()},n.prototype.paint=function(n,t,i,r,u,f,e,o){},n.prototype.createEditorElement=function(n){return i},n.prototype._getLocator=function(){var n=ut.createElement("span");return t.GC$(n).css(ct,lt).css(wi,f).css(kt,"#68E").css(at,et).css(yt,"2px").css(ft,"normal 12px Arial").css(bt,"white").css(ir,et).attr(ii,"gc-input-locator").attr(g,"gcEditingLocator"),n},n.prototype.getEditorValue=function(n,t){return i},n.prototype._formatEditorValue=function(n,t,i,r){return i},n.prototype.setEditorValue=function(n,t,i){},n.prototype.getEditingElement=function(){return i},n.prototype.parse=function(n,r,u){var o=typeof r===b||r===i,f=typeof n===b||n===i,e;if(o||f)return f?"":n.toString();else try{return t.features.formatter?(e=typeof r=="string"?new t.GeneralFormatter(r):r,e.Parse(n)):n.toString()}catch(s){return n.toString()}},n.prototype.format=function(n,r,u,f){var o,c,h,e;if(n===s||n===i||n==="")return"";if(typeof r=="string"&&typeof n!="object")return t._CacheMgr.getFormattedText(n,r,u);if(r)try{return t.features.formatter?(o=i,o=typeof r=="string"?t._CacheMgr.getFormatter(r):r,c=typeof n=="number",h=t.util.isStringNumber(n),!c&&h&&(n=t._NumberHelper.replaceCultureSymbolToNormal(n)),e=o.Format(n,u),h&&(e=t._NumberHelper.replaceNormalToCultureSymble(e)),e):n.toString()}catch(l){return n.toString()}else{if(typeof n=="boolean"||n instanceof Boolean)return n.toString().toUpperCase();else if(n instanceof Date)return new t._DateTimeHelper(n).localeFormat("M/d/yyyy h:mm:ss");return typeof n=="number"&&(n=t._NumberHelper.replaceNormalToCultureSymble(n.toString())),n.toString()}},n.prototype.focus=function(n,t){n&&n.focus&&n.focus()},n.prototype.getThemeStyle=function(n,i){return t.ThemeStyleHelper.getVisualStateThemeStyle(n,i)},n.prototype.activateEditor=function(n,t,i,r){},n.prototype.deactivateEditor=function(n,t){},n.prototype.selectAll=function(n,t){n&&n.select&&n.select()},n.prototype.updateEditor=function(n,t,i,r){},n.prototype.setImeMode=function(n,i,r){this.isImeAware(r)?this.updateImeMode(n,i,r):n&&t.GC$(n).css(st,this._getImeModeString(0))},n.prototype.updateImeMode=function(n,i,r){n&&t.GC$(n).css(st,this._getImeModeString(i))},n.prototype._getImeModeString=function(n){var t="";n===s&&(n=1);switch(n){case 1:t="auto";break;case 2:t="active";break;case 4:t="inactive";break;case 0:t="disabled";break}return t},n.prototype._updateEditorLocator=function(n,i){var r=n&&i&&i.sheet,f,e;r&&r.isEditing()&&r.showEditingLocator&&(f=n._editingLocator,e=t.GC$(n),f&&t.GC$(f).css(d,parseInt(e.css(d),10)-18).css(u,parseInt(e.css(u),10)))},n.prototype.getHitInfo=function(n,t,r,u,f){return i},n.prototype.processMouseDown=function(n){return!1},n.prototype.processMouseMove=function(n){return!1},n.prototype.processMouseUp=function(n){return!1},n.prototype.processMouseEnter=function(n){},n.prototype.processMouseLeave=function(n){},n.prototype.isReservedKey=function(n,t){return!1},n.prototype.isEditingValueChanged=function(n,t,i){return n!==t},n.prototype.processKeyDown=function(n,t){return!1},n.prototype.processKeyUp=function(n,t){return!1},n.prototype.getAutoFitWidth=function(n,t,i,r,u){return 0},n.prototype.getAutoFitHeight=function(n,t,i,r,u){return 0},n.prototype._renderTextDecoration=function(n,t,i,r,u,f,e){n.strokeStyle=n.fillStyle;var o=0,h=0,s=.5,c;c=f<=12?12:f;h=tt((c-12)/21+1);n.lineWidth=h;(h&1)==0&&(s=0);n.textAlign===y?i=i-u/2:n.textAlign===v&&(i=i-u);n.beginPath();(t&4)==4&&(o=a(r+e-f-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&2)==2&&(o=a(r+e-f/2)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&1)==1&&(o=a(r+e-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));n.stroke()},n.prototype._setEditStatusTextDecoration=function(n,t){var i="";(t&4)==4&&(i=fr);(t&2)==2&&(i+=" "+er);(t&1)==1&&(i+=" "+or);n.css(ur,i)},n.prototype.isImeAware=function(n){return!1},n.prototype.isEditting=function(){return!1},n.prototype.toJSON=function(){return{typeName:this.typeName}},n.prototype.fromJSON=function(n,t){},n}();t.BaseCellType=k;dt=function(w){function b(){w.call(this);this.allowOverflow=!0;this.typeName="1"}return __extends(b,w),b.prototype.paint=function(n,i,u,f,e,o,s,h){var l,a,c;n&&(h&&h.parentBackColor&&h.parentBackColor===s.backColor||r.paintBackground(n,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),l=r.paintConditionalFormats(n,i,u,f,e,o,s,h),h.showBarIconOnly=l,r.paintSparkline(n,u,f,e,o,h.sparkline),a=r.paintSparklineEx(n,i,u,f,e,o,h.sheet),h.cellOverflowLayout||l||a||(c=new t.Rect(u,f,e,o),r.adjustRectForIconSet(s.hAlign,h.sheet,h.row,h.col,h.sheetArea,c),this.paintValue(n,i,c.x,c.y,c.width,c.height,s,h)))},b.prototype.getText=function(n,t){return n},b.prototype.paintValue=function(n,t,r,u,f,e,o,s){var l=this,h,c;if(t=this.getText(t,s),h={value:i},c=l.format(t,o.formatter||o._autoFormatter,h),o.watermark&&!c){l.paintText(n,o.watermark,r,u,f,e,o,s,o.watermark,h,sr);return}c&&l.paintText(n,t,r,u,f,e,o,s,c,h)},b.prototype.createEditorElement=function(n){var i=t.GC$(ut.createElement("textarea"));i.css(at,et).css(yt,"1px").css(nr,"content-box").css(ft,"normal 11pt calibri").css(c,"normal").css(o,f).css(bi,p).css(ki,"2px #5292f7 solid").css(di,p).css(gi,"1px 2px 5px rgba(0,0,0,0.4)").css("min-height","0px").attr(ri,-1).attr(tr,"off").attr(g,"gcEditingInput");var r=ut.createElement("div"),u=n&&n.sheet&&n.sheet.parent&&n.sheet.parent._host,e=t.util.getPreferredZIndex(u)+1e3;return t.GC$(r).css(ct,lt).css(rr,e).append(i),r},b.prototype.getEditorValue=function(n,t){var u=n&&n.children[0],r;return u&&(r=u.value,r!==s&&r!==i&&r.length>0)?r:i},b.prototype.setEditorValue=function(n,r,u){var f=n&&n.children[0],e;f&&(e=!t.util.browser.msie&&(u&&u.sheet&&u.sheet._startEditByKeydown?!0:!1),f.value=r===i||r===s||e?"":r,f.selectionStart=f.selectionEnd=f.value.length)},b.prototype.focus=function(n,t){if(n){var i=n.children[0];this.isImeAware()&&i?(i.focus(),i.selectionStart=i.value.length):n.focus()}},b.prototype._formatEditorValue=function(n,i,r,u){var f=n&&u&&u.sheet;return t.util.formatValue2Text(i,r,f)},b.prototype.activateEditor=function(n,r,f,e){var s=n&&e&&e.sheet,v,l,a,o,c,h;s&&(v=t.GC$(n),l=s.getBounds(),a=e.canvasOffset?e.canvasOffset:s._eventHandler._getCanvasPosition(),v.css(d,a.top+l.y+f.y-2).css(u,a.left+l.x+f.x-2),o=this,c=n.children[0],c&&(h=t.GC$(c),o._editingElement=h.getElement(0),h.bind(fi,function(i){var u=i.keyCode===229||i.keyCode===0;if(u||o._isImeInputing||o._updateEditorImp(n,r,f,i,e,!0),!o._processEditingWrap(i,e)){var h=c.selectionStart===0&&i.keyCode===37&&!i.ctrlKey&&!i.shiftKey&&!i.altKey,l=c.selectionStart===c.value.length&&i.keyCode===39&&!i.ctrlKey&&!i.shiftKey&&!i.altKey,a=c.selectionStart===c.selectionEnd;a&&(h||l)&&s._editorStatus===2&&t.util.cancelDefault(i)}}),h.bind(ei,function(t){(t.keyCode===46||t.keyCode===8||(t.keyCode===90||t.keyCode===89)&&t.ctrlKey&&!t.altKey)&&o._updateEditorImp(n,r,f,t,e);(t.keyCode!==13&&t.keyCode!==9||t.ctrlKey||t.altKey)&&s.triggerEditChange({sheet:s,sheetName:s._name,row:s._activeRowIndex,col:s._activeColIndex,editingText:o.getEditorValue(n,e)})}),h.bind(oi,function(t){o._pasteInputSizingToken=window.setTimeout(function(){o._updateEditorImp(n,r,f,t,e);o._pasteInputSizingToken&&(window.clearTimeout(o._pasteInputSizingToken),delete o._pasteInputSizingToken)},10)}),h.bind(si,function(n){s._editorStatus===1&&(s._editorStatus=2,s.triggerEditorStatusChanged({sheet:s,sheetName:s._name,oldStatus:1,newStatus:2}))}),h.bind(hi,function(n){o._isImeInputing=!0;o._oldValueBeforeImeInputting=h.val()}),h.bind(ci,function(t){o._updateEditorImp(n,r,f,t?t:i,e,!0)}),h.bind(li,function(t){o._updateEditorImp(n,r,f,t?t:i,e);o._isImeInputing=!1})))},b.prototype.deactivateEditor=function(n,r){var u,f,e;n&&(u=n.children[0],u&&t.GC$(u).unbind(h),f=n._editingLocator,f&&(e=r&&r.sheet&&r.sheet._getHost(),e&&e.removeChild(f)));this._editingElement=i},b.prototype.getEditingElement=function(){return this._editingElement},b.prototype.selectAll=function(n,t){var i=n&&n.children[0];i&&i.select&&i.select()},b.prototype._updateEditorImp=function(n,r,h,p,w,b){var k=n&&n.children[0],rt=w&&w.sheet,et,dt,ri,ct,yt,ui,fi,st,lt,ei,ci,ut,gt,hi;if(k&&rt){var ni=this,d=t.GC$(k),ti=rt._render;if(rt.isEditing()){var g=i,oi=u,tt=i;if(r&&(g=t.util.getHAlignByValueType(r.hAlign,n._originalValue),g===1?oi=y:g===2&&(oi=v),d.css(pt,oi),r.backColor&&d.css(kt,r.backColor),r.foreColor&&d.css(bt,r.foreColor),tt=r.font||ti._getDefaultFont(),tt&&(rt._zoomFactor>1&&(tt=ti._getZoomFont(tt)),d.css(ft,tt)),r.textDecoration&&ni._setEditStatusTextDecoration(d,r.textDecoration)),h){t.GC$(n).width(h.width).height(h.height);var at=rt._getSheetLayout(),vt=1,ii=1;vt=vt+parseInt(d.css(ai),10)+parseInt(d.css(vi),10);ii=ii+parseInt(d.css(yi),10)+parseInt(d.css(pi),10);ut=h.width;h.x+h.width>at.width&&(ut=at.width-h.x);d.css(l,ut-vt).css(e,h.height-ii);g===s||g===i||g===0?k.maxWidth=at.width-h.x-vt:g===1?k.maxWidth=ht(0,it(at.width-h.x-h.width-vt,h.x-at.rowHeaderWidth-vt))*2+h.width:g===2&&(k.maxWidth=h.x+h.width-at.rowHeaderWidth-vt);k.maxHeight=at.height-h.y-ii;k.minWidth=parseInt(k.style.width,10);k.minHeight=parseInt(k.style.height,10)}try{b=b&&p&&p.keyCode&&rt._eventHandler.allowEnterEditing(p)&&k.selectionStart===0&&k.selectionEnd===k.value.length;b=b||(w&&w.sheet&&w.sheet._startEditByKeydown?!0:!1)}catch(bi){}if(et=b?"":k.value,tt=k.style.font,tt||(tt=ti._getZoomFont(ti._getDefaultFont())),dt=rt._getFontHeight(tt),!b&&p){if(rt._eventHandler.allowEnterEditing(p)){var si=k.selectionStart,li=et.substr(0,si),wi=et.substr(si,et.length-si);et=li+String.fromCharCode(p.keyCode)+wi}ni._isImeInputing&&(et=t.util.browser.msie?d.val():ni._oldValueBeforeImeInputting+p.data)}if(ri=[],ri=r&&r.wordWrap?t._WordWrapHelper._getWrapInfo(et,d.width(),tt):et.split(/\r\n|\r|\n/),fi=ri.length,k.minWidth=it(k.minWidth,k.maxWidth),k.minHeight=it(k.minHeight,k.maxHeight),r&&r.wordWrap||fi>0){if(st=fi*dt,r&&r.wordWrap)d.css(c,ot).css(o,f);else{for(lt=0,ei=[],ct=0;ct<fi;ct++)ci=ri[ct],yt=rt._getStringWidth(ci,tt),ei.push(yt),lt=ht(lt,yt);if(lt<=k.minWidth)d.css(l,k.minWidth).css(c,nt).css(o,f);else if(lt>k.minWidth&&lt<=k.maxWidth)d.css(l,lt).css(c,nt).css(o,f);else if(lt>k.maxWidth)for(d.css(l,k.maxWidth).css(c,ot).css(o,f),st=0,ct=0;ct<ei.length;ct++)yt=ei[ct],yt<=k.maxWidth?st+=dt:yt>k.maxWidth&&(ui=a(yt/k.maxWidth),st+=dt*ui)}st<=k.minHeight?d.css(e,k.minHeight):st>k.minHeight&&st<=k.maxHeight?d.css(e,st):st>k.maxHeight&&d.css(e,k.maxHeight).css(wt,"scroll")}else ut=rt._getStringWidth(et,tt),ut>k.minWidth&&ut<=k.maxWidth?d.css(l,ut).css(e,k.minHeight).css(c,nt).css(o,f):ut<=k.minWidth?d.css(l,k.minWidth).css(e,k.minHeight).css(c,nt).css(o,f):ut>k.maxWidth&&(d.css(l,k.maxWidth).css(c,ot),ui=a(ut/k.maxWidth),gt=dt*ui,gt<=k.minHeight?d.css(e,k.minHeight).css(o,f):gt<=k.maxHeight?d.css(e,gt).css(o,f):gt>k.maxHeight&&d.css(e,k.maxHeight).css(wt,"scroll"));g=d.css(pt);hi=d.width()-k.minWidth;g!==s&&g!==i&&g!==u&&(g===y?d.css(u,k.originalLeft-hi/2):g===v&&d.css(u,k.originalLeft-hi));ni._updateEditorLocator(n,w)}}},b.prototype.updateEditor=function(n,r,f,e){var o=e&&e.sheet,s,h,c,l;o&&f&&(s=e.canvasOffset?e.canvasOffset:o._eventHandler._getCanvasPosition(),h=o.getBounds(),t.GC$(n).css(d,s.top+h.y+f.y-2).css(u,s.left+h.x+f.x-2));this._updateEditorImp(n,r,f,i,e);t.util.browser.msie&&n&&(c=t.GC$(n.children[0]),l=c.width(),c.width(l+1).width(l))},b.prototype.updateImeMode=function(n,i,r){if(this.isImeAware()){var u=n&&n.children[0];u&&t.GC$(u).css(st,this._getImeModeString(i))}},b.prototype.isReservedKey=function(n,t){var i=n.srcElement||n.target;return i&&t&&t.isEditing&&i.getAttribute(g)==="gcEditingInput"?n.keyCode===13&&(n.ctrlKey&&!n.shiftKey||n.altKey)||n.keyCode===90&&n.ctrlKey&&!n.altKey||n.keyCode===89&&n.ctrlKey&&!n.altKey:!1},b.prototype._processEditingWrap=function(r,u){var f=r.srcElement||r.target,e,c,h;if(f&&f.getAttribute(g)==="gcEditingInput"&&r.keyCode===13&&(r.ctrlKey||r.altKey)){var o=f.selectionStart,s=f.value,l=s.substr(0,o),a=s.substr(o,s.length-o);return f.value=l+"\n"+a,f.selectionStart=o+1,f.selectionEnd=o+1,e=t.FocusHelper.getActiveElement(),c=n.Sheets,e instanceof c.Sheet&&(h=e.getCellType(e._activeRowIndex,e._activeColIndex),h&&h.updateEditor(e._editor,i,i,u)),t.util.cancelDefault(r),!0}return!1},b.prototype.getAutoFitWidth=function(n,t,i,u,f){return r.getAutoFitWidth(n,t,i,u,f)},b.prototype.getAutoFitHeight=function(n,t,i,u,f){return r.getAutoFitHeight(n,t,i,u,f)},b.prototype.isImeAware=function(n){return!0},b}(k);t.TextCellType=dt;rt=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.prototype._paint=function(n,i,r,u,f,e,o,h,c,l){var a,v,y;n&&(a=this,v=0,h.visualState!==s&&(v=h.visualState),y=a.getThemeStyle(h.visualState,"gc-"+c+"-"+t.VisualState[v].toLowerCase()),a._paintBackground(n,r,u,f,e,o,h,v,y),a._paintText(n,i,r,u,f,e,o,h,l,y),a._paintGridline(n,r,u,f,e,o,c,y,l))},i.prototype._paintBackground=function(n,i,u,f,e,o,s,h,c){var a,w,l,k,y,nt,d,g,v;if(typeof h!==b){if(n.save(),n.beginPath(),h===0&&o.backColor)a=o.backColor,n.fillStyle!==a&&(n.fillStyle=a),n.fillRect(i+1,u+1,f-1,e-1);else try{if(w=c&&c.backgroundColor,l=c&&c.backgroundImage,l&&l.indexOf("linear-gradient")!==-1){for(k=t.util.getLinearGradientColors(l),a=n.createLinearGradient(i+f/2,u,i+f/2,u+e),y=0,nt=k.length;y<nt;y++)d=k[y],a.addColorStop(d.point,d.color);n.fillStyle=a;n.fillRect(i+1,u+1,f-1,e-1)}else w?(n.fillStyle=w,n.fillRect(i+1,u+1,f-1,e-1)):l&&l!==p&&(g=new Image,v=l,v=v.replace('url("',""),v=v.replace('")',""),g.src=v,n.drawImage(g,i+1,u+1,f-1,e-1))}catch(tt){}r.paintBackgroundImage(n,i,u,f,e,o.backgroundImage,o.backgroundImageLayout,s.imageLoader);n.restore()}},i.prototype._paintText=function(n,i,r,f,e,o,s,h,c,l){var yt=this,et=yt.format(i,s.formatter),a,gt,ni,w,d,ti,g,wt,ct,lt,ut,at,ft,ui,dt;if(et){a={x:r,y:f,width:e,height:o};n.save();n.beginPath();var k=h.sheet,pt=k.rowFilter(),fi=!!(pt&&pt.isFilterHeader(h.row,h.col,c)&&pt.filterButtonVisible(h.col));fi&&(gt=it(k._zoomFactor,1),ni=tt(k.defaults.rowHeight*gt),e-=ni);w=s.foreColor;w||(w=l.color);w&&n.fillStyle!==w&&(n.fillStyle=w);d=s.font;d&&n.font!==d&&(n.font=d);h.visualState!==0&&parseInt(l.zIndex)>2007&&k._isSelected(h.row,h.col,c)&&(ti=k._isAllSelected(h.row,h.col,c)?this.getThemeStyle(h.visualState,"gc-columnHeader-selected"):this.getThemeStyle(h.visualState,"gc-columnHeader-highlight"),n.fillStyle=ti.color,n.font=t.StyleHelper.setStringFont(n.font,{fontWeight:"bold"}));g=0;wt=s.textIndent;wt>0&&(g=wt*8);var ii=s.hAlign,bt=s.vAlign,ot=u,p=2;p+=g;ii===1?(p=e/2,ot=y):ii===2&&(p=e-1,p-=g,ot=v);n.textAlign!==ot&&(n.textAlign=ot);var kt=0,ri=vt,b=2,ei=s.wordWrap,nt=h.lineHeight,rt=h.fontInfo.fontSize,st=[],ht=0;if(ei&&(st=t._WordWrapHelper._getWrapInfo(et,e-3-g,d),ht=st.length,ht>1&&bt!==0&&(kt=(ht-1)*nt)),ct=rt>8?tt((rt-8)/5+2):1,lt=nt/2-rt/2+ct-1,b+=nt-lt,bt===1?b=(o-kt)/2+nt/2-lt:bt===2&&(b=o-kt-2-lt),n.textBaseline!==ri&&(n.textBaseline=ri),ut=s.textDecoration,s.wordWrap)for(n.rect(a.x,a.y,a.width,a.height),n.clip(),n.beginPath(),at=f+b,ft=0;ft<ht;ft++)n.fillText(st[ft],r+p,at),ut&&(ui=n.measureText(st[ft]).width,yt._renderTextDecoration(n,ut,r+p,at,ui,rt,ct)),at+=h.lineHeight;else dt=n.measureText(et).width,(dt>a.width||nt>a.height)&&(n.rect(a.x,a.y,a.width,a.height),n.clip(),n.beginPath()),n.fillText(et,r+p,f+b),ut&&yt._renderTextDecoration(n,ut,r+p,f+b,dt,rt,ct);n.restore()}},i.prototype._paintGridline=function(n,t,i,r,u,f,e,o,s){var h;s===1?(n.beginPath(),h=n.createLinearGradient(t,i+1,t,i+u-2),h.addColorStop(0,o.borderLeftColor),h.addColorStop(1,o.borderRightColor),n.strokeStyle=h,f.borderLeft||(n.moveTo(t+.5,i),n.lineTo(t+.5,i+u)),f.borderRight||(n.moveTo(t+r-.5,i),n.lineTo(t+r-.5,i+u)),n.stroke(),o.borderBottomWidth&&!f.borderBottom&&(n.beginPath(),n.strokeStyle=o.borderBottomColor,n.moveTo(t+1,i+u-.5),n.lineTo(t+r,i+u-.5),n.stroke())):(n.beginPath(),h=n.createLinearGradient(t,i,t+r-2,i),h.addColorStop(0,o.borderTopColor),h.addColorStop(1,o.borderBottomColor),n.strokeStyle=h,f.borderTop||(n.moveTo(t,i+.5),n.lineTo(t+r,i+.5)),f.borderBottom||(n.moveTo(t,i+u-.5),n.lineTo(t+r,i+u-.5)),n.stroke(),o.borderRightWidth&&!f.borderRight&&(n.beginPath(),n.strokeStyle=o.borderRightColor,n.moveTo(t+r-.5,i+1),n.lineTo(t+r-.5,i+u),n.stroke()))},i.prototype.getAutoFitWidth=function(n,t,i,u,f){return r.getAutoFitWidth(n,t,i,u,f)},i.prototype.getAutoFitHeight=function(n,t,i,u,f){return r.getAutoFitHeight(n,t,i,u,f)},i}(k);t.HeaderCellType=rt;gt=function(n){function t(){n.call(this);this.typeName="2"}return __extends(t,n),t.prototype.paint=function(t,i,r,u,f,e,o,s){n.prototype._paint.call(this,t,i,r,u,f,e,o,s,"columnHeader",1)},t}(rt);t.ColumnHeaderCellType=gt;ni=function(n){function t(){n.call(this);this.typeName="3"}return __extends(t,n),t.prototype.paint=function(t,i,r,u,f,e,o,s){n.prototype._paint.call(this,t,i,r,u,f,e,o,s,"rowHeader",2)},t}(rt);t.RowHeaderCellType=ni;ti=function(n){function i(){n.call(this);this.typeName="4"}return __extends(i,n),i.prototype.paint=function(n,i,r,u,f,e,o,h){var y,it,v,rt,d,ot,ut,g,nt,l,tt;if(n){if(n.save(),n.rect(r,u,f,e),n.clip(),n.beginPath(),y=0,h.visualState!==s&&(y=h.visualState),typeof y!==b){try{var k=this.getThemeStyle(h.visualState,"gc-corner-"+t.VisualState[y].toLowerCase()),ft=k&&k.backgroundColor,a=k&&k.backgroundImage;ft?(n.fillStyle=ft,n.fillRect(r,u,f,e)):a&&a!==p&&(it=new Image,v=a,v=v.replace('url("',""),v=v.replace('")',""),it.src=v,n.drawImage(it,r,u,f,e))}catch(st){}var c=this.getThemeStyle(4,"gc-corner-triangle-"+t.VisualState[y].toLowerCase()),a=c&&c.backgroundImage,et=c&&c.backgroundColor,w=n.createLinearGradient(r+f/2,u,r+f/2,u+e);if(a&&a.indexOf("linear-gradient")!==-1){for(rt=t.util.getLinearGradientColors(a),d=0,ot=rt.length;d<ot;d++)ut=rt[d],w.addColorStop(ut.point,ut.color);n.fillStyle=w}else et&&(w.addColorStop(.125,ui),w.addColorStop(1,et),n.fillStyle=w);g=n.createLinearGradient(r+f,u+1,r+f,u+e-2);g.addColorStop(0,c.borderLeftColor);g.addColorStop(1,c.borderRightColor);n.beginPath();n.strokeStyle=g;n.moveTo(r+f-.5,u);n.lineTo(r+f-.5,u+e);n.stroke();nt=n.createLinearGradient(r,u,r+f-2,u);nt.addColorStop(0,c.borderTopColor);nt.addColorStop(1,c.borderBottomColor);n.beginPath();n.strokeStyle=nt;n.moveTo(r,u+e-.5);n.lineTo(r+f,u+e-.5);n.stroke();n.beginPath();l=3;tt=e;f<e&&(tt=f);n.moveTo(r+f-tt+l,u+e-l);n.lineTo(r+f-l,u+e-l);n.lineTo(r+f-l,u+e-tt+l);n.fill()}n.restore()}},i.prototype.getAutoFitWidth=function(n,t,i,u,f){return r.getAutoFitWidth(n,t,i,u,f)},i.prototype.getAutoFitHeight=function(n,t,i,u,f){return r.getAutoFitHeight(n,t,i,u,f)},i}(k);t.CornerCellType=ti})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(n){var f,o,s,h,c,l,a,r,v,u;n.feature("core.sheet_model",["core.common","core.stringResource"]);var t=null,i=undefined,e=Math.min,p=Math.floor,y=function(){function t(n,t){this._sheet=n;this._dataModel=new r;this._dataModel.name=this._name=t;this._rowHeaderModel=new r(this._dataModel.rowCount,1);this._colHeaderModel=new r(1,this._dataModel.colCount);this._colFooterModel=new r(1,this._dataModel.colCount,this._name+"cf");this._rowInfos=new u;this._colInfos=new u;this._colHeaderRowInfos=new u;this._rowHeaderColInfos=new u;this._spanModel=new f;this._colHeaderSpanModel=new f;this._rowHeaderSpanModel=new f}return t.prototype.name=function(n){if(n)this._name=n,this._dataModel.name=name;else return this._name},t.prototype.dataModel=function(){return this._dataModel},t.prototype.rowHeaderModel=function(){return this._rowHeaderModel},t.prototype.colHeaderModel=function(){return this._colHeaderModel},t.prototype.colFooterModel=function(){return this._colFooterModel},t.prototype.getDataModel=function(t){var r=n.SheetArea;if(t===3||t===i||t===null)return this._dataModel;else if(t===2)return this._rowHeaderModel;else if(t===1)return this._colHeaderModel;return null},t.prototype.getRowInfos=function(n){return n===1||n===0?this._colHeaderRowInfos:this._rowInfos},t.prototype.getColInfos=function(n){return n===2||n===0?this._rowHeaderColInfos:this._colInfos},t.prototype.getSpanModel=function(n){if(n===undefined||n===null||n===3)return this._spanModel;else if(n===1)return this._colHeaderSpanModel;else if(n===2)return this._rowHeaderSpanModel},t}();n.SheetModelManager=y;f=function(r){function u(){r.call(this);this._lastNonNullColumn=-1;this._lastNonNullRow=-1}return __extends(u,r),u.prototype.find=function(n,i){for(var f=this.length,r,u=0;u<f;u++)if(r=this[u],r&&r.contains(n,i))return r;return t},u.prototype.remove=function(n){for(var t=0;t<this.length;t++)if(this[t]===n){this.splice(t,1);return}},u.prototype._setLastNonNullRowAndColumn=function(n){var t=this,i=n.row+n.rowCount-1,r=n.col+n.colCount-1;i>t._lastNonNullRow&&(t._lastNonNullRow=i);r>t._lastNonNullColumn&&(t._lastNonNullColumn=r)},u.prototype.addSpan=function(n){this._setLastNonNullRowAndColumn(n);this.push(n)},u.prototype.removeSpan=function(n,t){this.splice(n,t)},u.prototype.copy=function(t,i,r,u,f,e){var h=this,a=!1,v=h.length,o,l,s,c;if(t===-1){for(c=[],s=0;s<v;s++)o=h[s],i<=o.col&&o.col<i+e?(c.push(new n.Range(o.row,u+o.col-i,o.rowCount,o.colCount)),a=!0):u<=o.col&&o.col<u+e&&(h.splice(s,1),s--,v--,a=!0);for(s=0;s<c.length;s++){if(l=c[s],!h.isValid(h,0,h.length,l))throw new Error(n.SR.Exp_OverlappingSpans);h.addSpan(l)}}else if(i===-1){for(c=[],s=0;s<v;s++)o=h[s],t<=o.row&&o.row<t+f?(c.push(new n.Range(r+o.row-t,o.col,o.rowCount,o.colCount)),a=!0):r<=o.row&&o.row<r+f&&(h.splice(s,1),s--,v--,a=!0);for(s=0;s<c.length;s++){if(l=c[s],!h.isValid(h,0,h.length,l))throw new Error(n.SR.Exp_OverlappingSpans);h.addSpan(l)}}else{for(c=[],s=0;s<v;s++)o=h[s],t<=o.row&&o.row<t+f&&i<=o.col&&o.col<i+e?(c.push(new n.Range(r+o.row-t,u+o.col-i,o.rowCount,o.colCount)),a=!0):r<=o.row&&o.row<r+f&&u<=o.col&&o.col<u+e&&(h.splice(s,1),s--,v--,a=!0);for(s=0;s<c.length;s++){if(l=c[s],!h.isValid(h,0,h.length,l))throw new Error(n.SR.Exp_OverlappingSpans);h.addSpan(l)}}},u.prototype.isValid=function(n,t,i,r){for(var f,u=t;u<i&&u<n.length;u++)if(f=n[u],f.intersect(r.row,r.col,r.rowCount,r.colCount))return!1;return!0},u.prototype.getEnumerator=function(n,t,i,r){return new o(this,n,t,i,r)},u.prototype.getSpans=function(n){var i,t,r;if(!n)return this.slice(0);for(i=[],t=0;t<this.length;t++)r=this[t],(!n||r.intersect(n.row,n.col,n.rowCount,n.colCount))&&i.push(r);return i},u.prototype.hasPartSpans=function(n,t,i,r){for(var u,f=0;f<this.length;f++)if(u=this[f],u.intersect(n,t,i,r)&&(u.row<n||u.row+u.rowCount>n+i||u.col<t||u.col+u.colCount>t+r))return!0;return!1},u.prototype.hasSpans=function(n,t,i,r){var u=this.getEnumerator(n,t,i,r);return u.moveNext()},u.prototype.clear=function(n,t,i,r){for(var f,u=0;u<this.length;u++)f=this[u],(n===-1||n<=f.row&&f.row<n+i)&&(t===-1||t<=f.col&&f.col<t+r)&&this.splice(u--,1)},u.prototype.move=function(t,i,r,f,e,o){var a=this,v=!1,l=new u,y=[],p=a.length,s,h,c;if(t===-1)for(h=0;h<p;h++)s=a[h],i<=s.col&&s.col<i+o?(c=new n.Range(s.row,f+s.col-i,s.rowCount,s.colCount),y.push(c),v=!0):f<s.col&&s.col<f+o?v=!0:l.push(s);else if(i===-1)for(h=0;h<p;h++)s=a[h],t<=s.row&&s.row<t+e?(c=new n.Range(r+s.row-t,s.col,s.rowCount,s.colCount),y.push(c),v=!0):r<=s.row&&s.row<r+e?v=!0:l.push(s);else for(h=0;h<p;h++)s=a[h],t<=s.row&&s.row<t+e&&i<=s.col&&s.col<i+o?(c=new n.Range(r+s.row-t,f+s.col-i,s.rowCount,s.colCount),y.push(c),v=!0):r<=s.row&&s.row<r+e&&f<=s.col&&s.col<f+o?v=!0:l.push(s);if(v){if(y.length>0)for(h=0;h<y.length;h++){if(c=y[h],!a.isValid(l,0,l.length,c))throw new Error(n.SR.Exp_OverlappingSpans);l.push(c)}for(a.length=0,h=0;h<l.length;h++)a.addSpan(l[h])}},u.prototype.isEmpty=function(){return this.length<=0?!0:!1},u.prototype.addRows=function(t,i){for(var r,u=this,e=!1,o=u.length,f=0;f<o;f++)r=u[f],r.row>=t?(u[f]=new n.Range(r.row+i,r.col,r.rowCount,r.colCount),u._setLastNonNullRowAndColumn(u[f]),e=!0):r.row<t&&t<r.row+r.rowCount&&(u[f]=new n.Range(r.row,r.col,r.rowCount+i,r.colCount),u._setLastNonNullRowAndColumn(u[f]),e=!0)},u.prototype.addColumns=function(t,i){for(var r,u=this,e=!1,o=u.length,f=0;f<o;f++)r=u[f],r.col>=t?(u[f]=new n.Range(r.row,r.col+i,r.rowCount,r.colCount),u._setLastNonNullRowAndColumn(u[f]),e=!0):r.col<t&&t<r.col+r.colCount&&(u[f]=new n.Range(r.row,r.col,r.rowCount,r.colCount+i),u._setLastNonNullRowAndColumn(u[f]),e=!0)},u.prototype.removeRows=function(t,i){for(var f=this,s=!1,o=[],c=f.length,r,h,u=0;u<c;u++)r=f[u],r.row>=t?r.row<t+i?(o.push(u),s=!0):(f[u]=new n.Range(r.row-i,r.col,r.rowCount,r.colCount),s=!0):r.row<t&&t<r.row+r.rowCount&&(f[u]=new n.Range(r.row,r.col,r.rowCount-e(r.row+r.rowCount-t,i),r.colCount),f[u].rowCount===1&&f[u].colCount===1&&o.push(u),s=!0);for(u=o.length-1;u>=0;u--)h=o[u],f.splice(h,1)},u.prototype.removeColumns=function(t,i){for(var f=this,s=!1,o=[],c=f.length,r,h,u=0;u<c;u++)r=f[u],r.col>=t?r.col<t+i?(o.push(u),s=!0):(f[u]=new n.Range(r.row,r.col-i,r.rowCount,r.colCount),s=!0):r.col<t&&t<r.col+r.colCount&&(f[u]=new n.Range(r.row,r.col,r.rowCount,r.colCount-e(r.col+r.colCount-t,i)),f[u].rowCount===1&&f[u].colCount===1&&o.push(u),s=!0);for(u=o.length-1;u>=0;u--)h=o[u],f.splice(h,1)},u.prototype.toJSON=function(){for(var n=[],t=0;t<this.length;t++)n.push(this[t]);return n.length===0?i:n},u.prototype.fromJSON=function(t,i){var f,u,r;if(t)for(f=t,u=0;u<f.length;u++)r=f[u],this.addSpan(new n.Range(r.row,r.col,r.rowCount,r.colCount))},u}(n._XArray);n._SpanModel=f;o=function(){function n(n,t,i,r,u){var f=this;f.model=n;f.row=t;f.column=i;f.rowCount=r;f.columnCount=u;f.currentIndex=-1;t===-1&&i===-1&&(f.all=!0)}return n.prototype.current=function(){var n=this;return 0<=n.currentIndex&&n.currentIndex<n.model.length?n.model[n.currentIndex]:t},n.prototype.moveNext=function(){var n=this;if(n.currentIndex++,!n.all)while(n.currentIndex<n.model.length&&!n.model[n.currentIndex].intersect(n.row,n.column,n.rowCount,n.columnCount))n.currentIndex++;return n.currentIndex<n.model.length},n.prototype.reset=function(){this.currentIndex=-1},n}();n._SpanEnumerator=o;s=function(n){function i(){n.call(this);this.headingOverflowlayout=t;this.trailingOverflowLayout=t}return __extends(i,n),i.prototype.find=function(n){var u=this,f=u.length,r,i;if(f>0)for(i=0;i<f;i++)if(r=u[i],r.contains(n))return r;return t},i}(n._XArray);n._CellOverflowLayoutModel=s;h=function(){function n(n,t,i,r,u,f,e,o){var s=this;s.column=n;s.startColumn=t;s.endColumn=i;s.valueWidth=r;s.columnWidth=u;s.backgroundWidth=f;s.backgroundLeftWidth=e;s.backgroundRightWidth=o}return n.prototype.contains=function(n){return n>=this.startColumn&&n<=this.endColumn},n}();n._CellOverflowLayout=h;c=function(r){function u(){r.call(this);this.selectionPolicy=2;this.selectionUnit=0}return __extends(u,r),u.prototype.find=function(n,i){var f=this,e=f.length,u,r;if(e>0)for(r=0;r<e;r++)if(u=f[r],u.contains(n,i))return u;return t},u.prototype.clear=function(){this.splice(0,this.length);this.activeSelectedRangeIndex=-1},u.prototype.add=function(t,i,r,u){var f=this,o;f.selectionPolicy===0?(r=e(r,1),u=e(u,1),f.clear()):f.selectionPolicy===1&&f.clear();f.selectionUnit===1?(i=-1,u=-1):f.selectionUnit===2&&(t=-1,r=-1);o=new n.Range(t,i,r,u);f.push(o);f.activeSelectedRangeIndex=f.length-1},u.prototype.toArray=function(){for(var t=[],n=0;n<this.length;n++)t.push(this[n]);return t},u.prototype.fromArray=function(n){this.splice(0,this.length);for(var t=0;t<n.length;t++)this.push(n[t])},u.prototype._isDefaultValue=function(n,t){var i=this;switch(n){case"selectionPolicy":return t===2;case"selectionUnit":return t===0;case"activeSelectedRangeIndex":return t===0;case"length":return t===1;default:return!1}},u.prototype.toJSON=function(){var t=this,u={};for(var r in t)!t._isDefaultValue(r,t[r])&&t.hasOwnProperty(r)&&(u[r]=t[r]);return n.GC$.isEmptyObject(u)?i:u},u.prototype.fromJSON=function(t,r){var e,u,o;if(t){var f=this,h=t,s=t.length;for(s===i&&(s=1),e=0;e<s;e++)u=h[e],u===i&&(u={row:0,col:0,rowCount:1,colCount:1}),f.push(new n.Range(u.row,u.col,u.rowCount,u.colCount));o=t.activeSelectedRangeIndex;o===i&&(o=0);f.activeSelectedRangeIndex=o;t.selectionPolicy!==i&&(f.selectionPolicy=t.selectionPolicy);t.selectionUnit!==i&&(f.selectionUnit=t.selectionUnit)}},u}(n._XArray);n._SelectionModel=c;l=function(n){function i(){n.call(this)}return __extends(i,n),i.prototype.findCell=function(n,i){var f=this,e=f.length,u,r;if(e>0)for(r=0;r<e;r++)if(u=f[r],u.contains(n,i))return u;return t},i.prototype.findRow=function(n){var u=this,f=u.length,r,i;if(f>0)for(i=0;i<f;i++)if(r=u[i],r.row===n)return r;return t},i.prototype.findCol=function(n){var u=this,f=u.length,r,i;if(f>0)for(i=0;i<f;i++)if(r=u[i],r.col===n)return r;return t},i.prototype.findX=function(n){var u=this,f=u.length,r,i;if(f>0)for(i=0;i<f;i++)if(r=u[i],r.containsX(n))return r;return t},i.prototype.findY=function(n){var u=this,f=u.length,r,i;if(f>0)for(i=0;i<f;i++)if(r=u[i],r.containsY(n))return r;return t},i.prototype.findNearX=function(n){var r=t,i=this,u=i.length;return u>0&&(r=i.findX(n),r||(r=n<i[0].x?i[0]:i[u-1])),r},i.prototype.findNearY=function(n){var r=t,i=this,u=i.length;return u>0&&(r=i.findY(n),r||(r=n<i[0].y?i[0]:i[u-1])),r},i}(n._XArray);n._LayoutModel=l;a=function(){function n(n,t,i,r,u,f,e,o){var s=this;s.rowCount=e;s.colCount=o;s.row=n;s.col=t;s.x=i;s.y=r;s.width=u;s.height=f}return n.prototype.contains=function(n,t){var i=this;return n<i.row+i.rowCount&&i.row<=n&&t<i.col+i.colCount&&i.col<=t},n.prototype.intersect=function(n){var t=this;return(t.x<0||n.x<t.x+t.width&&t.x<n.x+n.width)&&(t.y<0||n.y<t.y+t.height&&t.y<n.y+n.height)},n.prototype.containsX=function(n){return this.x<=n&&n<this.x+this.width},n.prototype.containsY=function(n){return this.y<=n&&n<this.y+this.height},n}();n._Layout=a;r=function(){function r(n,r,u){this._isSuspendDirty=!1;var f=this;f.rowCount=n!==t&&n!==i?n:200;f.colCount=r!==t&&r!==i?r:20;f.name=u;f.dataTable={};f._rowDataArray=[];f._columnDataArray=[];f._defaultDataNode=t;f.dirtyNodes={};f._lastNonNullColumn=-1;f._lastNonNullRow=-1}return r.prototype.getRowCount=function(){return this.rowCount},r.prototype.getColumnCount=function(){return this.colCount},r.prototype.setRowCount=function(n){this.rowCount=n},r.prototype.setColumnCount=function(n){this.colCount=n},r.prototype._updateDirty=function(n,t,r){if(!this._isSuspendDirty&&n>=0&&t>=0){this.dirtyNodes[n]||(this.dirtyNodes[n]={});var u=this.dirtyNodes[n];u.rs!=="n"&&(u.rs="e");r.originalItem!==i&&(u.originalItem=r.originalItem);u[t]||(u[t]={});r.oldValue!==i&&(u[t].oldValue=r.oldValue)}},r.prototype._suspendDirty=function(){this._isSuspendDirty=!0},r.prototype._resumeDirty=function(){this._isSuspendDirty=!1},r.prototype.getValue=function(n,r){var u=this.getNode(n,r);return u&&u.value!==i&&u.value!==t?u.value:t},r.prototype.setValue=function(n,t,i){var r=this.getNode(n,t,!0),u;r.value!==i&&(u=r.value,r.value=i,this._updateDirty(n,t,{oldValue:u}))},r.prototype.getBindingPath=function(n,r){var u=this.getNode(n,r);return u&&u.bindingPath!==i&&u.bindingPath!==t?u.bindingPath:t},r.prototype.setBindingPath=function(n,t,i){var r=this.getNode(n,t,!0);r.bindingPath!==i&&(r.bindingPath=i)},r.prototype.getSparkline=function(n,i){if(n<0||i<0)return t;var r=this.dataTable[n],u=r&&r[i];return u&&u.sparkline||t},r.prototype.setSparkline=function(n,t,i){var r=this.getNode(n,t,!0);r.sparkline!==i&&(r.sparkline=i)},r.prototype.getStyle=function(n,t){var i=this.getNode(n,t);return i&&i.style},r.prototype.setStyle=function(n,t,i){var r=this.getNode(n,t,!0);r&&r.style!==i&&(r.style=i)},r.prototype.getComment=function(n,t){var i=this.getNode(n,t);return i&&i.comment},r.prototype.setComment=function(n,t,i){var r=this.getNode(n,t,!0);r&&r.comment!==i&&(r.comment=i)},r.prototype.setTag=function(n,t,i){var r=this.getNode(n,t,!0);r&&r.tag!=i&&(r.tag=i)},r.prototype.getTag=function(n,r){var u=this.getNode(n,r);return u&&u.tag!==i&&u.tag!==t?u.tag:t},r.prototype.getVisualState=function(n,t){var i=this.getNode(n,t);return i&&i.visualState},r.prototype.setVisualState=function(n,t,i){var r=this.getNode(n,t,!0);r.visualState!==i&&(r.visualState=i)},r.prototype.addRows=function(t,i){var r=this,u;if(!(t<0)&&!(t>r.rowCount)&&!(i<0))for(n._ModelHelper.addElements(r.dataTable,r.rowCount,t,i),n._ModelHelper.addElements(r._rowDataArray,r.rowCount,t,i),n._ModelHelper.addElements(r.dirtyNodes,r.rowCount,t,i),this.rowCount+=i,u=0;u<i;u++)r.dataTable[t+u]={rs:"n"},r.dirtyNodes[t+u]=r.dataTable[t+u]},r.prototype.deleteRows=function(t,i){var u=this,r=u.rowCount;t<0||t>=r||i<=0||(t+i>r&&(i=r-t),n._ModelHelper.deleteElements(u.dataTable,r,t,i),n._ModelHelper.deleteElements(u._rowDataArray,r,t,i),n._ModelHelper.deleteElements(u.dirtyNodes,r,t,i),u.rowCount-=i)},r.prototype.addColumns=function(t,i){var r=this,u,f;if(!(t<0)&&!(t>r.colCount)&&!(i<0)){for(u=0;u<r.rowCount;u++)f=r.dataTable[u],f&&t<r.colCount&&n._ModelHelper.addElements(f,r.colCount,t,i);n._ModelHelper.addElements(this._columnDataArray,this.colCount,t,i);this.colCount+=i}},r.prototype.deleteColumns=function(t,i){var r=this,f=r.colCount,u,e;if(!(t<0)&&!(t>=f)&&!(i<0)){for(u=0;u<r.rowCount;u++)e=this.dataTable[u],e&&t<r.colCount&&n._ModelHelper.deleteElements(e,r.colCount,t,i);n._ModelHelper.deleteElements(this._columnDataArray,this.colCount,t,i);t+i>f&&(i=f-t);r.colCount-=i}},r.prototype.getNode=function(n,i,r){var u=this,f,e;return n>=u.rowCount||i>=u.colCount?t:(f=t,n>=0&&i>=0?(e=u.dataTable[n],r&&!e&&(e=u.dataTable[n]={},n>u._lastNonNullRow&&(u._lastNonNullRow=n)),e&&(f=e[i],r&&!f&&(f=e[i]={},i>u._lastNonNullColumn&&(u._lastNonNullColumn=i)))):n===-1&&i>=0?(f=u._columnDataArray[i],r&&!f&&(f=u._columnDataArray[i]={},i>u._lastNonNullColumn&&(u._lastNonNullColumn=i))):n>=0&&i===-1?(f=u._rowDataArray[n],r&&!f&&(f=u._rowDataArray[n]={},i>u._lastNonNullColumn&&(u._lastNonNullColumn=i))):n===-1&&i===-1&&(f=u._defaultDataNode,r&&!f&&(f=u._defaultDataNode={})),f)},r.prototype._setNode4Swap=function(n,t,i,r,u){var f=this,e;i>=0&&r>=0?(e=f.dataTable[i],e||(e=f.dataTable[i]={}),e[r]=u,u&&u.calc&&delete u.calc):i>=0&&r===-1&&n>=0&&t===-1?f._rowDataArray[i]=u:r>=0&&i===-1&&t>=0&&n===-1&&(f._columnDataArray[r]=u)},r.prototype.swapNode=function(n,i,r,u){var f=this,e=f.getNode(n,i),o=f.getNode(r,u);e?f._setNode4Swap(n,i,r,u,e):o&&f._setNode4Swap(n,i,r,u,t);o?f._setNode4Swap(r,u,n,i,o):e&&f._setNode4Swap(r,u,n,i,t)},r.prototype.getDataRowIndex=function(n){return n},r.prototype.nextNonNullRow=function(n){n++;for(var t=this.rowCount,i=this.dataTable;n>=0&&n<t;){if(i[n])break;n++}return n<t?n:-1},r.prototype.nextNonNullColumn=function(n,i){var r=this,u=t,f=r.colCount;if(n>=0&&n<r.rowCount&&(u=r.dataTable[n]),!u)return-1;for(i++;i>=0&&i<f;){if(u[i])break;i++}return i<f?i:-1},r.prototype.clear=function(i,r,u,f,e,o){var h=this,a=[],s,l,c;if(i>=0&&r>=0){if(i+u>h.rowCount&&(u=h.rowCount-i),u<=0)return;if(r+f>h.colCount&&(f=h.colCount-r),f<=0)return;for(c=i;c<i+u;c++)if(!o||!(n.ArrayHelper.indexOf(o,c)>=0))for(l=r;l<r+f;l++)s=h.getNode(c,l),s&&(a.push(s),(e&1)>0&&s.value&&s.value!==t&&h._updateDirty(c,l,{oldValue:s.value}))}else if(i>=0&&r===-1){if(i+u>h.rowCount&&(u=h.rowCount-i),u<=0)return;for(c=i;c<i+u;c++)s=h.getNode(c,-1),s&&a.push(s)}else if(i===-1&&r>=0){if(r+f>h.colCount&&(f=h.colCount-r),f<=0)return;for(l=r;l<r+f;l++)s=h.getNode(-1,l),s&&a.push(s)}else i===-1&&r===-1&&(s=h._defaultDataNode,s&&a.push(s));h.clearCore(a,e)},r.prototype.clearCore=function(n,i){for(var r=0;r<n.length;r++)n[r]&&((i&8)>0&&(n[r].tag=t),(i&2)>0&&(n[r].style=t),(i&1)>0&&(n[r].value=t),(i&16)>0&&(n[r].sparkline=t),(i&64)>0&&(n[r].bindingPath=t),(i&4)>0&&(n[r].comment=t))},r.prototype.toJSON=function(t){for(var i=this,f={},l={},r=i.nextNonNullRow(-1),e,a,v,o,s,y,h,c,u,p,w;r>=0;){for(e={},u=i.nextNonNullColumn(r,-1);u>=0;)a=i.getNode(r,u),a&&(v=i._toJSONNode(a),n.GC$.isEmptyObject(v)||(e[u]=v)),u=i.nextNonNullColumn(r,u);n.GC$.isEmptyObject(e)||(l[r]=e);r=i.nextNonNullRow(r)}for(n.GC$.isEmptyObject(l)||(f.dataTable=l),o=[],s=i._rowDataArray,r=0;r<i.rowCount;r++)s.hasOwnProperty(r)&&s[r]&&(y=i._toJSONNode(s[r]),n.GC$.isEmptyObject(y)||(o[r]=y));for(o.length>0&&(f.rowDataArray=o),h=[],c=i._columnDataArray,u=0;u<i.colCount;u++)c.hasOwnProperty(u)&&c[u]&&(p=i._toJSONNode(c[u]),n.GC$.isEmptyObject(p)||(h[u]=p));return h.length>0&&(f.columnDataArray=h),w=i._toJSONNode(i._defaultDataNode,t,!0),n.GC$.isEmptyObject(w)||(f.defaultDataNode=w),f},r.prototype.fromJSON=function(n,t){var e,r,h,c,l,v,y,o,u,s,f,a;if(n){if(e=this,r=n,this._suspendDirty(),r.name!==i&&(e.name=r.name),h=r.dataTable,h)for(v=e.rowCount,y=e.colCount,u=0;u<v;u++)if(c=h[u],c)for(f=0;f<y;f++)(l=c[f],l)&&e._copyFromJSONNode(u,f,l,t);if(o=r.rowDataArray?r.rowDataArray:r._rowDataArray,o)for(u=0;u<e.rowCount;u++)o.hasOwnProperty(u)&&o[u]&&e._copyFromJSONNode(u,-1,o[u],t);if(s=r.columnDataArray?r.columnDataArray:r._columnDataArray,s)for(f=0;f<e.colCount;f++)s.hasOwnProperty(f)&&s[f]&&e._copyFromJSONNode(-1,f,s[f],t);a=r.defaultDataNode?r.defaultDataNode:r._defaultDataNode;a&&e._copyFromJSONNode(-1,-1,a,t);this._resumeDirty()}},r.prototype._toJSONNode=function(r,u,f){var e,o,s;return r?(e={},r.value!==i&&r.value!==t&&(e.value=r.value),o=r.style,typeof o=="string"?e.style=o:o&&(s=o.toJSON(u,f),n.GC$.isEmptyObject(s)||(e.style=s,o.font&&(e.style.font=n.StyleHelper.normalizeFont(o.font)))),r.bindingPath!==i&&r.bindingPath!==t&&(e.bindingPath=r.bindingPath),r.tag!==t&&r.tag!==i&&(e.tag=r.tag),e):t},r.prototype._copyFromJSONNode=function(r,u,f,e){var c,h,o,l,a;if(f){var v=this,y=r,p=u,s=v.getNode(y,p,!0);f.value!==i&&(f.value!=t&&f.value._calcError&&(c=n.Calc.CalcError._parseCore(f.value._calcError),c!==i&&(f.value=c)),s.value=f.value);f.style!==i&&(h=t,typeof f.style=="string"?h=f.style:f.style&&(h=new n.Style,h.fromJSON(f.style,e)),s.style=h);f.visualState!==i&&(s.visualState=f.visualState);f.bindingPath!==i&&(s.bindingPath=f.bindingPath);o=f.tag;o!==i&&(l=o.typeName,typeof l=="string"&&(a=n.getTypeFromString(l),a&&(o=new a,o.fromJSON&&o.fromJSON(f.tag))),s.tag=o)}},r}();n._GcSheetModel=r;v=function(){function n(n,i,r){this.changed=t;var u=this;u._context=n;parseInt(i.toString(),10)<0&&(i=2147483647);u._maxLength=i;u._allowUndo=r;u._undoStack=[];u._redoStack=[]}return n.prototype.context=function(){return this._context},n.prototype.canUndo=function(){return this._undoStack.length>0},n.prototype.canRedo=function(){return this._redoStack.length>0},n.prototype._shrinkUndoStack=function(n){for(var t=0;t<n;t++)this._undoStack.shift()},n.prototype._raiseChanged=function(){var n=this;n.changed&&typeof n.changed=="function"&&n.changed(n)},n.prototype.doAction=function(n){var t,i;if(!n||!n.execute||(t=this,!n.canExecute(t._context)))return!1;i=!0;try{n.execute(t._context)}catch(r){i=!1}return t._allowUndo&&i&&n.canUndo()&&n.undo&&(t._maxLength>0&&t._undoStack.length>=t._maxLength&&t._shrinkUndoStack(t._undoStack.length-t._maxLength+1),t._undoStack.push(n),t._redoStack=[],t._raiseChanged()),i},n.prototype.undo=function(){var n=this,i=!0,t;if(n._allowUndo&&n.canUndo()){t=n._undoStack[n._undoStack.length-1];try{t&&t.canUndo&&t.canUndo()&&t.undo&&(i=t.undo(n._context))}catch(r){i=!1}i&&(n._redoStack.push(n._undoStack.pop()),n._raiseChanged())}return i},n.prototype.redo=function(){var n=this,i=!0,t;if(n._allowUndo&&n.canRedo()){t=n._redoStack[n._redoStack.length-1];try{t&&t.execute&&t.execute(n._context)}catch(r){i=!1}i&&(n._undoStack.push(n._redoStack.pop()),n._raiseChanged())}return i},n.prototype.getUndoList=function(){return this._undoStack.slice(0)},n.prototype.getRedoList=function(){return this._redoStack.slice(0)},n.prototype.clear=function(){this._undoStack=[];this._redoStack=[]},n}();n._UndoManager=v;u=function(){function r(){this._infos=[]}return r.prototype.addItems=function(t,i){t<0||t>this.length||i<0||(n._ModelHelper.addElements(this._infos,this.length,t,i),this.length+=i)},r.prototype.deleteItems=function(t,i){var r=this.length,u;t<0||t>=r||i<=0||(t+i>r&&(i=r-t),u=t,n._ModelHelper.deleteElements(this._infos,r,t,i),this.length-=i)},r.prototype.reset=function(n){this._infos.length>n&&(this._infos[n]=null)},r.prototype._getItems=function(){return this._infos},r.prototype._setItems=function(n){this._infos=n;this.length=n.length},r.prototype._getItem=function(n){return this._infos[n]},r.prototype._setItem=function(n,t){this._infos[n]=t;this.length=this._infos.length},r.prototype.getSize=function(n){var t=this._infos[n];return t?t.visible===!1?0:Math.floor(t.size):null},r.prototype.getActualSize=function(n){var t=this._infos[n];return t?Math.floor(t.size):null},r.prototype.setSize=function(n,t){var i=this._infos[n];i||(this._infos[n]=i={},this.length=this._infos.length);i.size!==t&&(i.size=t)},r.prototype.getVisible=function(n){var u=!0,r=this._infos[n];return r&&r.visible!==i&&r.visible!==t&&(u=r.visible),u},r.prototype.setVisible=function(n,t){var i=this._infos[n];i||(this._infos[n]=i={},this.length=this._infos.length);i.visible!==t&&(i.visible=t)},r.prototype.getResizeable=function(n){var u=!0,r=this._infos[n];return r&&r.resizable!==i&&r.resizable!==t&&(u=r.resizable),u},r.prototype.setResizeable=function(n,t){var i=this._infos[n];i||(this._infos[n]=i={},this.length=this._infos.length);i.resizable!=t&&(i.resizable=t)},r.prototype.getPageBreak=function(n){var u=!1,r=this._infos[n];return r&&r.pageBreak!==i&&r.pageBreak!==t&&(u=r.pageBreak),u},r.prototype.setPageBreak=function(n,t){var i=this._infos[n];i||(this._infos[n]=i={},this.length=this._infos.length);i.pageBreak!=t&&(i.pageBreak=t)},r}();n._AxieModel=u})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){function e(n,t){if(n){if(n._editorStatus===2)return!1;var i=n._formulaTextBox;if(i&&i.canAppendRange())return n._moveFormulaTextBoxCell(t,!1),!0;else i&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.moveActiveCell(t,!1),!0}return!1}function u(n,t,i,r){if(n){if(n._editorStatus===2)return!1;var u=n._formulaTextBox;if(u&&u.canAppendRange())return n._moveFormulaTextBoxCell(t,!1,i,r),!0;else u&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.moveActiveCell(t,!1,i,r),!0}return!1}function r(n,t,i){if(n){if(n._editorStatus===2)return!1;var r=n._formulaTextBox;if(r&&r.canAppendRange())return n._changeFormulaTextBoxActiveRange(t,i),!0;else r&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.endEdit()?(n._changeActiveSelectedRange(t,i),!0):!1}return!1}function s(n){for(var i,r=[],t=0,u=n._floatingObjectArray.length;t<u;t++)i=n._floatingObjectArray[t],i.isSelected()&&r.push(i.name());return r}var i,o,f;t.feature("core.sheet_action",["core.common","core.sheet_model"]);i=null;o=undefined;f=function(){function f(){}return f.navigationLeft=function(){return e(this,3)},f.navigationRight=function(){return e(this,4)},f.navigationUp=function(){return e(this,1)},f.navigationDown=function(){return e(this,2)},f.commitArrayFormula=function(){var n=f.handleFormulaTextboxAcrossSheet(this);return n.commitArrayFormula(),!0},f.commitInputNavigationDown=function(){var n=f.handleFormulaTextboxAcrossSheet(this);return n.moveActiveCell(2,!1),!0},f.commitInputNavigationUp=function(){var n=f.handleFormulaTextboxAcrossSheet(this);return n.moveActiveCell(1,!1),!0},f.handleFormulaTextboxAcrossSheet=function(n){var i=n,r=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;return t.features.formulatextbox&&r&&r.text&&(i=r.sheet,f.changeSheetForFormulaTextboxAcrossSheet(i)),i},f.changeSheetForFormulaTextboxAcrossSheet=function(n,i){typeof i=="undefined"&&(i=!0);var u=n.parent,r=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;t.features.formulatextbox&&r&&r.text&&u._changeSheetForFormulaAcrossSheet(n,i)},f.navigationHome=function(){var n=this;return u(n,4,i,n.frozenColCount?n.frozenColCount-1:-1)},f.navigationHome2=function(){var n=this;return u(n,4,i,-1)},f.navigationEnd=function(){var n=this;return u(this,3,i,n.getColumnCount()-n._frozenTrailingColCount)},f.navigationEnd2=function(){var n=this;return u(n,3,i,n.getColumnCount())},f.navigationTop=function(){var n=this;return u(n,2,-1,i)},f.navigationBottom=function(){var n=this;return u(n,1,n.getRowCount(),i)},f.navigationPageUp=function(){var n=this,u,h,r,e,o,s;if(!n||n._editorStatus===2)return!1;if(u=n._getPrevPageTopRow(),u===i||u===n._scrollTopRow)return!0;if(h=n._getRowLayout(1,3),r=n._getNextVisualRow(n._activeRowIndex-h.length),r<u&&(r=u),e=n._formulaTextBox,e&&e.canAppendRange())return o=n._getKeyboardAppendingInfo(),o.anchorRow=r,o.leadingRow=r,s=n._eventHandler.rangeToString(new t.Range(o.anchorRow,o.anchorCol,1,1)),s&&e.appendRange(s,!1,!0),n._setTopRow(u),!0;else e&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.endEdit()?(n.canSelect(r,n.getActiveColumnIndex())&&(n._setActiveCellCore(r,i),n._leadingCellRow=r,n.moveActiveCell()),n._setTopRow(u),!0):!1},f.navigationPageDown=function(){var n=this,u,h,r,e,o,s;if(!n||n._editorStatus===2)return!1;if(u=n._getNextPageTopRow(),u===i||u===n._scrollTopRow)return!0;if(h=n._getRowLayout(1,3),r=n._getPrevVisualRow(n._activeRowIndex+h.length),r<u&&(r=u),e=n._formulaTextBox,e&&e.canAppendRange())return o=n._getKeyboardAppendingInfo(),o.anchorRow=r,o.leadingRow=r,s=n._eventHandler.rangeToString(new t.Range(o.anchorRow,o.anchorCol,1,1)),s&&e.appendRange(s,!1,!0),n._setTopRow(u),!0;else e&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.endEdit()?(n.canSelect(r,n.getActiveColumnIndex())&&(n._setActiveCellCore(r,i),n._leadingCellRow=r,n.moveActiveCell()),n._setTopRow(u),!0):!1},f.navigationNextSheet=function(){var u=this,t=u.parent,f=n.Sheets,r,i;(t||t instanceof f.Spread)&&(r=t.getSheetCount(),i=t.getActiveSheetIndex(),i<r-1&&(i++,t._setActiveSheetIndexImp(i,1),t.repaint()))},f.navigationPreviousSheet=function(){var r=this,t=r.parent,u=n.Sheets,i;(t||t instanceof u.Spread)&&(i=t.getActiveSheetIndex(),i>0&&(i--,t._setActiveSheetIndexImp(i,1),t.repaint()))},f.navigationPrevious=function(){},f.navigationNext=function(){},f.navigationFirst=function(){var n=this,u,e;if(!n||n._editorStatus===2)return!1;var o=n.frozenColCount?n.frozenColCount-1:-1,s=n.frozenRowCount?n.frozenRowCount-1:-1,t=n._formulaTextBox,i=n._activeRowIndex,r=n._activeColIndex;if(t&&t.canAppendRange())return u=n._eventHandler,e=t.isAppending?u._formulaRangeAppendingInfo:u._formulaRangeAppendingInfo={anchorRow:i,anchorCol:r,leadingRow:n._leadingCellRow,leadingCol:n._leadingCellCol},n._moveFormulaTextBoxCell(5,!1,i,r),!0;else t&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.moveActiveCell(5,!1,i,r),!0},f.navigationLast=function(){var n=this,u,e;if(!n||n._editorStatus===2)return!1;var t=n._formulaTextBox,i=n._activeRowIndex,r=n._activeColIndex;if(t&&t.canAppendRange())return u=n._eventHandler,e=t.isAppending?u._formulaRangeAppendingInfo:u._formulaRangeAppendingInfo={anchorRow:i,anchorCol:r,leadingRow:n._leadingCellRow,leadingCol:n._leadingCellCol},n._moveFormulaTextBoxCell(6,!1,i,r),!0;else t&&(n=f.handleFormulaTextboxAcrossSheet(n));return n.moveActiveCell(6,!1,i,r),!0},f.commitInputNavigationTabNext=function(){var n=f.handleFormulaTextboxAcrossSheet(this);n._isTabNavigation=!0;n._isNavigateInSelection?n._moveActiveCellInSelection(4):n.moveActiveCell(4,!0);n._isTabNavigation=!1},f.commitInputNavigationTabPrevious=function(){var n=f.handleFormulaTextboxAcrossSheet(this);n._isTabNavigation=!0;n._isNavigateInSelection?n._moveActiveCellInSelection(3):n.moveActiveCell(3,!0);n._isTabNavigation=!1},f.selectNextControl=function(){var u=this,f,e,n,r;return u.endEdit()?(f=u._eventHandler,f.clearRepeatKeyDownTimeout(),f.resetMetaKeyState(),t.FocusHelper.setActiveElement(i),e=!1,n=u.parent,n&&(r=n.nextControl(),r&&r.focus?(r.focus(),e=!0):n.focusTabFocusElement()),e):!1},f.selectPreviousControl=function(){var u=this,f,e,n,r;if(u.endEdit())return f=u._eventHandler,f.clearRepeatKeyDownTimeout(),f.resetMetaKeyState(),t.FocusHelper.setActiveElement(i),e=!1,n=u.parent,n&&(r=n.previousControl(),r&&r.focus?(r.focus(),e=!0):n.focusTabFocusElement()),e},f.moveToNextCell=function(){return f.commitInputNavigationTabNext.apply(this),!0},f.moveToPreviousCell=function(){return f.commitInputNavigationTabPrevious.apply(this),!0},f.moveToNextCellThenControl=function(){var n=this,i=n._leadingCellRow,t,r;return n._isTabNavigation=!0,t=n._getMoveRightCell(n.getActiveRowIndex(),n.getActiveColumnIndex(),!0,i),n._isTabNavigation=!1,r=t?t.leadingCellRow<i:!0,r?f.selectNextControl.apply(this):f.moveToNextCell.apply(this)},f.moveToPreviousCellThenControl=function(){var n=this,i=n._leadingCellRow,t,r;return n._isTabNavigation=!0,t=n._getMoveLeftCell(n.getActiveRowIndex(),n.getActiveColumnIndex(),!0,i),n._isTabNavigation=!1,r=t?t.leadingCellRow>i:!0,r?f.selectPreviousControl.apply(this):f.moveToPreviousCell.apply(this)},f.cancelInput=function(){var n=this,i=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,h,c,l,r,e,u,a,s;if(t.features.formulatextbox&&i&&i.text&&(n=i.sheet,h=i.rowIndex,c=i.columnIndex,f.changeSheetForFormulaTextboxAcrossSheet(n,!1),n._detachFormulaTextBox(),n._setActiveCellAndSelection(h,c,o,o,1)),n.isEditing())return(l=n.getValue(n._activeRowIndex,n._activeColIndex,3),!n.endEdit(!0))?!1:(n.setValue(n._activeRowIndex,n._activeColIndex,l,3,!0),!0);else if(r=n.parent,r&&r.sheets)for(e=r.sheets,u=0,a=e.length;u<a;u++)s=e[u],s&&s._cutCopyIndicatorManager.cancelIndicator()},f.clear=function(){var n=this,r,i;n.isEditing()||(r=n.getSelections(),i=new t.UndoRedo.ClearValueUndoAction(n,r),i.canExecute(n)&&n._doCommand(i))},f.clearAndEditing=function(){var n=this;return n.isEditing()?!1:(n.startEdit(!0,""),!0)},f.copy=function(){var n=this;n._doCopy()},f.cut=function(){var n=this;n._doCut()},f.paste=function(){var n=this;n._doPaste()},f.selectionLeft=function(){return r(this,37)},f.selectionRight=function(){return r(this,39)},f.selectionUp=function(){return r(this,38)},f.selectionDown=function(){return r(this,40)},f.selectionHome=function(){return r(this,37,!0)},f.selectionEnd=function(){return r(this,39,!0)},f.selectionPageUp=function(){return r(this,33)},f.selectionPageDown=function(){return r(this,34)},f.selectionTop=function(){return r(this,38,!0)},f.selectionBottom=function(){return r(this,40,!0)},f.selectionFirst=function(){return r(this,36,!0)},f.selectionLast=function(){return r(this,35,!0)},f.unSelectAllFloatingObjects=function(){var n=this;n._hasFloatingObjectsSelected()&&(n._suspendInvalidate(),n.unSelectAllFloatingObjects(),n._loadAndSetSheetSelections(),n._resumeInvalidate())},f.selectAllFloatingObjects=function(){var n=this,t,r,i;if(n._hasFloatingObjectsSelected()){for(n._suspendInvalidate(),t=0,r=n._floatingObjectArray.length;t<r;t++)i=n._floatingObjectArray[t],i.isSelected()||i.isSelected(!0);n._resumeInvalidate()}},f.deleteFloatingObject=function(){var n=this,i=s(n),r,u;i.length>0&&(r={names:i},u=new t.UndoRedo.DeleteFloatingObjectUndoAction(n,r),n._doCommand(u))},f.navigationNextFloatingObject=function(){var n=this,i,r,t,u;if(n._hasFloatingObjectsSelected()){for(n._suspendInvalidate(),t=0,i=0,r=n._floatingObjectArray.length;i<r;i++)u=n._floatingObjectArray[i],u.isSelected()&&(t=i);return n.unSelectAllFloatingObjects(),t+=1,t==n._floatingObjectArray.length&&(t=0),n._floatingObjectArray[t].isSelected(!0),n._resumeInvalidate(),!0}return!1},f.navigationPreviousFloatingObject=function(){var n=this,i,r,t,u;if(n._hasFloatingObjectsSelected()){for(n._suspendInvalidate(),t=0,i=0,r=n._floatingObjectArray.length;i<r;i++)u=n._floatingObjectArray[i],u.isSelected()&&(t=i);return n.unSelectAllFloatingObjects(),t-=1,t<0&&(t=n._floatingObjectArray.length-1),n._floatingObjectArray[t].isSelected(!0),n._resumeInvalidate(),!0}return!1},f.clipboardCutFloatingObject=function(){var n=this;n._doFloatingObjectCut()},f.clipboardCopyFloatingObject=function(){var n=this;n._doFloatingObjectCopy()},f.clipboardPasteFloatingObject=function(){var n=this;n._doFloatingObjectPaste()},f.moveFloatingObjectUp=function(){for(var n=this,u=[],o=0,r,e,i=0,f=n._floatingObjectArray.length;i<f;i++)r=n._floatingObjectArray[i],r.isSelected()&&u.push(r.name());e=new t.UndoRedo.MovingFloatingObjectUndoAction(n,{names:u},{offsetX:0,offsetY:-1});n._doCommand(e)},f.moveFloatingObjectDown=function(){for(var n=this,u=[],o=0,r,e,i=0,f=n._floatingObjectArray.length;i<f;i++)r=n._floatingObjectArray[i],r.isSelected()&&u.push(r.name());e=new t.UndoRedo.MovingFloatingObjectUndoAction(n,{names:u},{offsetX:0,offsetY:1});n._doCommand(e)},f.moveFloatingObjectLeft=function(){for(var n=this,u=[],o=0,r,e,i=0,f=n._floatingObjectArray.length;i<f;i++)r=n._floatingObjectArray[i],r.isSelected()&&u.push(r.name());e=new t.UndoRedo.MovingFloatingObjectUndoAction(n,{names:u},{offsetX:-1,offsetY:0});n._doCommand(e)},f.moveFloatingObjectRight=function(){for(var n=this,u=[],o=0,r,e,i=0,f=n._floatingObjectArray.length;i<f;i++)r=n._floatingObjectArray[i],r.isSelected()&&u.push(r.name());e=new t.UndoRedo.MovingFloatingObjectUndoAction(n,{names:u},{offsetX:1,offsetY:0});n._doCommand(e)},f.unfilterSlicer=function(){var n=this,u=n&&n._slicerCollection,f=u&&u.getSelectedSlicers(),i,r,e;f.length===1&&(i=f[0],r=i.getSlicerData(),r)&&(e=r.getFilteredIndexes(i.columnName()),n._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(n,r,i.columnName(),e)))},f.deleteComment=function(){var n=this,i=n._commentManager.getActiveComment(),r;i&&(r=new t.UndoRedo.CommentDeleteUndoAction(n,i),n._doCommand(r))},f.deactivateComment=function(){var n=this;n._commentManager.deactivateComment();n._loadAndSetSheetSelections();n.repaint()},f.moveCommentUp=function(){var i=this,n=i._commentManager.getActiveComment(),r;n&&(r=new t.UndoRedo.CommentPropertyUndoAction(i,n,n.location().clone(),new t.Point(n.location().x,n.location().y-1),"location"),i._doCommand(r))},f.moveCommentDown=function(){var i=this,n=i._commentManager.getActiveComment(),r;n&&(r=new t.UndoRedo.CommentPropertyUndoAction(i,n,n.location().clone(),new t.Point(n.location().x,n.location().y+1),"location"),i._doCommand(r))},f.moveCommentLeft=function(){var i=this,n=i._commentManager.getActiveComment(),r;n&&(r=new t.UndoRedo.CommentPropertyUndoAction(i,n,n.location().clone(),new t.Point(n.location().x-1,n.location().y),"location"),i._doCommand(r))},f.moveCommentRight=function(){var i=this,n=i._commentManager.getActiveComment(),r;n&&(r=new t.UndoRedo.CommentPropertyUndoAction(i,n,n.location().clone(),new t.Point(n.location().x+1,n.location().y),"location"),i._doCommand(r))},f.changeFormulaReference=function(){var n=this,t;if(n&&n._formulaTextBox&&(t=n._eventHandler,t)){n._suspendInvalidate();try{t.changeFormulaReference()}finally{n._resumeInvalidate()}}},f.undo=function(){var t=this,n=t.undoManager();n.canUndo()&&n.undo()},f.redo=function(){var t=this,n=t.undoManager();n.canRedo()&&n.redo()},f}();t.SpreadActions=f})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){(function(i){var r=null,s=undefined,l=Math.min,e=Math.max,ir=Math.ceil,p=Math.floor,c=function(){function n(n,t,i){var r=this;r.row=n;r.column=t;r.value=i}return n}(),h,w,o,v,a,u,f,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,g,nt,tt,ui,it,fi,ei,rt,oi,si,hi,y,ci,li,ai,vi,yi,b,pi,wi,k,bi,ki,di,d,gi,nr,ut,tr;i.CellData=c;h=function(){function n(n,t,i){var r=this;r.sheet=n;r.range=t;r.dataType=i;r.cellsHasData=[];r.changedCells=[];r.initCellsHasData()}return n.prototype.initCellsHasData=function(){var i=this,a=i.range,t=i.sheet,st,ut,nt,ft,f,u,n,l,e,h,b,et,k,ot,v,tt,y,it;if(t&&a){var o=i.dataType,p=a.row,w=a.col,rt=a.rowCount,d=a.colCount,c=i.cellsHasData,g=!1;if(p===-1&&(g=!0,p=0,rt=t.getRowCount()),w===-1&&(g=!0,w=0,d=t.getColumnCount()),st=t.getDefaultStyle(),nt=[],(o&64)>0)for(n=0;n<d;n++)nt[n]=t.getStyleObject(-1,n)||r;for(f=0;f<rt;f++)for(u=p+f,(o&64)>0&&(ut=t.getStyleObject(u,-1)||r),n=0;n<d;n++){if(e=w+n,(o&2)>0&&(l=t.getFormulaInformation(u,e),l.hasFormula))if(l.isArrayFormula){if(h=l.baseRange,h.row===u&&h.col===e)for(b=h.row,et=h.row+h.rowCount;b<et;b++)for(k=h.col,ot=h.col+h.colCount;k<ot;k++)i.setCellDatas(c,b-p,k-w,l,2)}else i.setCellDatas(c,f,n,l.formula,2);(o&1)>0&&(!l||!l.hasFormula)&&i.setCellDatas(c,f,n,t.getValue(u,e,3),1);(o&16)>0&&(v=t.getSparkline(u,e),tt=r,v&&(tt=v.data()),v&&tt&&i.setCellDatas(c,f,n,v,16));(o&64)>0&&(g?y=t.getActualStyle(u,e,3):(ft=t.getStyleObject(u,e)||r,y=t.getCompositeStyle(u,e,3,ft,ut,nt[n])),it=s,y&&y.toJSON&&(it=JSON.stringify(y.toJSON(3,!0))),i.setCellDatas(c,f,n,it,64));(o&4)>0&&i.setCellDatas(c,f,n,t.getComment(u,e),4);(o&128)>0&&i.setCellDatas(c,f,n,t.getTag(u,e,3),128);(o&256)>0&&i.setCellDatas(c,f,n,t.getBindingPath(u,e,3),256)}}},n.prototype.getCellsHasData=function(){return this.cellsHasData},n.prototype.setCellDatas=function(n,i,u,f,e){f!==s&&f!==r&&n&&(n[i]===s&&(n[i]=[]),n[i][u]===s&&(n[i][u]={}),n[i][u][t.CopyToOption[e]]=f)},n.prototype.mergeCellsHasDiffData=function(n){var e,r,t,h,u,i,c,f,o;if(n)for(e=this,r=e.cellsHasData,t=0,h=n.length;t<h;t++)if(u=n[t],u)for(i=0,c=u.length;i<c;i++)f=u[i],f&&(r[t]||(r[t]=[]),o=r[t][i],o?e.isDataEqual(f,o)&&(r[t][i]=s):r[t][i]=f)},n.prototype.isDataEqual=function(n,i){var u=this.dataType,r=[],f,o,e;for(u&256&&r.push(t.CopyToOption[256]),u&4&&r.push(t.CopyToOption[4]),u&2&&r.push(t.CopyToOption[2]),u&16&&r.push(t.CopyToOption[16]),u&64&&r.push(t.CopyToOption[64]),u&128&&r.push(t.CopyToOption[128]),u&1&&r.push(t.CopyToOption[1]),f=0,o=r.length;f<o;f++)if(e=r[f],n[e]!==i[e])return!1;return!0},n.prototype.getChangedCells=function(){var n=this,o=[],u=n.range.row,f=n.range.col,s=n.cellsHasData,i,h,e,r,c;if(n.changedCells&&n.changedCells.length>0)return n.changedCells;for(u=u===-1?0:u,f=f===-1?0:f,i=0,h=s.length;i<h;i++)if(e=s[i],e)for(r=0,c=e.length;r<c;r++)e[r]&&o.push(new t.CellPosition(i+u,r+f));return n.changedCells=o,o},n}();i.ChangedCells=h;w=function(){function n(){}return n.prototype.saveDefaultStyle=function(n){this._defaultStyle=n;this._defaultStyleSaved=!0},n.prototype.getDefaultStyle=function(){return this._defaultStyle},n.prototype.saveDefaultColumnWidth=function(n){this._defaultColumnWidth=n;this._defaultColumnWidthSaved=!0},n.prototype.getDefaultColumnWidth=function(){return this._defaultColumnWidth},n.prototype.saveDefaultRowHeight=function(n){this._defaultRowHeight=n;this._defaultRowHeightSaved=!0},n.prototype.getDefaultRowHeight=function(){return this._defaultRowHeight},n.prototype.getTag=function(){return this._tag},n.prototype.saveColumnHeaderDefaultStyle=function(n){this._columnHeaderDefaultStyle=n;this._columnHeaderDefaultStyleSaved=!0},n.prototype.getColumnHeaderDefaultStyle=function(){return this._columnHeaderDefaultStyle},n.prototype.saveColumnHeaderDefaultRowHeight=function(n){this._columnHeaderDefaultRowHeight=n;this._columnHeaderDefaultRowHeightSaved=!0},n.prototype.getColumnHeaderDefaultRowHeight=function(){return this._columnHeaderDefaultRowHeight},n.prototype.saveRowHeaderDefaultStyle=function(n){this._rowHeaderDefaultStyle=n;this._rowHeaderDefaultStyleSaved=!0},n.prototype.getRowHeaderDefaultStyle=function(){return this._rowHeaderDefaultStyle},n.prototype.saveRowHeaderDefaultColumnWidth=function(n){this._rowHeaderDefaultColumnWidth=n;this._rowHeaderDefaultColumnWidthSaved=!0},n.prototype.getRowHeaderDefaultColumnWidth=function(){return this._rowHeaderDefaultColumnWidth},n.prototype.saveCommentManager=function(n){this._commentManager=n;this._commentManagerSaved=!0},n.prototype.saveTag=function(n){this._tag=n;this._tagSaved=!0},n.prototype.isDefaultStyleSaved=function(){return this._defaultStyleSaved},n.prototype.isDefaultColumnWidthSaved=function(){return this._defaultColumnWidthSaved},n.prototype.isDefaultRowHeightSaved=function(){return this._defaultRowHeightSaved},n.prototype.isColumnHeaderDefaultStyleSaved=function(){return this._columnHeaderDefaultStyleSaved},n.prototype.isColumnHeaderDefaultRowHeightSaved=function(){return this._columnHeaderDefaultRowHeightSaved},n.prototype.isRowHeaderDefaultStyleSaved=function(){return this._rowHeaderDefaultStyleSaved},n.prototype.isRowHeaderDefaultColumnWidthSaved=function(){return this._rowHeaderDefaultColumnWidthSaved},n.prototype.isCommentManagerSaved=function(){return this._commentManagerSaved},n.prototype.isTagSaved=function(){return this._tagSaved},n}();i.CopyMoveSheetInfo=w;o=function(){function n(n,t){var i=this;i._rowCount=n;i._columnCount=t;i._init()}return n.prototype._init=function(){var n=this;n._values=[];n._formulas=[];n._sparklines=[];n._styles=[];n._comments=[];n._tags=[];n._bindingPaths=[];n._spans=r;n._arrayFormulas=[];n._valueSaved=!1;n._formulaSaved=!1;n._sparklineSaved=!1;n._styleSaved=!1;n._commentSaved=!1;n._tagSaved=!1;n._spanSaved=!1;n._arrayFormulaSaved=!1;n._bindingPathSaved=!1},n.prototype.saveValue=function(n,t,i){i!==s&&i!==r&&this._values.push(new c(n,t,i));this._valueSaved=!0},n.prototype.getValues=function(){return this._values},n.prototype.saveFormula=function(n,t,i){i&&i!==""&&this._formulas.push(new c(n,t,i));this._formulaSaved=!0},n.prototype.getFormulas=function(){return this._formulas},n.prototype.saveArrayFormula=function(n){this._arrayFormulas.push(n);this._arrayFormulaSaved=!0},n.prototype.getArrayFormula=function(){return this._arrayFormulas},n.prototype.saveSparkline=function(n,t,i){i&&this._sparklines.push(new c(n,t,i));this._sparklineSaved=!0},n.prototype.getSparklines=function(){return this._sparklines},n.prototype.saveStyle=function(n,t,i){i&&this._styles.push(new c(n,t,i));this._styleSaved=!0},n.prototype.getStyles=function(){return this._styles},n.prototype.saveComment=function(n,t,i){i&&this._comments.push(new c(n,t,i));this._commentSaved=!0},n.prototype.getComments=function(){return this._comments},n.prototype.saveTag=function(n,t,i){i!==s&&i!==r&&this._tags.push(new c(n,t,i));this._tagSaved=!0},n.prototype.getTags=function(){return this._tags},n.prototype.saveBindingPath=function(n,t,i){i!==s&&i!==r&&this._bindingPaths.push(new c(n,t,i));this._bindingPathSaved=!0},n.prototype.getBindingPaths=function(){return this._bindingPaths},n.prototype.saveSpan=function(n){var t=this;t._spans||(t._spans=[]);t._spans.push(n);t._spanSaved=!0},n.prototype.isValueOrFormulaSaved=function(){return this._valueSaved||this._formulaSaved||this._arrayFormulaSaved},n.prototype.isValueSaved=function(){return this._valueSaved},n.prototype.isFormulaSaved=function(){return this._formulaSaved},n.prototype.isArrayFormulaSaved=function(){return this._arrayFormulaSaved},n.prototype.isSparklineSaved=function(){return this._sparklineSaved},n.prototype.isStyleSaved=function(){return this._styleSaved},n.prototype.isCommentSaved=function(){return this._commentSaved},n.prototype.isTagSaved=function(){return this._tagSaved},n.prototype.isSpanSaved=function(){return this._spanSaved},n.prototype.isBindingPathSaved=function(){return this._bindingPathSaved},n}();i.CopyMoveCellsInfo=o;v=function(){function n(n){this._columnCount=n;this._init()}return n.prototype._init=function(){var n=this;n._widths={};n._visibles={};n._resizables={};n._tags={};n._viewportColumnStyles={};n._headerColumnStyles={};n._levels={};n._collapsed={};n._bindingFields={};n._widthSaved=!1;n._visibleSaved=!1;n._resizableSaved=!1;n._tagSaved=!1;n._viewportColumnStyleSaved=!1;n._headerColumnStyleSaved=!1;n._rangeGroupSaved=!1;n._bindingFieldSaved=!1},n.prototype.saveWidth=function(n,t){var i=this;i._widths[n]!==r?i._widths[n]=t<0?r:t:t>=0&&(i._widths[n]=t);i._widthSaved=!0},n.prototype.getWidth=function(n){return this._widths[n]!==r?this._widths[n]:-1},n.prototype.saveVisible=function(n,t){var i=this;i._visibles[n]!==r?i._visibles[n]=t?r:t:t||(i._visibles[n]=t);i._visibleSaved=!0},n.prototype.getVisible=function(n){return this._visibles[n]!==r?this._visibles[n]:!0},n.prototype.saveResizable=function(n,t){var i=this;i._resizables[n]!==r?i._resizables[n]=t?r:t:t||(i._resizables[n]=t);i._resizableSaved=!0},n.prototype.getResizable=function(n){return this._resizables[n]!==r?this._resizables[n]:!0},n.prototype.saveTag=function(n,t){var i=this;i._tags[n]=t!==s&&t!==r?t:r;i._tagSaved=!0},n.prototype.getTag=function(n){return this._tags[n]},n.prototype.saveViewportColumnStyle=function(n,t){var i=this;i._viewportColumnStyles[n]?i._viewportColumnStyles[n]=t?t:r:t&&(i._viewportColumnStyles[n]=t);i._viewportColumnStyleSaved=!0},n.prototype.getViewportColumnStyle=function(n){return this._viewportColumnStyles[n]?this._viewportColumnStyles[n]:r},n.prototype.saveHeaderColumnStyle=function(n,t){var i=this;i._headerColumnStyles[n]?i._headerColumnStyles[n]=t?t:r:t&&(i._headerColumnStyles[n]=t);i._headerColumnStyleSaved=!0},n.prototype.getHeaderColumnStyle=function(n){return this._headerColumnStyles[n]?this._headerColumnStyles[n]:r},n.prototype.saveRangeGroup=function(n,t,i){var u=this;u._levels[n]!==r?u._levels[n]=t<0?r:t:t>=0&&(u._levels[n]=t);u._collapsed[n]!==r?u._collapsed[n]=i?i:r:i&&(u._collapsed[n]=i);u._rangeGroupSaved=!0},n.prototype.getRangeGroup=function(n,t){var i=this;t.level=-1;t.collapsed=!1;i._levels[n]!==r&&(t.level=i._levels[n]);i._collapsed[n]!==r&&(t.collapsed=i._collapsed[n])},n.prototype.saveBindingField=function(n,t){this._bindingFields[n]=t;this._bindingFieldSaved=!0},n.prototype.getBindingField=function(n,t){return(t.fieldName=r,this._bindingFields[n]!==r)?(t.fieldName=this._bindingFields[n],!0):!1},n.prototype.isWidthSaved=function(){return this._widthSaved},n.prototype.isVisibleSaved=function(){return this._visibleSaved},n.prototype.isResizableSaved=function(){return this._resizableSaved},n.prototype.isTagSaved=function(){return this._tagSaved},n.prototype.isViewportColumnStyleSaved=function(){return this._viewportColumnStyleSaved},n.prototype.isHeaderColumnStyleSaved=function(){return this._headerColumnStyleSaved},n.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},n.prototype.isBindingFieldSaved=function(){return this._bindingFieldSaved},n}();i.CopyMoveColumnsInfo=v;a=function(){function n(n){this._rowCount=n;this._init()}return n.prototype._init=function(){var n=this;n._heights={};n._visibles={};n._resizables={};n._tags={};n._viewportRowStyles={};n._headerRowStyles={};n._levels={};n._collapsed={};n._heightSaved=!1;n._visibleSaved=!1;n._resizableSaved=!1;n._tagSaved=!1;n._viewportRowStyleSaved=!1;n._headerRowStyleSaved=!1;n._rangeGroupSaved=!1},n.prototype.saveHeight=function(n,t){var i=this;i._heights[n]!==r?i._heights[n]=t<0?r:t:t>=0&&(i._heights[n]=t);i._heightSaved=!0},n.prototype.getHeight=function(n){return this._heights[n]!==r?this._heights[n]:-1},n.prototype.saveVisible=function(n,t){var i=this;i._visibles[n]!==r?i._visibles[n]=t?r:t:t||(i._visibles[n]=t);i._visibleSaved=!0},n.prototype.getVisible=function(n){return this._visibles[n]!==r?this._visibles[n]:!0},n.prototype.saveResizable=function(n,t){var i=this;i._resizables[n]!==r?i._resizables[n]=t?r:t:t||(i._resizables[n]=t);i._resizableSaved=!0},n.prototype.getResizable=function(n){return this._resizables[n]!==r?this._resizables[n]:!0},n.prototype.saveTag=function(n,t){var i=this;i._tags[n]=t!==s&&t!==r?t:r;i._tagSaved=!0},n.prototype.getTag=function(n){return this._tags[n]},n.prototype.saveViewportRowStyle=function(n,t){var i=this;i._viewportRowStyles[n]?i._viewportRowStyles[n]=t?t:r:t&&(i._viewportRowStyles[n]=t);i._viewportRowStyleSaved=!0},n.prototype.getViewportRowStyle=function(n){return this._viewportRowStyles[n]?this._viewportRowStyles[n]:r},n.prototype.saveHeaderRowStyle=function(n,t){var i=this;i._headerRowStyles[n]?i._headerRowStyles[n]=t?t:r:t&&(i._headerRowStyles[n]=t);i._headerRowStyleSaved=!0},n.prototype.getHeaderRowStyle=function(n){return this._headerRowStyles[n]?this._headerRowStyles[n]:r},n.prototype.saveRangeGroup=function(n,t,i){var u=this;u._levels[n]!==r?u._levels[n]=t<0?r:t:t>=0&&(u._levels[n]=t);u._collapsed[n]!==r?u._collapsed[n]=i?i:r:i&&(u._collapsed[n]=i);u._rangeGroupSaved=!0},n.prototype.getRangeGroup=function(n,t){var i=this;t.level=-1;t.collapsed=!1;i._levels[n]!==r&&(t.level=i._levels[n]);i._collapsed[n]!==r&&(t.collapsed=i._collapsed[n])},n.prototype.isHeightSaved=function(){return this._heightSaved},n.prototype.isVisibleSaved=function(){return this._visibleSaved},n.prototype.isResizableSaved=function(){return this._resizableSaved},n.prototype.isTagSaved=function(){return this._tagSaved},n.prototype.isViewportRowStyleSaved=function(){return this._viewportRowStyleSaved},n.prototype.isHeaderRowStyleSaved=function(){return this._headerRowStyleSaved},n.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},n}();i.CopyMoveRowsInfo=a;u=function(){function n(){}return n.getStyleObject=function(n,t,i,r){return n.getStyleObject(t,i,r)},n.setStyleObject=function(n,t,i,r,u){n.setStyleObject(t,i,u,r)},n.getComment=function(n,t,i){return n.getComment(t,i)},n.setComment=function(n,t,i,r){n.setComment(t,i,r)},n.saveSheetInfo=function(n,t,i){(i&64)>0&&(t.saveDefaultStyle(n.getDefaultStyle()),t.saveColumnHeaderDefaultStyle(n.getDefaultStyle(1)),t.saveRowHeaderDefaultStyle(n.getDefaultStyle(2)));(i&128)>0&&t.saveTag(n.tag());t.saveDefaultColumnWidth(n.defaults.colWidth);t.saveDefaultRowHeight(n.defaults.rowHeight);t.saveColumnHeaderDefaultRowHeight(n.defaults.colHeaderRowHeight);t.saveRowHeaderDefaultColumnWidth(n.defaults.rowHeaderColWidth)},n.saveColumnHeaderInfo=function(t,i,r,u,f){for(var l=i._rowCount,s=i._columnCount,e,a,c,h,o=0;o<l;o++)for(e=0;e<s;e++)(f&1)>0&&(a=t._getModel(1).getValue(o,u+e),i.saveValue(o,e,a)),(f&64)>0&&i.saveStyle(o,e,n.getStyleObject(t,o,u+e,1)),(f&128)>0&&i.saveTag(o,e,t.getTag(o,u+e,1));if((f&1)>0)for(e=0;e<s;e++)t.isColumnBound(u+e)&&r.saveBindingField(e,t.getDataColumnName(u+e));if((f&32)>0)for(c=t._getSpanModel(1).getEnumerator(0,u,l,s);c.moveNext();)i.saveSpan(c.current());for(s=r._columnCount,e=0;e<s;e++)r.saveWidth(e,t._getActualColumnWidth(u+e)),r.saveVisible(e,t.getColumnVisible(u+e)),r.saveResizable(e,t.getColumnResizable(u+e));if((f&128)>0)for(e=0;e<s;e++)r.saveTag(e,t.getTag(-1,u+e));if((f&64)>0)for(e=0;e<s;e++)r.saveViewportColumnStyle(e,n.getStyleObject(t,-1,u+e,3)),r.saveHeaderColumnStyle(e,n.getStyleObject(t,-1,u+e,1));if((f&8)>0&&(h=t.colRangeGroup,h&&!h._isEmpty()))for(e=0;e<s;e++)r.saveRangeGroup(e,h.getLevel(u+e),h.getCollapsed(u+e))},n.saveRowHeaderInfo=function(t,i,r,u,f){var s,c,e,o,a,l,h;if(!((f&1023)<=0)){for(s=i._rowCount,c=i._columnCount,e=0;e<s;e++)for(o=0;o<c;o++)(f&1)>0&&(a=t._getModel(2).getValue(u+e,o),i.saveValue(e,o,a)),(f&64)>0&&i.saveStyle(e,o,n.getStyleObject(t,u+e,o,2)),(f&128)>0&&i.saveTag(e,o,t.getTag(u+e,o,2));if((f&32)>0)for(l=t._getSpanModel(2).getEnumerator(u,0,s,c);l.moveNext();)i.saveSpan(l.current());for(s=r._rowCount,e=0;e<s;e++)r.saveHeight(e,t._getActualRowHeight(u+e)),r.saveVisible(e,t.getRowVisible(u+e)),r.saveResizable(e,t.getRowResizable(u+e));if((f&128)>0)for(e=0;e<s;e++)r.saveTag(e,t.getTag(u+e,-1));if((f&64)>0)for(e=0;e<s;e++)r.saveViewportRowStyle(e,n.getStyleObject(t,u+e,-1,3)),r.saveHeaderRowStyle(e,n.getStyleObject(t,u+e,-1,2));if((f&8)>0&&(h=t.rowRangeGroup,h&&!h._isEmpty()))for(e=0;e<s;e++)r.saveRangeGroup(e,h.getLevel(u+e),h.getCollapsed(u+e))}},n.saveViewportInfo=function(t,i,u,f,e){var l,a,o,s,h,v;if(!((e&1023)<=0)){for(l=i._rowCount,a=i._columnCount,o=0;o<l;o++)for(s=0;s<a;s++){if((e&2)>0&&(h=t.getFormulaInformation(u+o,f+s),h.hasFormula?h.isArrayFormula?h.baseRange.row===u+o&&h.baseRange.col===f+s&&i.saveArrayFormula(h):i.saveFormula(o,s,h.formula):i.saveFormula(o,s,r)),(e&1)>0&&(!h||!h.hasFormula)&&i.saveValue(o,s,t.getValue(u+o,f+s,3)),(e&16)>0){var c=t.getSparkline(u+o,f+s),y=r,p=r;c&&(y=c.data(),p=c.dateAxisData());c&&y?i.saveSparkline(o,s,c.clone()):i.saveSparkline(o,s,r)}(e&64)>0&&i.saveStyle(o,s,n.getStyleObject(t,u+o,f+s,3));(e&4)>0&&i.saveComment(o,s,n.getComment(t,u+o,f+s));(e&128)>0&&i.saveTag(o,s,t.getTag(u+o,f+s,3));(e&256)>0&&i.saveBindingPath(o,s,t.getBindingPath(u+o,f+s,3))}if((e&32)>0)for(v=t._getSpanModel().getEnumerator(u,f,l,a);v.moveNext();)i.saveSpan(v.current())}},n.saveTableInfo=function(n,t,i){var f=n.getTables(),r,o,u,e;if(f)for(r=0,o=f.length;r<o;r++)u=f[r],i.containsRange(u.range())&&(e=u.clone(),e.copyDataSource(u),t.push(e))},n.undoCellsInfo=function(t,i,u,f,e){var et=i._rowCount,ot=i._columnCount,o,y,b,k,d,v,c,l,st,g,ht,nt,ct,lt,tt,s,at,it,vt,rt,wt,yt,bt,ut,h,a,w,p,ft,pt;t.suspendCalcService();t.suspendEvent();try{for(c=0;c<et;c++)for(l=0;l<ot;l++)i.isBindingPathSaved()&&t.setBindingPath(u+c,f+l,r,e),i.isFormulaSaved()&&e===3&&t.setFormula(u+c,f+l,r),i.isSparklineSaved()&&e===3&&t.removeSparkline(u+c,f+l),i.isValueSaved()&&t.setValue(u+c,f+l,r,e),i.isStyleSaved()&&n.setStyleObject(t,u+c,f+l,e,r),i.isCommentSaved()&&n.setComment(t,u+c,f+l,r),i.isTagSaved()&&t.setTag(u+c,f+l,r,e);if(i.isBindingPathSaved())for(st=i.getBindingPaths(),o=0;o<st.length;o++)g=st[o],t.setBindingPath(u+g.row,f+g.column,g.value,e);if(i.isValueSaved())for(ht=i.getValues(),o=0;o<ht.length;o++)nt=ht[o],t.setValue(u+nt.row,f+nt.column,nt.value,e);if(i.isFormulaSaved()&&e===3)for(ct=i.getFormulas(),o=0;o<ct.length;o++)k=ct[o],t.setFormula(u+k.row,f+k.column,k.value);if(i.isSparklineSaved()&&e===3)for(lt=i.getSparklines(),tt=0;tt<lt.length;tt++)h=lt[tt],s=h.value,s?s.dateAxisData()?t.setSparkline(u+h.row,f+h.column,s.data(),s.dataOrientation(),s.sparklineType(),s.setting(),s.dateAxisData(),s.dateAxisOrientation()):t.setSparkline(u+h.row,f+h.column,s.data(),s.dataOrientation(),s.sparklineType(),s.setting()):t.removeSparkline(u+h.row,f+h.column);if(i.isStyleSaved())for(at=i.getStyles(),o=0;o<at.length;o++)it=at[o],n.setStyleObject(t,u+it.row,f+it.column,e,it.value);if(i.isCommentSaved())for(vt=i.getComments(),o=0;o<vt.length;o++)rt=vt[o],wt=rt.value,n.setComment(t,u+rt.row,f+rt.column,wt);if(i.isTagSaved())for(yt=i.getTags(),bt=yt.length,ut=0;ut<bt;ut++)h=yt[ut],t.setTag(u+h.row,f+h.column,h.value,e);if(i.isArrayFormulaSaved()&&e===3){if(a=t._getsArrayFormulas(u,f,et,ot),a&&a.length>0)for(d=a.getLength(0),v=0;v<d;v++)b=a[v][0],t.setArrayFormula(b.row,b.col,b.rowCount,b.colCount,r);if(a=i.getArrayFormula(),a&&a.length>0)for(d=a.length,v=0;v<d;v++)w=a[v],t.setArrayFormula(w.baseRange.row,w.baseRange.col,w.baseRange.rowCount,w.baseRange.colCount,w.formula)}}finally{t.resumeCalcService();t.resumeEvent()}if(p=t._getSpanModel(e),p&&p.length>0){for(ft=[],pt=p.getEnumerator(u,f,et,ot);pt.moveNext();)y=pt.current(),y&&ft.push(y);for(o=0;o<ft.length;o++)y=ft[o],p.remove(y)}if(i.isSpanSaved()&&p)for(o=0;o<i._spans.length;o++)y=i._spans[o],p.addSpan(y)},n.undoColumnsInfo=function(t,i,u){var e=i._columnCount,f,h,o,s;if(i.isBindingFieldSaved())for(h={fieldName:r},f=0;f<e;f++)i.getBindingField(f,h)&&t.bindColumn(u+f,h.fieldName);if(i.isWidthSaved())for(f=0;f<e;f++)t.setColumnWidth(u+f,i.getWidth(f),3);if(i.isVisibleSaved())for(f=0;f<e;f++)t.setColumnVisible(u+f,i.getVisible(f),3);if(i.isResizableSaved())for(f=0;f<e;f++)t.setColumnResizable(u+f,i.getResizable(f),3);if(i.isTagSaved())for(f=0;f<e;f++)t.setTag(-1,u+f,i.getTag(f),3);if(i.isViewportColumnStyleSaved())for(f=0;f<e;f++)n.setStyleObject(t,-1,u+f,3,i.getViewportColumnStyle(f));if(i.isHeaderColumnStyleSaved())for(f=0;f<e;f++)n.setStyleObject(t,-1,u+f,1,i.getHeaderColumnStyle(f));if(i.isRangeGroupSaved()&&(o=t.colRangeGroup,o))for(s={level:r,collapsed:r},f=0;f<e;f++)i.getRangeGroup(f,s),o._setLevel(u+f,s.level),o.setCollapsed(u+f,s.collapsed)},n.undoRowsInfo=function(t,i,u){var e=i._rowCount,f,o,s;if(i.isHeightSaved())for(f=0;f<e;f++)t.setRowHeight(u+f,i.getHeight(f),3);if(i.isVisibleSaved())for(f=0;f<e;f++)t.setRowVisible(u+f,i.getVisible(f),3);if(i.isResizableSaved())for(f=0;f<e;f++)t.setRowResizable(u+f,i.getResizable(f),3);if(i.isTagSaved())for(f=0;f<e;f++)t.setTag(u+f,-1,i.getTag(f),3);if(i.isViewportRowStyleSaved())for(f=0;f<e;f++)n.setStyleObject(t,u+f,-1,3,i.getViewportRowStyle(f));if(i.isHeaderRowStyleSaved())for(f=0;f<e;f++)n.setStyleObject(t,u+f,-1,2,i.getHeaderRowStyle(f));if(i.isRangeGroupSaved()&&(o=t.rowRangeGroup,o))for(s={level:r,collapsed:r},f=0;f<e;f++)i.getRangeGroup(f,s),o._setLevel(u+f,s.level),o.setCollapsed(u+f,s.collapsed)},n.undoSheetInfo=function(n,t){t.isDefaultStyleSaved()&&n.setDefaultStyle(t.getDefaultStyle());t.isDefaultColumnWidthSaved()&&(n.defaults.colWidth=t.getDefaultColumnWidth());t.isDefaultRowHeightSaved()&&(n.defaults.rowHeight=t.getDefaultRowHeight());t.isTagSaved()&&n.tag(t.getTag());t.isColumnHeaderDefaultStyleSaved()&&n.setDefaultStyle(t.getColumnHeaderDefaultStyle(),1);t.isColumnHeaderDefaultRowHeightSaved()&&(n.defaults.colHeaderRowHeight=t.getColumnHeaderDefaultRowHeight());t.isRowHeaderDefaultStyleSaved()&&n.setDefaultStyle(t.getRowHeaderDefaultStyle(),2);t.isRowHeaderDefaultColumnWidthSaved()&&(n.defaults.rowHeaderColWidth=t.getRowHeaderDefaultColumnWidth())},n.undoTableInfo=function(n,t,i){var f=t.length,e,r,u;if(f>0)for(r=0;r<f;r++)u=t[r],n._tableManager.add(u);else if(e=n.getTables(),e)for(r=0,f=e.length;r<f;r++)u=e[r],i.containsRange(u.range())&&n._tableManager.remove(u,!1)},n.getValues=function(n,t,i,u,f){var l,e,o,h;for(t<0&&(t=0,u=n.getRowCount()),i<0&&(i=0,f=n.getColumnCount()),l=[],e=0;e<u;e++)for(o=0;o<f;o++)h=n.getValue(t+e,i+o),h!==s&&h!==r&&l.push(new c(e,o,h));return l},n.raiseRangeDataChanged=function(n,t,i,r,u,f,e,o){n&&(t<0&&(t=0,r=n.getRowCount()),i<0&&(i=0,u=n.getColumnCount()),n._raiseRangeDataChanged(t,i,r,u,f,e))},n.convertToKey=function(n,t){var i=0;return i=n,i<<=32,i|t},n.remove=function(n,t,i){var e=r,f=-1,o=n.length,u;if(o>0)for(u=0;u<o;u++)if(n[u].row===t&&n[u].column===i){f=u;break}return f!==-1&&(e=n[f],n.splice(f,1)),e},n.clearFormula=function(n,t,i,r,u){var f=n._getCalcModel();f.clear(t,i,r,u)},n}();i.CopyMoveHelper=u;f=function(){function n(){this.canExecuteChanged=r}return n.prototype.execute=function(n){},n.prototype.canExecute=function(n){return!0},n.prototype.canUndo=function(){return!0},n.prototype.saveState=function(){},n.prototype.undo=function(n){return!0},n.prototype._raiseCanExecuteChanged=function(){var n=this;n.canExecuteChanged&&typeof n.canExecuteChanged=="function"&&n.canExecuteChanged(n)},n.prototype._suspendInvalidate=function(n){n&&n._suspendInvalidate&&n._suspendInvalidate()},n.prototype._resumeInvalidate=function(n){return n&&n._resumeInvalidate?n._resumeInvalidate():!1},n}();i.ActionBase=f;ft=function(n){function t(t,i,r,u){n.call(this);var f=this;f._sheet=t;f._columns=i;f._size=r;f._rowHeader=u;f._oldSizes=[];f._oldVisibles=[]}return __extends(t,n),t.prototype.canExecute=function(n){return!0},t.prototype.execute=function(n){var i=this,t=i._sheet,o=i._columns,b=o&&o.length,k=Number.MAX_VALUE,y,s,d,u,f,e,v,r,nt;if(t&&b>0){if(i._suspendInvalidate(n),y=i._getColumnsReiszed(o),s={sheet:t,sheetName:t._name,colList:y,header:i._rowHeader,cancel:!1},t.triggerColumnWidthChanging(s),s&&s.cancel===!0){i._canUndo=!1;i._resumeInvalidate(n);return}else i._canUndo=!0;i.saveState();d=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();try{var h=2,c=3,p=i._rowHeader,tt=p?t.getColumnCount(h):t.getColumnCount(c),a=t._scrollLeftCol,w=a;for(u=a-1;u>=t.frozenColCount;u--){if(t.getColumnVisible(u)&&t._getZoomColumnWidth(u)>0)break;t.getColumnResizable(u)&&(w=u)}for(f=k,e=i._size,v=0;v<b;v++){var g=o[v],it=g.firstCol,rt=g.lastCol;for(r=it;r<=rt;r++)0<=r&&r<tt&&(p&&t.getColumnResizable(r,h)&&e!==t._getActualColumnWidth(r,h)?t.setColumnWidth(r,e,h):!p&&t.getColumnResizable(r,c)&&e!==t._getActualColumnWidth(r,c)&&t.setColumnWidth(r,e,c),f=l(r,f))}f!==k&&f<=a&&w!==a&&(t._scrollLeftCol=w)}finally{t.resumeEvent();t.isPaintSuspended(d);nt=i._resumeInvalidate(n);nt||(t.invalidateLayout(),t.repaint())}t.triggerColumnWidthChanged({sheet:t,sheetName:t._name,colList:y,header:i._rowHeader});t._syncHScollbarPosition()}},t.prototype.saveState=function(){var r=this,e=[],o=[],u=r._sheet,s=r._columns,h=s&&s.length,n,t;if(u&&h>0){var c=r._rowHeader,y=c?2:3,w=u.getColumnCount(y),b=c?u.defaults.rowHeaderColWidth:u.defaults.colWidth,l=u._sheetModelManager.getColInfos();for(n=0;n<h;n++){var a=s[n],v=a.firstCol,k=a.lastCol,f,d,i;for(e[n]=[],o[n]=[],t=v;t<=k;t++)f=t-v,0<=t&&t<w?(i=l.getActualSize(t),i=isNaN(i)||i===null?b:p(i),e[n][f]=i,o[n][f]=l.getVisible(t)):(e[n][f]=-1,o[n][f]=!1)}}r._oldSizes=e;r._oldVisibles=o},t.prototype.undo=function(n){var r=this,f=!1,t=r._sheet,h=r._columns,p=h&&h.length,y,c,w,u,i,b;if(t&&p>0){if(r._suspendInvalidate(n),y=r._getColumnsReiszed(h),c={sheet:t,sheetName:t._name,colList:y,header:r._rowHeader,cancel:!1},t.triggerColumnWidthChanging(c),c&&c.cancel===!0)return r._resumeInvalidate(n),!1;w=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();try{var l=2,e=3,o=r._rowHeader,k=o?t.getColumnCount(2):t.getColumnCount(e),a,s;for(u=0;u<p;u++){var v=h[u],d=v.firstCol,g=v.lastCol;for(i=d;i<=g;i++)a=r._oldSizes[u][i-v.firstCol],s=r._oldVisibles[u][i-v.firstCol],0<=i&&i<k&&a!==-1&&(o&&t.getColumnResizable(i,l)?(t.setColumnWidth(i,a,l),f=!0):!o&&t.getColumnResizable(i,e)&&(t.setColumnWidth(i,a,e),f=!0),o&&t.getColumnVisible(i,l)!==s?(t.setColumnVisible(i,s,l),f=!0):o||t.getColumnVisible(i,e)===s||(t.setColumnVisible(i,s,e),f=!0))}}finally{t.resumeEvent();t.isPaintSuspended(w);b=r._resumeInvalidate(n);b||(t.invalidateLayout(),t.repaint())}t.triggerColumnWidthChanged({sheet:t,sheetName:t._name,colList:y,header:r._rowHeader})}return f},t.prototype._getColumnsReiszed=function(n){for(var t,r=[],i=0,f=n.length;i<f;i++){var u=n[i],e=u.firstCol,o=u.lastCol;for(t=e;t<=o;t++)r.push(t)}return r},t.prototype.canUndo=function(){return this._canUndo},t}(f);i.ColumnResizeUndoAction=ft;et=function(n){function t(t,i,r,u){n.call(this);var f=this;f._sheet=t;f._rows=i;f._size=r;f._columnHeader=u;f._oldSizes=[];f._oldVisibles=[]}return __extends(t,n),t.prototype.canExecute=function(n){return!0},t.prototype.execute=function(n){var i=this,t=i._sheet,o=i._rows,b=o&&o.length,k=Number.MAX_VALUE,y,s,d,u,f,e,v,r,nt;if(t&&b>0){if(i._suspendInvalidate(n),y=i._getRowsReiszed(o),s={sheet:t,sheetName:t._name,rowList:y,header:i._columnHeader,cancel:!1},t.triggerRowHeightChanging(s),s&&s.cancel===!0){i._canUndo=!1;i._resumeInvalidate(n);return}else i._canUndo=!0;i.saveState();d=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();t.suspendCalcService();try{var h=3,c=1,p=i._columnHeader,tt=p?t.getRowCount(c):t.getRowCount(h),a=t._scrollTopRow,w=a;for(u=a-1;u>=t.frozenRowCount;u--){if(t.getRowVisible(u)&&t._getZoomRowHeight(u)>0)break;t.getRowResizable(u)&&(w=u)}for(f=k,e=i._size,v=0;v<b;v++){var g=o[v],it=g.firstRow,rt=g.lastRow;for(r=it;r<=rt;r++)0<=r&&r<tt&&(p&&t.getRowResizable(r,c)&&e!==t._getActualRowHeight(r,c)?t.setRowHeight(r,e,c):!p&&t.getRowResizable(r,h)&&e!==t._getActualRowHeight(r,h)&&t.setRowHeight(r,e,h),f=l(r,f))}f!==k&&f<=a&&w!==a&&(t._scrollTopRow=w)}finally{t.resumeCalcService(!1);t.resumeEvent();t.isPaintSuspended(d);nt=i._resumeInvalidate(n);nt||(t.invalidateLayout(),t.repaint())}t.triggerRowHeightChanged({sheet:t,sheetName:t._name,rowList:y,header:i._columnHeader});t._syncVScrollbarPosition()}},t.prototype.saveState=function(){var r=this,e=[],o=[],u=r._sheet,s=r._rows,h=s&&s.length,n,t;if(u&&h>0){var c=r._columnHeader,y=c?1:3,w=u.getRowCount(y),b=c?u.defaults.colHeaderRowHeight:u.defaults.rowHeight,l=u._sheetModelManager.getRowInfos();for(n=0;n<h;n++){var a=s[n],v=a.firstRow,k=a.lastRow,f,d,i;for(e[n]=[],o[n]=[],t=v;t<=k;t++)f=t-v,0<=t&&t<w?(i=l.getActualSize(t),i=isNaN(i)||i===null?b:p(i),e[n][f]=i,o[n][f]=l.getVisible(t)):(e[n][f]=-1,o[n][f]=!1)}}r._oldVisibles=o;r._oldSizes=e},t.prototype.undo=function(n){var r=this,f=!1,t=r._sheet,c=r._rows,p=c&&c.length,v,l,w,u,i,k;if(t&&p>0){if(r._suspendInvalidate(n),v=r._getRowsReiszed(c),l={sheet:t,sheetName:t._name,rowList:v,header:r._columnHeader,cancel:!1},t.triggerRowHeightChanging(l),l&&l.cancel===!0)return r._resumeInvalidate(n),!1;w=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();t.suspendCalcService();try{var e=3,o=1,s=r._columnHeader,d=s?t.getRowCount(o):t.getRowCount(e),g=r._oldSizes,nt=r._oldVisibles,a,h;for(u=0;u<p;u++){var b=c[u],y=b.firstRow,tt=b.lastRow;for(i=y;i<=tt;i++)a=g[u][i-y],h=nt[u][i-y],0<=i&&i<d&&a!==-1&&(s&&t.getRowResizable(i,o)?(t.setRowHeight(i,a,o),f=!0):!s&&t.getRowResizable(i,e)&&(t.setRowHeight(i,a,e),f=!0),s&&t.getRowVisible(i,o)!==h?(t.setRowVisible(i,h,o),f=!0):s||t.getRowVisible(i,e)===h||(t.setRowVisible(i,h,e),f=!0))}}finally{t.resumeCalcService(!1);t.resumeEvent();t.isPaintSuspended(w);k=r._resumeInvalidate(n);k||(t.invalidateLayout(),t.repaint())}t.triggerRowHeightChanged({sheet:t,sheetName:t._name,rowList:v,header:r._columnHeader})}return f},t.prototype._getRowsReiszed=function(n){for(var t,r=[],i=0,f=n.length;i<f;i++){var u=n[i],e=u.firstRow,o=u.lastRow;for(t=e;t<=o;t++)r.push(t)}return r},t.prototype.canUndo=function(){return this._canUndo},t}(f);i.RowResizeUndoAction=et;ot=function(n){function i(t,i,r,u){n.call(this);var f=this;f._sheet=t;f._columns=i;f._sheetArea=r?2:3;arguments.length===3&&(u=t._getAutoFitType());f._autofitType=u;f._oldSizes=[];f._oldVisibles=[]}return __extends(i,n),i.prototype.canExecute=function(n){return this._sheet&&this._columns&&this._columns.length>0},i.prototype.execute=function(n){var r=this,i,e,w,a,u,c,f,b;if(r.canExecute(n)){i=r._sheet;e=r._sheetArea;r._suspendInvalidate(n);var v=r._getColumnsReiszed(r._columns),y=e===2,l={sheet:i,sheetName:i._name,colList:v,header:y,cancel:!1};if(i.triggerColumnWidthChanging(l),l&&l.cancel===!0){r._canUndo=!1;r._resumeInvalidate(n);return}else r._canUndo=!0;r.saveState();var p=i.getColumnCount(e),s=p-1,h=0,o;for(u=0,c=r._columns.length;u<c;u++)o=r._columns[u].col,s=s>o?o:s,h=h<o?o:h;t._CacheMgr.startCache(i,0,s,i.getRowCount()-1,h);w=i.isPaintSuspended();i.isPaintSuspended(!0);i.suspendEvent();try{for(u=0,c=r._columns.length;u<c;u++)f=r._columns[u],0<=f.col&&f.col<p&&i.getColumnResizable(f.col,e)&&(a=r._getColumnAutoFitValue(f.col),a!==i.getColumnWidth(f.col,e)&&i.setColumnWidth(f.col,a,e))}finally{t._CacheMgr.clearCache();i.resumeEvent();i.isPaintSuspended(w);b=r._resumeInvalidate(n);b||(i.invalidateLayout(),i.repaint())}i.triggerColumnWidthChanged({sheet:i,sheetName:i._name,colList:v,header:y})}},i.prototype.saveState=function(){var n=this,u=r,f=r,e=n._sheet,o=n._sheetArea,s,t,h,i;if(e&&n._columns&&n._columns.length>0)for(s=e.getColumnCount(o),u=[n._columns.length],f=[n._columns.length],t=0,h=n._columns.length;t<h;t++)i=n._columns[t],0<=i.col&&i.col<s?(u[t]=e.getColumnWidth(i.col,o),f[t]=e.getColumnVisible(i.col,o)):(u[t]=-1,f[t]=!1);n._oldSizes=u;n._oldVisibles=f},i.prototype.undo=function(n){var i=this,c=!1,u=i._sheetArea,o,t,s,f,l,a,h,v,r,e,y;if(i._sheet&&i._columns&&i._columns.length>0){if(o=u===2,t=i._sheet,i._suspendInvalidate(n),s=i._getColumnsReiszed(i._columns),f={sheet:t,sheetName:t._name,colList:s,header:o,cancel:!1},t.triggerColumnWidthChanging(f),f&&f.cancel===!0)return i._resumeInvalidate(n),!1;l=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();try{for(a=t.getColumnCount(u),r=0;r<i._columns.length;r++)e=i._columns[r],h=i._oldSizes[r],v=i._oldVisibles[r],0<=r&&r<a&&h!==-1&&t.getColumnResizable(e.col,u)&&(t.setColumnWidth(e.col,h,u),t.setColumnVisible(e.col,v,u),c=!0)}finally{t.resumeEvent();t.isPaintSuspended(l);y=i._resumeInvalidate(n);y||(t.invalidateLayout(),t.repaint())}t.triggerColumnWidthChanged({sheet:t,sheetName:t._name,colList:s,header:o})}return c},i.prototype._getColumnsReiszed=function(n){for(var r,i=[],t=0;t<n.length;t++)r=n[t],i.push(r.col);return i},i.prototype._getColumnAutoFitValue=function(n){return t.util.getColumnAutoFitValue(n,this._sheet,this._sheetArea,this._autofitType)},i.prototype.canUndo=function(){return this._canUndo},i}(f);i.ColumnAutoFitUndoAction=ot;st=function(n){function i(t,i,r,u){n.call(this);var f=this;f._sheet=t;f._rows=i;f._sheetArea=r?1:3;arguments.length===3&&(u=t._getAutoFitType());f._autofitType=u;f._oldSizes=[];f._oldVisibles=[]}return __extends(i,n),i.prototype.canExecute=function(n){return this._sheet&&this._rows&&this._rows.length>0},i.prototype.execute=function(n){var i=this,t,c,l,o,f,a,r,v;if(i.canExecute(n)){t=i._sheet;i._suspendInvalidate(n);var s=i._getRowsResized(i._rows),u=i._sheetArea,h=i._sheetArea===1,e={sheet:t,sheetName:t._name,rowList:s,header:h,cancel:!1};if(t.triggerRowHeightChanging(e),e&&e.cancel===!0){i._canUndo=!1;i._resumeInvalidate(n);return}else i._canUndo=!0;i.saveState();c=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();t.suspendCalcService();try{for(l=t.getRowCount(u),f=0,a=i._rows.length;f<a;f++)r=i._rows[f],0<=r.row&&r.row<l&&t.getRowResizable(r.row,u)&&(o=i._getRowAutoFitValue(r.row),o!==t.getRowHeight(r.row,u)&&t.setRowHeight(r.row,o,u))}finally{t.resumeCalcService(!1);t.resumeEvent();t.isPaintSuspended(c);v=i._resumeInvalidate(n);v||(t.invalidateLayout(),t.repaint())}t.triggerRowHeightChanged({sheet:t,sheetName:t._name,rowList:s,header:h})}},i.prototype.saveState=function(){var n=this,u=r,f=r,e=n._sheet,o=n._sheetArea,s,t,h,i;if(e&&n._rows&&n._rows.length>0)for(u=[n._rows.length],f=[n._rows.length],s=e.getRowCount(o),t=0,h=n._rows.length;t<h;t++)i=n._rows[t],0<=i.row&&i.row<s?(u[t]=e.getRowHeight(i.row,o),f[t]=e.getRowVisible(i.row,o)):(u[t]=-1,f[t]=!1);n._oldSizes=u;n._oldVisibles=f},i.prototype.undo=function(n){var i=this,h=!1,t=i._sheet,u=i._sheetArea,c=i._sheetArea===1,o,f,l,s,a,v,r,y,e,p;if(t&&i._rows&&i._rows.length>0){if(i._suspendInvalidate(n),o=i._getRowsResized(i._rows),f={sheet:t,sheetName:t._name,rowList:o,header:c,cancel:!1},t.triggerRowHeightChanging(f),f&&f.cancel===!0)return i._resumeInvalidate(n),!1;l=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendEvent();t.suspendCalcService();try{for(v=t.getRowCount(u),r=0,y=i._rows.length;r<y;r++)e=i._rows[r],s=i._oldSizes[r],a=i._oldVisibles[r],0<=r&&r<v&&s!==-1&&t.getRowResizable(e.row,u)&&(t.setRowHeight(e.row,s,u),t.setRowVisible(e.row,a,u),h=!0)}finally{t.resumeCalcService(!1);t.resumeEvent();t.isPaintSuspended(l);p=i._resumeInvalidate(n);p||(t.invalidateLayout(),t.repaint())}t.triggerRowHeightChanged({sheet:t,sheetName:t._name,rowList:o,header:c})}return h},i.prototype._getRowsResized=function(n){for(var r,i=[],t=0,u=n.length;t<u;t++)r=n[t],i.push(r.row);return i},i.prototype._getRowAutoFitValue=function(n){return t.util.getRowAutoFitValue(n,this._sheet,this._sheetArea,this._autofitType)},i.prototype.canUndo=function(){return this._canUndo},i}(f);i.RowAutoFitUndoAction=st;ht=function(){function n(n,t){this.index=n;this.count=t}return n}();i.GroupExtent=ht;ct=function(n){function i(t,i){n.call(this);this._sheet=t;this._columnGroupExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(n){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,u,f,e;t.features.group&&r&&i._columnGroupExtent&&r.colRangeGroup&&(i._suspendInvalidate(n),u=i._columnGroupExtent.index,f=i._columnGroupExtent.count,r.colRangeGroup.group(u,f),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint()),i._canUndo=!0)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,u=!1,r=i._sheet,f,e,o;return t.features.group&&r&&i._columnGroupExtent&&r.colRangeGroup&&(i._suspendInvalidate(n),f=i._columnGroupExtent.index,e=i._columnGroupExtent.count,r.colRangeGroup.ungroupRange(f,e),u=!0,o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),u},i}(f);i.ColumnGroupUndoAction=ct;lt=function(n){function i(t,i){n.call(this);this._sheet=t;this._columnUngroupExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(n){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,u,f,e;t.features.group&&r&&i._columnUngroupExtent&&r.colRangeGroup&&(u=i._columnUngroupExtent.index,f=i._columnUngroupExtent.count,r.colRangeGroup.getLevel(u)>=0||r.colRangeGroup.getLevel(u+f-1)>=0?(i._suspendInvalidate(n),i._canUndo=!0,r.colRangeGroup.ungroupRange(u,f),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint())):i._canUndo=!1)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,u=!1,r=i._sheet,f,e,o;return t.features.group&&i._canUndo===!0&&r&&i._columnUngroupExtent&&r.colRangeGroup&&(i._suspendInvalidate(n),f=i._columnUngroupExtent.index,e=i._columnUngroupExtent.count,r.colRangeGroup.group(f,e),u=!0,o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),u},i}(f);i.ColumnUngroupUndoAction=lt;at=function(n){function i(t,i){n.call(this);this._sheet=t;this._rowGroupExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(n){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,u,f,e;t.features.group&&r&&i._rowGroupExtent&&r.rowRangeGroup&&(i._suspendInvalidate(n),u=i._rowGroupExtent.index,f=i._rowGroupExtent.count,r.rowRangeGroup.group(u,f),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint()),i._canUndo=!0)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,u=!1,r=i._sheet,f,e,o;return t.features.group&&r&&i._rowGroupExtent&&r.rowRangeGroup&&(i._suspendInvalidate(n),f=i._rowGroupExtent.index,e=i._rowGroupExtent.count,r.rowRangeGroup.ungroupRange(f,e),u=!0,o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),u},i}(f);i.RowGroupUndoAction=at;vt=function(n){function i(t,i){n.call(this);this._sheet=t;this._rowUngroupExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(n){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,u,f,e;t.features.group&&r&&i._rowUngroupExtent&&r.rowRangeGroup&&(u=i._rowUngroupExtent.index,f=i._rowUngroupExtent.count,r.rowRangeGroup.getLevel(u)>=0||r.rowRangeGroup.getLevel(u+f-1)>=0?(i._suspendInvalidate(n),i._canUndo=!0,r.rowRangeGroup.ungroupRange(u,f),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint())):i._canUndo=!1)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,u=!1,r=i._sheet,f,e,o;return t.features.group&&i._canUndo===!0&&r&&i._rowUngroupExtent&&r.rowRangeGroup&&(i._suspendInvalidate(n),f=i._rowUngroupExtent.index,e=i._rowUngroupExtent.count,r.rowRangeGroup.group(f,e),u=!0,o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),u},i}(f);i.RowUngroupUndoAction=vt;yt=function(){function n(n,t,i){this.index=n;this.level=t;this.collapsed=i}return n}();i.GroupExpandExtent=yt;pt=function(n){function i(t,i){n.call(this);this._sheet=t;this._columnExpandExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,f,u,e;t.features.group&&r&&i._columnExpandExtent&&r.colRangeGroup&&(i._suspendInvalidate(n),f=i._columnExpandExtent.index,u=i._columnExpandExtent.collapsed,r.colRangeGroup.setCollapsed(f,u),i._showColumnRangeGroup(u),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint()),i._canUndo=!0)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,f=!1,r=i._sheet,e,u,o;return t.features.group&&r&&i._columnExpandExtent&&r.colRangeGroup&&(i._suspendInvalidate(n),e=i._columnExpandExtent.index,u=i._columnExpandExtent.collapsed,r.colRangeGroup.setCollapsed(e,!u),f=!0,i._showColumnRangeGroup(!u),o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),f},i.prototype._showColumnRangeGroup=function(n){var r=this,t=r._sheet,f=r._columnExpandExtent.index,o,u,e,s,i,h,c,a;if(!(f<0)&&!(f>=t.getColumnCount())){if(t.colRangeGroup.direction===1){if(o=t.colRangeGroup.find(f-1,r._columnExpandExtent.level),!o)return;u=o.start;e=f;s=1;n?u=f:u<t.frozenColCount&&(u=t.frozenColCount);i=t.getViewportLeftColumn(s);u<i&&(i=u);h=t.getViewportWidth(s);c=r._getColsTotalWidth(t,i,e);c>h&&(i=r._getNewLeftColumn(t,i,c-h));t._scrollLeftCol=r._tryGetNextScrollableCol(t,i)}else{if(o=t.colRangeGroup.find(f+1,r._columnExpandExtent.level),!o)return;u=f;e=o.end;s=1;n?e=f:(a=t.getColumnCount(),e>=a&&(e=a-1));i=t.getViewportLeftColumn(s);u<i?t._scrollLeftCol=r._tryGetNextScrollableCol(t,u):(h=t.getViewportWidth(s),c=r._getColsTotalWidth(t,i,e),c>h&&(i=r._getNewLeftColumn(t,i,c-h),t._scrollLeftCol=r._tryGetNextScrollableCol(t,l(u,i))))}t._syncHScollbarPosition()}},i.prototype._getColsTotalWidth=function(n,t,i){for(var u=0,f=n.getColumnCount(),r=t;r<=i&&r<f;r++)u+=n.getColumnWidth(r)*n._zoomFactor;return u},i.prototype._getNewLeftColumn=function(n,t,i){for(var f=0,r=n.getColumnCount(),u=t;u<r&&f<i;u++)t++,f+=n.getColumnWidth(u)*n._zoomFactor;return t>=r?r-1:t},i.prototype._tryGetNextScrollableCol=function(n,t){var u=n.frozenColCount,r=n.getColumnCount()-1,i,f;if(t<u)return u;if(t>r)return r;for(i=t;i<=r;i++)if(f=n.getColumnWidth(i),f>0)return i;return-1},i}(f);i.ColumnGroupExpandUndoAction=pt;wt=function(n){function i(t,i){n.call(this);this._sheet=t;this._rowExpandExtent=i;this._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,f,u,e;t.features.group&&r&&i._rowExpandExtent&&r.rowRangeGroup&&(i._suspendInvalidate(n),f=i._rowExpandExtent.index,u=i._rowExpandExtent.collapsed,r.rowRangeGroup.setCollapsed(f,u),i._showRowRangeGroup(u),e=i._resumeInvalidate(n),e||(r.invalidateLayout(),r.repaint()),i._canUndo=!0)},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){},i.prototype.undo=function(n){var i=this,f=!1,r=i._sheet,e,u,o;return t.features.group&&r&&i._rowExpandExtent&&r.rowRangeGroup&&(i._suspendInvalidate(n),e=i._rowExpandExtent.index,u=i._rowExpandExtent.collapsed,r.rowRangeGroup.setCollapsed(e,!u),f=!0,i._showRowRangeGroup(!u),o=i._resumeInvalidate(n),o||(r.invalidateLayout(),r.repaint())),f},i.prototype._showRowRangeGroup=function(n){var r=this,t=r._sheet,f=r._rowExpandExtent.index,o,u,e,s,i,h,c,a;if(!(f<0)&&!(f>=t.getRowCount())){if(t.rowRangeGroup.direction===1){if(o=t.rowRangeGroup.find(f-1,r._rowExpandExtent.level),!o)return;u=o.start;e=f;s=1;n?u=f:u<t.frozenRowCount&&(u=t.frozenRowCount);i=t.getViewportTopRow(s);u<i&&(i=u);h=t.getViewportHeight(s);c=r._getRowsTotalHeight(t,i,e);c>h&&(i=r._getNewTopRow(t,i,c-h));t._scrollTopRow=r._tryGetNextScrollableRow(t,i)}else{if(o=t.rowRangeGroup.find(f+1,r._rowExpandExtent.level),!o)return;u=f;e=o.end;s=1;n?e=f:(a=t.getRowCount(),e>=a&&(e=a-1));i=t.getViewportTopRow(s);u<i?t._scrollTopRow=r._tryGetNextScrollableRow(t,u):(h=t.getViewportHeight(s),c=r._getRowsTotalHeight(t,i,e),c>h&&(i=r._getNewTopRow(t,i,c-h),t._scrollTopRow=r._tryGetNextScrollableRow(t,l(u,i))))}t._syncVScrollbarPosition()}},i.prototype._getRowsTotalHeight=function(n,t,i){for(var u=0,f=n.getRowCount(),r=t;r<=i&&r<f;r++)u+=n.getRowHeight(r)*n._zoomFactor;return u},i.prototype._getNewTopRow=function(n,t,i){for(var f=0,r=n.getRowCount(),u=t;u<=r&&f<i;u++)t++,f+=n.getRowHeight(u)*n._zoomFactor;return t>=r?r-1:t},i.prototype._tryGetNextScrollableRow=function(n,t){var u=n.frozenRowCount,r=n.getRowCount()-1,i,f;if(t<u)return u;if(t>r)return r;for(i=t;i<=r;i++)if(f=n.getRowHeight(i),f>0)return i;return-1},i}(f);i.RowGroupExpandUndoAction=wt;bt=function(){function n(n){this.level=n}return n}();i.GroupHeaderExpandExtent=bt;kt=function(n){function i(t,i){n.call(this);var r=this;r._sheet=t;r._columnGroupHeaderExpandExtent=i;r._oldStatus={};r._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,f,u,e;if(t.features.group&&r&&i._columnGroupHeaderExpandExtent&&r.colRangeGroup){for(i._suspendInvalidate(n),i.saveState(),f=i._columnGroupHeaderExpandExtent.level,u=0;u<f;u++)r.colRangeGroup.expand(u,!0);r.colRangeGroup.expand(f,!1);e=i._resumeInvalidate(n);e||(r.invalidateLayout(),r.repaint());i._canUndo=!0}},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){var u=this,f=r,t=u._sheet,s,e,n,i,h;if(t&&u._columnGroupHeaderExpandExtent&&t.colRangeGroup)for(s=u._columnGroupHeaderExpandExtent.level,f={},e=0;e<=s;e++)for(var o=0,c=t.getColumnCount(),l=t.colRangeGroup.direction;o<c;){if(n=t.colRangeGroup.find(o,e),n){i=-1;switch(l){case 0:i=n.start-1;break;case 1:i=n.end+1;break;default:break}h=n.getState()===1;f[i]||(f[i]=h);o+=n.end-n.start+1}o++}u._oldStatus=f},i.prototype.undo=function(n){var i=this,f=!1,r=i._sheet,u,e;if(t.features.group&&r&&i._oldStatus&&r.colRangeGroup){i._suspendInvalidate(n);for(u in i._oldStatus)u&&(r.colRangeGroup.setCollapsed(u,i._oldStatus[u]),f=!0);e=i._resumeInvalidate(n);e||(r.invalidateLayout(),r.repaint())}return f},i}(f);i.ColumnGroupHeaderExpandUndoAction=kt;dt=function(n){function i(t,i){n.call(this);var r=this;r._sheet=t;r._rowGroupHeaderExpandExtent=i;r._oldStatus={};r._canUndo=!1}return __extends(i,n),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(n){var i=this,r=i._sheet,f,u,e;if(t.features.group&&r&&i._rowGroupHeaderExpandExtent&&r.rowRangeGroup){for(i._suspendInvalidate(n),i.saveState(),f=i._rowGroupHeaderExpandExtent.level,u=0;u<f;u++)r.rowRangeGroup.expand(u,!0);r.rowRangeGroup.expand(f,!1);e=i._resumeInvalidate(n);e||(r.invalidateLayout(),r.repaint());i._canUndo=!0}},i.prototype.canUndo=function(){return this._canUndo},i.prototype.saveState=function(){var u=this,f=r,t=u._sheet,s,e,n,i,h;if(t&&u._rowGroupHeaderExpandExtent&&t.rowRangeGroup)for(s=u._rowGroupHeaderExpandExtent.level,f={},e=0;e<=s;e++)for(var o=0,c=t.getRowCount(),l=t.rowRangeGroup.direction;o<c;){if(n=t.rowRangeGroup.find(o,e),n){i=-1;switch(l){case 0:i=n.start-1;break;case 1:i=n.end+1;break;default:break}h=n.getState()===1;f[i]||(f[i]=h);o+=n.end-n.start+1}o++}u._oldStatus=f},i.prototype.undo=function(n){var i=this,f=!1,r=i._sheet,u,e;if(t.features.group&&r&&i._oldStatus&&r.rowRangeGroup){i._suspendInvalidate(n);for(u in i._oldStatus)u&&(r.rowRangeGroup.setCollapsed(u,i._oldStatus[u]),f=!0);e=i._resumeInvalidate(n);e||(r.invalidateLayout(),r.repaint())}return f},i}(f);i.RowGroupHeaderExpandUndoAction=dt;gt=function(){function n(n,t,i,r,u,f){var e=this;e.fromRow=n;e.fromColumn=t;e.toRow=i;e.toColumn=r;e.rowCount=u;e.columnCount=f}return n}();i.DragDropExtent=gt;ni=function(n){function i(t,i,r,u,f){n.call(this);var e=this;e._sheet=t;e._dragDropExtent=i;e._copy=r;e._insert=u;e._option=f}return __extends(i,n),i.prototype.canExecute=function(n){var u=this,r=u._sheet,i=u._dragDropExtent;return r._isValidRange(i.fromRow,i.fromColumn,i.rowCount,i.columnCount,u._sheet.getRowCount(),u._sheet.getColumnCount())?!u._insert&&!r._isValidRange(i.toRow,i.toColumn,i.rowCount,i.columnCount,u._sheet.getRowCount(),u._sheet.getColumnCount())?!1:!(r.isProtected&&r._isAnyCellInRangeLocked(new t.Range(i.toRow,i.toColumn,i.rowCount,i.columnCount)))&&r._checkArrayFormula(i.toRow,i.toColumn,i.rowCount,i.columnCount)&&!(r.isProtected&&r._isAnyCellInRangeLocked(new t.Range(i.fromRow,i.fromColumn,i.rowCount,i.columnCount)))&&r._checkArrayFormula(i.fromRow,i.fromColumn,i.rowCount,i.columnCount):!1},i.prototype.execute=function(n){var r=this,i=r._sheet,f,s,o,a,v,rt,ut,k,d,y,tt,it,p;if(r.saveState(),r._insert){if(rt=r._dragDropExtent.fromRow,ut=r._dragDropExtent.fromColumn,ut>=0&&rt<0){f=r._dragDropExtent.fromColumn;s=r._dragDropExtent.toColumn;o=r._dragDropExtent.columnCount;k=r._dragDropExtent.toColumn;r._suspendInvalidate(n);y=i.isPaintSuspended();i.isPaintSuspended(!0);try{r._sheet.addColumns(s,o);r._copy?r._sheet.copyTo(-1,s<=f?f+o:f,-1,s,-1,o,r._option):(r._sheet.moveTo(-1,s<=f?f+o:f,-1,s,-1,o,r._option),r._sheet.deleteColumns(s<=f?f+o:f,o),f<s&&(k=s-o));i&&(a=i.getSelections(),i._clearSelectionImp(),i.addSelection(-1,k,i.getRowCount(),o),v=i.getSelections(),i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:a,newSelections:v}),i.triggerSelectionChanged({sheet:i,sheetName:i._name}),i._setActiveCellImp(i._getFirstVisualRow(),k,i.activeRowViewportIndex,i.activeColViewportIndex))}finally{i._dragRect={};i.isPaintSuspended(y);p=r._resumeInvalidate(n);p||(i.invalidateLayout(),i.repaint())}}else if(r._dragDropExtent.fromRow>=0&&r._dragDropExtent.fromColumn<0){f=r._dragDropExtent.fromRow;s=r._dragDropExtent.toRow;o=r._dragDropExtent.rowCount;d=r._dragDropExtent.toRow;r._suspendInvalidate(n);y=i.isPaintSuspended();i.isPaintSuspended(!0);try{r._sheet.addRows(s,o);r._copy?r._sheet.copyTo(s<=f?f+o:f,-1,s,-1,o,-1,r._option):(r._sheet.moveTo(s<=f?f+o:f,-1,s,-1,o,-1,r._option),r._sheet.deleteRows(s<=f?f+o:f,o),f<s&&(d=s-o));i&&(a=i.getSelections(),i._clearSelectionImp(),i.addSelection(d,-1,o,i.getColumnCount()),v=i.getSelections(),i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:a,newSelections:v}),i.triggerSelectionChanged({sheet:i,sheetName:i._name}),i._setActiveCellImp(d,i._getFirstVisualColumn(),i.activeRowViewportIndex,i.activeColViewportIndex))}finally{i._dragRect={};i.isPaintSuspended(y);p=r._resumeInvalidate(n);p||(i.invalidateLayout(),i.repaint())}}}else{var g=r._dragDropExtent.fromRow,nt=r._dragDropExtent.fromColumn,w=r._dragDropExtent.toRow,b=r._dragDropExtent.toColumn,c=r._dragDropExtent.rowCount,l=r._dragDropExtent.columnCount;r._suspendInvalidate(n);y=i.isPaintSuspended();i.isPaintSuspended(!0);try{r._copy?i.copyTo(g,nt,w,b,c,l,r._option):i.moveTo(g,nt,w,b,c,l,r._option);i&&(a=i.getSelections(),i._clearSelectionImp(),i.addSelection(w,b,c,l),v=i.getSelections(),i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:a,newSelections:v}),i.triggerSelectionChanged({sheet:i,sheetName:i._name}),i._setActiveCellImp(e(i._getFirstVisualRow(),w),e(i._getFirstVisualColumn(),b),i.activeRowViewportIndex,i.activeColViewportIndex),tt=r._savedFromViewportCells,!r._copy&&tt&&tt.isValueOrFormulaSaved()&&(r._savedFromAfterPastedChangedCells=new h(r._sheet,new t.Range(g,nt,c,l),r._option),r._savedFromAfterPastedChangedCells.mergeCellsHasDiffData(r._savedFromBeforePastedChangedCells.getCellsHasData()),u.raiseRangeDataChanged(i,g,nt,c,l,r._savedFromAfterPastedChangedCells.getChangedCells(),0,tt.getValues())),it=r._savedToViewportCells,it&&it.isValueOrFormulaSaved()&&(r._savedToAfterPastedChangedCells=new h(r._sheet,new t.Range(w,b,c,l),r._option),r._savedToAfterPastedChangedCells.mergeCellsHasDiffData(r._savedToBeforePastedChangedCells.getCellsHasData()),u.raiseRangeDataChanged(i,w,b,c,l,r._savedToAfterPastedChangedCells.getChangedCells(),0,it.getValues())))}finally{i._dragRect={};i.isPaintSuspended(y);p=r._resumeInvalidate(n);p||(i.invalidateLayout(),i.repaint())}}},i.prototype.saveState=function(){var n=this,w,b,k,d,g,nt,tt,it,rt,e,s,c;n.initSaveState();var f=n._dragDropExtent.fromRow<0?0:n._dragDropExtent.fromRow,l=n._dragDropExtent.fromColumn<0?0:n._dragDropExtent.fromColumn,y=n._dragDropExtent.toRow<0?0:n._dragDropExtent.toRow,p=n._dragDropExtent.toColumn<0?0:n._dragDropExtent.toColumn,i=n._dragDropExtent.fromRow<0?n._sheet.getRowCount():n._dragDropExtent.rowCount,r=n._dragDropExtent.fromColumn<0?n._sheet.getColumnCount():n._dragDropExtent.columnCount;n._insert?n._dragDropExtent.fromColumn>=0&&n._dragDropExtent.fromRow>=0||n._dragDropExtent.fromColumn>=0||n._dragDropExtent.fromRow>=0&&(n._copy||n._sheet._hasTable(y,-1,1,-1)&&(e=new o(i,n._sheet.getColumnCount(2)),s=new a(i),u.saveRowHeaderInfo(n._sheet,e,s,f,n._option),n._savedFromRowHeaderCells=e,n._savedFromRows=s,c=new o(i,r),u.saveViewportInfo(n._sheet,c,f,l,n._option),n._savedFromViewportCells=c)):(n._dragDropExtent.fromRow<0&&(w=new o(n._sheet.getRowCount(1),r),b=new v(r),u.saveColumnHeaderInfo(n._sheet,w,b,p,n._option),n._savedToColumnHeaderCells=w,n._savedToColumns=b,n._copy||(k=new o(n._sheet.getRowCount(1),r),d=new v(r),u.saveColumnHeaderInfo(n._sheet,k,d,l,n._option),n._savedFromColumnHeaderCells=k,n._savedFromColumns=d)),n._dragDropExtent.fromColumn<0&&(g=new o(i,n._sheet.getColumnCount(2)),nt=new a(i),u.saveRowHeaderInfo(n._sheet,g,nt,y,n._option),n._savedToRowHeaderCells=g,n._savedToRows=nt,n._copy||(e=new o(i,n._sheet.getColumnCount(2)),s=new a(i),u.saveRowHeaderInfo(n._sheet,e,s,f,n._option),n._savedFromRowHeaderCells=e,n._savedFromRows=s)),tt=new o(i,r),u.saveViewportInfo(n._sheet,tt,y,p,n._option),n._savedToViewportCells=tt,it=[],u.saveTableInfo(n._sheet,it,new t.Range(y,p,i,r)),n._savedToTables=it,n._copy||(c=new o(i,r),u.saveViewportInfo(n._sheet,c,f,l,n._option),n._savedFromViewportCells=c,rt=[],u.saveTableInfo(n._sheet,rt,new t.Range(f,l,i,r)),n._savedFromTables=rt,n._savedFromBeforePastedChangedCells=new h(n._sheet,new t.Range(f,l,i,r),n._option)),n._savedToBeforePastedChangedCells=new h(n._sheet,new t.Range(y,p,i,r),n._option));n._savedAcitveRowViewportIndex=n._sheet.activeRowViewportIndex;n._savedAcitveColumnViewportIndex=n._sheet.activeColViewportIndex;n._savedActiveRow=n._sheet._activeRowIndex;n._savedActiveColumn=n._sheet._activeColIndex},i.prototype.initSaveState=function(){var n=this;n._savedFromColumnHeaderCells=r;n._savedFromColumns=r;n._savedFromViewportCells=r;n._savedFromRowHeaderCells=r;n._savedFromRows=r;n._savedToColumnHeaderCells=r;n._savedToColumns=r;n._savedToViewportCells=r;n._savedToRowHeaderCells=r;n._savedToRows=r;n._savedAcitveRowViewportIndex=-2;n._savedAcitveColumnViewportIndex=-2;n._savedActiveRow=-1;n._savedActiveColumn=-1},i.prototype.undo=function(n){var i=this,f=i._sheet,s,p,w,o,c,h,rt,ut,nt,g,b,it;if(!f._isValidRange(i._dragDropExtent.fromRow,i._dragDropExtent.fromColumn,i._dragDropExtent.rowCount,i._dragDropExtent.columnCount,i._sheet.getRowCount(),i._sheet.getColumnCount())||!i._insert&&!f._isValidRange(i._dragDropExtent.toRow,i._dragDropExtent.toColumn,i._dragDropExtent.rowCount,i._dragDropExtent.columnCount,i._sheet.getRowCount(),i._sheet.getColumnCount()))return!1;if(s=!1,i._insert){if(!(i._dragDropExtent.fromColumn>=0&&i._dragDropExtent.fromRow>=0))if(i._dragDropExtent.fromColumn>=0){rt=i._dragDropExtent.fromColumn;o=i._dragDropExtent.columnCount;i._suspendInvalidate(n);b=f.isPaintSuspended();f.isPaintSuspended(!0);try{i._copy?i._sheet.deleteColumns(i._dragDropExtent.toColumn,o):(c=i._dragDropExtent.toColumn,h=i._dragDropExtent.fromColumn,i._dragDropExtent.fromColumn<i._dragDropExtent.toColumn?c=i._dragDropExtent.toColumn-o:h=i._dragDropExtent.fromColumn+o,i._sheet.addColumns(h,o),i._sheet.copyTo(-1,h<=c?c+o:c,-1,h,-1,o,i._option),i._sheet.deleteColumns(h<=c?c+o:c,o),c<h&&(rt=h-o));f&&(p=f.getSelections(),f._clearSelectionImp(),f.addSelection(-1,rt,f.getRowCount(),o),w=f.getSelections(),f.triggerSelectionChanging({sheet:f,sheetName:f._name,oldSelections:p,newSelections:w}),f.triggerSelectionChanged({sheet:f,sheetName:f._name}))}finally{f.isPaintSuspended(b);nt=i._resumeInvalidate(n);nt||(f.invalidateLayout(),f.repaint())}s=!0}else if(i._dragDropExtent.fromRow>=0){o=i._dragDropExtent.rowCount;ut=i._dragDropExtent.fromRow;i._suspendInvalidate(n);b=f.isPaintSuspended();f.isPaintSuspended(!0);try{i._copy?i._sheet.deleteRows(i._dragDropExtent.toRow,o):(c=i._dragDropExtent.toRow,h=i._dragDropExtent.fromRow,i._dragDropExtent.fromRow<i._dragDropExtent.toRow?c=i._dragDropExtent.toRow-o:h=i._dragDropExtent.fromRow+o,i._sheet.addRows(h,o),i._savedFromViewportCells&&(u.undoCellsInfo(i._sheet,i._savedFromViewportCells,h,0,3),s=!0),i._savedFromRowHeaderCells&&(u.undoCellsInfo(i._sheet,i._savedFromRowHeaderCells,h,0,2),s=!0),i._savedFromRows&&(u.undoRowsInfo(i._sheet,i._savedFromRows,h),s=!0),s||i._sheet.copyTo(h<=c?c+o:c,-1,h,-1,o,-1,i._option),i._sheet.deleteRows(h<=c?c+o:c,o),c<h&&(ut=h-o));f&&(p=f.getSelections(),f._clearSelectionImp(),f.addSelection(ut,-1,o,f.getColumnCount()),w=f.getSelections(),f.triggerSelectionChanging({sheet:f,sheetName:f._name,oldSelections:p,newSelections:w}),f.triggerSelectionChanged({sheet:f,sheetName:f._name}))}finally{f.isPaintSuspended(b);nt=i._resumeInvalidate(n);nt||(f.invalidateLayout(),f.repaint())}s=!0}}else{var k=i._dragDropExtent.fromRow<0?0:i._dragDropExtent.fromRow,d=i._dragDropExtent.fromColumn<0?0:i._dragDropExtent.fromColumn,l=i._dragDropExtent.toRow<0?0:i._dragDropExtent.toRow,a=i._dragDropExtent.toColumn<0?0:i._dragDropExtent.toColumn,v=i._dragDropExtent.fromRow<0?i._sheet.getRowCount():i._dragDropExtent.rowCount,y=i._dragDropExtent.fromColumn<0?i._sheet.getColumnCount():i._dragDropExtent.columnCount;u.clearFormula(f,l,a,v,y);var ft=r,et=r,tt=i._savedFromViewportCells;!i._copy&&tt&&tt.isValueOrFormulaSaved()&&(et=u.getValues(i._sheet,k,d,v,y));g=i._savedToViewportCells;g&&g.isValueOrFormulaSaved()&&(ft=u.getValues(i._sheet,l,a,v,y));i._suspendInvalidate(n);b=f.isPaintSuspended();f.isPaintSuspended(!0);try{i._savedToTables&&u.undoTableInfo(i._sheet,i._savedToTables,new t.Range(l,a,v,y));i._savedToColumnHeaderCells&&(u.undoCellsInfo(i._sheet,i._savedToColumnHeaderCells,0,a,1),s=!0);i._savedToColumns&&(u.undoColumnsInfo(i._sheet,i._savedToColumns,a),s=!0);g&&(u.undoCellsInfo(i._sheet,g,l,a,3),s=!0);i._savedToRowHeaderCells&&(u.undoCellsInfo(i._sheet,i._savedToRowHeaderCells,l,0,2),s=!0);i._savedToRows&&(u.undoRowsInfo(i._sheet,i._savedToRows,l),s=!0);i._savedFromTables&&u.undoTableInfo(i._sheet,i._savedFromTables,new t.Range(k,d,v,y));i._savedFromColumnHeaderCells&&(u.undoCellsInfo(i._sheet,i._savedFromColumnHeaderCells,0,d,1),s=!0);i._savedFromColumns&&(u.undoColumnsInfo(i._sheet,i._savedFromColumns,d),s=!0);tt&&(u.undoCellsInfo(i._sheet,tt,k,d,3),s=!0);i._savedFromRowHeaderCells&&(u.undoCellsInfo(i._sheet,i._savedFromRowHeaderCells,k,0,2),s=!0);i._savedFromRows&&(u.undoRowsInfo(i._sheet,i._savedFromRows,k),s=!0);s&&f&&(p=f.getSelections(),f._clearSelectionImp(),f.addSelection(i._dragDropExtent.fromRow,i._dragDropExtent.fromColumn,i._dragDropExtent.rowCount,i._dragDropExtent.columnCount),w=f.getSelections(),f.triggerSelectionChanging({sheet:f,sheetName:f._name,oldSelections:p,newSelections:w}),f.triggerSelectionChanged({sheet:f,sheetName:f._name}),ft&&u.raiseRangeDataChanged(f,l,a,v,y,i._savedToAfterPastedChangedCells.getChangedCells(),0,ft),et&&u.raiseRangeDataChanged(f,k,d,v,y,i._savedFromAfterPastedChangedCells.getChangedCells(),0,et))}finally{f.isPaintSuspended(b);i._resumeInvalidate(n)}}return s&&f&&(i._savedActiveRow!==-1&&i._savedActiveColumn!==-1&&(it=f.getSelections()[0],it.contains(i._savedActiveRow,i._savedActiveColumn)?f._setActiveCellImp(i._savedActiveRow,i._savedActiveColumn):f._setActiveCellImp(e(f._getFirstVisualRow(),it.row),e(f._getFirstVisualColumn(),it.col))),i._savedAcitveRowViewportIndex!==-2&&i._savedAcitveColumnViewportIndex!==-2&&i._savedActiveRow!==-1&&i._savedActiveColumn!==-1&&f.showCell(i._savedActiveRow,i._savedActiveColumn,3,3),f.invalidateLayout(),f.repaint()),s},i}(f);i.DragDropUndoAction=ni;ti=function(i){function u(n,t){var r,u;i.call(this);this._oldValueCatch={};this._oldValueIsFormulaCatch={};this._eventNS=".cellEditaction";this._sheet=n;this._cellEditInfo=t;this._canUndo=!1;t.ranges&&t.endEditType===1&&(r=t.ranges[0],r.row===-1&&(r.row=0,r.rowCount=n.getRowCount()),r.col===-1&&(r.col=0,r.colCount=n.getColumnCount()),r.rowCount===1&&r.colCount===1&&(u=n._getsArrayFormulas(r.row,r.col,1,1),u&&u.ranges&&u.ranges.length>0&&(t.ranges=[u.ranges[0]])))}return __extends(u,i),u.prototype.canExecute=function(n){var i=this,u,r;if(i._cellEditInfo.ranges){for(u=0;u<i._cellEditInfo.ranges.length;u++)if((r=i._cellEditInfo.ranges[u],i._sheet.isProtected&&i._sheet._isAnyCellInRangeLocked(r))||!i._sheet._checkArrayFormula(r.row,r.col,r.rowCount,r.colCount))return!1}else if(!i._sheet._checkArrayFormula(i._cellEditInfo.row,i._cellEditInfo.col,1,1)||i._sheet.isProtected&&i._sheet._isAnyCellInRangeLocked(new t.Range(i._cellEditInfo.row,i._cellEditInfo.col,1,1)))return!1;return!0},u.prototype.saveState=function(){var n=this;n.iteration(function(t,i){var r=n._sheet.getFormulaInformation(t,i),u=n._positionToString(t,i);r.hasFormula?r.isArrayFormula&&(r.baseRange.row!==t||r.baseRange.col!==i)?n._oldValueIsFormulaCatch[u]=!1:(n._oldValueCatch[u]=r.formula,n._oldValueIsFormulaCatch[u]=r):n._oldValueCatch[u]=n._sheet.getValue(n._cellEditInfo.row,n._cellEditInfo.col)})},u.prototype.iteration=function(n){var i=this,r,t,u,f;if(i._cellEditInfo.ranges)for(r=0;r<i._cellEditInfo.ranges.length;r++)for(t=i._cellEditInfo.ranges[r],u=t.row;u<t.row+t.rowCount;u++)for(f=t.col;f<t.col+t.colCount;f++)n(u,f);else n(i._cellEditInfo.row,i._cellEditInfo.col)},u.prototype.saveCellState=function(n,t){},u.prototype.undo=function(n){var u=this,i=u._sheet,s=u._cellEditInfo.row,h=u._cellEditInfo.col,o=i._paintSuspended,f,e;try{i._paintSuspended=!0;i._bind(t.Events.CellChanged+u._eventNS,function(n,t){t.propertyName==="value"&&i._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)});u.iteration(function(n,t){var e=u._positionToString(n,t),f=u._oldValueIsFormulaCatch[e],o;if(f===!1)return;else f?f.isArrayFormula?i.setArrayFormula(n,t,f.baseRange.rowCount,f.baseRange.colCount,f.formula):i.setFormula(n,t,u._oldValueCatch[e]):(o=i.getFormula(n,t),o===r||o===""||i.setFormula(n,t,r),i.setValue(n,t,u._oldValueCatch[e]))})}catch(c){return!1}finally{i._unbind(t.Events.CellChanged+u._eventNS);i._paintSuspended=o}return f=i._getSheetLayout(),e=new t.Rect(f.frozenX,f.frozenY,f.width-f.frozenX,f.height-f.frozenY),i.repaint(e),!0},u.prototype.execute=function(n){var i=this,r,f,u,e;i.saveState();r=i._sheet;f=r._paintSuspended;try{r._paintSuspended=!0;r._bind(t.Events.CellChanged+i._eventNS,function(n,t){t.propertyName==="value"&&r._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)});i.applyResult=i._applyEditing(n)}finally{i._sheet._unbind(t.Events.CellChanged+i._eventNS);r._paintSuspended=f}u=r._getSheetLayout();e=new t.Rect(u.frozenX,u.frozenY,u.width-u.frozenX,u.height-u.frozenY);r.repaint(e);i._canUndo=i.applyResult===0},u.prototype._positionToString=function(n,t){return n+"_"+t},u.prototype._stringToPosition=function(n){var t=n.split("_");return{row:parseInt(t[0],10),col:parseInt(t[1],10)}},u.prototype._validateEditingValue=function(){var r=this,o=0,n=r._cellEditInfo.row,t=r._cellEditInfo.col,i=r._sheet,u=r._cellEditInfo.newValue,a=r._cellEditInfo.hasOwnProperty("autoFormat")?r._cellEditInfo.autoFormat:!0,f,e,s,h,c,l;return u&&u.length>0&&u[0]==="="?i.getDataValidator(n,t)&&(f=u.substring(1),f!==""&&f!==i.getFormula(n,t)&&(e=i.getCalcService(),e&&(s=e.parse(i._getSheetSource(),f,n>=0?n:0,t>=0?t:0),s&&(h=e.evaluateParsedFormula(i._getSheetSource(),s,n,t),i.isValid(n,t,h)||(o=i._validationError(n,t,h)))))):(c=r._getValueFromEditing(n,t,u,a),l=i.isValid(n,t,c),l||(o=i._validationError(n,t,u),i._eventHandler._forceCancelSelectiong=!0)),o},u.prototype._applyEditing=function(i){var f=this,u=f._sheet,e=f._cellEditInfo.newValue,l=f._validateEditingValue(),y,k,d,h,c,w,g,a,v,o,b;if(l===1||l===2)return l;if(k=f._cellEditInfo.hasOwnProperty("autoFormat")?f._cellEditInfo.autoFormat:!0,t.util.hasCalc())if(d=u.parent?u.parent.canUserEditFormula():!0,h=f._cellEditInfo.row,h=h>=0?h:0,c=f._cellEditInfo.col,c=c>=0?c:0,w=n.Sheets.Calc.Parser.getParserOption(),g={numberDecimalSeparator:n.Sheets.CR.numberDecimalSeparator,arrayListSeparator:n.Sheets.CR.arrayListSeparator,arrayGroupSeparator:n.Sheets.CR.arrayGroupSeparator,listSeparator:n.Sheets.CR.listSeparator},n.Sheets.Calc.Parser.setParserOption(g),a=u.getCalcService(),d&&a&&e&&e.length>0&&e[0]==="=")try{if(f._cellEditInfo.ranges&&f._cellEditInfo.endEditType===1)return o=f._cellEditInfo.ranges[0],u.setArrayFormula(o.row,o.col,o.rowCount,o.colCount,e.substring(1)),n.Sheets.Calc.Parser.setParserOption(w),l;else v=a.parse(u._getSheetSource(),e.substring(1),h,c)}catch(p){u._raiseInvalidOperation(0,typeof p=="string"?p:p.message);throw p;}else f._cellEditInfo.ranges&&f._cellEditInfo.endEditType===1&&(o=f._cellEditInfo.ranges[0],u.clear(o.row,o.col,o.rowCount,o.colCount,3,1));return v||(b=!1,/^('=)/ig.test(e)&&(e=e.substring(1),b=!0),(y===s||y===r||b)&&(y=f._getValueFromEditing(h,c,e,k))),f.iteration(function(n,t){if(v)try{n==h&&t==c?u.setFormula(n,t,a.unparse(u._getSheetSource(),v,n,t)):u.setFormula(n,t,a.unparseWithoutCulture(u._getSheetSource(),v,n,t));u.triggerUserFormulaEntered({sheet:u,sheetName:u._name,row:n,col:t,formula:e.substring(1).toUpperCase()})}catch(i){u._raiseInvalidOperation(0,typeof i=="string"?i:i.message);throw i;}else{try{u.hasFormula(n,t)&&u.setFormula(n,t,r)}catch(i){u._raiseInvalidOperation(0,typeof i=="string"?i:i.message);throw i;}try{u._setValueInternal(n,t,y)}catch(f){u.setValue(n,t,e)}}}),t.util.hasCalc()&&n.Sheets.Calc.Parser.setParserOption(w),l},u.prototype.canUndo=function(){return this._canUndo},u.prototype._getValueFromEditing=function(n,i,u,f){var o,e,l,a;if(!t.features.formatter)return u;var s=this,v=s._sheet.getActualStyle(n,i),h={},y=t.util.parseText2Value(v,u,f,h),c=h.value;return f&&h.value&&(o=r,f&&c&&(y!==r&&c.FormatString()!=="General"||!v._autoFormatter)&&(o=new t.AutoFormatter(c)),o&&(e=s._sheet.getStyleObject(n,i),l=typeof e=="string",(!e||l)&&(a=new t.Style,l&&(a.parentName=e),e=a),e._autoFormatter=o,s._sheet.setStyle(n,i,e))),y},u}(f);i.CellEditUndoAction=ti;ii=function(n){function t(t,i){n.call(this);this._sheet=t;this._newName=i;this._oldName=r}return __extends(t,n),t.prototype.canUndo=function(){return!!this._oldName},t.prototype.canExecute=function(n){var t=this;return t._sheet&&t._newName&&t._newName!==t._oldName},t.prototype.execute=function(n){var t=this,i=t._sheet;i&&t._newName&&t._newName!==t._oldName&&(t.saveState(),t._suspendInvalidate(n),i.setNameCore(t._newName),t._resumeInvalidate(n),i._refreshTabStrip())},t.prototype.saveState=function(){this._sheet&&(this._oldName=this._sheet._name)},t.prototype.undo=function(n){var t=this,i=t._sheet;return i?(t._suspendInvalidate(n),i.setNameCore(t._oldName),t._resumeInvalidate(n),i._refreshTabStrip(),!0):!1},t}(f);i.SheetRenameUndoAction=ii;ri=function(n){function t(t,i){n.call(this);this._sheet=t;i<.25?i=.25:i>4&&(i=4);this._zoomFactor=i;this._prevZoomFactor=-1}return __extends(t,n),t.prototype.canExecute=function(n){var t=this;return t._sheet&&t._sheet.parent._allowUserZoom&&t._sheet._zoomFactor!==t._zoomFactor},t.prototype.execute=function(n){var i=this,t=i._sheet,r,u;if(i.saveState(),t&&(!t.parent||t.parent._allowUserZoom===!0)&&t._zoomFactor!==i._zoomFactor){if(t.isEditing()===!0&&!t.endEdit())return;i._suspendInvalidate(n);r=t.isPaintSuspended();t.isPaintSuspended(!0);t.zoom(i._zoomFactor);t.isPaintSuspended(r);u=i._resumeInvalidate(n);u||(t.invalidateLayout(),t.repaint())}},t.prototype.canUndo=function(){return this._sheet&&this._prevZoomFactor>0},t.prototype.saveState=function(){this._sheet&&(this._prevZoomFactor=this._sheet._zoomFactor)},t.prototype.undo=function(n){var i=this,t=i._sheet,r,u;return t?(i._suspendInvalidate(n),r=t.isPaintSuspended(),t.isPaintSuspended(!0),t.zoom(i._prevZoomFactor),t.isPaintSuspended(r),u=i._resumeInvalidate(n),u||(t.invalidateLayout(),t.repaint()),!0):!1},t}(f);i.ZoomUndoAction=ri;g=function(){function n(n,t){this.value=n;this.formulaInfo=t}return n}();nt=function(n){function i(t,i){n.call(this);this._cachedFormulaInfos=[];this._eventNS=".clearRangeAction";var u=this;u._sheet=t;u._clearRange=i;u._cachedFilteredColumns=r;u._cachedValues=r;u._cachedTables=r}return __extends(i,n),i.prototype.execute=function(n){var f=this,i,r,e;if(f.saveState(),i=f._sheet,i&&(r=i._getActualRange(f._clearRange),r.colCount>0&&r.rowCount>0))try{i._bind(t.Events.CellChanged+f._eventNS,function(n,t){t.propertyName==="value"&&i._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)});e=i.isPaintSuspended();i.isPaintSuspended(!0);i.suspendEvent();i.clear(r.row,r.col,r.rowCount,r.colCount,3,1);i.resumeEvent();i.isPaintSuspended(e);u.raiseRangeDataChanged(i,r.row,r.col,r.rowCount,r.colCount,f._changedCells.getChangedCells(),2)}finally{f._sheet._unbind(t.Events.CellChanged+f._eventNS)}},i.prototype.canExecute=function(n){var i=this._sheet,t=this._clearRange;return!(i.isProtected===!0&&i._isAnyCellInRangeLocked(t))&&i._checkArrayFormula(t.row,t.col,t.rowCount,t.colCount)},i.prototype.canUndo=function(){return!!this._cachedValues},i.prototype.saveState=function(){var n=this,e=n._sheet,l,w,t,u,o,v,b,a,i,f,y,c,p;if(e){if(n._cachedTables=[],l=e.getTables(),l&&l.length>0)for(f=0;f<l.length;f++)w=l[f],n._clearRange.containsRange(w.range())&&n._cachedTables.push(w);if(n._cachedFilteredColumns=[],t=e.rowFilter(),t&&t.range&&t.isFiltered()&&(u=t.range.row,v=t.range.rowCount,t.filterButtonVisible&&t.filterButtonVisible()&&(u=t.range.row-1,v=t.range.rowCount+1,u<0&&(u=-1,v=-1)),(n._clearRange.row===-1||n._clearRange.row<=u&&u+v<=n._clearRange.row+n._clearRange.rowCount)&&(n._clearRange.col===-1||n._clearRange.col<=t.range.col&&t.range.col+t.range.colCount<=n._clearRange.col+n._clearRange.colCount)))for(o=t.range.col<0?0:t.range.col,b=t.range.colCount<0?e.getColumnCount():t.range.colCount,a=0;a<b;a++)t.isColumnFiltered(o+a)&&n._cachedFilteredColumns.push(o+a);if(i=e._getActualRange(n._clearRange),i.colCount>0&&i.rowCount>0)for(n._cachedValues=[i.row+i.rowCount],f=0;f<i.rowCount;f++)for(n._cachedValues[i.row+f]=[i.col+i.colCount],n._cachedFormulaInfos[i.row+f]=[],y=0;y<i.colCount;y++)u=i.row+f,o=i.col+y,c=e.getFormulaInformation(u,o),c.hasFormula?n._cachedValues[u][o]=c.isArrayFormula&&(c.baseRange.row!==u||c.baseRange.col!==o)?-1:new g(c.formula,c):(p=e.getValue(u,o),p!==s&&p!==r&&(n._cachedValues[u][o]=new g(p,s)));n._changedCells=new h(e,e._getActualRange(n._clearRange),3)}},i.prototype.undo=function(n){var f=this,i=f._sheet,a,e,y,w,o,b,k,d,v,l,p,g;if(i){if(a=!1,f._cachedTables&&f._cachedTables.length>0)for(y=f._cachedTables,w=y.length,e=0;e<w;e++)i._addTableInternal(y[e]);if(o=i._getActualRange(f._clearRange),f._cachedValues&&o.colCount>0&&o.rowCount>0){b=i.isPaintSuspended();i.isPaintSuspended(!0);i.suspendEvent();try{for(i._bind(t.Events.CellChanged+f._eventNS,function(n,t){t.propertyName==="value"&&i._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),k=o.rowCount,d=o.colCount,e=0;e<k;e++)for(v=0;v<d;v++){var s=o.row+e,h=o.col+v,c=f._cachedValues[s][h];if(c===-1)continue;else c?c.formulaInfo?(l=c.formulaInfo,l&&l.isArrayFormula?i.setArrayFormula(s,h,l.baseRange.rowCount,l.baseRange.colCount,l.formula):i.setFormula(s,h,c.value)):(i.setFormula(s,h,r),i.setValue(s,h,c.value)):(i.setFormula(s,h,r),i.setValue(s,h,r))}a=!0}finally{i._unbind(t.Events.CellChanged+f._eventNS);i.resumeEvent();i.isPaintSuspended(b)}}if(a&&u.raiseRangeDataChanged(i,o.row,o.col,o.rowCount,o.colCount,f._changedCells.getChangedCells(),2),p=i.rowFilter(),p&&f._cachedFilteredColumns&&f._cachedFilteredColumns.length>0)for(e=0;e<f._cachedFilteredColumns.length;e++)g=f._cachedFilteredColumns[e],p.filter(g);if(a)return i.repaint(),!0}return!1},i}(f);i.ClearRangeValueUndoAction=nt;tt=function(n){function t(t,i){var u,f;if(n.call(this),this._cachedActions=[],u=this,u._sheet=t,u._cachedActions=r,i&&i.length>0)for(u._cachedActions=[],f=0;f<i.length;f++)u._cachedActions[f]=new nt(t,i[f])}return __extends(t,n),t.prototype.canExecute=function(n){var t,i;if(this._cachedActions){for(t=0;t<this._cachedActions.length;t++)if(i=this._cachedActions[t],!i.canExecute(n))return!1;return!0}return!1},t.prototype.execute=function(n){var t=this,i,r,u;if(t.saveState(),t._cachedActions){for(t._suspendInvalidate(n),i=0;i<t._cachedActions.length;i++)r=t._cachedActions[i],r.execute(n);u=t._resumeInvalidate(n);u||(t._sheet.invalidateLayout(),t._sheet.repaint())}},t.prototype.canUndo=function(){var n,t;if(this._cachedActions){for(n=0;n<this._cachedActions.length;n++)if(t=this._cachedActions[n],!t.canUndo())return!1;return!0}return!1},t.prototype.saveState=function(){var n,t;if(this._cachedActions)for(n=0;n<this._cachedActions.length;n++)t=this._cachedActions[n],t.saveState()},t.prototype.undo=function(n){var t=this,i,r,u,f;if(t._cachedActions){for(i=t._cachedActions.length-1;i>=0;i--)if(r=t._cachedActions[i],t._suspendInvalidate(n),u=r.undo(n),f=t._resumeInvalidate(n),u)f||(t._sheet.invalidateLayout(),t._sheet.repaint());else return!1;return!0}return!1},t}(f);i.ClearValueUndoAction=tt;ui=function(){function n(n,t,i,r){this.startRange=n;this.fillRange=t;this.autoFillType=i;this.fillDirection=r}return n}();i.DragFillExtent=ui;it=function(n){function i(t,i){n.call(this);var r=this;r._workSheet=t;r._dragFillExtent=i;r._dragFillExtent.autoFillType===4?r._clearValueUndoAction=new tt(t,[r._dragFillExtent.fillRange]):r.initWholeFilledRange();r._fillSeries=r._dragFillExtent.fillDirection===0||r._dragFillExtent.fillDirection===1?1:0}return __extends(i,n),i.prototype.canExecute=function(n){var r=this,i=r._workSheet,t=r._dragFillExtent;return i.isProtected&&i._isAnyCellInRangeLocked(t.fillRange)?!1:i._checkArrayFormula(t.fillRange.row,t.fillRange.col,t.fillRange.rowCount,t.fillRange.colCount)?this._dragFillExtent.autoFillType===4?this.canExecuteDragClear():this.canExecuteDragFill():!1},i.prototype.canExecuteDragClear=function(){return!0},i.prototype.canExecuteDragFill=function(){var n=this._dragFillExtent.startRange,t=this._dragFillExtent.fillRange;return!t.intersect(n.row,n.col,n.rowCount,n.colCount)},i.prototype.execute=function(n){var i=this,e,r,o;if(i.canExecute(n)){var t=i._workSheet,s=t.getSelections(),f=!1;try{i._suspendInvalidate(t);t.suspendCalcService();t.suspendEvent();i.saveState();e=t.isPaintSuspended();t.isPaintSuspended(!0);i._dragFillExtent.autoFillType===4?i.executeDragFillClear(t):i.executeDragFill(t)}finally{t.isPaintSuspended(e);t.resumeCalcService();t.resumeEvent();r=i._dragFillExtent.fillRange;i._savedAfterFilledChangedCells=new h(i._workSheet,r,1023);i._savedAfterFilledChangedCells.mergeCellsHasDiffData(i._savedBeforeFillChangedCells.getCellsHasData());u.raiseRangeDataChanged(t,r.row,r.col,r.rowCount,r.colCount,i._savedAfterFilledChangedCells.getChangedCells(),1,i._savedFilledViewportCells.getValues());o=t.getSelections();t._raiseSelectionChanging(s,o)&&t._raiseSelectionChanged();f=i._resumeInvalidate(t)}f||(t.invalidateLayout(),t.repaint())}},i.prototype.executeDragFillClear=function(n){var u=this,r,f,i;u._clearValueUndoAction.execute(n);r=u._dragFillExtent.startRange;f=u._dragFillExtent.fillRange;r.equals(f)||(u._fillSeries===0?(i=new t.Range(r.row,r.col,e(1,r.rowCount-f.rowCount),r.colCount),n._setActiveCellImp(e(n._getFirstVisualRow(),i.row),e(n._getFirstVisualColumn(),i.col),n.activeRowViewportIndex,n.activeColViewportIndex),n._clearSelectionImp(),n.addSelection(i.row,i.col,i.rowCount,i.colCount)):(i=new t.Range(r.row,r.col,r.rowCount,e(1,r.colCount-f.colCount)),n._setActiveCellImp(e(n._getFirstVisualRow(),i.row),e(n._getFirstVisualColumn(),i.col),n.activeRowViewportIndex,n.activeColViewportIndex),n._clearSelectionImp(),n.addSelection(i.row,i.col,i.rowCount,i.colCount)))},i.prototype.executeDragFill=function(n){var i=this,c=i._workSheet,f=i._dragFillExtent.startRange,l=i._dragFillExtent.fillRange,s,h,v,y,p,o,a;if(i._dragFillExtent.autoFillType===1)c.fillAuto(f,i._wholeFillRange,i._fillSeries);else if(i._dragFillExtent.autoFillType===0)v=1019,i.copyCells(f,l,v);else if(i._dragFillExtent.autoFillType===2)i.copyCells(f,l,64);else if(i._dragFillExtent.autoFillType===3)if(y=f.rowCount===1&&f.colCount===1&&!(f.row===-1&&f.col!==-1)&&!(f.col===-1&&f.row!==-1),y)p=187,i.copyCells(f,l,p);else{for(o=i.adjustRange(i._wholeFillRange),a=new t._GcSheetModel(o.rowCount,o.colCount,r),s=0;s<o.rowCount;s++)for(h=0;h<o.colCount;h++)a.setStyle(s,h,u.getStyleObject(i._workSheet,o.row+s,o.col+h,3));for(c.fillAuto(f,i._wholeFillRange,i._fillSeries),s=0;s<o.rowCount;s++)for(h=0;h<o.colCount;h++)u.setStyleObject(i._workSheet,o.row+s,o.col+h,3,a.getStyle(s,h))}c._setActiveCellImp(e(n._getFirstVisualRow(),i._wholeFillRange.row),e(n._getFirstVisualColumn(),i._wholeFillRange.col),n.activeRowViewportIndex,n.activeColViewportIndex);n._selectionModel&&n._clearSelectionImp();c.addSelection(i._wholeFillRange.row,i._wholeFillRange.col,i._wholeFillRange.rowCount,i._wholeFillRange.colCount)},i.prototype.clearData=function(n,t){var i=1;this._workSheet.clearCore(n.row,n.col,n.rowCount,n.colCount,3,i,t)},i.prototype.adjustRange=function(n){var i=n.row!==-1?n.row:0,r=n.col!==-1?n.col:0,u=n.rowCount!==-1?n.rowCount:this._workSheet.getRowCount(),f=n.colCount!==-1?n.colCount:this._workSheet.getColumnCount();return new t.Range(i,r,u,f)},i.prototype.copyCells=function(n,t,i){var f=this,w=f._workSheet,r=f.adjustRange(n),u=f.adjustRange(t),e,h,c,o,s,b,l,a,v,k,g,y,nt,d,tt,it;if(f._fillSeries===0){for(v=p(u.rowCount/r.rowCount),e=0;e<v;e++)h=r.row,c=r.col,f._dragFillExtent.fillDirection===3?o=u.row+e*r.rowCount:(b=u.row+u.rowCount,o=b-(e+1)*r.rowCount),s=u.col,l=r.rowCount,a=r.colCount,w.copyToCore(h,c,o,s,l,a,i,!0);k=u.rowCount%r.rowCount;k!==0&&(f._dragFillExtent.fillDirection===3?h=r.row:(g=r.rowCount-(u.rowCount-r.rowCount*v),h=r.row+g),c=r.col,f._dragFillExtent.fillDirection===3?o=u.row+r.rowCount*v:(b=u.row+u.rowCount,o=b-v*r.rowCount-k),s=u.col,l=k,a=r.colCount,w.copyToCore(h,c,o,s,l,a,i,!0))}else{for(y=p(u.colCount/r.colCount),e=0;e<y;e++)h=r.row,c=r.col,o=u.row,f._dragFillExtent.fillDirection===1?s=u.col+e*r.colCount:(nt=u.col+u.colCount,s=nt-(e+1)*r.colCount),l=r.rowCount,a=r.colCount,w.copyToCore(h,c,o,s,l,a,i,!0);d=u.colCount%r.colCount;d!==0&&(h=r.row,f._dragFillExtent.fillDirection===1?c=r.col:(tt=r.colCount-(u.colCount-r.colCount*y),c=r.col+tt),o=u.row,f._dragFillExtent.fillDirection===1?s=u.col+r.colCount*y:(it=u.col+u.colCount,s=it-y*r.colCount-d),l=r.rowCount,a=d,w.copyToCore(h,c,o,s,l,a,i,!0))}},i.prototype.saveState=function(){var n=this;n._dragFillExtent.autoFillType===4?n.saveDragClearState():n.saveDragFillState();n._savedBeforeFillChangedCells=new h(n._workSheet,n._dragFillExtent.fillRange,1023);n._savedFilledViewportCells=n.saveRangeStates(n._dragFillExtent.fillRange)},i.prototype.saveDragClearState=function(){this._clearValueUndoAction.saveState()},i.prototype.saveDragFillState=function(){this._savedStartViewportCells=this.saveRangeStates(this._dragFillExtent.startRange)},i.prototype.saveRangeStates=function(n){var t=this.adjustRange(n),i=new o(t.rowCount,t.colCount);return u.saveViewportInfo(this._workSheet,i,t.row,t.col,1023),i},i.prototype.undo=function(n){var i=this,t=i._workSheet,r=!1,u=!1,f;try{i._suspendInvalidate(t);t.suspendCalcService();f=t.isPaintSuspended();t.isPaintSuspended(!0);r=i._undo(t)}finally{t.isPaintSuspended(f);t.resumeCalcService();u=i._resumeInvalidate(t)}return u||(t.invalidateLayout(),t.repaint()),r},i.prototype._undo=function(n){var i=this,r,e=n.getSelections(),t=i._dragFillExtent.fillRange,o=u.getValues(i._workSheet,t.row,t.col,t.rowCount,t.colCount),f;return r=i._dragFillExtent.autoFillType===4?i.undoDragClear(n):i.undoDragFill(n),n._skipCloseDragFillSmartTag!==!0&&n._closeDragFillPopup(),u.raiseRangeDataChanged(n,t.row,t.col,t.rowCount,t.colCount,i._savedAfterFilledChangedCells.getChangedCells(),1,o),f=n.getSelections(),n._raiseSelectionChanging(e,f)&&n._raiseSelectionChanged(),r},i.prototype.undoDragClear=function(n){var t=this,i=t._clearValueUndoAction.undo(n);return n._setActiveCellImp(e(n._getFirstVisualRow(),t._dragFillExtent.startRange.row),e(n._getFirstVisualColumn(),t._dragFillExtent.startRange.col),n.activeRowViewportIndex,n.activeColViewportIndex),n._clearSelectionImp(),n.addSelection(t._dragFillExtent.startRange.row,t._dragFillExtent.startRange.col,t._dragFillExtent.startRange.rowCount,t._dragFillExtent.startRange.colCount),i},i.prototype.undoDragFill=function(n){var t=this;t._suspendInvalidate(n);n.suspendCalcService();try{t.undoRangeStates(t._savedFilledViewportCells,t._dragFillExtent.fillRange);t.undoRangeStates(t._savedStartViewportCells,t._dragFillExtent.startRange);n._setActiveCellImp(e(n._getFirstVisualRow(),t._dragFillExtent.startRange.row),e(n._getFirstVisualColumn(),t._dragFillExtent.startRange.col),n.activeRowViewportIndex,n.activeColViewportIndex);n._clearSelectionImp();n.addSelection(t._dragFillExtent.startRange.row,t._dragFillExtent.startRange.col,t._dragFillExtent.startRange.rowCount,t._dragFillExtent.startRange.colCount)}finally{n.resumeCalcService(!1);t._resumeInvalidate(n)}return n.invalidateLayout(),!0},i.prototype.undoRangeStates=function(n,t){var i=this.adjustRange(t);u.undoCellsInfo(this._workSheet,n,i.row,i.col,3)},i.prototype.initWholeFilledRange=function(){var i=this,f=0,e=0,o=0,s=0,r=i._dragFillExtent.fillDirection,n=i._dragFillExtent.startRange,u=i._dragFillExtent.fillRange;r===0||r===1?(f=n.row,e=n.rowCount,o=r===0?u.col:n.col,s=n.colCount+u.colCount):(f=r===2?u.row:n.row,e=n.rowCount+u.rowCount,o=n.col,s=n.colCount);i._wholeFillRange=new t.Range(f,o,e,s)},i}(f);i.DragFillUndoAction=it;fi=function(n){function f(t,i,r){n.call(this);this._sheet=t;this._fillRange=r;this._fillType=i}return __extends(f,n),f.prototype.execute=function(n){var t=this,i=t._sheet,l,f,s,r,a;t._suspendInvalidate(i);t.saveState();l=i.isPaintSuspended();i.isPaintSuspended(!0);try{f=t.adjustRange(t._fillRange);s=new o(f.rowCount,f.colCount);u.saveViewportInfo(t._sheet,s,f.row,f.col,1023);t._savedFilledViewportCells=s;var c=i._eventHandler,e={sheet:i,sheetName:i._name,fillRange:t._fillRange,autoFillType:t._fillType,fillDirection:c.getCurrentFillDirection()},v=i._raiseDragFillBlock(e);c._currentDragFillType=e.autoFillType;c._isCancelDragFill=v;t.executeDragFillAction(n,e);i._raiseDragFillBlockCompleted(e)}finally{i.isPaintSuspended(l);r=t._fillRange;t._savedAfterFilledChangedCells=new h(i,r,1023);t._savedAfterFilledChangedCells.mergeCellsHasDiffData(t._savedBeforeFillChangedCells.getCellsHasData());u.raiseRangeDataChanged(i,r.row,r.col,r.rowCount,r.colCount,t._savedAfterFilledChangedCells.getChangedCells(),1,t._savedFilledViewportCells.getValues())}a=t._resumeInvalidate(i);a||t.refreshUI(n)},f.prototype.executeDragFillAction=function(n,t){var r=this._sheet,u=r._eventHandler,e=this._fillRange,o=this._fillType,f;if(u._currentDragFillType=o,f=r._getActualRange(e),u._preFillCellsInfo=new i.CopyMoveCellsInfo(f.rowCount,f.colCount),i.CopyMoveHelper.saveViewportInfo(r,u._preFillCellsInfo,f.row,f.col,1023),!u._isCancelDragFill){var h=t.autoFillType===5?o:t.autoFillType,c={startRange:u._dragFillStartRange,fillRange:e,autoFillType:h,fillDirection:u.getCurrentFillDirection()},s=new it(r,c);r.suspendEvent();s.execute(n);r.resumeEvent();this._dragFillUndoAction=s}},f.prototype.canExecute=function(n){return!0},f.prototype.canUndo=function(){return!0},f.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},f.prototype.adjustRange=function(n){var i=n.row!==-1?n.row:0,r=n.col!==-1?n.col:0,u=n.rowCount!==-1?n.rowCount:this._sheet.getRowCount(),f=n.colCount!==-1?n.colCount:this._sheet.getColumnCount();return new t.Range(i,r,u,f)},f.prototype.saveState=function(){var n=this;n._savedBeforeFillChangedCells=new h(n._sheet,n._fillRange,1023)},f.prototype.undo=function(n){var t=this,f=t._sheet,o=!0,s,e,i,c;t._suspendInvalidate(f);f.suspendEvent();t.saveState();s=f.isPaintSuspended();f.isPaintSuspended(!0);e=r;try{i=t._fillRange;e=u.getValues(t._sheet,i.row,i.col,i.rowCount,i.colCount);o=t._dragFillUndoAction.undo(n)}finally{f.isPaintSuspended(s);f.resumeEvent();t._savedAfterFilledChangedCells=new h(f,i,1023);t._savedAfterFilledChangedCells.mergeCellsHasDiffData(t._savedBeforeFillChangedCells.getCellsHasData());u.raiseRangeDataChanged(f,i.row,i.col,i.rowCount,i.colCount,t._savedAfterFilledChangedCells.getChangedCells(),1,e);c=t._resumeInvalidate(f);c||t.refreshUI(n)}return o},f}(f);i.FillUndoAction=fi;ei=function(){function n(n,t,i,r){this.sourceRange=n;this.targetRange=t;this.isCutting=i;this.clipboardText=r}return n}();i.PasteRangeExtent=ei;rt=function(n){function i(t,i,r,u,f){n.call(this);var e=this;e._sheet=t;e._fromSheet=i;e._toSheet=r;e._pasteExtent=u;e._pasteOption=f}return __extends(i,n),i.prototype.canUndo=function(){return!0},i.prototype.canExecute=function(n){var t=this._sheet,i=this._pasteExtent.targetRange,r=this._pasteExtent.sourceRange;return!(t.isProtected&&t._isAnyCellInRangeLocked(i))&&t._checkArrayFormula(i.row,i.col,i.rowCount,i.colCount)&&(!this._pasteExtent.isCutting||!(t.isProtected&&t._isAnyCellInRangeLocked(r))&&t._checkArrayFormula(r.row,r.col,r.rowCount,r.colCount))},i.prototype.saveState=function(){var n=this,k,d,g,nt,tt,it,rt,et,ot,st,ht,ct,lt,at;n.initSaveState();var vt=n._pasteExtent.isCutting,e=i.convertPasteOption(n._pasteOption),r=n._pasteExtent.sourceRange,f=n._pasteExtent.targetRange;if(n._fromSheet&&r&&vt){var p=r.row<0?0:r.row,b=r.col<0?0:r.col,s=r.row<0?n._fromSheet.getRowCount():r.rowCount,c=r.col<0?n._fromSheet.getColumnCount():r.colCount;r.row<0&&r.col<0&&f.row<0&&f.col<0&&n._fromSheet._name!==n._toSheet._name&&(k=new w,u.saveSheetInfo(n._fromSheet,k,e),n._savedFromSheetInfo=k);r.row<0&&(d=new o(n._fromSheet.getRowCount(1),c),g=new v(c),u.saveColumnHeaderInfo(n._fromSheet,d,g,b,e),n._savedFromColumnHeaderCells=d,n._savedFromColumns=g);r.col<0&&(nt=new o(s,n._fromSheet.getColumnCount(2)),tt=new a(s),u.saveRowHeaderInfo(n._fromSheet,nt,tt,p,e),n._savedFromRowHeaderCells=nt,n._savedFromRows=tt);it=new o(s,c);u.saveViewportInfo(n._fromSheet,it,p,b,e);n._savedFromViewportCells=it;rt=[];u.saveTableInfo(n._sheet,rt,new t.Range(p,b,s,c));n._savedFromTables=rt;n._savedFromBeforePastedChangedCells=new h(n._fromSheet,r,e)}var ut=f.row<0?0:f.row,ft=f.col<0?0:f.col,l=f.row<0?n._toSheet.getRowCount():f.rowCount,y=f.col<0?n._toSheet.getColumnCount():f.colCount;n._fromSheet&&r&&(r.row<0&&r.col<0&&f.row<0&&f.col<0&&n._fromSheet._name!==n._toSheet._name&&(et=new w,u.saveSheetInfo(n._toSheet,et,e),n._savedToSheetInfo=et),r.row<0&&(ot=new o(n._toSheet.getRowCount(1),y),st=new v(y),u.saveColumnHeaderInfo(n._toSheet,ot,st,ft,e),n._savedToColumnHeaderCells=ot,n._savedToColumns=st),r.col<0&&(ht=new o(l,n._toSheet.getColumnCount(2)),ct=new a(l),u.saveRowHeaderInfo(n._toSheet,ht,ct,ut,e),n._savedToRowHeaderCells=ht,n._savedToRows=ct));lt=new o(l,y);u.saveViewportInfo(n._toSheet,lt,ut,ft,e);n._savedToViewportCells=lt;at=[];u.saveTableInfo(n._sheet,at,new t.Range(ut,ft,l,y));n._savedToTables=at;n._savedToBeforePastedChangedCells=new h(n._toSheet,f,e)},i.prototype.initSaveState=function(){var n=this;n._savedFromSheetInfo=r;n._savedFromColumnHeaderCells=r;n._savedFromColumns=r;n._savedFromViewportCells=r;n._savedFromRowHeaderCells=r;n._savedFromRows=r;n._savedToSheetInfo=r;n._savedToColumnHeaderCells=r;n._savedToColumns=r;n._savedToViewportCells=r;n._savedToRowHeaderCells=r;n._savedToRows=r},i.prototype.pasteOption=function(){return this._pasteOption},i.prototype.pasteRange=function(){return this._pasteExtent.targetRange},i.prototype.execute=function(n){var r=this,e=r._fromSheet,o=r._toSheet,f=r._pasteExtent.sourceRange,s=r._pasteExtent.targetRange,v,c,a,l;if((!e||!f||e._isValidRange(f.row,f.col,f.rowCount,f.colCount,e.getRowCount(),e.getColumnCount()))&&o&&s&&o._isValidRange(s.row,s.col,s.rowCount,s.colCount,o.getRowCount(),o.getColumnCount())){r.saveState();r._suspendInvalidate(n);o.suspendEvent();e&&e.suspendEvent();try{f&&t._CacheMgr.startCache(e,f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1);o._clipboardPaste(e,f,o,s,r._pasteExtent.isCutting,r._pasteExtent.clipboardText,r._pasteOption)}finally{o.resumeEvent();e&&e.resumeEvent();r._resumeInvalidate(n);v=r._sheet;v&&(c=r._savedFromViewportCells,r._pasteExtent.isCutting&&c&&e&&c.isValueOrFormulaSaved()&&(l=i.convertPasteOption(r._pasteOption),r._savedFromAfterPastedChangedCells=new h(e,f,l),r._savedFromAfterPastedChangedCells.mergeCellsHasDiffData(r._savedFromBeforePastedChangedCells.getCellsHasData()),u.raiseRangeDataChanged(e,f.row,f.col,f.rowCount,f.colCount,r._savedFromAfterPastedChangedCells.getChangedCells(),3,c.getValues())),a=r._savedToViewportCells,a&&o&&a.isValueOrFormulaSaved()&&(l=i.convertPasteOption(r._pasteOption),r._savedToAfterPastedChangedCells=new h(o,s,l),r._savedToAfterPastedChangedCells.mergeCellsHasDiffData(r._savedToBeforePastedChangedCells.getCellsHasData()),u.raiseRangeDataChanged(o,s.row,s.col,s.rowCount,s.colCount,r._savedToAfterPastedChangedCells.getChangedCells(),3,a.getValues())));f&&t._CacheMgr.clearCache()}}},i.prototype.undo=function(n){var i=this,f=i._pasteExtent.sourceRange,o=i._pasteExtent.targetRange,e,a,v,g;if(!i._toSheet||!o||!i._toSheet._isValidRange(o.row,o.col,o.rowCount,o.colCount,i._toSheet.getRowCount(),i._toSheet.getColumnCount())||i._fromSheet&&f&&(!i._fromSheet._isValidRange(f.row,f.col,f.rowCount,f.colCount,i._fromSheet.getRowCount(),i._fromSheet.getColumnCount())||i._fromSheet&&i._fromSheet._name===i._toSheet._name&&i._toSheet.parent&&!t.ArrayHelper.contains(i._toSheet.parent.sheets,i._fromSheet)))return!1;i._suspendInvalidate(n);e=!1;try{var k=r,d=r,s=o.row<0?0:o.row,h=o.col<0?0:o.col,y=o.row<0?i._toSheet.getRowCount():o.rowCount,p=o.col<0?i._toSheet.getColumnCount():o.colCount;u.clearFormula(i._toSheet,s,h,y,p);i._savedToTables&&u.undoTableInfo(i._sheet,i._savedToTables,new t.Range(s,h,y,p));i._savedToSheetInfo&&(u.undoSheetInfo(i._toSheet,i._savedToSheetInfo),e=!0);a=i._savedToViewportCells;a&&a.isValueOrFormulaSaved()&&(k=u.getValues(i._toSheet,s,h,y,p));i._savedToColumnHeaderCells&&(u.undoCellsInfo(i._toSheet,i._savedToColumnHeaderCells,0,h,1),e=!0);i._savedToColumns&&(u.undoColumnsInfo(i._toSheet,i._savedToColumns,h),e=!0);a&&(u.undoCellsInfo(i._toSheet,a,s,h,3),e=!0);i._savedToRowHeaderCells&&(u.undoCellsInfo(i._toSheet,i._savedToRowHeaderCells,s,0,2),e=!0);i._savedToRows&&(u.undoRowsInfo(i._toSheet,i._savedToRows,s),e=!0);var c=0,l=0,w=0,b=0;i._fromSheet&&f&&(c=f.row<0?0:f.row,l=f.col<0?0:f.col,w=f.row<0?i._fromSheet.getRowCount():f.rowCount,b=f.col<0?i._fromSheet.getColumnCount():f.colCount,i._savedFromTables&&u.undoTableInfo(i._sheet,i._savedFromTables,new t.Range(c,l,w,b)),v=i._savedFromViewportCells,v&&v.isValueOrFormulaSaved()&&(d=u.getValues(i._fromSheet,c,l,w,b)),i._savedFromColumnHeaderCells&&(u.undoCellsInfo(i._fromSheet,i._savedFromColumnHeaderCells,0,l,1),e=!0),i._savedFromColumns&&(u.undoColumnsInfo(i._fromSheet,i._savedFromColumns,l),e=!0),v&&(u.undoCellsInfo(i._fromSheet,v,c,l,3),e=!0),i._savedFromRowHeaderCells&&(u.undoCellsInfo(i._fromSheet,i._savedFromRowHeaderCells,c,0,2),e=!0),i._savedFromRows&&(u.undoRowsInfo(i._fromSheet,i._savedFromRows,c),e=!0));g=n;e&&g&&(k&&i._toSheet&&u.raiseRangeDataChanged(i._toSheet,s,h,y,p,i._savedToAfterPastedChangedCells.getChangedCells(),3,k),d&&i._fromSheet&&u.raiseRangeDataChanged(i._fromSheet,c,l,w,b,i._savedFromAfterPastedChangedCells.getChangedCells(),3,d))}finally{i._resumeInvalidate(n)}return e},i.convertPasteOption=function(n){var t=0;return(n===0||n===1)&&(t|=1),(n===0||n===2)&&(t|=64),(n===0||n===3)&&(t|=2),n===0&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128),t},i}(f);i.ClipboardPasteRangeUndoAction=rt;oi=function(){function n(n,t,i,r){this.fromRange=n;this.pastedRanges=t;this.isCutting=i;this.clipboardText=r}return n}();i.PasteExtent=oi;si=function(n){function i(i,r,u,f,e){var o,s;if(n.call(this),this._sheet=i,!u)throw new Error(t.SR.Exp_DestSheetIsNull);if(!f)throw new Error(t.SR.Exp_PasteExtentIsNull);if(f.pastedRanges&&f.pastedRanges.length>0)for(this._cachedActions=[],o=0;o<f.pastedRanges.length;o++)s={sourceRange:f.fromRange,targetRange:f.pastedRanges[o],isCutting:f.isCutting,clipboardText:f.clipboardText},this._cachedActions[o]=new rt(i,r,u,s,e)}return __extends(i,n),i.prototype.execute=function(n){var i=this,t,f,u,r,e,o;if(i._cachedActions){t=i._sheet;i._suspendInvalidate(t);f=t.isPaintSuspended();t.isPaintSuspended(!0);try{for(u=0;u<i._cachedActions.length;u++)r=i._cachedActions[u],t?(e=t._raiseClipboardPasting(r.pasteRange(),r.pasteOption()),e||(r.execute(n),t._raiseClipboardPasted(r.pasteRange(),r.pasteOption()))):r.execute(n);i.refreshSelection(n)}finally{t.isPaintSuspended(f);o=i._resumeInvalidate(t);o||i.refreshUI(n)}}},i.prototype.refreshSelection=function(n){var r=this,t=r._sheet,o,f,s,u,i;if(t&&r._cachedActions){if(o=t.getSelections(),t._clearSelectionImp(),r._cachedActions.length>1)for(f=0;f<r._cachedActions.length;f++)s=r._cachedActions[f],u=s.pasteRange(),t.addSelection(u.row,u.col,u.rowCount,u.colCount);else r._cachedActions.length>0&&(i=r._cachedActions[0].pasteRange(),t.addSelection(i.row,i.col,i.rowCount,i.colCount),i.contains(t._activeRowIndex,t._activeColIndex)||t._setActiveCellImp(e(t._getFirstVisualRow(),i.row),e(t._getFirstVisualColumn(),i.col),t.activeRowViewportIndex,t.activeColViewportIndex));t._raiseSelectionChanging(o,t.getSelections())&&t._raiseSelectionChanged()}},i.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},i.prototype.canExecute=function(n){var t,i;if(this._cachedActions){for(t=0;t<this._cachedActions.length;t++)if(i=this._cachedActions[t],!i.canExecute(n))return!1;return!0}return!1},i.prototype.canUndo=function(){var n,t;if(this._cachedActions){for(n=0;n<this._cachedActions.length;n++)if(t=this._cachedActions[n],!t.canUndo())return!1;return!0}return!1},i.prototype.saveState=function(){var n,t;if(this._cachedActions)for(n=0;n<this._cachedActions.length;n++)t=this._cachedActions[n],t.saveState()},i.prototype.undo=function(n){var t=this,i,r,f,u,e,o;if(t._cachedActions){i=t._sheet;r=!0;t._suspendInvalidate(i);f=i.isPaintSuspended();i.isPaintSuspended(!0);try{for(u=0;u<t._cachedActions.length;u++)e=t._cachedActions[u],r=r&&e.undo(n)}finally{i.isPaintSuspended(f);o=t._resumeInvalidate(i);o||t.refreshUI(n)}return r}return!1},i}(f);i.ClipboardPasteUndoAction=si;hi=function(){function n(n){this.names=n}return n}();i.FloatingObjectExtent=hi;y=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.init=function(n,t){this._sheet=n;this._floatingObjectExtent=t;this._savedFloatingObjects=[]},t.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(n){return this._sheet._hasFloatingObjectsSelected()?!0:!1},t.prototype.canUndo=function(){return this._savedFloatingObjects&&this._savedFloatingObjects.length>0?!0:!1},t.prototype.saveState=function(){var n=this,t,r,i;if(n._floatingObjectExtent&&n._floatingObjectExtent.names instanceof Array)for(t=0,r=n._floatingObjectExtent.names.length;t<r;t++)i=n._sheet._findFloatingObjectInternal(n._floatingObjectExtent.names[t]),i&&n._savedFloatingObjects.push(i)},t}(f);i.FloatingObjectUndoActionBase=y;ci=function(n){function i(t,i){n.call(this);this.init(t,i)}return __extends(i,n),i.prototype.execute=function(n){var i=this,r,o,u,h,f,e,c,l;if(t.features.floatingObject&&i._floatingObjectExtent&&i._floatingObjectExtent.names instanceof Array){for(i.saveState(),r=i._sheet,i._suspendInvalidate(n),o=r.isPaintSuspended(),r.isPaintSuspended(!0),u=0,h=i._floatingObjectExtent.names.length;u<h;u++)f=r._findFloatingObjectInternal(i._floatingObjectExtent.names[u]),f&&(e=r._slicerCollection,i._isSlicer(f)&&e&&e.removeSlicer(f),c=r._removeFloatingObjectInternal(i._floatingObjectExtent.names[u]),c||(i._savedFloatingObjects[u]=s),f.isSelected(!1));r._loadAndSetSheetSelections();r.isPaintSuspended(o);l=i._resumeInvalidate(n);l||i.refreshUI(n)}},i.prototype.undo=function(n){var i=this,r,o,f,s,u,e,h;if(t.features.floatingObject&&i._savedFloatingObjects&&i._savedFloatingObjects.length>0){for(r=i._sheet,i._suspendInvalidate(n),o=r.isPaintSuspended(),r.isPaintSuspended(!0),f=0,s=i._savedFloatingObjects.length;f<s;f++)u=i._savedFloatingObjects[f],u&&(u.isSelected(!0),r._addFloatingOjectInternal(u),e=r._slicerCollection,i._isSlicer(u)&&e&&e.addSlicer(u));return r._saveAndClearSheetSelections(),i._savedFloatingObjects.length=0,r.isPaintSuspended(o),h=i._resumeInvalidate(n),h||i.refreshUI(n),!0}return!1},i.prototype._isSlicer=function(n){return n&&n.typeName==="Slicer"},i}(y);i.DeleteFloatingObjectUndoAction=ci;li=function(){function n(n,t){this.offsetX=n;this.offsetY=t}return n}();i.MovingFloatingObjectExtent=li;ai=function(n){function i(t,i,r){n.call(this);this.init(t,i);this._movingSettings=r}return __extends(i,n),i.prototype.execute=function(n){var i=this,r,o,u,s,f,e,h;if(t.features.floatingObject&&i._floatingObjectExtent&&i._floatingObjectExtent.names instanceof Array){for(i.saveState(),r=i._sheet,i._suspendInvalidate(n),o=r.isPaintSuspended(),r.isPaintSuspended(!0),u=0,s=i._floatingObjectExtent.names.length;u<s;u++)f=r._findFloatingObjectInternal(i._floatingObjectExtent.names[u]),e=f.position(),f.position(new t.Point(e.x+i._movingSettings.offsetX,e.y+i._movingSettings.offsetY));r.isPaintSuspended(o);h=i._resumeInvalidate(n);h||i.refreshUI(n)}},i.prototype.undo=function(n){var i=this,r,o,u,s,f,e,h;if(t.features.floatingObject&&i._savedFloatingObjects&&i._savedFloatingObjects.length>0){for(r=i._sheet,i._suspendInvalidate(n),o=r.isPaintSuspended(),r.isPaintSuspended(!0),u=0,s=i._savedFloatingObjects.length;u<s;u++)f=i._savedFloatingObjects[u],e=f.position(),f.position(new t.Point(e.x-i._movingSettings.offsetX,e.y-i._movingSettings.offsetY));return i._savedFloatingObjects.length=0,r.isPaintSuspended(o),h=i._resumeInvalidate(n),h||i.refreshUI(n),!0}return!1},i}(y);i.MovingFloatingObjectUndoAction=ai;vi=function(){function n(n,t,i,r){this.offsetX=n;this.offsetY=t;this.offsetWidth=i;this.offsetHeight=r}return n}();i.ReszingFloatingObjectExtent=vi;yi=function(n){function i(t,i,r){n.call(this);this.init(t,i);this._resizingSettings=r}return __extends(i,n),i.prototype.execute=function(n){var i=this,u,o,f,s,r,e,h;if(t.features.floatingObject&&i._floatingObjectExtent&&i._floatingObjectExtent.names instanceof Array){for(i.saveState(),u=i._sheet,i._suspendInvalidate(n),o=u.isPaintSuspended(),u.isPaintSuspended(!0),f=0,s=i._floatingObjectExtent.names.length;f<s;f++)r=u._findFloatingObjectInternal(i._floatingObjectExtent.names[f]),e=r.position(),r.width(r.width()+i._resizingSettings.offsetWidth),r.height(r.height()+i._resizingSettings.offsetHeight),r.position(new t.Point(e.x+i._resizingSettings.offsetX,e.y+i._resizingSettings.offsetY));u.isPaintSuspended(o);h=i._resumeInvalidate(n);h||i.refreshUI(n)}},i.prototype.undo=function(n){var i=this,u,o,f,s,r,e,h;if(t.features.floatingObject&&i._savedFloatingObjects&&i._savedFloatingObjects.length>0){for(u=i._sheet,i._suspendInvalidate(n),o=u.isPaintSuspended(),u.isPaintSuspended(!0),f=0,s=i._savedFloatingObjects.length;f<s;f++)r=i._savedFloatingObjects[f],e=r.position(),r.position(new t.Point(e.x-i._resizingSettings.offsetX,e.y-i._resizingSettings.offsetY)),r.width(r.width()-i._resizingSettings.offsetWidth),r.height(r.height()-i._resizingSettings.offsetHeight);return i._savedFloatingObjects.length=0,u.isPaintSuspended(o),h=i._resumeInvalidate(n),h||i.refreshUI(n),!0}return!1},i}(y);i.ResizingFloatingObjectUndoAction=yi;b=function(n){function t(){n.call(this);this._sheet=r;this._floatingObjectExtent=r;this._savedObjects=r}return __extends(t,n),t.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(n){var i=this,t=i._floatingObjectExtent;return t&&t.names&&t.names.length>0&&i._canEditObjects(t.names)?!0:!1},t.prototype.canUndo=function(){return this._savedObjects&&this._savedObjects.length>0?!0:!1},t.prototype._canEditObjects=function(n){for(var i,u=this,r=u._sheet,t=0,f=n.length;t<f;t++)if(i=r._findFloatingObjectInternal(n[t]),i&&!r.canEditFloatingObject(i))return!1;return!0},t.prototype._generateFloatingObjectName=function(){for(var i="FloatingObject",n=this._sheet._floatingObjectArray.length+1,t=i+n;this._sheet._findFloatingObjectInternal(t)!==r;)n++,t=i+n;return t},t.prototype._isSlicer=function(n){return n&&n.typeName==="Slicer"},t}(f);i.FloatingObjectCopyPasteUndoAction=b;pi=function(n){function i(t,i,u){n.call(this);this._sheet=r;this._fromSheet=r;this._floatingObjectExtent=r;this._savedObjects=r;this.OFFSET=15;var f=this;f._sheet=t;f._fromSheet=u;f._floatingObjectExtent=i;f._savedObjects=[];f._activeRowIndex=f._sheet.getActiveRowIndex();f._activeColumnIndex=f._sheet.getActiveColumnIndex()}return __extends(i,n),i.prototype.execute=function(n){var r=this,u,a,et,tt,v,y,c,o,b,k,it,rt,ut,f,ht,ft,d,ct,lt;if(t.features.floatingObject&&r._floatingObjectExtent&&r._floatingObjectExtent.names&&r._floatingObjectExtent.names.length>0){u=r._sheet;a=r._fromSheet._eventHandler;r._suspendInvalidate(n);et=u.isPaintSuspended();u.isPaintSuspended(!0);for(var s=r._floatingObjectExtent.names,ot=[],h=Number.MAX_VALUE,g=h,nt=h,i=0,e=s.length;i<e;i++)o=a._getClipboardFloatingObjectData().findByPropertyName(s[i]).position(),g=l(g,o.x),nt=l(nt,o.y);for(tt=[],i=0,e=s.length;i<e;i++)o=a._getClipboardFloatingObjectData().findByPropertyName(s[i]).position(),tt.push(new t.Point(o.x-g,o.y-nt));if(v=0,y=0,u._hasFloatingObjectsSelected()){var p=h,w=h,st=u._floatingObjectArray;for(i=0,e=st.length;i<e;i++)c=st[i],c&&c.isSelected()&&(o=c.position(),p=l(p,o.x),w=l(w,o.y),c.isSelected(!1));v=p<h?p+r.OFFSET:0;y=w<h?w+r.OFFSET:0}else{for(b=0;b<r._activeRowIndex;b++)y+=u._getActualRowHeight(b,3);for(k=0;k<r._activeColumnIndex;k++)v+=u._getActualColumnWidth(k,3)}for(i=0,e=s.length;i<e;i++)it=tt[i],ot.push(new t.Point(v+it.x,y+it.y));for(rt=u._getFloatingObjectClipboardHelper(),ut=rt&&rt.isCutting,i=0,e=s.length;i<e;i++)ft=a._getClipboardFloatingObjectData().findByPropertyName(s[i]),ut?(f=ft,f.owner(u)):(f=ft.clone(u),ht=r._generateFloatingObjectName()),f.isVisible(!0),f.position(ot[i]),f.isSelected(!0),r._isSlicer(f)?(d=f,ut||(ct=u._slicerCollection.getAutoSlicerName(d.name()),d.name(ct)),u._slicerCollection.addSlicer(d)):f.name(ht),u._addFloatingOjectInternal(f),r._savedObjects.push(f);u.isPaintSuspended(et);lt=r._resumeInvalidate(n);lt||r.refreshUI(n)}},i.prototype.undo=function(n){var i=this,r,o,u,s,f,e,h;if(t.features.floatingObject&&i._savedObjects&&i._savedObjects.length>0){for(r=i._sheet,i._suspendInvalidate(n),o=r.isPaintSuspended(),r.isPaintSuspended(!0),u=0,s=i._savedObjects.length;u<s;u++)f=i._savedObjects[u],e=r._slicerCollection,i._isSlicer(f)&&e&&e.removeSlicer(e.getSlicer(f.name())),r._removeFloatingObjectInternal(f.name());return i._savedObjects.length=0,r.isPaintSuspended(o),h=i._resumeInvalidate(n),h||i.refreshUI(n),!0}return!1},i}(b);i.ClipboardPasteFloatingObjectUndoAction=pi;wi=function(n){function i(t,i,u){n.call(this);this._sheet=r;this._floatingObjectExtent=r;this._savedObjects=r;this._movingInfo=r;var f=this;f._sheet=t;f._floatingObjectExtent=i;f._savedObjects=[];f._movingInfo=u}return __extends(i,n),i.prototype.execute=function(n){var i=this,r,h,e,c,f,u,s,o,l,a;if(t.features.floatingObject&&i._floatingObjectExtent&&i._floatingObjectExtent.names&&i._floatingObjectExtent.names.length>0&&i._movingInfo){for(r=i._sheet,i._suspendInvalidate(n),h=r.isPaintSuspended(),r.isPaintSuspended(!0),e=0,c=i._floatingObjectExtent.names.length;e<c;e++)f=r._findFloatingObjectInternal(i._floatingObjectExtent.names[e]),f&&(u=f.clone(r),s=f.position(),u.position(new t.Point(s.x+i._movingInfo.offsetX,s.y+i._movingInfo.offsetY)),u.name(i._generateFloatingObjectName()),u.isSelected(!0),f.isSelected(!1),i._isSlicer(u)&&r._slicerCollection&&(o=u,l=r._slicerCollection.getAutoSlicerName(o.columnName()),o.name(l),r._slicerCollection.addSlicer(o)),r._addFloatingOjectInternal(u),i._savedObjects.push(u));r.isPaintSuspended(h);a=i._resumeInvalidate(n);a||i.refreshUI(n)}},i.prototype.undo=function(n){var i=this,r,f,u,e,c;if(t.features.floatingObject&&i._savedObjects&&i._savedObjects.length>0){for(r=i._sheet,i._suspendInvalidate(n),f=r.isPaintSuspended(),r.isPaintSuspended(!0),u=0,e=i._savedObjects.length;u<e;u++){var o=i._savedObjects[u].name(),s=r._slicerCollection,h=r._findFloatingObjectInternal(o);i._isSlicer(h)&&s&&s.removeSlicer(h);r._removeFloatingObjectInternal(o)}return i._savedObjects.length=0,r.isPaintSuspended(f),c=i._resumeInvalidate(n),c||i.refreshUI(n),!0}return!1},i}(b);i.DragCopyFloatingObjectUndoAction=wi;k=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.init=function(n,t){this._sheet=n;this._comment=t},t.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(n){return!0},t.prototype.canUndo=function(){return this._savedComment?!0:!1},t.prototype.saveState=function(){this._savedComment=this._comment},t.prototype.clearState=function(){this._savedComment=s},t}(f);i.CommentUndoActionBase=k;bi=function(n){function t(t,i){n.call(this);this.init(t,i)}return __extends(t,n),t.prototype.execute=function(n){var i=this,t,e,o;i.saveState();t=i._sheet;i._suspendInvalidate(n);e=t.isPaintSuspended();t.isPaintSuspended(!0);var u=i._comment,s=t._commentManager,f={sheet:t,sheetName:t.getName(),comment:u,cancel:!1};t.triggerCommentRemoving(f);f&&f.cancel===!0?i.clearState():(t.setComment(u._rowIndex,u._colIndex,r),s._activeComment=r,t._loadAndSetSheetSelections(),t.triggerCommentRemoved({sheet:t,sheetName:t.getName(),comment:u}));t.isPaintSuspended(e);o=i._resumeInvalidate(n);o||i.refreshUI(n)},t.prototype.undo=function(n){var t=this,i,r,u;return t._savedComment?(i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),i.setComment(t._savedComment._rowIndex,t._savedComment._colIndex,t._savedComment),i._saveAndClearSheetSelections(),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n),!0):!1},t}(k);i.CommentDeleteUndoAction=bi;ki=function(n){function t(t,i,r,u,f){n.call(this);var e=this;e.init(t,i);e._oldValue=r;e._newValue=u;e._propertyName=f}return __extends(t,n),t.prototype.execute=function(n){var t=this,i,r,u;t._comment&&(t.saveState(),i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._comment._changeProperty(t._propertyName,t._newValue),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n))},t.prototype.undo=function(n){var t=this,i,r,u;return t._savedComment?(i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._comment._changeProperty(t._propertyName,t._oldValue),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n),!0):!1},t}(k);i.CommentPropertyUndoAction=ki;di=function(n){function t(){n.call(this);this._commentUndoTransaction=[]}return __extends(t,n),t.prototype.execute=function(n){var t=this,i,r;if(t._commentUndoTransaction&&t._commentUndoTransaction.length>0)for(i=0;i<t._commentUndoTransaction.length;i++)r=t._commentUndoTransaction[i],r&&r.execute(n)},t.prototype.undo=function(n){var t=this,i,r;if(t._commentUndoTransaction&&t._commentUndoTransaction.length>0){for(i=0;i<t._commentUndoTransaction.length;i++)r=t._commentUndoTransaction[i],r&&r.undo(n);return!0}return!1},t.prototype.add=function(n){this._commentUndoTransaction.push(n)},t}(f);i.CommentUndoTransaction=di;d=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.init=function(n,t){this._sheet=n;this._slicerData=t},t.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(n){return!0},t.prototype.canUndo=function(){return this._slicerData?!0:!1},t.prototype.saveState=function(){this._savedSlicerData=this._slicerData},t}(f);i.SlicerDataUndoActionBase=d;gi=function(n){function t(t,i,r,u,f){n.call(this);var e=this;e.init(t,i);e._columnName=r;e._oldValue=u;e._newValue=f}return __extends(t,n),t.prototype.execute=function(n){var t=this,i,r,u;t._slicerData&&(t.saveState(),i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicerData.doFilter(t._columnName,{exclusiveRowIndexes:t._newValue}),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n))},t.prototype.undo=function(n){var t=this,i,r,u;return t._slicerData?(i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicerData.doFilter(t._columnName,{exclusiveRowIndexes:t._oldValue}),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n),!0):!1},t}(d);i.SlicerDataFilterUndoAction=gi;nr=function(n){function t(t,i,r,u){n.call(this);var f=this;f.init(t,i);f._columnName=r;f._value=u}return __extends(t,n),t.prototype.execute=function(n){var t=this,i,r,u;t._slicerData&&(t.saveState(),i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicerData.doUnfilter(t._columnName),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n))},t.prototype.undo=function(n){var t=this,i,r,u;return t._slicerData?(i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicerData.doFilter(t._columnName,{exclusiveRowIndexes:t._value}),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n),!0):!1},t}(d);i.SlicerDataUnFilterUndoAction=nr;ut=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.init=function(n,t){this._sheet=n;this._slicer=t},t.prototype.refreshUI=function(n){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(n){return!0},t.prototype.canUndo=function(){return this._slicer?!0:!1},t.prototype.saveState=function(){this._savedSlicer=this._slicer},t}(f);i.SlicerUndoActionBase=ut;tr=function(n){function t(t,i,r,u,f){n.call(this);var e=this;e.init(t,i);e._oldValue=u;e._newValue=f;e._propertyName=r}return __extends(t,n),t.prototype.execute=function(n){var t=this,i,r,u;t._slicer&&(t.saveState(),i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicer[t._propertyName](t._newValue),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n))},t.prototype.undo=function(n){var t=this,i,r,u;return t._savedSlicer?(i=t._sheet,t._suspendInvalidate(n),r=i.isPaintSuspended(),i.isPaintSuspended(!0),t._slicer[t._propertyName](t._oldValue),i.isPaintSuspended(r),u=t._resumeInvalidate(n),u||t.refreshUI(n),!0):!1},t}(ut);i.SlicerPropertyUndoAction=tr})(t.UndoRedo||(t.UndoRedo={}));var i=t.UndoRedo})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){var vt;t.feature("core.sheet_event",["core.common","core.sheet_action","core.stringResource"]);var i=null,e=undefined,f=Math.max,r=Math.min,o=Math.abs,ot=Math.ceil,k="undefined",s="position",h="absolute",y="border",yt="border-radius",rt="padding",ut="box-shadow",d="font",g="background-color",p="overflow",c="top",l="left",nt="z-index",st="outline",tt="width",it="height",ht="resize",b="hidden",ct="visible",w="auto",ft="white",a="none",et="tabindex",lt="size",v="gcUIElement",u=window.document,at=function(){function at(n){this.RESIZETOOLTIP_TOP=30;this.DRAGDROPTOOLTIP_OFFSET=5;this.DRAGFILLTOOLTIP_OFFSET=3;this.VSCROLLTOOLTIP_LEFT=100;this.HSCROLLTOOLTIP_LEFT=30;this.HSCROLLTOOLTIP_TOP=40;this._clipboardFloatingObjectData=i;this._repeatKeyDownTimeoutID=0;this.waittime=100;this.newLeft=0;this.newTop=0;this._focusReleased=!1;this._init(n)}return at.prototype._init=function(n){this._sheet=n;this._elem=i;this._eventSuspended=0},at.prototype._getElem=function(){return this._elem||(this._elem=u.createElement("input")),this._elem},at.prototype._dispose=function(){var n=this;n._hScrollTimer&&n._hScrollTimer._dispose();n._vScrollTimer&&n._vScrollTimer._dispose();n.mousePosition=i},at.prototype._getHScrollTimer=function(){var n=this;return n._hScrollTimer||(n._hScrollTimer=new t.Timer(n)),n._hScrollTimer},at.prototype._getVScrollTimer=function(){var n=this;return n._vScrollTimer||(n._vScrollTimer=new t.Timer(n)),n._vScrollTimer},at.prototype.doResize=function(){var i=this._sheet,n=i._getCanvas(),o,s,y,p,r,u,l;if(n&&n.parentNode){var v=getComputedStyle(n.parentNode),h=v.width,c=v.height,e=h.indexOf("px");(e>0&&(h=h.substring(0,e)),e=c.indexOf("px"),e>0&&(c=c.substring(0,e)),o=parseInt(h),s=parseInt(c),isNaN(o)&&(o=t.GC$(n.parentNode).width()),isNaN(s)&&(s=t.GC$(n.parentNode).height()),o!==0&&s!==0)&&(y=0,p=0,n.style.display=a,r=f(o-y,0),u=f(s-p,0),n.style.display="",n.width=r,n.height=u,n.style.width=r+"px",n.style.height=u+"px",r=n.clientWidth||n.width,u=n.clientHeight||n.height,l=i.getBounds(),i.setBounds(new t.Rect(l.x,l.y,r,u)),t.DPIHelper.setSize(n,r,u),i._paintSuspended||(i.invalidateLayout(),i.repaint()))}},at.prototype._getCanvasOffset=function(){var i=this._sheet,n=t.GC$(i._getCanvas()).offset();return n?(isNaN(u.body.clientTop)||(n.top+=u.body.clientTop),isNaN(u.body.clientLeft)||(n.left+=u.body.clientLeft)):n={top:0,left:0},window.gcGlobal.canvasOffset&&(n=window.gcGlobal.canvasOffset),n},at.prototype._getCanvasPosition=function(){var i=this._sheet,n=t.GC$(i._getCanvas()).position();return n||(n={top:0,left:0}),n},at.prototype.doMouseDown=function(n){var t,i,r,u;return n.button===2?!0:(t=this,i=t._sheet,i.inCanvas||t.handleDocumentMouseMove(),r=t._getCanvasOffset(),u=t.doMouseDownImp(n,n.pageX-r.left,n.pageY-r.top),i.isEditing()||u||t.setFocus(),i._isMouseDownInSheet=!0,!1)},at.prototype.handleDocumentMouseMove=function(){var n=this;n._isMouseCapture||(t.GC$(u).bind("mousemove.gcSheet",function(t){n.doMouseMove(t)}).bind("mouseup.gcSheet",function(t){n.doMouseUp(t)}),n._isMouseCapture=!0)},at.prototype.unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,t.GC$(u).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},at.prototype.doMouseDownImp=function(n,r,u){var s=this,f=s._sheet,o=f.hitTest(r,u),h=o.row,c=o.col,rt=o.groupHitInfo,v=o.dragInfo,y=o.filterButtonHitInfo,a=o.formulaRangeHitInfo,l=o.cellTypeHitInfo,g,nt,w,b,k,ut,d,et,tt,it;if(typeof f.unSelectAllFloatingObjects=="function"&&f.unSelectAllFloatingObjects(),g=f._commentManager,g&&g.deactivateComment(),rt)f.isEditing()||s._doClickRangeGroup(rt);else if(f._currentTarget=o,s.isMouseDown=!0,o.resizeInfo){if(!f.endEdit())return;s.startResizing(o)}else if(v&&v.side&&v.side!=="corner"){if(!f.endEdit())return;s.startDragDropping(o)}else if(v&&v.side==="corner"){if(!f.endEdit())return;s.startDragFill(o)}else if(y){if(!f.endEdit())return;if(!y||!y.rowFilter)return;y.rowFilter.openFilterDialog(y)}else if(a)a.inBorder?s.startFormulaRangeMoving(o):(a.inTopLeft||a.inTopRight||a.inBottomLeft||a.inBottomRight)&&s.startFormulaRangeResizing(o);else if(f.canSelect(o.rowViewportIndex<0?-1:h,o.colViewportIndex<0?-1:c)){if(nt=f._formulaTextBox,nt&&nt.canAppendRange()){s.startFormulaRangeAppending(o);return}else if(s._clearFormulaTextbox(f))return;if(w=f.getActiveRowIndex(),b=f.getActiveColumnIndex(),l){if(k=l.sheetArea,(k===i||k===e||k===3)&&(h!==w||c!==b)){ut=f.isPaintSuspended();f.isPaintSuspended(!0);try{if(!f.endEdit())return;if(d={sheet:f,sheetName:f._name,row:w,col:b,cancel:!1},f.triggerLeaveCell(d),d&&d.cancel===!0)return;var ot=f._selectionModel.toArray(),ft=null,p=f._getSpanModel().find(h,c);ft=p?[new t.Range(p.row,p.col,p.rowCount,p.colCount)]:[new t.Range(h,c,1,1)];f.triggerSelectionChanging({sheet:f,sheetName:f._name,oldSelections:ot,newSelections:ft});f._setActiveCellAndSelection(h,c,e,e,1);f.triggerEnterCell({sheet:f,sheetName:f._name,row:h,col:c});f.triggerSelectionChanged({sheet:f,sheetName:f._name});s._updateValidationUI(h,c)}finally{f.isPaintSuspended(ut)}}et=f.getCellType(h,c,o.hitTestType);l.sheet||(l.sheet=f);et.processMouseDown(l)}if(l&&l.isReservedLocation)return!0;else{s.setMetaKeyState(n);try{if(s._hitTestResult=o,f.isEditing()&&w===f.getActiveRowIndex()&&b===f.getActiveColumnIndex()&&!f.endEdit())return}finally{s._hitTestResult=i}if(h===e||h===i||c===e||c===i)return;o.hitTestType===3&&s._updateValidationUI(h,c);tt=f._selectionModel.toArray();s.startSelecting(o);it=f._selectionModel.toArray();s._notEqualSelecions(tt,it)&&f.triggerSelectionChanging({sheet:f,sheetName:f._name,oldSelections:tt,newSelections:it})}}},at.prototype._clearFormulaTextbox=function(n){var e=!1,r=t.features.formulatextbox&&t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,u,f;if(r&&r.dom)if(u=r.sheet,f=n._formulaTextBox,f&&u.setFormula(r.rowIndex,r.columnIndex,f.text()),u!==n){if(t.SpreadActions.changeSheetForFormulaTextboxAcrossSheet(u),!u.endEdit())return;e=!0}else f&&(f.destroy(),n._formulaTextBox=i),r.clear();return e},at.prototype._doClickRangeGroup=function(n){var i=this._sheet,r,e,u,o,f,s,h,c;i&&n&&t.features.group&&(r=n.info,n.what==="rgh"?i&&!i.isEditing()&&(e=r.index,u={sheet:i,sheetName:i._name,isRowGroup:!0,index:-1,level:e,cancel:!1},i.triggerRangeGroupStateChanging(u),u&&u.cancel===!1&&(o=new t.UndoRedo.RowGroupHeaderExpandUndoAction(i,{level:e}),i._doCommand(o),i.triggerRangeGroupStateChanged({sheet:i,sheetName:i._name,isRowGroup:!0,index:-1,level:e}))):n.what==="cgh"?i.isEditing()||(e=r.index,u={sheet:i,sheetName:i._name,isRowGroup:!1,index:-1,level:e,cancel:!1},i.triggerRangeGroupStateChanging(u),u&&u.cancel===!1&&(o=new t.UndoRedo.ColumnGroupHeaderExpandUndoAction(i,{level:e}),i._doCommand(o),i.triggerRangeGroupStateChanged({sheet:i,sheetName:i._name,isRowGroup:!1,index:-1,level:e}))):n.what==="rg"?i.rowRangeGroup&&(f=r.index,s=r.isExpanded,r.lineDirection===1?f--:f++,u={sheet:i,sheetName:i._name,isRowGroup:!0,index:f,level:r.level,cancel:!1},i.triggerRangeGroupStateChanging(u),u&&u.cancel===!1&&(h=new t.UndoRedo.RowGroupExpandUndoAction(i,{index:r.index,level:r.level,collapsed:s}),i._doCommand(h),i.triggerRangeGroupStateChanged({sheet:i,sheetName:i._name,isRowGroup:!0,index:f,level:r.level}))):n.what==="cg"&&i.colRangeGroup&&(f=r.index,s=r.isExpanded,r.lineDirection===1?f--:f++,u={sheet:i,sheetName:i._name,isRowGroup:!1,index:f,level:r.level,cancel:!1},i.triggerRangeGroupStateChanging(u),u&&u.cancel===!1&&(c=new t.UndoRedo.ColumnGroupExpandUndoAction(i,{index:r.index,level:r.level,collapsed:s}),i._doCommand(c),i.triggerRangeGroupStateChanged({sheet:i,sheetName:i._name,isRowGroup:!1,index:f,level:r.level}))))},at.prototype._isInvalidRect=function(n){var r=this._sheet,t;return r?(t=r._getSheetLayout(),n.x===i||n.x===e||n.y===i||n.y===e||n.width===i||n.width===e||n.height===i||n.height===e||n.x+n.width>t.viewportX+t.viewportWidth+t.frozenTrailingWidth||n.y+n.height>t.viewportY+t.viewportHeight+t.frozenTrailingHeight):!0},at.prototype._commitSelectValue=function(n,r,u,f){for(var v,c,l,y,p,o=this._sheet,s,h=0,a=n.options,w=a.length;h<w;h++)if(v=a[h],v.selected){s=f[h].value;break}c=!1;o.isProtected&&(l=o.getActualStyle(r,u),l&&(c=l.locked));s===i||s===e||c||(y={row:r,col:u,newValue:s,autoFormat:!0},p=new t.UndoRedo.CellEditUndoAction(o,y),o._doCommand(p));t.GC$(n).hide()},at.prototype._updateValidationUI=function(n,o){var ht=this,p=ht._sheet,ni=p&&p.parent,ai,ti,k,it,b,wt,ii,yt,tt,dt,pt,fi,oi,ct,gt,si,hi,ci,li,pi,at;if(ni&&t.features.dataValidator&&(ai=p._disposeValidationUI(),ai)&&(ti=ni.getActiveSheet(),ti&&p.getName()===ti.getName())&&(k=p.getDataValidator(n,o),k)&&(it=ht._getCanvasOffset(),b=p.getCellRect(n,o),!ht._isInvalidRect(b))&&(wt=t.util.getPreferredZIndex(ni.getHost()),k&&k.showInputMessage&&k.inputMessage&&(ii=u.createElement("span"),t.GC$(ii).css(s,h).css(y,"1px #C0C0C0 solid").css(rt,"3px 8px 3px 8px").css(g,"#FFFFFF").css(ut,"1px 2px 5px rgba(0,0,0,0.4)").css(d,"normal normal normal 12px/normal Arial").width(w).height(w).css(c,b.y+b.height+it.top+5).css(l,b.x+b.width/2+it.left).css(nt,wt).html("<b>"+k.inputTitle+"<\/b><br/>"+k.inputMessage).attr(v,"gcValidationInputMessage").appendTo(u.body),p._validationInputMessage=ii),k&&k.type===3&&k.inCellDropdown)){var vt=k.condition.getValidListImp(p,n,o),bt=vt.length,ot=u.createElement("select"),wi=p.getValue(n,o),kt=-1,vi=u.createDocumentFragment();for(yt=0;yt<bt;yt++)(tt=vt[yt].text,tt===i||tt===e||t.util.hasCalc()&&tt instanceof t.Calc.CalcError)||(kt<0&&tt===wi&&(kt=yt),tt instanceof Date&&(tt=new t._DateTimeHelper(tt).localeFormat("M/d/yyyy h:mm:ss")),dt=u.createElement("option"),dt.value=tt,dt.text=tt,vi.appendChild(dt));ot.appendChild(vi);ot.selectedIndex=kt>0?kt:0;var ri=p.getActualStyle(n,o),yi=p._render,ui=ri&&ri.font?ri.font:yi._getDefaultFont();p._zoomFactor>1&&(ui=yi._getZoomFont(ui));pt=p.getSpans(new t.Range(n,o,1,1));fi=1;pt&&pt.length>0&&pt[0]&&(fi=pt[0].colCount);var ei=o+fi-1==p.getColumnCount()-1,et=p.getRowHeight(n)*p._zoomFactor,bi=p.parent&&p.parent.useTouchLayout();et=bi?r(50,et):r(15,et);oi=t.util.device();ct=t.util.browser.safari&&(oi.ipad||oi.iphone);ct?(gt=b.width+3,si=b.height+3,hi=b.y+it.top-1.5,ci=b.x+it.left-1.5,li=ft):(gt=f(b.width+(ei?0:et),p.defaults.colWidth),si=bt>8?140:w,hi=b.y+b.height+it.top,ci=b.x+b.width+it.left+(ei?0:et)-gt,li="");pi=t.GC$(ot).css(st,a).css(s,h).css(d,ui).css(nt,wt).css(g,li).width(gt).height(si).css(c,hi).css(l,ci).attr(v,"gcValidationSelect").appendTo(u.body).attr(lt,bt>2?bt:2).hide().bind("click",function(){ht._commitSelectValue(ot,n,o,vt);ct&&t.GC$(p._validationButton).show()}).bind("keydown",function(i){i.keyCode!==13||i.ctrlKey||i.shiftKey||i.altKey?i.keyCode!==27||i.ctrlKey||i.shiftKey||i.altKey||t.GC$(ot).hide():ht._commitSelectValue(ot,n,o,vt);ct&&t.GC$(p._validationButton).show()});ct&&pi.bind("blur",function(i){ht._commitSelectValue(ot,n,o,vt);t.GC$(p._validationButton).show()});p._validationSelect=ot;at=u.createElement("input");at.type="image";at.src=t.DefaultDataValidator.getImageSrc();at.alt="v";t.GC$(at).css(s,h).width(et).height(et).css(c,b.y+b.height+it.top-(et+3)).css(l,b.x+b.width+it.left-(ei?et:0)).css(nt,wt).css(g,ft).css(y,"1px solid gray").attr(v,"gcValidationButton").appendTo(u.body).bind("click",function(){(!p.isEditing()||p.endEdit())&&(t.GC$(p._validationSelect).toggle().focus(),ct&&t.GC$(p._validationButton).toggle())});p._validationButton=at}},at.prototype.startScroll=function(){var n=this,t;n.startHitInfo&&(t=n.startHitInfo.hitTestType,(t===3||t===2)&&n._getVScrollTimer().setAction(n.processVSScrolled),(t===3||t===1)&&n._getHScrollTimer().setAction(n.processHSScrolled))},at.prototype.processVSScrolled=function(n){var t=this,s=t.adjustScrollRowViewport(),r,e,o;if(!s){var h=t.startHitInfo,i=t._sheet,f=h.scrollRowViewportIndex,u=i.getViewportTopRow(f),c=i.getViewportBottomRow(f);n?c<i.getRowCount()-i._frozenTrailingRowCount-1?i._setTopRow(i._getNextVisualRow(u)):(r=i._getRowLayout(f),r&&r.length>0&&(e=i._getSheetLayout(),o=r[r.length-1],o.y+o.height>=e.viewportY+e.viewportHeight&&i._setTopRow(i._getNextVisualRow(u)))):u>i.frozenRowCount&&i._setTopRow(i._getPrevVisualRow(u))}t.isSelecting&&t.continueSelecting();t.isDragDropping&&t.continueDragDropping();t.isDraggingFill&&t.continueDragFill();t.isFormulaRangeAppending&&t.continueFormulaRangeAppending();t.isFormulaRangeMoving&&t.continueFormulaRangeMoving();t.isFormulaRangeResizing&&t.continueFormulaRangeResizing()},at.prototype.processHSScrolled=function(n){var t=this,s=t.adjustScrollColViewport(),r,e,o;if(!s){var i=t._sheet,h=t.startHitInfo,f=h.scrollColViewportIndex,u=i.getViewportLeftColumn(f),c=i.getViewportRightColumn(f);n?c<i.getColumnCount()-i._frozenTrailingColCount-1?i._setLeftColumn(i._getNextVisualColumn(u)):(r=i._getColumnLayout(f),r&&r.length>0&&(e=i._getSheetLayout(),o=r[r.length-1],o.x+o.width>=e.viewportX+e.viewportWidth&&i._setLeftColumn(i._getNextVisualColumn(u)))):u>i.frozenColCount&&i._setLeftColumn(i._getPrevVisualColumn(u))}t.isSelecting&&t.continueSelecting();t.isDragDropping&&t.continueDragDropping();t.isDraggingFill&&t.continueDragFill();t.isFormulaRangeAppending&&t.continueFormulaRangeAppending();t.isFormulaRangeMoving&&t.continueFormulaRangeMoving();t.isFormulaRangeResizing&&t.continueFormulaRangeResizing()},at.prototype.adjustScrollRowViewport=function(){var n=this._sheet,u=n._getSheetLayout(),o=this.mousePosition,f=this.startHitInfo,h=f.scrollRowViewportIndex,t,i,e;if(h===0){if(o.y>u.viewportY)return n._setTopRow(n._getFirstPageTopRow()),f.scrollRowViewportIndex=1,!0}else if(h===1){if(t=n._getRowLayout(1),t&&t.length>0){if(i=t[0],n.frozenRowCount>0&&o.y<u.viewportY&&i.row<=n._getFirstPageTopRow())return f.scrollRowViewportIndex=0,!0;if(i=t[t.length-1],n._frozenTrailingRowCount>0&&o.y>u.frozenTrailingY&&i.row>=n._getLastVisualRow()&&i.y+i.height<=u.frozenTrailingY)return f.scrollRowViewportIndex=2,!0}}else if(h===2&&(t=n._getRowLayout(1),t&&t.length>0&&o.y<u.frozenTrailingY)){if(i=t[t.length-1],i.y+i.height>u.frozenTrailingY){var l=u.viewportHeight,s=n.getRowCount()-n._frozenTrailingRowCount-1,c=0;for(e=s;e>=n.frozenRowCount;e--)if(c+=n._getZoomRowHeight(e),c>l){s=r(e+1,s);break}n._setTopRow(n._getNextVisualRow(s-1))}return f.scrollRowViewportIndex=1,!0}return!1},at.prototype.adjustScrollColViewport=function(){var n=this._sheet,u=n._getSheetLayout(),o=this.mousePosition,f=this.startHitInfo,h=f.scrollColViewportIndex,t,i,e;if(h===0){if(o.x>u.viewportX)return n._setLeftColumn(n._getFirstPageLeftColumn()),f.scrollColViewportIndex=1,!0}else if(h===1){if(t=n._getColumnLayout(1),t&&t.length>0){if(i=t[0],n.frozenColCount>0&&o.x<u.viewportX&&i.col<=n._getFirstPageLeftColumn())return f.scrollColViewportIndex=0,!0;if(i=t[t.length-1],n._frozenTrailingColCount>0&&o.x>u.frozenTrailingX&&i.col>=n._getLastVisualColumn()&&i.x+i.width<=u.frozenTrailingX)return f.scrollColViewportIndex=2,!0}}else if(h===2&&(t=n._getColumnLayout(1),t&&t.length>0&&o.x<u.frozenTrailingX)){if(i=t[t.length-1],i.x+i.width>u.frozenTrailingX){var l=u.viewportWidth,s=n.getColumnCount()-n._frozenTrailingColCount-1,c=0;for(e=s;e>=n.frozenColCount;e--)if(c+=n._getZoomColumnWidth(e),c>l){s=r(e+1,s);break}n._setLeftColumn(n._getNextVisualColumn(s-1))}return f.scrollColViewportIndex=1,!0}return!1},at.prototype.continueScroll=function(){var t=this,e,o;if(t.isWorking||t.isFloatingObjectWorking||t.isCommentWorking){var c=t._sheet,s=c._getSheetLayout(),h=t.startHitInfo,u=h.scrollRowViewportIndex,f=h.scrollColViewportIndex,r=t.mousePosition,n=i;u>=0&&f>=0?n=s.viewportRect(u,f):u>=0?n=s.rowHeaderRect(u):f>=0&&(n=s.colHeaderRect(f));n&&(e=0,o=0,r.x<=n.x?e=r.x-n.x:r.x>=n.x+n.width&&(e=r.x-(n.x+n.width)),r.y<=n.y?o=r.y-n.y:r.y>=n.y+n.height&&(o=r.y-(n.y+n.height)),t._getHScrollTimer().setInterval(t.getIntervalFromDistance(e)),t._getVScrollTimer().setInterval(t.getIntervalFromDistance(o)))}},at.prototype.stopScroll=function(){this._getHScrollTimer().stop();this._getVScrollTimer().stop()},at.prototype.startResizing=function(n){var i=this,r=i._sheet,a=r._getSheetLayout(),t=n.resizeInfo,s,f,h,e,o;t.action==="sizeRow"||t.action==="sizeHiddenRow"?(s=r._getAllRowLayout(t.sheetArea),r.getRowVisible(t.index)||(t.index=i._getPreVisualRow(t.index,t.sheetArea)),f=s.findRow(t.index),f||(f=s.findRow(n.row)),t.startY=f.y):(h=r._getAllColumnLayout(t.sheetArea),r.getColumnVisible(t.index)||(t.index=i._getPreVisualCol(t.index,t.sheetArea)),e=h.findCol(t.index),e||(e=h.findCol(n.col)),t.startX=e.x);var c=r.parent,l=n.x,u=n.y;c&&(o=c.showResizeTip(),(o===1&&(t.action==="sizeCol"||t.action==="sizeHiddenCol")||o===2&&(t.action==="sizeRow"||t.action==="sizeHiddenRow")||o===3)&&(u=u-i.RESIZETOOLTIP_TOP<0?u+i.RESIZETOOLTIP_TOP/2:u-i.RESIZETOOLTIP_TOP,i._showTooltip(i._getMouseDownResizeTooltipContent(),l,u)));i.isResizing=!0;i.isWorking=!0},at.prototype.continueResizing=function(){var i=this,u=i._sheet,o=u._currentTarget,n=o.resizeInfo,h=i.mousePosition,c=h.x,l=h.y,t=u._getSheetLayout(),r,v,f,a,s,e;n&&i.isWorking&&i.isResizing&&(o.x!==c||o.y!==l)&&(n.action==="sizeRow"||n.action==="sizeHiddenRow"?(n.movingY=l,n.movingY<n.startY&&(n.movingY=n.startY),r=t.y+t.height,n.movingY>r&&(n.movingY=r)):(n.movingX=c,n.movingX<n.startX&&(n.movingX=n.startX),r=t.x+t.width,n.movingX>r&&(n.movingX=r)),f=u._render,a=f._getCtx(),f.copyDoubleBuffer(t.x,t.y,t.width,t.height),f.paintAdornment(a),s=u.parent,s&&(e=s.showResizeTip(),(e===1&&(n.action==="sizeCol"||n.action==="sizeHiddenCol")||e===2&&(n.action==="sizeRow"||n.action==="sizeHiddenRow")||e===3)&&i._refreshTooltip(i._getMouseMoveResizeTooltipContent(n))))},at.prototype.stopResizing=function(){var s=this,l,p,a,w,y;s.isResizing=!1;s.isWorking=!1;var v=!0,r=s._sheet,b=r._currentTarget,n=b.resizeInfo,h,o,u,c;if(n){if(s._removeTooltip(),n.action==="sizeRow"||n.action==="sizeHiddenRow")if(n.movingY!==e&&n.movingY!==i){if(h=f(0,(n.movingY-n.startY)/r._zoomFactor),l=[],r._isRowSelected(n.index))for(o=0;o<r._selectionModel.length;o++)u=r._selectionModel[o],u.col===-1&&(u=r._getActualRange(u),l.push({firstRow:u.row,lastRow:u.row+u.rowCount-1}));else l.push({firstRow:n.index,lastRow:n.index});p=n.sheetArea===1;c=new t.UndoRedo.RowResizeUndoAction(r,l,h,p);r._doCommand(c)}else v=!1;else if(n.movingX!==e&&n.movingX!==i){if(h=f(0,(n.movingX-n.startX)/r._zoomFactor),a=[],r._isColumnSelected(n.index))for(o=0;o<r._selectionModel.length;o++)u=r._selectionModel[o],u.row===-1&&(u=r._getActualRange(u),a.push({firstCol:u.col,lastCol:u.col+u.colCount-1}));else a.push({firstCol:n.index,lastCol:n.index});w=n.sheetArea===2;c=new t.UndoRedo.ColumnResizeUndoAction(r,a,h,w);r._doCommand(c)}else v=!1;y=r.hitTest(s.mousePosition.x,s.mousePosition.y);y&&s.updateCanvasCursor(y);v||r.repaint()}},at.prototype._startSelectingCore=function(n,t){var v=0,y=0,p=0,w=0,u=this,i=u._sheet,s,f,e,l,a,b,h,c;if(u._lastSelections=i._selectionModel.toArray(),u.ctrl||u.shift||i._clearSelectionImp(),n.hitTestType===0){if(!u.shift){if(s=i.frozenRowCount?i._getFirstVisualRow():i._scrollTopRow,a=i.frozenColCount?i._getFirstVisualColumn():i._scrollLeftCol,f={sheet:i,sheetName:i._name,row:i._activeRowIndex,col:i._activeColIndex,cancel:!1},i.triggerLeaveCell(f),f&&f.cancel===!0)return;i._setActiveCellImp(s,a,1,1,t);i.triggerEnterCell({sheet:i,sheetName:i._name,row:s,col:a});u._updateValidationUI(s,a)}u.ctrl||i._clearSelectionImp();i._setSelectedRange(-1,-1,i.getRowCount(),i.getColumnCount(),!0)}else if(n.hitTestType===1){if(!u.shift){if(s=i.frozenRowCount?i._getFirstVisualRow():i._scrollTopRow,e=i._getAvailableActiveCell(s,n.col,!1),f={sheet:i,sheetName:i._name,row:i._activeRowIndex,col:i._activeColIndex,cancel:!1},i.triggerLeaveCell(f),f&&f.cancel===!0)return;i._setActiveCellImp(e.row,e.col,1,n.colViewportIndex,t);i.triggerEnterCell({sheet:i,sheetName:i._name,row:e.row,col:e.col});u._updateValidationUI(e.row,e.col)}u.shift?(v=r(i._activeColIndex,n.col),w=o(i._activeColIndex-n.col)+1,i._replaceActiveSelectedRange(-1,v,i.getRowCount(),w,!0)):i._setSelectedRange(-1,i._activeColIndex,i.getRowCount(),1,!0)}else if(n.hitTestType===2){if(!u.shift){if(b=i.frozenColCount?i._getFirstVisualColumn():i._scrollLeftCol,e=i._getAvailableActiveCell(n.row,b,!0),f={sheet:i,sheetName:i._name,row:i._activeRowIndex,col:i._activeColIndex,cancel:!1},i.triggerLeaveCell(f),f&&f.cancel===!0)return;l=i._activeRowIndex!==e.row;i._setActiveCellImp(e.row,e.col,n.rowViewportIndex,1,t);l&&i.doDataItemChanged();i.triggerEnterCell({sheet:i,sheetName:i._name,row:e.row,col:e.col});u._updateValidationUI(e.row,e.col)}u.shift?(y=r(i._activeRowIndex,n.row),p=o(i._activeRowIndex-n.row)+1,i._replaceActiveSelectedRange(y,-1,p,i.getColumnCount(),!0)):i._setSelectedRange(i._activeRowIndex,-1,1,i.getColumnCount(),!0)}else if(n.hitTestType===3)if(isNaN(n.row)||isNaN(n.col))i.isEditing()&&(c=i.getCellRect(i._activeRowIndex,i._activeColIndex,i.activeRowViewportIndex,i.activeColViewportIndex),i._render.update(c.x,c.y,c.width,c.height));else{if(!u.shift&&(i._activeRowIndex!==n.row||i._activeColIndex!==n.col)){if(f={sheet:i,sheetName:i._name,row:i._activeRowIndex,col:i._activeColIndex,cancel:!1},i.triggerLeaveCell(f),f&&f.cancel===!0)return;l=i._activeRowIndex!==n.row;i._setActiveCellImp(n.row,n.col,n.rowViewportIndex,n.colViewportIndex,t);l&&i.doDataItemChanged();i.triggerEnterCell({sheet:i,sheetName:i._name,row:n.row,col:n.col});u._updateValidationUI(n.row,n.col)}u.shift?i._extendSelectedRange(n.row,n.col,!0):(h=i._getSpanModel().find(n.row,n.col),h?i._setSelectedRange(h.row,h.col,h.rowCount,h.colCount,!0):i._setSelectedRange(n.row,n.col,1,1,!0))}},at.prototype._startSelectingScroll=function(n){if(n&&(n.hitTestType!==3||!(isNaN(n.row)||isNaN(n.col)))){var t=this;t.isWorking=!0;t.isSelecting=!0;t.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType};t.startScroll()}},at.prototype.startSelecting=function(n){this._startSelectingCore(n);this._startSelectingScroll(n)},at.prototype.continueSelecting=function(){var n=this,t;n.startHitInfo&&n.isWorking&&n._forceCancelSelectiong!==!0&&(t=n.startHitInfo.hitTestType,t===3?n.continueCellSelecting():t===2?n.continueRowSelecting():t===1&&n.continueColumnSelecting())},at.prototype.continueCellSelecting=function(){var t=this,n=t._sheet,i=t.getHitRowIndex(),r=t.getHitColumnIndex(),u,f;i>=0&&r>=0&&n.canSelect(i,r)&&(u=n._selectionModel.toArray(),n._extendSelectedRange(i,r,!0),f=n._selectionModel.toArray(),t._notEqualSelecions(u,f)&&n.triggerSelectionChanging({sheet:n,sheetName:n._name,oldSelections:u,newSelections:f}),t.continueScroll())},at.prototype.continueRowSelecting=function(){var t=this,n=t._sheet,i=t.getHitRowIndex(),h,e,o;if(i>=0&&n.canSelect(i,-1)){var u=r(n._activeRowIndex,i),s=f(n._activeRowIndex,i)-u+1,c=-1,l=n.getColumnCount(),a=n.selectionPolicy();if(a===0)return;h=n.selectionUnit();h===2&&(u=-1,s=-1);e=n._selectionModel.toArray();n._replaceActiveSelectedRange(u,c,s,l,!0);o=n._selectionModel.toArray();t._notEqualSelecions(e,o)&&n.triggerSelectionChanging({sheet:n,sheetName:n._name,oldSelections:e,newSelections:o})}t.continueScroll()},at.prototype.continueColumnSelecting=function(){var t=this,n=t._sheet,i=t.getHitColumnIndex(),h,e,o;if(i>=0&&n.canSelect(-1,i)){var u=r(n._activeColIndex,i),s=f(n._activeColIndex,i)-u+1,c=-1,l=n.getRowCount(),a=n.selectionPolicy();if(a===0)return;h=n.selectionUnit();h===1&&(u=-1,s=-1);e=n._selectionModel.toArray();n._replaceActiveSelectedRange(c,u,l,s,!0);o=n._selectionModel.toArray();t._notEqualSelecions(e,o)&&n.triggerSelectionChanging({sheet:n,sheetName:n._name,oldSelections:e,newSelections:o})}t.continueScroll()},at.prototype.stopSelecting=function(){var n=this,t,r,u;n.startHitInfo=i;n.stopScroll();n._forceCancelSelectiong=i;n.isWorking=!1;n.isSelecting=!1;t=n._sheet;r=!n._lastSelections;r||(u=t._selectionModel.toArray(),r=n._notEqualSelecions(n._lastSelections,u));r&&t.triggerSelectionChanged({sheet:n._sheet,sheetName:n._sheet._name});n._lastSelections=t._selectionModel.toArray()},at.prototype.startDragDropping=function(n){var o=this,f,e,l,c,u;if(!o.isDragDropping&&(f=o._sheet,e=i,f._selectionModel.length===1?e=f._selectionModel[0]:f._selectionModel.length<1&&(l=f._getSpanModel().find(f._activeRowIndex,f._activeColIndex),e=l?l:new t.Range(f._activeRowIndex,f._activeColIndex,1,1)),e)){o.isDragDropping=!0;o.isWorking=!0;o._dragDropFromRange=e;c=f._getRangeRect(n.rowViewportIndex,n.colViewportIndex,e);u=f._dragRect;u.x=c.x;u.y=c.y;u.width=c.width-1;u.height=c.height-1;u.row=e.row;u.col=e.col;u.rowCount=e.rowCount;u.colCount=e.colCount;var r=f._fixRange(e),s=n.row,h=n.col;s<r.row&&(s=r.row);s>=r.row+r.rowCount&&(s=r.row+r.rowCount-1);h<r.col&&(h=r.col);h>=r.col+r.colCount&&(h=r.col+r.colCount-1);u.hitRow=s;u.hitCol=h;u.rowOffset=s-r.row;u.colOffset=h-r.col;o.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType};o.startScroll()}},at.prototype.continueDragDropping=function(){var n=this,t,i;if(n.startHitInfo&&n.isWorking&&n.isDragDropping&&n._dragDropFromRange){var r=n.mousePosition,u=n._sheet,f=u._dragRect;f.hitTarget={x:r.x,y:r.y};t=n.getHitRowIndex();i=n.getHitColumnIndex();t>=0&&i>=0&&n.updateDragDropRect(t,i);n.continueScroll()}},at.prototype.updateDragDropRect=function(n,t){var o=this,e,s,c,l,a;if(o.isDragDropping&&o._dragDropFromRange){var u=o._sheet,i=u._dragRect,h=u._getActiveSelectedRange();(h.row===-1&&h.col!==-1?(i.row=-1,i.col=f(0,r(u.getColumnCount()-i.colCount,t-i.colOffset))):h.row!==-1&&h.col===-1?(i.row=f(0,r(u.getRowCount()-i.rowCount,n-i.rowOffset)),i.col=-1):(i.row=i.row<0?-1:f(0,r(u.getRowCount()-i.rowCount,n-i.rowOffset)),i.col=i.col<0?-1:f(0,r(u.getColumnCount()-i.colCount,t-i.colOffset))),i.hitRow=n,i.hitCol=t,e=u._fixRange(i),s=u._oldDragRange,s&&e.row===s.row&&e.col===s.col&&e.rowCount===s.rowCount&&e.colCount===s.colCount&&e.row>u._getFirstVisualRow()&&e.col>u._getFirstVisualColumn()&&e.row+e.rowCount-1<u._getLastVisualRow()&&e.col+e.colCount-1<u._getLastVisualColumn())||(u._actualDragRange=e,u._render.refreshDragDropIndicator(),u._oldDragRange=e,c=u.parent,c&&c.showDragDropTip()&&(l=i.x+i.width+o.DRAGDROPTOOLTIP_OFFSET,a=i.y+i.height+o.DRAGDROPTOOLTIP_OFFSET,o._showTooltip(o._getDragDropRectString(e),l,a)))}},at.prototype._getDragDropRectString=function(n){if(n&&t.util.hasCalc()){var o=this._sheet,i=o._getActiveSelectedRange(),r=o.getActiveRowIndex(),u=o.getActiveColumnIndex(),f;return r=r<0?0:r,u=u<0?0:u,i.rowCount===1&&i.colCount===1?f=new t.Calc.Expressions.CellExpression(n.row-r,n.col-u,!0,!0):(f=new t.Calc.Expressions.RangeExpression,i.row===-1&&i.col>=0?f.initBand(n.col-u,n.col-u+i.colCount-1,!0,!0,!1):i.col===-1&&i.row>=0?f.initBand(n.row-r,n.row-r+i.rowCount-1,!0,!0,!0):i.row>=0&&i.col>=0&&f.init(n.row-r,n.col-u,n.row-r+i.rowCount-1,n.col-u+i.colCount-1,!0,!0,!0,!0)),o.getCalcService().unparse(o._getSheetSource(),f,r,u)}else return e},at.prototype.stopDragDrop=function(){var u=this,f=!1,s="",b=!1,r=u._sheet,w=i,v;if(u.startHitInfo=i,u.stopScroll(),v=r._getActiveSelectedRange(),w=v&&(v.rowCount>0||v.colCount>0)?{r:v.row,c:v.col,rc:v.rowCount,cc:v.colCount}:{r:r._activeRowIndex,c:r._activeColIndex,rc:1,cc:1},u.isDragDropping===!0&&u.isWorking===!0){var e=w.r,o=w.c,h=w.rc,c=w.cc,a=r._dragRect.row,l=r._dragRect.col,y,p,n;u._isDragInsert&&(e===-1||o===-1)?o>=0&&e<0?(u._isDragCopy&&(l<=o||l>=o+c)||!u._isDragCopy&&(l<o||l>o+c))&&((r._hasPartSpans(-1,o,-1,c)||r._hasPartSpans(-1,l,-1,0))&&(f=!0,s=t.SR.Exp_ChangeMergedCell),f||(r._hasPartArrayFormulas(-1,o,-1,c)||r._hasPartArrayFormulas(-1,l,-1,0))&&(f=!0,s=t.SR.Exp_ChangePartOfArray),!f&&r.isProtected&&(f=!0,s=t.SR.Exp_ColumnReadOnly),!f&&r._hasPartTable(-1,l,-1,1)&&(f=!0,s=t.SR.Exp_DragDropShiftTableCell),f||u._isDragCopy||!r._hasPartTable(-1,o,-1,c)||(f=!0,s=t.SR.Exp_DragDropChangePartOfTable),f||(n=new t.UndoRedo.DragDropExtent(-1,o,-1,l,-1,c),p=r._raiseDragDropBlock(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!0,1023),p||(y=new t.UndoRedo.DragDropUndoAction(r,n,u._isDragCopy,!0,1023),b=r._doCommand(y),r._raiseDragDropBlockCompleted(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!0,1023)))):e>=0&&o<0&&(u._isDragCopy&&(a<=e||a>=e+h)||!u._isDragCopy&&(a<e||a>e+h))&&((r._hasPartSpans(e,-1,h,-1)||r._hasPartSpans(a,-1,0,-1))&&(f=!0,s=t.SR.Exp_ChangeMergedCell),f||(r._hasPartArrayFormulas(e,-1,h,-1)||r._hasPartArrayFormulas(a,-1,0,-1))&&(f=!0,s=t.SR.Exp_ChangePartOfArray),!f&&r.isProtected&&(f=!0,s=t.SR.Exp_RowReadOnly),f||u._isDragCopy||!r._hasPartTable(e,-1,h,-1)||(f=!0,s=t.SR.Exp_DragDropChangePartOfTable),f||(n=new t.UndoRedo.DragDropExtent(e,-1,a,-1,h,-1),p=r._raiseDragDropBlock(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!0,1023),p||(y=new t.UndoRedo.DragDropUndoAction(r,n,u._isDragCopy,!0,1023),b=r._doCommand(y),r._raiseDragDropBlockCompleted(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!0,1023)))):(a!==e||l!==o)&&((r._hasPartSpans(e,o,h,c)||r._hasPartSpans(a,l,h,c))&&(f=!0,s=t.SR.Exp_ChangeMergedCell),f||(r._hasPartArrayFormulas(e,o,h,c)||r._hasPartArrayFormulas(a,l,h,c))&&(f=!0,s=t.SR.Exp_ChangePartOfArray),!f&&r.isProtected&&(!u._isDragCopy&&r._isAnyCellInRangeLocked(new t.Range(e,o,h,c))||r._isAnyCellInRangeLocked(new t.Range(a,l,h,c)))&&(f=!0,s=t.SR.Exp_CellReadOnly),f||(n=new t.UndoRedo.DragDropExtent(e,o,a,l,h,c),p=r._raiseDragDropBlock(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!1,1023),p||(y=new t.UndoRedo.DragDropUndoAction(r,n,u._isDragCopy,!1,1023),b=r._doCommand(y),r._raiseDragDropBlockCompleted(n.fromRow,n.fromColumn,n.toRow,n.toColumn,n.rowCount,n.columnCount,u._isDragCopy,!1,1023))))}u.isWorking=!1;u.isDragDropping=!1;u._dragDropFromRange=i;u._isDragInsert=!1;u._isDragCopy=!1;u._removeTooltip();b===!1&&(r._dragRect={},r.repaint());f&&r._raiseInvalidOperation(3,s)},at.prototype.startFormulaRangeAppending=function(n){var r=this,u=r._sheet,f=u._formulaTextBox,w;if(f){w=f.isAppending();w&&r._formulaRangeAppendingInfo||(r._formulaRangeAppendingInfo={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1});var b=u.getRowCount(),k=u.getColumnCount(),a=n.hitTestType,e=n.row,o=n.col,l=r.shift,v=r.ctrl,s=r._formulaRangeAppendingInfo,y=s.anchorRow,p=s.anchorCol,h=-1,c=-1,i;a===0?(h=u.frozenRowCount?u._getFirstVisualRow():u._scrollTopRow,c=u.frozenColCount?u._getFirstVisualColumn():u._scrollLeftCol,i=new t.Range(-1,-1,-1,-1),v?f.appendRange(r.rangeToString(i),!1,!1):l?f.appendRange(r.rangeToString(i),!0,!1):f.appendRange(r.rangeToString(i),!1,!0),r.isWorking=!0):a===1?(h=u.frozenRowCount?u._getFirstVisualRow():u._scrollTopRow,c=o,i=u._getExtendedRange(0,o,b-1,o),i=new t.Range(-1,i.col,-1,i.colCount),v?f.appendRange(r.rangeToString(i),!1,!1):l?(p>=0&&(i=u._getExtendedRange(0,o,b-1,p),i=new t.Range(-1,i.col,-1,i.colCount)),f.appendRange(r.rangeToString(i),!0,!1)):f.appendRange(r.rangeToString(i),!1,!0),r.isWorking=!0):a===2?(h=e,c=u.frozenColCount?u._getFirstVisualColumn():u._scrollLeftCol,i=u._getExtendedRange(e,0,e,k-1),i=new t.Range(i.row,-1,i.rowCount,-1),v?f.appendRange(r.rangeToString(i),!1,!1):l?(y>=0&&(i=u._getExtendedRange(e,0,y,k-1),i=new t.Range(i.row,-1,i.rowCount,-1)),f.appendRange(r.rangeToString(i),!0,!1)):f.appendRange(r.rangeToString(i),!1,!0),r.isWorking=!0):a===3&&(h=e,c=o,i=u._getExtendedRange(e,o,e,o),i=new t.Range(i.row,i.col,1,1),v?f.appendRange(r.rangeToString(i),!1,!1):l?(y>=0&&p>=0&&(i=u._getExtendedRange(e,o,y,p)),f.appendRange(r.rangeToString(i),!0,!1)):f.appendRange(r.rangeToString(i),!1,!0),r.isWorking=!0);r.isFormulaRangeAppending=r.isWorking;l&&w||(s.anchorRow=h,s.anchorCol=c,s.leadingRow=h,s.leadingCol=c);r.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType};r.startScroll()}},at.prototype.continueFormulaRangeAppending=function(){var n=this,i=n.startHitInfo,t;i&&n.isWorking&&(t=i.hitTestType,t===3?n.continueFormulaRangeCellAppending():t===2?n.continueFormulaRangeRowAppending():t===1&&n.continueFormulaRangeColumnAppending())},at.prototype.continueFormulaRangeCellAppending=function(){var n=this,t=n._formulaRangeAppendingInfo,i=t.anchorRow,r=t.anchorCol,u=n.getHitRowIndex(),f=n.getHitColumnIndex(),s;if(i>=0&&r>=0&&u>=0&&f>=0){var e=n._sheet,h=e._getExtendedRange(u,f,i,r),o=n.rangeToString(h);o&&(s=e._formulaTextBox,s.appendRange(o,!0,!1))}n.continueScroll()},at.prototype.continueFormulaRangeRowAppending=function(){var n=this,f=n._formulaRangeAppendingInfo.anchorRow,e=n.getHitRowIndex(),r,i,u,o;f>=0&&e>=0&&(r=n._sheet,i=r._getExtendedRange(e,0,f,r.getColumnCount()-1),i=new t.Range(i.row,-1,i.rowCount,-1),u=n.rangeToString(i),u&&(o=r._formulaTextBox,o.appendRange(u,!0,!1)));n.continueScroll()},at.prototype.continueFormulaRangeColumnAppending=function(){var n=this,f=n._formulaRangeAppendingInfo.anchorCol,e=n.getHitColumnIndex(),r,i,u,o;f>=0&&e>=0&&(r=n._sheet,i=r._getExtendedRange(0,e,r.getRowCount()-1,f),i=new t.Range(-1,i.col,-1,i.colCount),u=n.rangeToString(i),u&&(o=r._formulaTextBox,o.appendRange(u,!0,!1)));n.continueScroll()},at.prototype.stopFormulaRangeAppending=function(){var n=this;n.stopScroll();n.startHitInfo=i;n.isWorking=!1;n.isFormulaRangeAppending=!1},at.prototype.startFormulaRangeMoving=function(n){var i=this,c=i._sheet,f=c._formulaTextBox,s=n.formulaRangeHitInfo,e,h,o,l,a;if(s&&s.inBorder&&f&&(f.isAppending()&&f.stopAppending(),f.close(),e=s.paramRange,h=e&&e.text,h)&&(o=i.stringToRange(h),o)){var t=c._fixRange(o),r=n.row,u=n.col;r<t.row&&(r=t.row);r>=t.row+t.rowCount&&(r=t.row+t.rowCount-1);u<t.col&&(u=t.col);u>=t.col+t.colCount&&(u=t.col+t.colCount-1);l=r-t.row;a=u-t.col;i.isWorking=!0;i.isFormulaRangeMoving=!0;i._formulaRangeMovingInfo={paramRange:e,fromRange:o,rowOffset:l,colOffset:a};i.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType};i.startScroll()}},at.prototype.continueFormulaRangeMoving=function(){var n=this,u,e,y;if(n.isWorking&&n.isFormulaRangeMoving){if(u=n.getHitRowIndex(),e=n.getHitColumnIndex(),u>=0&&e>=0){var i=n._formulaRangeMovingInfo,o=i.fromRange,p=i.rowOffset,w=i.colOffset,b=i.toRow,k=i.toCol,h=u,c=e;if(h!==b||c!==k){i.toRow=h;i.toCol=c;var s=n._sheet,d=s.getRowCount(),g=s.getColumnCount(),nt=o.row,tt=o.col,l=o.rowCount,a=o.colCount,it=nt<0?-1:f(0,r(d-l,u-p)),rt=tt<0?-1:f(0,r(g-a,e-w)),v=n.rangeToString(new t.Range(it,rt,l,a));v&&(y=s._formulaTextBox,y.repalceRange(i.paramRange.index,v))}}n.continueScroll()}},at.prototype.stopFormulaRangeMoving=function(){var n=this;n.stopScroll();n.isWorking=!1;n.isFormulaRangeMoving=!1;n._formulaRangeMovingInfo=i},at.prototype.startFormulaRangeResizing=function(n){var i=this,p=i._sheet,v=p._formulaTextBox,r=n.formulaRangeHitInfo,u,y,t;if(r&&v&&(v.isAppending()&&v.stopAppending(),u=r.paramRange,y=u&&u.text,u&&y)&&(t=i.stringToRange(y),t)){var h=t.row,c=t.row<0?-1:t.row+t.rowCount-1,l=t.col,a=t.col<0?-1:t.col+t.colCount-1,f,e,o,s;if(r.inTopLeft)f=c,e=a,o=h,s=l;else if(r.inTopRight)f=c,e=l,o=h,s=a;else if(r.inBottomLeft)f=h,e=a,o=c,s=l;else if(r.inBottomRight)f=h,e=l,o=c,s=a;else return;i.isWorking=!0;i.isFormulaRangeResizing=!0;i._formulaRangeResizingInfo={paramRange:u,anchorRow:f,anchorCol:e,toRow:o,toCol:s};i.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType};i.startScroll()}},at.prototype.continueFormulaRangeResizing=function(){var n=this,h,c,y,nt;if(n.isWorking&&n.isFormulaRangeResizing){if(h=n.getHitRowIndex(),c=n.getHitColumnIndex(),h>=0&&c>=0){var i=n._formulaRangeResizingInfo,p=i.anchorRow,w=i.anchorCol,tt=i.toRow,it=i.toCol,u=h,e=c;if(u!==tt||e!==it){i.toRow=u;i.toCol=e;var l=n._sheet,b=l.getRowCount(),k=l.getColumnCount(),d=p<0?b-1:p,g=w<0?k-1:w,o=r(d,u),s=r(g,e),a=f(d,u)-o+1,v=f(g,e)-s+1;o===0&&a===b&&(o=-1,a=-1);s===0&&v===k&&(s=-1,v=-1);y=n.rangeToString(new t.Range(o,s,a,v));y&&(nt=l._formulaTextBox,nt.repalceRange(i.paramRange.index,y))}}n.continueScroll()}},at.prototype.stopFormulaRangeResizing=function(){var n=this;n.stopScroll();n.isWorking=!1;n.isFormulaRangeResizing=!1;n._formulaRangeResizingInfo=i},at.prototype.getFormulaRangeHitInfo=function(n,r,u){var k=this._sheet,d=k._formulaTextBox,a=d&&d.getRanges(),y,p,e,w,o,v,b;if(!a||a.length===0||(y=n.rowViewportIndex,p=n.colViewportIndex,this.inGrayArea(y,p,r,u)))return i;for(v=a.length-1;v>=0;v--)if((e=a[v],e.allowDrag!==!1)&&(b=t.features.formulatextbox&&t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,!b||!b.text)&&(w=this.stringToRange(e.text),w)){o=k._getRangeRect(y,p,w);var f=5,s=o.x-2,h=o.x+o.width+1-f,c=o.y-2,l=o.y+o.height+1-f;if(s+f<=r&&r<h&&(c+1<=u&&u<=c+3||l+1<=u&&u<=l+3))return{paramRange:e,inBorder:!0};if(c+f<=u&&u<l&&(s+1<=r&&r<=s+3||h+1<=r&&r<=h+3))return{paramRange:e,inBorder:!0};if(h<=r&&r<h+f&&l<=u&&u<l+f)return{paramRange:e,inBottomRight:!0};if(s<=r&&r<s+f&&l<=u&&u<l+f)return{paramRange:e,inBottomLeft:!0};if(h<=r&&r<h+f&&c<=u&&u<c+f)return{paramRange:e,inTopRight:!0};if(s<=r&&r<s+f&&c<=u&&u<c+f)return{paramRange:e,inTopLeft:!0}}return i},at.prototype.changeFormulaReference=function(){var s=this,l=s._sheet,f=l._formulaTextBox,v,a,w,b,y;if(f){var d=n.Sheets,p=t.Calc,h=l._activeRowIndex,c=l._activeColIndex,k=l.referenceStyle()===1,e=new p.ParserContext(l._getSheetSource(),k,h,c),o=new p.Parser,u,r;if(f.isAppending())for(v=f.getAppendingRanges(),a=0;a<v.length;a++){u=v[a];try{r=o.parse(u.text,e)}catch(g){r=i}r&&(r.t===2?(s.changeRangeExpressionReference(r,h,c,!0,!0),f.repalceRange(u.index,o.unparse(r,e))):r.t===0&&(s.changeCellExpressionReference(r,h,c),f.repalceRange(u.index,o.unparse(r,e))))}else{if(u=f.getActiveRange(),!u)return;try{r=o.parse(u.text,e)}catch(g){r=i}if(!r)return;r.t===2?(w=u.textOffset+u.text.lastIndexOf(":"),b=f.caret()<=w,b?(s.changeRangeExpressionReference(r,h,c,!0,!1),y=o.unparse(r,e),f.repalceRange(u.index,y),f.caret(u.textOffset+y.lastIndexOf(":"))):(s.changeRangeExpressionReference(r,h,c,!1,!0),f.repalceRange(u.index,o.unparse(r,e)))):r.t===0&&(s.changeCellExpressionReference(r,h,c),f.repalceRange(u.index,o.unparse(r,e)))}}},at.prototype.changeRangeExpressionReference=function(n,t,i,r,u){var o=n.startRowRelative,s=n.startColumnRelative,f,e;r&&(o&&s?(n.startRowRelative=!1,n.startColumnRelative=!1,n.startRow+=t,n.startColumn+=i):o?(n.startColumnRelative=!0,n.startColumn-=i):s?(n.startRowRelative=!0,n.startColumnRelative=!1,n.startRow-=t,n.startColumn+=i):(n.startColumnRelative=!0,n.startColumn-=i));f=n.endRowRelative;e=n.endColumnRelative;u&&(f&&e?(n.endRowRelative=!1,n.endColumnRelative=!1,n.endRow+=t,n.endColumn+=i):f?(n.endColumnRelative=!0,n.endColumn-=i):e?(n.endRowRelative=!0,n.endColumnRelative=!1,n.endRow-=t,n.endColumn+=i):(n.endColumnRelative=!0,n.endColumn-=i))},at.prototype.changeCellExpressionReference=function(n,t,i){var r=n.rowRelative,u=n.columnRelative;r&&u?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=i):r?(n.columnRelative=!0,n.column-=i):u?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=i):(n.columnRelative=!0,n.column-=i)},at.prototype.rangeToString=function(r){var c,f,o,e;if(!r)return i;var v=n.Sheets,l=t.Calc,u=this._sheet,s=u._activeRowIndex,h=u._activeColIndex,a=u.referenceStyle()===1;return r.row<0&&r.col<0&&(r=new v.Range(0,-1,u.getRowCount(),-1)),c=u.findTable(r.row,r.col),f=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,this.isStructReference(c,r)?(t.features.formulatextbox&&f&&f.text&&f.sheet!==u&&(s=h=-1),l.rangeToFormulaWithStructReference(u,r,s,h,15,a,c)):(o=l.rangeToFormula(r,s,h,15,a),t.features.formulatextbox&&f&&f.text&&(e=u.getName(),(/^\d+$/.test(e)||t.StringUtil.contains(e," "))&&(e="'"+e+"'"),o=e+"!"+o),o)},at.prototype.isStructReference=function(n,t){if(!n)return!1;var i=!1,r=!1;if(t.rowCount===1){if(n.hasHeadersRow()&&t.row===n.startRow()||n.hasTotalsRow()&&t.row===n.endRow())return!0}else n.hasHeadersRow()&&t.row===n.startRow()&&(t.rowCount===n.dataRange().rowCount+1&&(i=!0),n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1+1&&(i=!0)),t.row===n.dataRange().row&&(t.rowCount===n.dataRange().rowCount&&(i=!0),n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1&&(i=!0));return t.col+t.colCount<=n.startColumn()+n.dataRange().colCount&&(r=!0),i&&r},at.prototype.stringToRange=function(r){if(!r)return i;var s=n.Sheets,f=t.Calc,u=this._sheet,e=u._activeRowIndex,o=u._activeColIndex;try{return f.formulaToRange(u,r,e,o)}catch(h){}return i},at.prototype.startDragFill=function(n){var t=this;t.isDraggingFill!==!0&&t.isWorking!==!0&&(t.updateDragFillStartRange(),t._dragFillStartRange)&&(t.isWorking=!0,t.isDraggingFill=!0,t._isDragAroundIndicator=!0,t._dragStartRowViewport=n.rowViewportIndex,t._dragStartColumnViewport=n.colViewportIndex,t._dragToRowViewport=n.rowViewportIndex,t._dragToColumnViewport=n.colViewportIndex,t.updateDragStartRangeViewports(),t.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType},t.startScroll())},at.prototype.updateDragStartRangeViewports=function(){var n=this,i=n.dragFillStartTopRow(),t;i>=0&&i<n._sheet.frozenRowCount?n._dragFillStartTopRowViewport=0:i>=n._sheet.frozenRowCount&&i<=n._sheet.getRowCount()&&(n._dragFillStartTopRowViewport=1);n._dragFillStartBottomRowViewport=n.isDragFillWholeColumns()?1:n._dragStartRowViewport;t=n.dragFillStartLeftColumn();t>=0&&t<n._sheet.frozenColCount?n._dragFillStartLeftColumnViewport=0:t>=n._sheet.frozenColCount&&t<=n._sheet.getColumnCount()&&(n._dragFillStartLeftColumnViewport=1);n._dragFillStartRightColumnViewport=n.isDragFillWholeRows()?1:n._dragStartColumnViewport},at.prototype.continueDragFill=function(){var n=this;if(n.startHitInfo&&n.isDraggingFill&&n.isWorking&&n._dragFillStartRange){if(n._dragToRowViewport=n.getHitRowViewportIndex(),n._dragToColumnViewport=n.getHitColumnViewportIndex(),n._dragToRow=n.getHitRowIndex(),n._dragToColumn=n.getHitColumnIndex(),n._dragToRow>=0&&n._dragToColumn>=0){n.updateCurrentFillSettings();n.updateCurrentFillRange();var t=n._sheet.parent,i=!1,r=n.getDragFillFrameRange();r&&(i=n.validateFillRange(n._currentFillRange));t&&t.showDragFillTip()&&i&&n._showDragFillTooltip();n.refreshDragFill()}n.continueScroll()}},at.prototype._getDragFillTooltipContent=function(){var v,e,p,s,w,r,b;if(!t.features.fill)return i;var n=this,u=n._sheet,h=n._dragFillStartRange,c=n._currentFillRange,l=n.getDragAutoFillType(),f=n.getCurrentFillDirection(),k=n.getDragFillFrameRange(),a;if(l===1){a=f===0||f===1?1:0;v=new t.FillImp(u);e=i;e=v.fillAuto(k,a,!0);var r=n._getAvailableRange(f,c,h),o=u.getActualStyle(r.row,r.col),d=o.cellType||u.getDefaultCellType(),y=o.formatter?o.formatter:o._autoFormatter;return e instanceof Date&&t.features.formatter&&(y=new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern+" hh:mm:ss AM/PM;@",0,t._CultureInfo._currentCulture.Name())),p=n.startHitInfo,s=3,p&&(s=n.startHitInfo.hitTestType),w={sheet:u,row:r.row,col:r.col,sheetArea:s},d.format(e,y,w)}else return l===0?(r=n._getAvailableRange(f,c,h),b=u.getFormula(r.row,r.col),b)?i:u.getText(r.row,r.col):i},at.prototype._getAvailableRange=function(n,i,r){var f=new t.Range(r.row,r.col,1,1),u;return n===3?(u=i.rowCount%r.rowCount,u=u===0?r.row+r.rowCount-1:r.row+u-1,f.row=u,f.col=r.col):n===1?(u=i.colCount%r.colCount,u=u===0?r.col+r.colCount-1:r.col+u-1,f.row=r.row,f.col=u):n===0?(u=i.colCount%r.colCount,u=u===0?r.col:r.col+r.colCount-u,f.row=r.row,f.col=u):n===2&&(u=i.rowCount%r.rowCount,u=u===0?r.row:r.row+r.rowCount-u,f.row=u,f.col=r.col),f},at.prototype._showDragFillTooltip=function(){var n=this,o=n.getDragAutoFillType();if(o===4||n.isDragFillWholeRows()||n.isDragFillWholeColumns())return n._removeTooltip(),i;else{var r,u,e,s=n._sheet,f=n.getCurrentFillDirection(),h=n.getDragFillFrameRange(),t=s._getRangeRect2(h);e=n._getDragFillTooltipContent();f===3?(r=t.x+t.width+n.DRAGFILLTOOLTIP_OFFSET,u=t.y+t.height+n.DRAGFILLTOOLTIP_OFFSET):f===1?(r=t.x+t.width+n.DRAGFILLTOOLTIP_OFFSET,u=t.y+t.height+n.DRAGFILLTOOLTIP_OFFSET):f===0?(r=t.x+n.DRAGFILLTOOLTIP_OFFSET,u=t.y+t.height+n.DRAGFILLTOOLTIP_OFFSET):f===2&&(r=t.x+t.width+n.DRAGFILLTOOLTIP_OFFSET,u=t.y+n.DRAGFILLTOOLTIP_OFFSET);n._showTooltip(e,r,u)}},at.prototype.refreshDragFill=function(){var n=this;n.clearDragFill();n.refreshSelectionBorder();n.paintDragFill();n._oldDragFillFrameRange=n.getDragFillFrameRange()},at.prototype.clearDragFill=function(){var t=this._sheet,n;this._oldDragFillFrameRange&&(n=t._getRangeRect2(this._oldDragFillFrameRange),n.x-=2,n.y-=2,n.width+=4,n.height+=4,t._render.copyDoubleBufferRect(n))},at.prototype.refreshSelectionBorder=function(n){var t=this._sheet;t._render.repaintSelection(this._dragFillStartRange,i,n)},at.prototype.paintDragFill=function(){var t=this._sheet,i=t._render,r=this.getDragFillFrameRange(),n,u;r&&(n=i._getCtx(),u=t._getRangeRect2(r),n.save(),n.beginPath(),i.paintDragRectangle(n,u),n.restore())},at.prototype.updateCurrentFillRange=function(){this._currentFillRange=this.getCurrentFillRange()},at.prototype.isDragFillWholeRows=function(){return this._dragFillStartRange.col===-1&&this._dragFillStartRange.row!==-1},at.prototype.isDragFillWholeColumns=function(){return this._dragFillStartRange.row===-1&&this._dragFillStartRange.col!==-1},at.prototype.isDragClear=function(){return this._currentFillDirection===4||this._currentFillDirection===5},at.prototype.getCurrentFillRange=function(){var n=this,i=-1,r=-1,u=-1,f=-1;switch(n._currentFillDirection){case 0:n.isDragFillWholeColumns()?(i=-1,u=-1):(i=n.dragFillStartTopRow(),u=n._dragFillStartRange.rowCount);r=n._dragToColumn;f=n.dragFillStartLeftColumn()-r;break;case 1:n.isDragFillWholeColumns()?(i=-1,u=-1):(i=n.dragFillStartTopRow(),u=n._dragFillStartRange.rowCount);r=n.dragFillStartRightColumn()+1;f=n._dragToColumn-r+1;break;case 2:i=n._dragToRow;u=n.dragFillStartTopRow()-i;n.isDragFillWholeRows()?(r=-1,f=-1):(r=n.dragFillStartLeftColumn(),f=n._dragFillStartRange.colCount);break;case 3:i=n.dragFillStartBottomRow()+1;u=n._dragToRow-i+1;n.isDragFillWholeRows()?(r=-1,f=-1):(r=n.dragFillStartLeftColumn(),f=n._dragFillStartRange.colCount);break;case 5:i=n._dragToRow;u=n.dragFillStartBottomRow()-i+1;n.isDragFillWholeRows()?(r=-1,f=-1):(r=n.dragFillStartLeftColumn(),f=n._dragFillStartRange.colCount);break;case 4:n.isDragFillWholeColumns()?(i=-1,u=-1):(i=n._dragFillStartRange.row,u=n._dragFillStartRange.rowCount);r=n._dragToColumn;f=n.dragFillStartRightColumn()-r+1;break;default:break}return new t.Range(i,r,u,f)},at.prototype.dragFillStartBottomRowLayout=function(){var n=this.dragFillStartBottomRow();return n!==-1?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(n):i},at.prototype.dragFillToViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportBottomRow())},at.prototype.dragFillToViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},at.prototype.dragFillStartRightColumnLayout=function(){var n=this.dragFillStartRightColumn();return n!==-1?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(n):i},at.prototype.dragFillToViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportRightColumn())},at.prototype.dragFillToViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},at.prototype.updateCurrentFillSettings=function(){var n=this,l=n.isDragFillWholeRows(),a=n.isDragFillWholeColumns(),y=t.GC$(n._sheet._getCanvas()).offset(),p=n.mousePosition.e,ft=n.mousePosition.x,w=n.mousePosition.y,h=p.pageX-y.left,c=p.pageY-y.top,b=!1,i,u,f,s,k,d,e;if(l||a?a?n._dragToColumn>=n.dragFillStartLeftColumn()&&n._dragToColumn<=n.dragFillStartRightColumn()?n._currentFillDirection=4:n._dragToColumn<n.dragFillStartLeftColumn()?n._currentFillDirection=0:n._dragToColumn>n.dragFillStartRightColumn()&&(n._currentFillDirection=1):l&&(n._dragToRow>=n.dragFillStartTopRow()&&n._dragToRow<=n.dragFillStartBottomRow()?n._currentFillDirection=5:n._dragToRow<n.dragFillStartTopRow()?n._currentFillDirection=2:n._dragToRow>n.dragFillStartBottomRow()&&(n._currentFillDirection=3)):n._dragToRow>=n.dragFillStartTopRow()&&n._dragToRow<=n.dragFillStartBottomRow()?n._dragToColumn>=n.dragFillStartLeftColumn()&&n._dragToColumn<=n.dragFillStartRightColumn()?(i=o(n._dragToColumn-n.dragFillStartRightColumn()),u=o(n._dragToRow-n.dragFillStartBottomRow()),u>i?n._currentFillDirection=5:u<i?n._currentFillDirection=4:(f=n.dragFillStartBottomRowLayout(),f||(f=n.dragFillToViewportBottomRowLayout()),w>f.y+f.height?n._currentFillDirection=3:(s=n.dragFillStartRightColumnLayout(),s||(s=n.dragFillToViewportRightColumnLayout()),k=s.x+s.width-ft,d=f.y+f.height-w,h>=s.x&&h<=s.x+s.width&&c>=f.y&&c<=f.y+f.height?n._currentFillDirection=k>=d?4:5:b=!0))):n._dragToColumn<n.dragFillStartLeftColumn()?n._currentFillDirection=0:n._dragToColumn>n.dragFillStartRightColumn()&&(n._currentFillDirection=1):n._dragToRow<n.dragFillStartTopRow()?n._dragToColumn>=n.dragFillStartLeftColumn()&&n._dragToColumn<=n.dragFillStartRightColumn()?n._currentFillDirection=2:n._dragToColumn<n.dragFillStartLeftColumn()?(i=o(n._dragToColumn-n.dragFillStartLeftColumn()),u=o(n._dragToRow-n.dragFillStartTopRow()),n._currentFillDirection=u>=i?2:0):n._dragToColumn>n.dragFillStartRightColumn()&&(i=o(n._dragToColumn-n.dragFillStartRightColumn()),u=o(n._dragToRow-n.dragFillStartTopRow()),n._currentFillDirection=u>=i?2:1):n._dragToRow>n.dragFillStartBottomRow()&&(n._dragToColumn>=n.dragFillStartLeftColumn()&&n._dragToColumn<=n.dragFillStartRightColumn()?n._currentFillDirection=3:n._dragToColumn<n.dragFillStartLeftColumn()?(i=o(n._dragToColumn-n.dragFillStartLeftColumn()),u=o(n._dragToRow-n.dragFillStartBottomRow()),n._currentFillDirection=u>=i?3:0):n._dragToColumn>n.dragFillStartRightColumn()&&(i=o(n._dragToColumn-n.dragFillStartRightColumn()),u=o(n._dragToRow-n.dragFillStartBottomRow()),n._currentFillDirection=u>=i?3:1)),e=n._sheet._dragFillIndicatorRect,e){var g=n.dragFillStartBottomRow(),nt=n.dragFillStartRightColumn(),et=g+1,ot=nt+1,st=n._sheet.getRowHeight(g,3),ht=n._sheet.getColumnWidth(nt,3),ct=n._sheet.getRowHeight(et,3),lt=n._sheet.getColumnWidth(ot,3),tt=e.x+e.width/2-r(10,ht/2),it=e.x+e.width/2+r(10,lt/2),rt=e.y+e.height/2-r(10,st/2),ut=e.y+e.height/2+r(10,ct/2),v=!1;l||a?a?v=tt<=h&&h<=it:l&&(v=rt<=c&&c<=ut):v=tt<=h&&h<=it&&rt<=c&&c<=ut;v||b?(n._isDragAroundIndicator=!0,n._currentFillDirection=4):n._isDragAroundIndicator=!1}},at.prototype.dragFillStartTopRow=function(){return this._dragFillStartRange?this._dragFillStartRange.row===-1?0:this._dragFillStartRange.row:-1},at.prototype.dragFillStartBottomRow=function(){var n=this;return n._dragFillStartRange?n._dragFillStartRange.row===-1?n._sheet.getRowCount()-1:n._dragFillStartRange.row+n._dragFillStartRange.rowCount-1:-1},at.prototype.dragFillStartLeftColumn=function(){return this._dragFillStartRange?this._dragFillStartRange.col===-1?0:this._dragFillStartRange.col:-1},at.prototype.dragFillStartRightColumn=function(){var n=this;return n._dragFillStartRange?n._dragFillStartRange.col===-1?n._sheet.getColumnCount()-1:n._dragFillStartRange.col+n._dragFillStartRange.colCount-1:-1},at.prototype.endDragFill=function(){var n=this,u=n._sheet,r,f,e,o,s;if(n.startHitInfo=i,n.stopScroll(),n._removeTooltip(),!n.isDraggingFill||!n.isWorking){n.resetDragFill();return}(n.isDraggingFill=!1,n.isWorking=!1,r=n.getDragFillFrameRange(),r)&&(f=n.validateFillRange(n._currentFillRange),!f||n._isDragAroundIndicator?(n.resetDragFill(),n.refreshSelection(r)):(e=n.getDragAutoFillType(),o=new t.UndoRedo.FillUndoAction(u,e,n._currentFillRange),u._doCommand(o),s=n._isCancelDragFill,!s&&n.isDragFill()&&u.showDragFillSmartTag()&&n._currentDragFillType!==4?n.showDragFillSmartTag(n._currentDragFillType):n.refreshSelection(r),n.resetDragFill()))},at.prototype.showDragFillSmartTag=function(n){if(t.features.fill_ui){var i=this._sheet,r=i._dragFillIndicatorRect,u={x:r.x+r.width,y:r.y+r.height,fillType:n};i._smartTag=new t._GcFillDialog(i.parent._getContainerDiv(),i,u);i._smartTag.open()}},at.prototype.updateDragFillStartRange=function(){var n=this._sheet;n._selectionModel.length===1?this._dragFillStartRange=n._selectionModel[0]:n._activeRowIndex>=0&&n._activeColIndex>=0&&(this._dragFillStartRange=new t.Range(n._activeRowIndex,n._activeColIndex,1,1))},at.prototype.resetDragFill=function(){this.isWorking=!1;this.isDraggingFill=!1},at.prototype.refreshSelection=function(n){this._sheet._render.repaintSelection(n)},at.prototype.getDragAutoFillType=function(){var n=this,r=n._sheet,t=r.defaultDragFillType(),i;return n.isDragClear()?4:t!==5?t:(i=n._dragFillStartRange.rowCount===1&&n._dragFillStartRange.colCount===1&&!n.isDragFillWholeColumns()&&!n.isDragFillWholeRows(),i?n.isControlPressed?1:0:n.isControlPressed?0:1)},at.prototype.getDragFillFrameRange=function(){var n=this;if(!n._dragFillStartRange)return i;if(n.isDragClear())return n._dragFillStartRange;if(!n._currentFillRange)return i;var r=0,u=0,f=0,e=0;return n.isVerticalDragFill()?(r=n._currentFillDirection===2?n._currentFillRange.row:n._dragFillStartRange.row,u=n._dragFillStartRange.rowCount+n._currentFillRange.rowCount,f=n._dragFillStartRange.col,e=n._dragFillStartRange.colCount):(r=n._dragFillStartRange.row,u=n._dragFillStartRange.rowCount,f=n._currentFillDirection===0?n._currentFillRange.col:n._dragFillStartRange.col,e=n._dragFillStartRange.colCount+n._currentFillRange.colCount),new t.Range(r,f,u,e)},at.prototype.validateFillRange=function(n){var r=this._sheet,i=!0,u="";return r._hasSpans(n.row,n.col,n.rowCount,n.colCount)&&(i=!1,u=t.SR.Exp_FillRangeContainsMergedCell),i&&r.isProtected&&r._isAnyCellInRangeLocked(n)&&(i=!1,u=t.SR.Exp_FillCellsReadOnly),i||r._raiseInvalidOperation(2,u),i},at.prototype.isDragFill=function(){return this.isIncreaseFill()||this.isDecreaseFill()},at.prototype.isIncreaseFill=function(){return this._currentFillDirection===3||this._currentFillDirection===1},at.prototype.isDecreaseFill=function(){return this._currentFillDirection===0||this._currentFillDirection===2},at.prototype.isVerticalDragFill=function(){return this._currentFillDirection===2||this._currentFillDirection===3||this._currentFillDirection===5},at.prototype.isDragToRowInView=function(){return this.isRowInViewport(this._dragToRowViewport,this._dragToRow)},at.prototype.isRowInViewport=function(n,t){var i=this._sheet.getViewportTopRow(n),r=this._sheet.getViewportBottomRow(n);return t>=i&&t<=r?!0:!1},at.prototype.getCurrentDragToRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragToRow)},at.prototype.isDragFillStartBottomRowInView=function(){return this.isRowInViewport(this._dragFillStartBottomRowViewport,this.dragFillStartBottomRow())},at.prototype.dragFillStartViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragStartRowViewport).findRow(this.dragFillStartViewportBottomRow())},at.prototype.dragFillStartViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragStartRowViewport)},at.prototype.getValidVerDragToRowLayout=function(){var n=this;return n.isIncreaseFill()?n.isDragToRowInView()?n.getCurrentDragToRowLayout():n.dragFillToViewportBottomRowLayout():n.isDragFillStartBottomRowInView?n.dragFillStartBottomRowLayout():n.dragFillStartViewportBottomRowLayout()},at.prototype.isDragToColumnInView=function(){return this.isColumnInViewport(this._dragToColumnViewport,this._dragToColumn)},at.prototype.isColumnInViewport=function(n,t){var i=this._sheet.getViewportLeftColumn(n),r=this._sheet.getViewportRightColumn(n);return t>=i&&t<=r?!0:!1},at.prototype.getCurrentDragToColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragToColumn)},at.prototype.isDragFillStartRightColumnInView=function(){return this.isColumnInViewport(this._dragFillStartRightColumnViewport,this.dragFillStartRightColumn())},at.prototype.dragFillStartViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragStartColumnViewport).findCol(this.dragFillStartViewportRightColumn())},at.prototype.dragFillStartViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragStartColumnViewport)},at.prototype.getValidHorDragToColumnLayout=function(){var n=this;return n.isIncreaseFill()?n.isDragToColumnInView()?n.getCurrentDragToColumnLayout():n.dragFillToViewportRightColumnLayout():n.isDragFillStartRightColumnInView()?n.dragFillStartRightColumnLayout():n.dragFillStartViewportRightColumnLayout()},at.prototype.dragFillToViewportTopRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportTopRow())},at.prototype.dragFillToViewportTopRow=function(){return this._sheet.getViewportTopRow(this._dragToRowViewport)},at.prototype.dragFillToViewportLeftColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportLeftColumn())},at.prototype.dragFillToViewportLeftColumn=function(){return this._sheet.getViewportLeftColumn(this._dragToColumnViewport)},at.prototype.getCurrentFillDirection=function(){switch(this._currentFillDirection){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 0;case 5:return 2;default:break}return 3},at.prototype.getHitRowViewportIndex=function(){var i=this._sheet,n=i._getRowViewportIndexNearY(this.mousePosition.y),r=this.startHitInfo.scrollRowViewportIndex,t=i._getRowLayout(1);return n===0&&r>0&&t.length>0&&t[0].row>i._getFirstPageTopRow()?n=1:n===2&&r<2&&t.length>0&&t[t.length-1].row<i._getLastVisualRow()&&(n=1),n},at.prototype.getHitColumnViewportIndex=function(){var i=this._sheet,n=i._getColumnViewportIndexNearX(this.mousePosition.x),r=this.startHitInfo.scrollColViewportIndex,t=i._getColumnLayout(1);return n===0&&r>0&&t.length>0&&t[0].col>i._getFirstPageLeftColumn()?n=1:n===2&&r<2&&t.length>0&&t[t.length-1].col<i._getLastVisualColumn()&&(n=1),n},at.prototype.getHitRowIndex=function(){var t=this._sheet,i=this.mousePosition.y,r=this.getHitRowViewportIndex(),f=t._getViewportRowLayoutNearY(r,i),u,n;return f?(u=t._getSheetLayout(),n=f.row,r===1&&i<u.viewportY&&n>t._getFirstPageTopRow())?t._getNextVisualRow(n-1)||n:r===1&&i>u.frozenTrailingY&&n>t._getLastFullyVisibleRow()?t._getPrevVisualRow(n)||n:n:-1},at.prototype.getHitColumnIndex=function(){var t=this._sheet,i=this.mousePosition.x,r=this.getHitColumnViewportIndex(),f=t._getViewportColumnLayoutNearX(r,i),u,n;return f?(u=t._getSheetLayout(),n=f.col,r===1&&i<u.viewportX&&n>t._getFirstPageLeftColumn())?t._getNextVisualColumn(n-1)||n:r===1&&i>u.frozenTrailingX&&n>t._getLastFullyVisibleColumn()?t._getPrevVisualColumn(n)||n:n:-1},at.prototype.getIntervalFromDistance=function(n){var t=0,i;return isNaN(n)||n===0||(i=n<0,n=o(n),t=ot(500/n),t=f(20,t*10),t>200&&(t=200),i&&(t=-t)),t},at.prototype.updateRange=function(n,t,i,r){if(i!==0&&r!==0){var a=this,e=a._sheet,y=3,o=e._getRowLayout(0,y),s=e._getColumnLayout(0,y),h=e._getRowLayout(1,y),c=e._getColumnLayout(1,y),p=0;s&&s.length>0&&(p=s[s.length-1].col);c&&c.length>0&&(p=c[c.length-1].col);var l=a.getYForRow(n,t,i,r,!0,p,o,h),w=a.getYForRow(n,t,i,r,!1,p,o,h),b=0;o&&o.length>0&&(b=o[o.length-1].row);h&&h.length>0&&(b=h[h.length-1].row);var f=a.getXForCol(n,t,i,r,!0,b,s,c),v=a.getXForCol(n,t,i,r,!1,b,s,c),u=e._getSheetLayout(),k=e._render;v>f&&w>l&&k.update(f-u.headerX-2,l-u.headerY-2,v-f+2*u.headerX+2,w-l+2*u.headerY+2);w>l&&k.update(u.headerX,l,u.rowHeaderWidth,w-l);v>f&&(k.update(f,u.headerY,v-f,u.colHeaderHeight),k.update(f,u.footerY,v-f,u.colHeaderHeight))}},at.prototype.getYForRow=function(n,t,i,r,u,e,o,s){var v=this._sheet,c=n,l,a,h;if(u||(c=n+i-1),c<v.frozenRowCount){if(o.length<1)return-1}else{if(s.length<1)return-1;u?c<s[0].row&&(c=s[0].row):c>s[s.length-1].row&&(c=s[s.length-1].row)}for(l=0,u&&(l=9e4),a=f(v._scrollLeftCol,t);a<t+r&&a<=e;a++)h=v.getCellRect(c,a),h&&(u?h.y<l&&(l=h.y):l<h.y+h.height&&(l=h.y+h.height));return l},at.prototype.getXForCol=function(n,t,i,r,u,e,o,s){var v=this._sheet,c=t,l,a,h;if(u||(c=t+r-1),c<v.frozenColCount){if(o.length<1)return}else{if(s.length<1)return;u?c<s[0].col&&(c=s[0].col):c>s[s.length-1].col&&(c=s[s.length-1].col)}for(l=0,u&&(l=9e4),a=f(v._scrollTopRow,n);a<n+i&&a<=e;a++)h=v.getCellRect(a,c),h&&(u?h.x<l&&(l=h.x):l<h.x+h.width&&(l=h.x+h.width));return l},at.prototype._getPreVisualRow=function(n,t){var u=this._sheet,r=u._getPrevVisualRow(n,t);return r!==i?r:n},at.prototype._getPreVisualCol=function(n,t){var u=this._sheet,r=u._getPrevVisualColumn(n,t);return r!==i?r:n},at.prototype._getPreVisibleRow=function(n,t,i){for(var r=this._sheet;n>t;)if(n--,r.getRowVisible(n,i))return n;return n},at.prototype._getPreVisibleCol=function(n,t,i){for(var r=this._sheet;n>t;)if(n--,r.getColumnVisible(n,i))return n;return n},at.prototype._getResizeRowInfo=function(n,r,u,e,o){var h=i,l,c,s,a,w,y,v,p;return n.canDoResizeRows()?(l=this,c=n._getRowLayout(r.rowViewportIndex,e),!c||isNaN(r.row)||isNaN(r.col)||(n.getRowVisible(r.row)||(r.row=this._getPreVisualRow(r.row,e)),s=c.findRow(r.row),s&&(s.y+s.height-u<=o&&o<=s.y+s.height+u?(h={action:"sizeRow",index:r.row,sheetArea:e},a=c[c.length-1].row,a>=0&&(w=n._getLastVisualRow(e),h.index===w&&h.index!==a&&s.y+s.height-u/2<=o&&(h={action:l.getResizeRowAction(n,a,e),index:a,sheetArea:e}))):s.y-u<=o&&o<=s.y+u&&t.ArrayHelper.indexOf(c,s)>0&&(y=l._getPreVisibleRow(r.row,0,e),h={action:l.getResizeRowAction(n,y,e),index:y,sheetArea:e})),!h&&r.rowViewportIndex===1&&c.length>0&&(s=c[0],f(0,s.y-u)<=o&&o<=s.y+u&&(v=r.row-1,p=n._getRowLayout(r.rowViewportIndex-1,e),v>=0&&p&&!p.findRow(v)&&(h={action:l.getResizeRowAction(n,v,e),index:v,sheetArea:e})))),h&&!n.getRowResizable(h.index,e)&&(h=i),h):h},at.prototype.getResizeRowAction=function(n,t,i){var r=n.parent;return r&&r.resizeZeroIndicator()===1&&n.getRowVisible(t)&&n._getActualRowHeight(t,i)===0?"sizeHiddenRow":"sizeRow"},at.prototype._getResizeColInfo=function(n,r,u,e,o){var h=i,l,c,s,a,w,y,v,p;return n.canDoResizeColumns()?(l=this,c=n._getColumnLayout(r.colViewportIndex,e),!c||isNaN(r.col)||isNaN(r.row)||(n.getColumnVisible(r.col)||(r.col=this._getPreVisualCol(r.col,e)),s=c.findCol(r.col),s&&(s.x+s.width-u<=o&&o<=s.x+s.width+u?(h={action:"sizeCol",index:r.col,sheetArea:e},a=c[c.length-1].col,a>=0&&(w=n._getLastVisualColumn(e),h.index===w&&h.index!==a&&s.x+s.width-u/2<=o&&(h={action:l.getResizeColAction(n,a,e),index:a,sheetArea:e}))):s.x-u<=o&&o<=s.x+u&&t.ArrayHelper.indexOf(c,s)>0&&(y=l._getPreVisibleCol(r.col,0,e),h={action:l.getResizeColAction(n,y,e),index:y,sheetArea:e})),!h&&r.colViewportIndex===1&&c.length>0&&(s=c[0],f(0,s.x-u)<=o&&o<=s.x+u&&(v=r.col-1,p=n._getColumnLayout(r.colViewportIndex-1,e),v>=0&&p&&!p.findCol(v)&&(h={action:l.getResizeColAction(n,v,e),index:v,sheetArea:e})))),h&&!n.getColumnResizable(h.index,e)&&(h=i),h):h},at.prototype.getResizeColAction=function(n,t,i){var r=n.parent;return r&&r.resizeZeroIndicator()===1&&n.getColumnVisible(t)&&n._getActualColumnWidth(t,i)===0?"sizeHiddenCol":"sizeCol"},at.prototype.getResizingRowCol=function(n,t,r,u){var c=this,f=c._sheet,y=f.parent,e=i,s,h,l,a,v;return(!y||y._allowUserResize)&&(l=f._getSheetLayout(),n.rowViewportIndex<0&&n.colViewportIndex>=0&&f.colHeaderVisible?(e=c._getResizeColInfo(f,n,u,1,t),e||(e=c._getResizeRowInfo(f,n,u,1,r))):n.rowViewportIndex>=0&&n.colViewportIndex<0&&f.rowHeaderVisible?(e=c._getResizeRowInfo(f,n,u,2,r),e||(e=c._getResizeColInfo(f,n,u,2,t))):n.rowViewportIndex<0&&n.colViewportIndex<0?f._getLastVisualRow(2)===i&&o(r-l.colHeaderHeight)<=u?(a=f._getRowLayout(1),a&&a.length>0&&(s=a[a.length-1].row),s>=0&&f.getRowResizable(s,2)&&(e={action:c.getResizeRowAction(f,s,2),index:s,sheetArea:2})):f._getLastVisualColumn(1)===i&&o(t-l.rowHeaderWidth)<=u&&(v=f._getColumnLayout(1),v&&v.length>0&&(h=v[v.length-1].col),h>=0&&f.getColumnResizable(h,1)&&(e={action:c.getResizeColAction(f,h,1),index:h,sheetArea:1})):n.rowViewportIndex>=0&&n.colViewportIndex>=0&&(l.colHeaderHeight===0&&r<=u&&f.colHeaderVisible?(s=f.getRowCount(1)-1,s>=0&&(e={action:"sizeHiddenRow",index:s,sheetArea:1})):l.rowHeaderWidth===0&&t<=u&&f.rowHeaderVisible&&(h=f.getColumnCount(2)-1,h>=0&&(e={action:"sizeHiddenCol",index:h,sheetArea:2})))),e},at.prototype.getDragInfo=function(n,t,r){var o=this,f=i,s=n.rowViewportIndex,h=n.colViewportIndex,c,l,u,e;if(typeof s===k||s===i||typeof h===k||h===i||(c=o._sheet,l=c._getActiveSelectedRange(),l.row===-1&&l.col===-1))return f;if(s>=0&&h>=0&&c._selectionModel.length===1){if(o.inGrayArea(s,h,t,r))return f;u=c._getRangeRect(s,h,l);u.x-4<t&&t<u.x+4&&u.y<=r&&r<u.y+u.height&&(f={action:"drag",side:"left"});f||(e=o._sheet._dragFillIndicatorRect,e&&e.x<=t&&t<=e.x+e.width&&e.y<=r&&r<=e.y+e.height&&(f={action:"drag",side:"corner"}));f||u.x+u.width-4<t&&t<u.x+u.width+4&&u.y<=r&&r<u.y+u.height&&(f={action:"drag",side:"right"});f||u.y-4<r&&r<u.y+4&&u.x<=t&&t<u.x+u.width&&(f={action:"drag",side:"top"});f||u.y+u.height-4<r&&r<u.y+u.height+4&&u.x<=t&&t<u.x+u.width&&(f={action:"drag",side:"bottom"});f&&(t<u.x||t>u.x+u.width||r<u.y||r>u.y+u.height)&&(f.outside=!0)}return o._sheet.canUserDragDrop()||f&&f.side!=="corner"&&(f.side=i),o._sheet.canUserDragFill()||f&&f.side==="corner"&&(f.side=i),f},at.prototype.inGrayArea=function(n,t,i,r){var o=this._sheet,c=o._getSheetLayout(),u=c.viewportRect(1,1),f,s,e,h;if(t===1)if(f=o._getColumnLayout(t),f&&f.length>0){if(s=f[f.length-1],s.x+s.width<=i&&i<u.x+u.width)return!0}else if(u.contains(i,r))return!0;if(n===1)if(e=o._getRowLayout(n),e&&e.length>0){if(h=e[e.length-1],h.y+h.height<=r&&r<u.y+u.height)return!0}else if(u.contains(i,r))return!0;return!1},at.prototype.doMouseMove=function(n){var t=this._getCanvasOffset();this.doMouseMoveImp(n,n.pageX-t.left,n.pageY-t.top)},at.prototype.doMouseOut=function(n){var r=this._sheet,t=r._currentTarget,u;if(t&&t.cellTypeHitInfo){var f=t.row,e=t.col,o=r.getCellType(f,e,t.hitTestType);o.processMouseLeave(t.cellTypeHitInfo)}this.isWorking||(u={x:-1e4,y:-1e4,rowViewportIndex:i,colViewportIndex:i,row:-1,col:-1,resizeInfo:i,hitTestType:i},r._setHoverCell(u))},at.prototype._hoverShowComment=function(n){var t=this._sheet,i=-1,r=-1,u;if(n&&n.rowViewportIndex>=0&&n.colViewportIndex>=0&&(i=n.row,r=n.col),t.parent){if(i<0||r<0)return;u=t.getComment(i,r);t._commentManager&&t._commentManager.hoverShowComment(u)}},at.prototype.doMouseMoveImp=function(n,i,r){var u=this,f,e;if(u.mousePosition={e:n,x:i,y:r},f=u._sheet,u.isMouseDown&&(t.FocusHelper.isActiveElement(f)||t.FocusHelper.setActiveElement(f)),u.isMouseDown&&u.isWorking){u.isResizing?u.continueResizing():u.isDragDropping?u.continueDragDropping():u.isDraggingFill?u.continueDragFill():u.isFormulaRangeAppending?u.continueFormulaRangeAppending():u.isFormulaRangeMoving?u.continueFormulaRangeMoving():u.isFormulaRangeResizing?u.continueFormulaRangeResizing():u.isSelecting&&u.continueSelecting();return}(e=f.hitTest(i,r),e)&&(t.features.comment&&u._hoverShowComment(e),u.updateCanvasCursor(e),f._setHoverCell(e))},at.prototype.updateCanvasCursor=function(n){var u=this,e=u._sheet,r=e._getCanvas(),t,h;if(r){if(t=e._currentTarget,h=!t||n.row!==t.row||n.col!==t.col||n.hitTestType!==t.hitTestType||n.resizeInfo&&!t.resizeInfo||!n.resizeInfo&&t.resizeInfo||n.resizeInfo&&n.resizeInfo.action!==t.resizeInfo.action||n.dragInfo&&!t.dragInfo||!n.dragInfo&&t.dragInfo||n.dragInfo&&n.dragInfo.action!==t.dragInfo.action,t&&h&&t.cellTypeHitInfo){var p=t.row,w=t.col,l=e.getCellType(p,w,t.hitTestType);l.processMouseLeave(t.cellTypeHitInfo)}var s=n.resizeInfo,c=n.dragInfo,f=n.formulaRangeHitInfo,o=n.cellTypeHitInfo,a=e._render;if(s)r.style.cursor=s.action==="sizeCol"?"col-resize":s.action==="sizeRow"?"row-resize":s.action==="sizeHiddenCol"?"w-resize":s.action==="sizeHiddenRow"?"n-resize":"default";else if(c&&c.action==="drag")c.side==="corner"?r.style.cursor="crosshair":c.side&&(r.style.cursor="move");else if(f){f.inBorder?r.style.cursor="move":f.inTopLeft?r.style.cursor="nw-resize":f.inTopRight?r.style.cursor="ne-resize":f.inBottomLeft?r.style.cursor="sw-resize":f.inBottomRight&&(r.style.cursor="se-resize");var b=u.isFormulaRangeHoving,v=u._formulRangeHovingInfo,k=v&&v.paramRange,y=f.paramRange;u.isFormulaRangeHoving=!0;u._formulRangeHovingInfo={paramRange:y};b&&y.index===k.index||a.paintFormulaTextBox()}else{if(o){var d=n.row,g=n.col,l=e.getCellType(d,g,n.hitTestType);o.sheet=e;h&&l.processMouseEnter(o);l.processMouseMove(o)}!h&&o&&o.isReservedLocation||(r.style.cursor="default");u.isFormulaRangeHoving&&(u.isFormulaRangeHoving=!1,u._formulRangeHovingInfo=i,a.paintFormulaTextBox())}}},at.prototype.doMouseUp=function(n){var t=this,i=t._sheet,r;if(i.inCanvas||t.unhandleDocumentMouseMove(),r=t._getCanvasOffset(),i._isMouseDownInSheet)i._isMouseDownInSheet=!1;else return!0;return t.doMouseUpImp(n,n.pageX-r.left,n.pageY-r.top),!1},at.prototype.doMouseUpImp=function(n,i,r){var u=this,e=u._sheet,o=t.FocusHelper.getActiveElement(),f;if(u.isMouseDown=!1,o&&o!==e&&o.endEdit&&(o.endEdit(),o.repaint()),t.FocusHelper.setActiveElement(e),u.isResizing)u.stopResizing();else if(u.isDragDropping)u.stopDragDrop();else if(u.isDraggingFill)u.endDragFill();else if(u.isFormulaRangeAppending)u.stopFormulaRangeAppending();else if(u.isFormulaRangeMoving)u.stopFormulaRangeMoving();else if(u.isFormulaRangeResizing)u.stopFormulaRangeResizing();else if(e._currentTarget){if(f=e._currentTarget,f.cellTypeHitInfo){var s=f.row,h=f.col,c=e.getCellType(s,h,f.hitTestType);f.cellTypeHitInfo.sheet||(f.cellTypeHitInfo.sheet=e);c.processMouseUp(f.cellTypeHitInfo)}f.cellTypeHitInfo&&f.cellTypeHitInfo.isReservedLocation||e.triggerCellClick({sheet:e,sheetName:e._name,sheetArea:f.hitTestType,row:f.row,col:f.col})}u.stopSelecting();u.setMetaKeyState(n)},at.prototype.startEdit=function(n){var t=this._sheet,r=t._getCanvas(),i=this._getCanvasOffset();n.shiftKey||n.ctrlKey||t._doStartEdit(r,n.pageX-i.left,n.pageY-i.top)},at.prototype.doKeyDown=function(n){var r=this,i=r._sheet,o,s,h,c;if(i){var u=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),e=i.getCellType(u,f),l={isEditing:i.isEditing(),sheet:i,row:u,col:f,sheetArea:3},a={sheet:i,row:u,col:f,sheetArea:3};if(e&&e.isReservedKey(n,l)){i.isEditing()||e.processKeyDown(n,a);return}if(o=i._formulaTextBox,o&&o.isReservedKey(n))return;if(s=i.parent&&i.parent._attachedFormulaTextBox,s&&s.isReservedKey(n))return}if(h=!i.isEditing()&&!n.ctrlKey&&!n.metaKey&&(n.keyCode===34||n.keyCode===33||n.keyCode===37||n.keyCode===39||n.keyCode===9||n.keyCode===13||n.keyCode===38||n.keyCode===40),i._isTouchMode&&(i._isTouchMode=!1,i._render.refreshTouchSelectionIndicator()),c=r._keyDownImp(n),h&&c&&t.FocusHelper.isActiveElement(i)){if(r._keyPressed){r._keyPressedCount<25&&r._keyPressedCount++;t.util.cancelDefault(n);return}r._keyPressed=!0;r._keyPressedCount=1;r._repeatKeyDown(n,!0)}},at.prototype._getMouseDownResizeTooltipContent=function(){var i=this._sheet,f=i._currentTarget,n=f.resizeInfo,e,r,o,u;return n.action==="sizeRow"||n.action==="sizeHiddenRow"?(e=i._getAllRowLayout(n.sheetArea),i.getRowVisible(n)||(n.index=this._getPreVisualRow(n.index,n.sheetArea)),r=e.findRow(n.index),r||(r=e.findRow(f.row)),t._StringHelper.format(t.SR.Tip_Height,[r.height.toFixed(0)])):(o=i._getAllColumnLayout(n.sheetArea),i.getColumnVisible(n.index)||(n.index=this._getPreVisualCol(n.index,n.sheetArea)),u=o.findCol(n.index),u||(u=o.findCol(f.col)),t._StringHelper.format(t.SR.Tip_Width,[u.width.toFixed(0)]))},at.prototype._getMouseMoveResizeTooltipContent=function(n){return n.action==="sizeRow"||n.action==="sizeHiddenRow"?t._StringHelper.format(t.SR.Tip_Height,[(n.movingY-n.startY).toFixed(0)]):t._StringHelper.format(t.SR.Tip_Width,[(n.movingX-n.startX).toFixed(0)])},at.prototype._repeatKeyDown=function(n,t){var i=this;i._keyPressed&&(t||i._keyDownImp(n),i._keyPressed&&(i._repeatKeyDownTimeoutID=window.setTimeout(function(){i._repeatKeyDown(n)},500/i._keyPressedCount)))},at.prototype._startEditByKeyboard=function(n){var t=this._sheet,u=t._getCanvas(),f,r;if(u){t._startEditByKeydown=!0;try{f=t.isEditing();t._startEditImp(u,t._activeRowIndex,t._activeColIndex,i,i,!0);!f&&t.isEditing()&&(r=t.getCellType(t._activeRowIndex,t._activeColIndex),!r._triggerButtonClicked||n.keyCode!==32||n.ctrlKey||n.shiftKey||n.altKey||r._triggerButtonClicked(t,t._activeRowIndex,t._activeColIndex,3),r._cancelDefaultKeydown&&r._cancelDefaultKeydown(n))}finally{t._startEditByKeydown=!1}}},at.prototype._keyDownImp=function(n){var u=this,r=u._sheet,o,f,s,e,h;return(u.setMetaKeyState(n),r.isEditing()||n.keyCode!==27||n.altKey||n.ctrlKey||n.shiftKey||!r._validationInputMessage||(t.GC$(r._validationInputMessage).remove(),r._validationInputMessage=i),r.isEditing()||n.keyCode!==34&&n.keyCode!==33&&n.keyCode!==35&&n.keyCode!==36&&n.keyCode!==38&&n.keyCode!==40||t.util.cancelDefault(n),r.isEditing()||n.keyCode!==37&&n.keyCode!==39||t.util.cancelDefault(n),t.features.tableSlicer&&r._processSlicerKeyMap(n))?!1:t.features.floatingObject&&r._processFloatingObjectsKeyMap(n)?!1:t.features.comment&&r._processCommentKeyMap(n)?!1:r._processKeyMap(n)?!0:(o=n.keyCode===229||n.keyCode===0,u.allowEnterEditing(n)&&!o&&(f=r._formulaTextBox,f&&f.isAppending()&&f.stopAppending(),s=r.isEditing(),s||(e=t.Global.prototype.getUIElement(n.target),h=e&&e.getAttribute(v)==="gcAttachedFormulaTextBox",h||u._startEditByKeyboard(n))),!1)},at.prototype.clearRepeatKeyDownTimeout=function(){var n=this;n._keyPressed=!1;n._repeatKeyDownTimeoutID>0&&(window.clearTimeout(n._repeatKeyDownTimeoutID),n._repeatKeyDownTimeoutID=0)},at.prototype.doKeyUp=function(n){var i=this,t,e,o;if(i.clearRepeatKeyDownTimeout(),t=i._sheet,t){var r=t.getActiveRowIndex(),u=t.getActiveColumnIndex(),f=t.getCellType(r,u),s={isEditing:t.isEditing(),sheet:t,row:r,col:u,sheetArea:3},h={sheet:t,row:r,col:u,sheetArea:3};if(f&&f.isReservedKey(n,s)){t.isEditing()||f.processKeyUp(n,h);return}if(e=t._formulaTextBox,e&&e.isReservedKey(n))return;if(o=t.parent&&t.parent._attachedFormulaTextBox,o&&o.isReservedKey(n))return}i.setMetaKeyState(n)},at.prototype.doCompositionStart=function(n){this._startEditByKeyboard(n)},at.prototype.allowEnterEditing=function(n){if(n.ctrlKey||n.altKey||n.metaKey)return!1;if(n.keyCode>=65&&n.keyCode<=90)return!0;else if(n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=105)return!0;else if(n.keyCode>=186&&n.keyCode<=192)return!0;else if(n.keyCode>=220&&n.keyCode<=222||n.keyCode===219)return!0;else if(n.keyCode>=106&&n.keyCode<=111)return!0;else if(n.keyCode===32)return!0;else if(n.keyCode===61)return!0;else if(n.keyCode===173)return!0;else if(n.keyCode===229||n.keyCode===0)return!0;else if(n.keyCode===8)return!0;return!1},at.prototype.setMetaKeyState=function(n){var i=this,r=i._sheet,o=t.util.isMacOS(),f=o?n.metaKey:n.ctrlKey,u;if(i.ctrl=f&&!n.shiftKey,i.shift=n.shiftKey&&!f,r._isNavigateInSelection=!1,n.keyCode===9&&(r._selectionModel.length>1?r._isNavigateInSelection=!0:(u=r._getActiveSelectedRange(),u&&r._selectionModel.length>0&&(r._isNavigateInSelection=!(r._activeRowIndex===u.row&&r._activeColIndex===u.col&&r._activeRowCount===u.rowCount&&r._activeColCount===u.colCount)))),i.isDragDropping===!0){var e=r._getActiveSelectedRange(),s=i._isDragInsert,h=i._isDragCopy;i._isDragInsert=e.row===-1||e.col===-1?n.shiftKey:!1;i._isDragCopy=n.ctrlKey;(s!==i._isDragInsert||h!==i._isDragCopy)&&r._render.refreshDragDropIndicator()}i.isShiftPressed=n.shiftKey;i.isControlPressed=n.ctrlKey},at.prototype.resetMetaKeyState=function(){var n=this;n.shift=!1;n.ctrl=!1;n._sheet._isNavigateInSelection=!1;n.isDragDropping=!1;n._isDragInsert=!1;n._isDragCopy=!1;n.isShiftPressed=!1;n.isControlPressed=!1},at.prototype.doMouseWheel=function(n,i,r){var u=this._sheet,c=!1,l=!1,a=u._slicerCollection,y,o,p,s,f,h,w;if(a&&a.mouseWheelSelectedSlicer(n))return!0;if(n.ctrlKey){if(!u.parent||u.parent._allowUserZoom){var v=u._zoomFactor,e=u._zoomFactor-.05*i,b=new t.UndoRedo.ZoomUndoAction(u,e);u._doCommand(b);e=u._zoomFactor;v!==e&&u.triggerUserZooming({sheet:u,sheetName:u._name,oldZoomFactor:v,newZoomFactor:e})}}else y=u._scrollTopRow,o=this._getNewTopRow(i),y!==o?(this.vScrollTo(o),u._syncVScrollbarPosition(),f=u.parent,f&&!f._scrollbarShowMax&&u._syncVScrollbarSize()):c=!0,p=u._scrollLeftCol,s=this._getNewLeftCol(r),p!==s?(this.hScrollTo(s),u._syncHScollbarPosition(),f=u.parent,f&&!f._scrollbarShowMax&&u._syncHScrollbarSize()):l=!0;return t.features.comment&&(h=this._getCanvasOffset(),w=u.hitTest(n.pageX-h.left,n.pageY-h.top),this._hoverShowComment(w)),c&&l},at.prototype._getNewTopRow=function(n){var r=this._sheet,t=r._scrollTopRow,u,f,e;return r.frozenRowCount>0&&(r._scrollTopRow===0&&n>0?t=r.frozenRowCount:n<0&&r._scrollTopRow===r.frozenRowCount-n&&(t=0)),n<0?(u=r._getScrollableRow(t+n,!0),t=u!=-1?u:t+n):n>0&&(u=r._getScrollableRow(t+n),t=u!=-1?u:t+n),f=r._getFirstPageTopRow(),e=r._getLastVisualScrollRow(),t<f?t=f:t>e&&(t=e),t===i&&(t=-1),t},at.prototype._getNewLeftCol=function(n){var r=this._sheet,t=r._scrollLeftCol,u,f,e;return r.frozenColCount>0&&(r._scrollLeftCol===0&&n>0?t=r.frozenColCount:n<0&&r._scrollLeftCol===r.frozenColCount-n&&(t=0)),n<0?(u=r._getScrollableColumn(t+n,!0),t=u!=-1?u:t+n):n>0&&(u=r._getScrollableColumn(t+n),t=u!=-1?u:t+n),f=r._getFirstPageLeftColumn(),e=r._getLastVisualScrollColumn(),t<f?t=f:t>e&&(t=e),t===i&&(t=-1),t},at.prototype.updateEditingEditor=function(n){var i,f,h,c,s;if(n&&n.sheet?(i=n.sheet,f=n.editor,h=n.canvasOffset):(i=this._sheet,f=i._editor),i.isEditing()){var e=i._activeRowIndex,o=i._activeColIndex,l=i.getCellType(e,o),u=i._getSheetLayout(),a=i.getActualStyle(e,o),r=i.getCellRect(e,o);r&&r.width>0&&r.height>0&&r.x>=u.frozenX&&r.y>=u.frozenY&&r.x+r.width<=u.frozenTrailingX+u.frozenTrailingWidth&&r.y+r.height<=u.frozenTrailingY+u.frozenTrailingHeight?(c={sheet:i,row:e,col:o,sheetArea:3,canvasOffset:h},l.updateEditor(f,a,r,c)):t.GC$(f).css({top:-1e4,left:-1e4});s=i._formulaTextBox;s&&s.position()}},at.prototype.doVScroll=function(n){var t=this,i=t._sheet;t.scrolling=!0;t.newTop=n;t.newLeft=i._scrollLeftCol;t.scrollTimer||(t.scrollTimer=window.setInterval(function(){t._scrollView()},t.waittime))},at.prototype.doHScroll=function(n){var t=this,i=t._sheet;t.scrolling=!0;t.newLeft=n;t.newTop=i._scrollTopRow;t.scrollTimer||(t.scrollTimer=window.setInterval(function(){t._scrollView()},t.waittime))},at.prototype._scrollView=function(){var n=this;if(!n.scrolling){n.scrollTimer&&(window.clearInterval(n.scrollTimer),n.scrollTimer=i);return}n.scrolling=!1;n._updateView()},at.prototype._showScrollTooltip=function(n,t){var i=this,r,u;n?(r=t.pageY,u=t.pageX-i.VSCROLLTOOLTIP_LEFT):(r=t.pageY-i.HSCROLLTOOLTIP_TOP,u=t.pageX-i.HSCROLLTOOLTIP_LEFT);i._showTooltip(i._getScrollTooltipContent(n),u,r,!0)},at.prototype._getScrollTooltipContent=function(n){var i=this._sheet;return n?t.SR.Tip_Row+(i._scrollTopRow+1):i.colHeaderAutoText===1?t.SR.Tip_Column+(i._scrollLeftCol+1):t.SR.Tip_Column+i._indexToLetters(i._scrollLeftCol+1)},at.prototype._dataContextLoaded=function(n,t){var r=n.data,u,f,i;if(r&&r.length>0){if(u=this._sheet,f=u.getDataSource(),f&&this.lastLoadedRowIndex===n.start)for(i=0;i<r.length;i++)f[n.start+i]=r[i];u.recalcAll();u.repaint()}},at.prototype.getElementById=function(n,t){var r,u;if(!n)return i;for(r=n.firstChild;r;){if(r.id===t||r.name===t)return r;if(u=this.getElementById(r,t),u)return u;r=r.nextSibling}return i},at.prototype._updateView=function(){var n=this,i=n._sheet,r,t;n.painting||(n.painting=!0,r=i.parent,t=0,r&&(t=r.showScrollTip()),n.newTop!==i._scrollTopRow?(n.vScrollTo(n.newTop),(t===2||t===3)&&n._refreshTooltip(n._getScrollTooltipContent(!0))):n.newLeft!==i._scrollLeftCol&&(n.hScrollTo(n.newLeft),(t===1||t===3)&&n._refreshTooltip(n._getScrollTooltipContent(!1))),n.painting=!1)},at.prototype.vScrollTo=function(n){var i=this._sheet,p=i._scrollTopRow,tt,w,d,h,c,l,f,g,nt;if(n!==p&&(i._scrollTopRow=n,i.triggerTopRowChanged({sheet:i,sheetName:i._name,oldTopRow:p,newTopRow:n}),!i._paintSuspended&&!(i._layoutSuspended>0))){if(t.features.comment&&(tt=i._commentManager,tt.updateCommentsLayoutWhenSheetScroll()),w=!1,t.util._useDoubleBuffer()){var b=i.getBounds(),a=i._getSheetLayout(),v=a.viewportY,o=a.viewportHeight,r,y,e,s,u=i._render,k=u._getCtx();if(n>p){if(c=i._getRowLayout(1),c&&c.length>0&&(d=c.findRow(n)),d){for(f=c.length-1,h=c[f];h.y+h.height>v+o;)f=f-1,h=c[f];h.row>n&&(w=!0,g=2,r=b?b.x:a.x,y=d.y,e=a.width,s=h.y+h.height-d.y-g,u.copyScreen(r,y,e,s,r,v),i.invalidateLayout(),u.paintBody(k,new t.Rect(r,v+s,e,o-s)),u.paintAdornment(k,new t.Rect(r,v,e,o)),i.parent&&i.parent._themeVersion>2007&&i.frozenRowCount===0&&u.repaintSelection())}}else{for(l=0,f=n;f<p&&l<o;f++)l+=i._getZoomRowHeight(f);l<o&&(w=!0,g=2,r=b?b.x:a.x,y=v,e=a.width,s=o-l,i.getFrozenTrailingRowCount()>0&&(s-=1),u.copyScreen(r,y,e,s,r,y+l),i.invalidateLayout(),u.paintBody(k,new t.Rect(r,y,e,l+g)),u.paintAdornment(k,new t.Rect(r,v,e,o)),i.parent&&i.parent._themeVersion>2007&&(nt=i._selectionModel,(i.frozenRowCount===0||nt.length===1&&nt[0].row+nt[0].rowCount===i.frozenRowCount&&i._scrollTopRow===i.frozenRowCount)&&u.repaintSelection()))}}w||(i.invalidateLayout(),i.repaint());this.updateEditingEditor()}},at.prototype.hScrollTo=function(n){var i=this._sheet,p=i._scrollLeftCol,tt,w,d,h,c,l,f,g,nt;if(n!==p&&(i._scrollLeftCol=n,i.triggerLeftColumnChanged({sheet:i,sheetName:i._name,oldLeftCol:p,newLeftCol:n}),!i._paintSuspended&&!(i._layoutSuspended>0))){if(t.features.comment&&(tt=i._commentManager,tt.updateCommentsLayoutWhenSheetScroll()),w=!1,t.util._useDoubleBuffer()){var b=i.getBounds(),a=i._getSheetLayout(),v=a.viewportX,o=a.viewportWidth,y,r,s,e,u=i._render,k=u._getCtx();if(n>p){if(c=i._getColumnLayout(1),c&&c.length>0&&(d=c.findCol(n)),d){for(f=c.length-1,h=c[f];h.x+h.width>v+o;)f=f-1,h=c[f];h.col>n&&(w=!0,g=2,y=d.x,r=b?b.y:a.y,s=h.x+h.width-d.x-g,e=a.height,u.copyScreen(y,r,s,e,v,r),i.invalidateLayout(),u.paintBody(k,new t.Rect(v+s,r,o-s,e)),u.paintAdornment(k,new t.Rect(v,r,o,e)),i.parent&&i.parent._themeVersion>2007&&i.frozenColCount===0&&u.repaintSelection())}}else{for(l=0,f=n;f<p&&l<o;f++)l+=i._getZoomColumnWidth(f);l<o&&(w=!0,g=2,y=v,r=b?b.y:a.y,s=o-l,e=a.height,i.getFrozenTrailingColumnCount()>0&&(s-=1),u.copyScreen(y,r,s,e,y+l,r),i.invalidateLayout(),u.paintBody(k,new t.Rect(y,r,l+g,e)),u.paintAdornment(k,new t.Rect(v,r,o,e)),i.parent&&i.parent._themeVersion>2007&&(nt=i._selectionModel,(i.frozenColCount===0||nt.length===1&&nt[0].col+nt[0].colCount===i.frozenColCount&&i._scrollLeftCol===i.frozenColCount)&&u.repaintSelection()))}}w||(i.invalidateLayout(),i.repaint());this.updateEditingEditor()}},at.prototype._notEqualSelecions=function(n,t){var f=!0,i,r,u;if(n.length===t.length)for(i=0;i<n.length;i++)if(r=n[i],u=t[i],r.row!==u.row||r.col!==u.col||r.rowCount!==u.rowCount||r.colCount!==u.colCount){f=!0;break}else f=!1;return f},at.prototype._createFocusHolder=function(n,r,f,e){var o=this,l=o._sheet,d={sheet:l,row:r,col:f,sheetArea:3},g=l._getHost(),ut=n.isImeAware(d),c,nt,w,rt;return e&&o._destroyFocusHolder(),ut&&!o._cellTypeFocusHolder&&(c=n.createEditorElement(d),o._focusHolderOldCss||(o._focusHolderOldCss={overflow:ct,border:a}),o._focusHolderOldCss.overflow=c.style.overflow,o._focusHolderOldCss.border=c.style.border,t.GC$(c).css(s,h).css(p,b).css(tt,"0px").css(it,"0px").css(y,a),l=o._sheet,l._setEditorValue(n,c,r,f,l.getActualStyle(r,f)),nt=n.getEditorValue(c,d),t.util.browser.safari&&(nt===""||nt===i||typeof nt===k)&&n.setEditorValue(c," ",d),g&&g.insertBefore(c,i),o._cellTypeFocusHolder=c),o._originalFocusHolder||(c=u.createElement("div"),t.GC$(c).css(s,h).css(p,b).css(tt,"0px").css(it,"0px"),o._originalFocusHolder=c,w=u.createElement("textarea"),t.GC$(w).attr(v,"gcSheetFocusInput").attr(et,-1).css(s,h).css(p,b).css(y,a).css(ht,a),w.value=" ",c.insertBefore(w,i),o._focusElem=w,rt=u.createElement("div"),t.GC$(rt).css(s,h).css(p,b).attr(v,"gcSheetFocusInput").attr(et,-1),c.insertBefore(rt,i),o._readonlyFocusElem=rt,g&&g.insertBefore(c,i)),o._cellTypeFocusHolder&&o._setVisibleLocation(l,o._cellTypeFocusHolder),o._setVisibleLocation(l,o._originalFocusHolder),ut?o._cellTypeFocusHolder:o._focusElem},at.prototype._resetFocusHolder=function(){var n=this;n._cellTypeFocusHolder&&n._focusHolderOldCss&&t.GC$(n._cellTypeFocusHolder).css(p,n._focusHolderOldCss.overflow).css(y,n._focusHolderOldCss.border)},at.prototype._destroyFocusHolder=function(){var n=this;n._cellTypeFocusHolder&&(n._cellTypeFocusHolder.parentElement&&n._cellTypeFocusHolder.parentElement.removeChild(n._cellTypeFocusHolder),n._cellTypeFocusHolder=i)},at.prototype.setFocus=function(){t.FocusHelper.isActiveElement(this._sheet)||this._setFocusCore(!0,!0)},at.prototype.setFocusToReadonlyFocusElem=function(){var n=this._readonlyFocusElem;n&&n.focus()},at.prototype.changeFocusHolder=function(){this._setFocusCore(!0,!0)},at.prototype._clearTouchSetFocusTimeout=function(){this._touchSetFocusTimeout&&(clearTimeout(this._touchSetFocusTimeout),this._touchSetFocusTimeout=i)},at.prototype._setFocusCore=function(n,i){var f,r,s,h,e,o,c,a,l;(!t.util._isSilverlightCanvas()||t.util._isStandardCanvas())&&(arguments.length===0&&(n=!0),f=this,f._focusReleased=!1,f._clearTouchSetFocusTimeout(),r=f._sheet,s=r.getActiveRowIndex(),h=r.getActiveColumnIndex(),e=r.getCellType(s,h),f._createFocusHolder(e,s,h,i),o={sheet:r,row:s,col:h,sheetArea:3},c=e.isImeAware(o)?f._cellTypeFocusHolder:f._focusElem,i&&!t.util.browser.msie&&e.setImeMode(c,r.getActualStyle(s,h).imeMode,o),u.body.focus(),a=function(){var n=function(){try{e.isImeAware(o)?(e.focus(c,o),e.selectAll(c,o)):(c.focus(),c.select())}catch(n){}};n();i&&t.util.browser.msie&&(e.setImeMode(c,r.getActualStyle(s,h).imeMode,o),n())},(r._isTouchMode||t.util.device().ipad)&&(n||!e.isImeAware(o))?(l=t.util.device(),!r.isEditing()&&(t.util.browser.metroMode||l.ipad||l.iphone||l.android)?i&&e.setImeMode(f._cellTypeFocusHolder,r.getActualStyle(s,h).imeMode,o):f._touchSetFocusTimeout=setTimeout(function(){(f._clearTouchSetFocusTimeout(),r.isEditing())||r._enhanceIme!==!1&&a()},200)):r._enhanceIme!==!1&&a(),t.FocusHelper.isActiveElement(r)||t.FocusHelper.setActiveElement(r),f._updateValidationUI(r._activeRowIndex,r._activeColIndex))},at.prototype._setVisibleLocation=function(n,i){var b=n.getActiveRowIndex(),k=n.getActiveColumnIndex(),d=n.activeRowViewportIndex,g=n.activeColViewportIndex,s=n.getCellRect(b,k,d,g),r,u,f=this,v=f._getCanvasOffset(),e=f._getCanvasPosition(),y=f._cellTypeFocusHolder,nt=0,rt=0,p=0,w=0;if(y){var o=t.GC$(y),nt=parseInt(o.css(c),10),rt=parseInt(o.css(l),10);p=parseInt(o.css(it),10);w=parseInt(o.css(tt),10)}f._isInvalidRect(s)?(r=nt,u=rt):(r=s.y+e.top-2,u=s.x+e.left-2);var h=window.pageYOffset-v.top+e.top,ut=window.innerHeight+h-p,a=window.pageXOffset-v.left+e.left,ft=window.innerWidth+a-w;(isNaN(r)||r<h||r>ut)&&(r=h);(isNaN(u)||u<a||u>ft)&&(u=a);t.GC$(i).css(c,r).css(l,u)},at.prototype.releaseFocus=function(n){var t=this,i,r,f,e,o,s;(t._clearTouchSetFocusTimeout(),t._sheet.isEditing()||t._focusReleased&&u.activeElement===t._readonlyFocusElem)||(i=t._sheet,n?(r=n.row,f=n.col,e=n.rowViewportIndex,o=n.colViewportIndex):(r=i._activeRowIndex,f=i._activeColIndex,e=i.activeRowViewportIndex,o=i.activeColViewportIndex),s=i.getCellType(r,f),t._createFocusHolder(s,r,f,!1),t._readonlyFocusElem.focus(),t._focusReleased=!0)},at.prototype.resumeFocus=function(n){var t=this;arguments.length===0&&(n=!0);t._focusReleased&&(t._focusReleased=!1,t._setFocusCore(n))},at.prototype._switchFocusForClipboard=function(n){var t=this;t._focusElem&&(t._focusElem.value=n,t._focusElem.focus(),t._focusElem.select(),t._clipboardFloatingObjectData=i)},at.prototype._switchBackFocusAfterClipboard=function(){var n=this;n._focusElem&&(n._focusElem.value=" ");this._setFocusCore(!0,!1)},at.prototype._setClipboardFloatingObjectData=function(n){this._clipboardFloatingObjectData=n},at.prototype._getClipboardFloatingObjectData=function(){return this._clipboardFloatingObjectData},at.prototype._getClipboardData=function(){var n=this._focusElem?this._focusElem.value:"";return this._formatClipboardData(n)},at.prototype._formatClipboardData=function(n){var t=[],f,i,r,u;if(n){for(f='"',i=!1,r=0;r<n.length;r++)u=n[r],u===f?(i=!i,t.push(f)):i||u!=="\n"?t.push(u):t.push("\r\n");return t.join("")}return""},at.prototype._disposeFocusHolders=function(){var n=this,r;n._clearTouchSetFocusTimeout();r=n._cellTypeFocusHolder;r&&(t.GC$(r).remove(),n._cellTypeFocusHolder=e);r=n._originalFocusHolder;r&&(t.GC$(r).remove(),n._focusElem=e,n._originalFocusHolder=i,n._readonlyFocusElem=i)},at.prototype.bind=function(n,i,r){t.GC$(this._getElem()).bind(n,i,r)},at.prototype.unbind=function(n,i){t.GC$(this._getElem()).unbind(n,i)},at.prototype.trigger=function(n,i){this._eventSuspended===0&&t.GC$(this._getElem()).trigger(n,i)},at.prototype._showTooltip=function(n,i,r,f){var c=this._sheet,o=c.parent,e;o&&!o._tooltip&&(e=u.createElement("div"),t.GC$(e).addClass("spread-toolTip ui-state-default ui-widget-content btn-default"),t.GC$(e).css(s,h).css(rt,"0px 3px 0px 3px").css(d,"normal normal normal 11pt calibri").css(ut,"1px 2px 5px rgba(0,0,0,0.4)").width(w).height(w).appendTo(u.body),o._tooltip=e);this._refreshTooltip(n,i,r,f)},at.prototype._refreshTooltip=function(n,u,f,o){var y=this._sheet,p=y.parent,v,s,h,a;p&&(v=p._tooltip,v&&(s=t.GC$(v),n===e||n===i||n===""?s.hide():(s.html(n),s.show()),h=this._getCanvasOffset(),o&&(f-=h.top,u-=h.left),a=y.getBounds(),f=r(f,a.y+a.height-s.outerHeight()),u=r(u,a.x+a.width-s.outerWidth()),f!==i&&f!==e&&s.css(c,f+h.top),u!==i&&u!==e&&s.css(l,u+h.left)))},at.prototype._removeTooltip=function(){var r=this._sheet,n=r.parent;n&&n._tooltip&&(t.GC$(n._tooltip).remove(),n._tooltip=i)},at}();t._SheetEventHandler=at;vt=function(){function n(){var n=this;n.top=!1;n.bottom=!1;n.left=!1;n.right=!1;n.distanceX=0;n.distanceY=0;n.nearMouseX=0;n.nearMouseY=0}return n}()})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){var o,r,h,c,k,p;t.feature("core.sheet_border",["core.common"]);var s=undefined,i=null,w=Math.sqrt,l=Math.pow,b=Math.min,f={first:1,second:2},e=function(){function n(){}return n.prototype.adjust=function(n){var t=this;n.orientation===0?(n.offsetEnd&&(t._x2+=n.offsetEnd),n.offsetStart&&(t._x1+=n.offsetStart)):(n.offsetEnd&&(t._y2+=n.offsetEnd),n.offsetStart&&(t._y1+=n.offsetStart))},n.prototype.paint=function(n){var t=this._color||"#9eb6ce",i=this._lineWidth,r=n.lineWidth,u=n.strokeStyle;n.beginPath();(r!==i||u!==t)&&(r!==i&&(n.lineWidth=i),u!==t&&(n.strokeStyle=t));this.paintLine(n);n.stroke()},n.prototype.paintLine=function(n){var t=this;n.moveTo(t._x1,t._y1);n.lineTo(t._x2,t._y2)},n.Create=function(n,t,u,f,e,l){(l===s||l===i)&&(l=1);switch(l){case 1:return new o(n,t,u,f,e,1);case 2:return new o(n,t,u,f,e,2);case 5:return new o(n,t,u,f,e,3);case 3:return new r(n,t,u,f,e,1,[3,1]);case 9:return new r(n,t,u,f,e,1,[8,2,2,2]);case 4:return new r(n,t,u,f,e,1,[2,2]);case 11:return new r(n,t,u,f,e,1,[9,3,3,3,3,3]);case 13:return new h(n,t,u,f,e,n!==u,[11,1,5,1],[10,2,4,2]);case 10:return new r(n,t,u,f,e,2,[9,3,3,3]);case 12:return new r(n,t,u,f,e,2,[9,3,3,3,3,3]);case 8:return new r(n,t,u,f,e,2,[9,3]);case 7:return new r(n,t,u,f,e,1,[1]);case 6:return new c(n,t,u,f,e,n!==u)}return i},n}();t.Line=e;o=function(n){function t(t,i,r,u,f,e){var s,o;n.call(this);s=e%2;s||(t!==r?(i-=.5,u-=.5):(t-=.5,r-=.5));o=this;o._x1=t;o._y1=i;o._x2=r;o._y2=u;o._color=f;o._lineWidth=e}return __extends(t,n),t}(e);t.SolidLine=o;r=function(n){function t(t,i,r,u,f,e,o){var h,s;n.call(this);h=e%2;h||(t!==r?(i-=.5,u-=.5):(t-=.5,r-=.5));s=this;s._x1=t;s._y1=i;s._x2=r;s._y2=u;s._color=f;s._lineWidth=e;s._pattern=o}return __extends(t,n),t.prototype.paintLine=function(n){var i=this;t.render(n,i._x1,i._y1,i._x2,i._y2,i._pattern)},t.render=function(n,t,i,r,u,f){var e=w(l(r-t,2)+l(u-i,2)),c={x:(r-t)/e,y:(u-i)/e},s=0,a=0,o,h;for(f=f&&f.length?f:[4,4];s<e;)o=b(f[a++%f.length],e-s),h=a%2,s+=o,h&&n.moveTo(t,i),t+=o*c.x,i+=o*c.y,h&&n.lineTo(t,i)},t}(e);t.DashedLine=r;h=function(n){function t(t,i,r,u,f,e,o,s){n.call(this);e?(t-=1,r-=1):(i-=1,u-=1);var h=this;h._x1=t;h._y1=i;h._x2=r;h._y2=u;h._color=f;h._horizental=e;h._lineWidth=1;h._pattern1=o;h._pattern2=s}return __extends(t,n),t.prototype.paintLine=function(n){var t=this,i=t._horizental?0:1,u=t._horizental?1:0;r.render(n,t._x1-i,t._y1-u,t._x2-i,t._y2-u,t._pattern1);r.render(n,t._x1,t._y1,t._x2,t._y2,t._pattern2)},t}(e);t.SlantedLine=h;c=function(n){function t(t,i,r,u,f,e){n.call(this);var h=e?0:1,c=e?1:0,s=this;s._line1=new o(t-h,i-c,r-h,u-c,f,1);s._line2=new o(t+h,i+c,r+h,u+c,f,1);s._color=f;s._horizental=e;s._lineWidth=1}return __extends(t,n),t.prototype.paintLine=function(n){this._line1.paintLine(n);this._line2.paintLine(n)},t.prototype.adjust=function(n){var t=this;n.lineSide?n.lineSide===f.first?t._line1.adjust(n):n.lineSide===f.second&&t._line2.adjust(n):(t._line1.adjust(n),t._line2.adjust(n))},t}(e);t.DoubleLine=c,function(n){n[n.previous=-1]="previous";n[n.next=1]="next"}(t._LineType||(t._LineType={}));k=t._LineType,function(n){n[n.horizontal=0]="horizontal";n[n.vertical=1]="vertical"}(t._LineOrientation||(t._LineOrientation={}));var g=t._LineOrientation,u=function(){function n(){}return n.compareColor=function(n,t){return 0},n.compareLineStyle=function(t,i){if(t){if(!i)return 1}else return i?-1:0;var r=n._styleWeightCache;return r[t.style]-r[i.style]},n.getDrawingThickness=function(n){if(n){if(n.isGridLine)return 1;if(n.style)return t.LineBorder.prototype.width(n.style)}return 0},n.isDoubleLine=function(n){return n&&n.style===6},n.isSlantedLine=function(n){return n&&n.style===13},n.getMaxLine=function(t,i){if(t){if(!i)return t}else return i;return n.compareLineStyle(t.style,i.style)>=0?t:i},n.adjustLine=function(n,t){n&&n.line&&n.line.adjust(t)},n.compareLine=function(t,i){if(t===i)return 0;if(!t)return-1;if(!i)return 1;if(t.isGridLine)return i.isGridLine?0:-1;else if(i.isGridLine)return 1;return n.compareLineStyle(t.style,i.style)},n.isDoubleLineItem=function(n){return n&&n.style&&n.style.style===6},n.isAllowExtend=function(n,t,i,r){if(n.style&&n.style.style===6)return!0;var u=0;return u+=t&&t.style&&t.style.style===6?1:0,u+=i&&i.style&&i.style.style===6?1:0,u+=r&&r.style&&r.style.style===6?1:0,u<2},n.layout4CrossRoad=function(n,t,i,r,u,e){var o={orientation:e?1:0,offsetStart:0,offsetEnd:0},s=this.compareLine(n,i),h=this.compareLine(n,r);s>=0&&h>=0?s===0&&h===0?u!==-1&&u===1&&(o.offsetEnd-=u):u===-1?o.offsetStart-=u:u===1&&(o.offsetEnd-=2*u):h>=0?(o.lineSide=f.second,o.offsetStart+=u):s>=0&&(o.lineSide=f.first,o.offsetStart+=u);this.adjustLine(n,o)},n.layout4TurnRoad=function(t,i,r,u,e,o,s,h,c){var a={orientation:h?1:0,lineSide:c?f.second:f.first,offsetStart:0,offsetEnd:0},l={orientation:h?1:0,lineSide:c?f.first:f.second,offsetStart:0,offsetEnd:0},k=o===1?u:e,v=s===1?r:i,it=this.isDoubleLineItem(v),d,g,nt,tt,w;it?(d=this.compareLine(t,k),d===0?(g=this.compareLine(t,v),g===0?s===1&&(l.offsetEnd-=s):g>0&&(s===-1?l.offsetStart-=2*s:s===1&&(l.offsetEnd-=2*s))):d>0?(nt=this.compareLine(t,v),nt===0?s===1&&(l.offsetEnd-=s):nt>0&&(s===-1?l.offsetStart-=2*s:s===1&&(l.offsetEnd-=2*s))):(tt=this.compareLine(t,v),tt===0?s===-1?a.offsetStart+=2*s:s===1&&(a.offsetEnd+=2*s):tt>0&&(s===-1?a.offsetStart-=3*s:s===1&&(a.offsetEnd-=3*s)))):this.compareLine(t,k)>=0?s===-1?l.offsetStart-=2*s:s===1&&(l.offsetEnd-=2*s):s===-1?a.offsetStart+=2*s:s===1&&(a.offsetEnd+=2*s);var rt=o===1?2:1,p=rt===1?u:e,b=!1,y=0;!b&&this.isDoubleLineItem(p)&&this.compareLine(p,t)>0&&(b=!0,w=n.getDrawingThickness(p),this.compareLine(p,k)>0?w>0&&(y=s===1&&this.isDoubleLineItem(r)?w>=2?2:1:s===-1&&this.isDoubleLineItem(i)?w>=3?2:1:w===3?3:2):y=w===3?3:2);b||this.isDoubleLineItem(v)||(!v||v.isGridLine)&&(!p||p.isGridLine)||(b=!0,y=s===-1?2:1);b&&(s===-1?(a.offsetStart+=s*y,l.offsetStart+=s*y):s===1&&(a.offsetEnd+=s*y,l.offsetEnd+=s*y));(a.offsetStart||a.offsetEnd)&&this.adjustLine(t,a);(l.offsetStart||l.offsetEnd)&&this.adjustLine(t,l)},n.layout4TRoad=function(n,t,i,r,u,f){if(this.compareLine(n,i)>=0&&this.compareLine(n,r)>=0){var e={orientation:f?1:0,offsetStart:0,offsetEnd:0};u===-1?(e.offsetStart-=2*u,this.isDoubleLineItem(n)&&this.compareLine(t,n)>0&&(e.offsetStart-=1)):u===1&&(e.offsetEnd-=2*u,this.isDoubleLineItem(n)&&this.compareLine(t,n)>0&&(e.offsetEnd+=1));this.adjustLine(n,e)}},n.layout4Connected=function(t,i,r,u,f,e){var s,h,o;this.isDoubleLineItem(t)&&(s=this.getMaxLine(r,u),s&&!s.isGridLine&&(h=n.getDrawingThickness(s),h>0&&(o={orientation:e?1:0,offsetStart:0,offsetEnd:0},f===-1?o.offsetStart+=h*f:o.offsetEnd+=h*f,(o.offsetStart||o.offsetEnd)&&this.adjustLine(t,o))))},n.calcLayoutHorizontal=function(t,i,r,u,f,e,o){var h,c,s=n,l,a;(i||r||u)&&(l=s.getMaxLine(r,u),s.isAllowExtend(t,i,r,u)?(c=s.compareLine(l,t))>0?(h=s.getDrawingThickness(l),s.isDoubleLineItem(t)&&(s.isDoubleLineItem(r)||s.isDoubleLineItem(u)||s.isDoubleLineItem(i))||h===3&&s.adjustLine(t,{orientation:0,offsetStart:1})):l&&c<0?(c=s.compareLine(t,i))>0?(h=s.getDrawingThickness(l),h===3||h===2?s.adjustLine(t,{orientation:0,offsetStart:-2}):h===1&&s.adjustLine(t,{orientation:0,offsetStart:-1})):c!==0&&s.compareLine(i,l)>0&&(h=s.getDrawingThickness(l),h===3&&s.adjustLine(t,{orientation:0,offsetStart:1})):c===0&&(!i||s.compareLine(t,i)>0)&&(h=s.getDrawingThickness(l),h===3||h===2?s.adjustLine(t,{orientation:0,offsetStart:-2}):h===1&&s.adjustLine(t,{orientation:0,offsetStart:-1})):s.adjustLine(t,{orientation:0,offsetStart:1}));(f||e||o)&&(a=s.getMaxLine(e,o),s.isAllowExtend(t,f,e,o)?(c=s.compareLine(a,t))>0?(h=s.getDrawingThickness(a),s.isDoubleLineItem(t)&&(s.isDoubleLineItem(e)||s.isDoubleLineItem(o)||s.isDoubleLineItem(f))||(h===3?s.adjustLine(t,{orientation:0,offsetEnd:-2}):(h===2||h===1)&&s.adjustLine(t,{orientation:0,offsetEnd:-1}))):c<0?(c=s.compareLine(t,f))>0?(h=s.getDrawingThickness(a),h===3&&s.adjustLine(t,{orientation:0,offsetEnd:1})):c!==0&&s.adjustLine(t,{orientation:0,offsetEnd:-1}):c===0&&((c=s.compareLine(t,f))>0?(h=s.getDrawingThickness(a),h===3&&s.adjustLine(t,{orientation:0,offsetEnd:1})):c!==0&&s.adjustLine(t,{orientation:0,offsetEnd:-1})):s.adjustLine(t,{orientation:0,offsetEnd:-2}))},n.calcLayoutVertical=function(t,r,u,f,e,o,s){var c,l,h=n,a,v;(r||u||f)&&(a=h.getMaxLine(u,f),h.isAllowExtend(t,r,u,f)?(l=h.compareLine(a,t))>0?(c=h.getDrawingThickness(a),h.isDoubleLineItem(t)&&(h.isDoubleLineItem(u)||h.isDoubleLineItem(f)||h.isDoubleLineItem(r))||c===3&&h.adjustLine(t,{orientation:1,offsetStart:1})):l<0?(l=h.compareLine(t,r))>0?(c=h.getDrawingThickness(a),c===3||c===2?h.adjustLine(t,{orientation:1,offsetStart:-2}):c===1&&h.adjustLine(t,{orientation:1,offsetStart:-1})):l!==0&&h.compareLine(r,a)>0&&(c=h.getDrawingThickness(a),c===3&&h.adjustLine(t,{orientation:1,offsetStart:1})):l===0&&h.compareLine(t,r)>0&&(c=h.getDrawingThickness(a),c===3||c===2?h.adjustLine(t,{orientation:1,offsetStart:-2}):c===1&&h.adjustLine(t,{orientation:1,offsetStart:-1})):h.adjustLine(t,{orientation:1,offsetStart:1}));(e||o||s)&&(v=h.getMaxLine(o,s),h.isAllowExtend(t,e,o,s)?(l=h.compareLine(t,v))<0?(c=h.getDrawingThickness(v),h.isDoubleLineItem(t)&&(h.isDoubleLineItem(o)||h.isDoubleLineItem(s)||h.isDoubleLineItem(e))||(c===3||c===2?h.adjustLine(t,{orientation:1,offsetEnd:-2}):c===1&&h.adjustLine(t,{orientation:1,offsetEnd:-1}))):v!==i&&l>0?(l=h.compareLine(t,e))>0?(c=h.getDrawingThickness(v),c===3&&h.adjustLine(t,{orientation:1,offsetEnd:1})):l!==0&&h.adjustLine(t,{orientation:1,offsetEnd:-1}):l===0&&((l=h.compareLine(t,e))>0?(c=h.getDrawingThickness(v),c===3&&h.adjustLine(t,{orientation:1,offsetEnd:1})):l!==0&&h.adjustLine(t,{orientation:1,offsetEnd:-1})):h.adjustLine(t,{orientation:1,offsetEnd:-2}))},n.calcDoubleLayout=function(t,i,r,u,f,e,o,s){var h=n,a;s?this.calcLayoutVertical(t,i,r,u,f,e,o):this.calcLayoutHorizontal(t,i,r,u,f,e,o);var c=h.isDoubleLineItem(r),l=h.isDoubleLineItem(u),v=h.isDoubleLineItem(i);c&&l&&v?h.layout4CrossRoad(t,i,r,u,-1,s):c&&!l?h.layout4TurnRoad(t,i,f,r,u,1,-1,s,!0):!c&&l?h.layout4TurnRoad(t,i,f,r,u,2,-1,s,!1):c&&l&&!v?h.layout4TRoad(t,i,r,u,-1,s):v&&h.layout4Connected(t,i,r,u,-1,s);c=h.isDoubleLineItem(e);l=h.isDoubleLineItem(o);a=h.isDoubleLineItem(f);c&&l&&a?h.layout4CrossRoad(t,f,e,o,1,s):c&&!l?h.layout4TurnRoad(t,i,f,e,o,1,1,s,!0):!c&&l?h.layout4TurnRoad(t,i,f,e,o,2,1,s,!1):c&&l&&!a?h.layout4TRoad(t,f,e,o,1,s):a&&h.layout4Connected(t,f,e,o,1,s)},n._styleWeightCache=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],n}(),a={layoutHorizontal:function(n,t,i,r,f,e,o){u.calcLayoutHorizontal(n,t,i,r,f,e,o)},layoutVertical:function(n,t,i,r,f,e,o){u.calcLayoutVertical(n,t,i,r,f,e,o)}},v={layoutHorizontal:function(n,t,i,r,f,e,o){u.calcDoubleLayout(n,t,i,r,f,e,o,!1)},layoutVertical:function(n,t,i,r,f,e,o){u.calcDoubleLayout(n,t,i,r,f,e,o,!0)}},y={layoutHorizontal:function(n,t,i,r,u,f,e){},layoutVertical:function(n,t,i,r,u,f,e){}},d=function(){function n(n,t,i,r,u){this._row=n;this._column=t;this._horPoints=[];this._verPoints=[];this._lines={}}return n.prototype._addLine=function(n,t,i,r,u){var l,f,e,c,o;if(r!==0&&u!==0)throw"invalid argument.";if(l=this._lines[n],l||(l=this._lines[n]={hori:[],vert:[]}),r===0)var a=t,s=i,h=i+u,v=l.hori;else a=i,s=t,h=t+r,v=l.vert;if(f=v[a],f)for(e=f.length-1;e>=0;e--)if(c=f[e],s>c.e){f.splice(e+1,0,{s:s,e:h});return}else if(h<c.s){if(e===0){f.unshift({s:s,e:h});return}continue}else if(s>=c.s){f.splice(e,1,{s:c.s,e:Math.max(c.e,h)});return}else for(o=e-1;o>=0;o++)if(f[o].e<s){f.splice(o+1,e-o,{s:s,e:Math.max(c.e,h)});return}else if(f[o].s>s){if(o===0){f.splice(0,e,{s:s,e:Math.max(c.e,h)});return}continue}else{f.splice(o,e-o+1,{s:f[o].s,e:Math.max(c.e,h)});return}else f=v[a]=[{s:s,e:h}]},n.prototype._getStyle=function(t){return t.style===0?null:n._lineStyleCache[t.style]+t.color},n.prototype.addCellLines=function(n,t,i,r,u,f,e,o){var v,y,p,w;if(e){var s=this,h=1,c=1,l=s._horPoints,a=s._verPoints;if(o){if(n!==o.row||t!==o.col)return;n=o.row;t=o.col;h=o.rowCount;c=o.colCount;l[n]=o.y;l[n+h]=o.y+o.height;a[t]=o.x;a[t+c]=o.x+o.width}else l[n]=r,l[n+1]=r+f,a[t]=i,a[t+1]=i+u;v=e.borderLeft;v&&v.style&&s._addLine(s._getStyle(v),n,t,h,0);y=e.borderRight;y&&y.style&&s._addLine(s._getStyle(y),n,t+c,h,0);p=e.borderTop;p&&p.style&&s._addLine(s._getStyle(p),n,t,0,c);w=e.borderBottom;w&&w.style&&s._addLine(s._getStyle(w),n+h,t,0,c)}},n.prototype.addCellOverlfowLayout=function(n,t){for(var i=t.startColumn;i<=t.endColumn;i++)this._removeAllVertLine(n,i)},n.prototype._removeAllVertLine=function(n,t){for(var i in this._lines)this._removeLine(this._lines[i].vert,t,n,1)},n.prototype._removeLine=function(n,t,i,r){var s=i+r,e=n[t],f,u,o,h;if(e)for(f=e.length-1;f>=0;f--)u=e[f],u.e>i&&u.s<s&&(o=[],u.s<i&&o.push({s:u.s,e:i}),u.e>=s&&o.push({s:s,e:u.e}),h=[f,1].concat(o),Array.prototype.splice.apply(e,h))},n.prototype.paint=function(n,t){for(var e=Object.getOwnPropertyNames(this._lines),r,s,u,h,f,e=e.sort(),i=0;i<e.length;i++){var o=this._lines[e[i]],c=e[i].split("-"),l=parseInt(c[0]);for(n.beginPath(),n.strokeStyle=c[1],n.lineWidth=l,i=0;i<o.hori.length;i++)if(r=o.hori[i],r){if(s=this._horPoints[i],typeof s!="number")continue;for(u=0;u<r.length;u++)f=r[u],n.moveTo(this._verPoints[f.s],s-.5),n.lineTo(this._verPoints[f.e],s-.5)}for(i=0;i<o.vert.length;i++)if(r=o.vert[i],r){if(h=this._verPoints[i],typeof h!="number")continue;for(u=0;u<r.length;u++)f=r[u],n.moveTo(h-.5,this._horPoints[f.s]),n.lineTo(h-.5,this._horPoints[f.e])}n.stroke()}},n._lineStyleCache=["","1-","2-","1-","1-","3-","3-","1-","2-","1-","2-","1-","2-","2-"],n}();t._FastBorders=d;p=function(){function t(n,t,i,r){this._isInitialized=!1;this._isMerged=!1;var u=this;u._sheet=n;u._sheetArea=r;u._rowViewportIndex=t;u._colViewportIndex=i}return t.prototype._initialize=function(){var n=this,t,l,o,f,i,a,s,e;n._spanCells=[];n._rowIndecies=[];n._colIndecies=[];n._overflowedCells=[];n._adjustingRanges=[];n._hGridLine={};n._vGridLine={};n._hBorders={};n._vBorders={};var h=n._sheet,c=n._sheetArea,v=n._colViewportIndex,y=n._rowViewportIndex,r=h._getRowLayout(y,c),u=h._getColumnLayout(v,c);if(r&&r.length>0&&u&&u.length>0){for(t=n._rowIndecies,l=r.length,f=0;f<l;f++)o=r[f],o.height>0&&t.push(o.row);for(t.push(t[t.length-1]+1),i=n._colIndecies,a=u.length,e=0;e<a;e++)s=u[e],s.width>0&&i.push(s.col);i.push(i[i.length-1]+1)}n._isInitialized=!0},t.prototype.addCellOverlfowLayout=function(n,t){if(t){var i={row:n,startCol:t.startColumn,endCol:t.endColumn};this._overflowedCells.push(i)}},t.prototype.addCellLines=function(n,t,i,r,u,f,e,o){var s=this,h,c,l,a,v;s._isInitialized||s._initialize();o?s._spanCells.push(o):(e&&(h=e.borderLeft,c=e.borderTop,l=e.borderRight,a=e.borderBottom,v=e.backColor),!v||h||l||c||a||s._adjustingRanges.push({r:n,c:t,rc:1,cc:1}),s._addCellLineImp(n,t,i,r,u,f,h,c,l,a,v))},t.prototype._addCellLineImp=function(n,t,i,r,u,f,e,o,h,c,l,a,v){var y=this,k=!1,d=!1,g=!1,nt=!1,p,w,b;o&&(k=y._addCellLineSide(n,t,i,r-.5,i+u,r-.5,o,y._hBorders));e&&(d=y._addCellLineSide(n,t,i-.5,r,i-.5,r+f,e,y._vBorders));c&&(g=y._addCellLineSide(n+1,t,i,r+f-.5,i+u,r+f-.5,c,y._hBorders));h&&(nt=y._addCellLineSide(n,t+1,i+u-.5,r,i+u-.5,r+f,h,y._vBorders));p=y._sheet;l&&p._cachePool.getZoomRowHeight(n)!==0&&p._cachePool.getZoomColWidth(t)!==0||(w=!g&&!a,b=!nt&&!v,(w||b)&&y._addGridLine(n,t,i,r,u,f,w,b));(k||l!==s)&&y._removeLineItem(n-1,t,y._hGridLine);(d||l!==s)&&y._removeLineItem(n,t-1,y._vGridLine);!l||e||h||o||c||(y._adjustLineItem(n-1,t-1,y._vGridLine,!1),y._adjustLineItem(n-1,t-1,y._hGridLine,!0))},t.prototype._addCellLineSide=function(n,t,r,f,o,s,h,c){if(h){var l=this._queryLineItem(n,t,c,!0);return l?l.style.style!==6&&(h.style===6||u.compareLineStyle(h,l.style)>0)&&(l.line=e.Create(r,f,o,s,h.color,h.style),l.style=h):(l=this._queryLineItem(n,t,c),l.line=e.Create(r,f,o,s,h.color,h.style),l.style=h),l.line!==i}return!1},t.prototype._addGridLine=function(t,i,r,u,f,e,o,s){var h=this,w=n.Sheets,l=h._sheetArea===3,c=h._sheet.gridline,p=w.Line,a,v,y;l&&c&&(a=c.color,o&&(c.showHorizontalGridline||!l)&&(v=h._queryLineItem(t,i,h._hGridLine),v.isGridLine=!0,v.line=p.Create(r,u+e-.5,r+f,u+e-.5,a)),s&&(c.showVerticalGridline||!l)&&(y=h._queryLineItem(t,i,h._vGridLine),y.isGridLine=!0,y.line=p.Create(r+f-.5,u,r+f-.5,u+e,a)))},t.prototype._adjustLineItem=function(n,t,i,r){var f=this._queryLineItem(n,t,i,!0),u;f&&(u=f,u&&u.line&&u.line.adjust({orientation:r?0:1,offsetEnd:-1}))},t.prototype._removeLineItem=function(n,t,i){var r,u;n>=0&&t>=0&&(r=i[n],r&&(u=r[t],u&&delete r[t]))},t.prototype._queryLineItem=function(n,t,i,r){var u,f;if(n===-1||t===-1)return null;if(u=i[n],!u){if(r)return null;i[n]=u={}}if(f=u[t],!f){if(r)return null;u[t]=f={}}return f},t.prototype._processOverflowCells=function(){for(var t,n=this,e=n._overflowedCells,h=e.length,o=n._vBorders,s=n._vGridLine,u=0;u<h;u++){var f=e[u],i=f.row,c=f.startCol,l=f.endCol,r;for(t=c;t<l;t++)r=n._queryLineItem(i,t+1,o,!0),r?n._removeLineItem(i,t+1,o):(r=n._queryLineItem(i,t,s,!0),r&&n._removeLineItem(i,t,s))}},t.prototype._processSpans=function(){var t=this._spanCells,i=t.length,r,n;if(i>0)for(n=0;n<i;n++)r=t[n],this._processSpanCell(r)},t.prototype._processSpanCell=function(n){var t=this,d=n.row,g=n.col,it=n.x,ut=n.y,a,v,y,p,rt=t._sheet.getActualStyle(d,g,t._sheetArea),l=rt?rt.backColor:i,o,r,u,f,e,w,nt,b,tt,s,h=it,c=ut,k;if(n.rowCount===1)for(r=d,f=t._sheet._getZoomRowHeight(r,t._sheetArea),o=0;o<n.colCount;o++)w=o===0,b=o===n.colCount-1,u=g+o,e=t._sheet._getZoomColumnWidth(u,t._sheetArea),s=t._sheet.getActualStyle(r,u,t._sheetArea),s?(a=s.borderLeft,v=s.borderTop,y=s.borderRight,p=s.borderBottom):a=v=y=p=i,w?t._addCellLineImp(r,u,h,c,e,f,a,v,i,p,l,!1,!0):b?t._addCellLineImp(r,u,h,c,e,f,i,v,y,p,l):t._addCellLineImp(r,u,h,c,e,f,i,v,i,p,l,!1,!0),h+=e;else if(n.colCount===1)for(u=g,e=t._sheet._getZoomColumnWidth(u,t._sheetArea),o=0;o<n.rowCount;o++)nt=o===0,tt=o===n.rowCount-1,r=d+o,f=t._sheet._getZoomRowHeight(r,t._sheetArea),s=t._sheet.getActualStyle(r,u,t._sheetArea),s?(a=s.borderLeft,v=s.borderTop,y=s.borderRight,p=s.borderBottom):a=v=y=p=i,nt?t._addCellLineImp(r,u,h,c,e,f,a,v,y,i,l,!0,!1):tt?t._addCellLineImp(r,u,h,c,e,f,a,i,y,p,l):t._addCellLineImp(r,u,h,c,e,f,a,i,y,i,l,!0,!1),c+=f;else for(o=0;o<n.rowCount;o++){for(r=d+o,nt=o===0,tt=o===n.rowCount-1,f=t._sheet._getZoomRowHeight(r,t._sheetArea),k=0;k<n.colCount;k++)u=g+k,w=k===0,b=k===n.colCount-1,e=t._sheet._getZoomColumnWidth(u,t._sheetArea),s=t._sheet.getActualStyle(r,u,t._sheetArea),s?(a=s.borderLeft,v=s.borderTop,y=s.borderRight,p=s.borderBottom):a=v=y=p=i,nt?w?t._addCellLineImp(r,u,h,c,e,f,a,v,i,i,l,!0,!0):b?t._addCellLineImp(r,u,h,c,e,f,i,v,y,i,l,!0,!1):t._addCellLineImp(r,u,h,c,e,f,i,v,i,i,l,!0,!0):tt?w?t._addCellLineImp(r,u,h,c,e,f,a,i,i,p,l,!1,!0):b?t._addCellLineImp(r,u,h,c,e,f,i,i,y,p,l):t._addCellLineImp(r,u,h,c,e,f,i,i,i,p,l,!1,!0):w?t._addCellLineImp(r,u,h,c,e,f,a,i,i,i,l,!0,!0):b&&t._addCellLineImp(r,u,h,c,e,f,i,i,y,i,l,!0,!1),h+=e;h=it;c+=f}!l||a||y||v||p||t._adjustingRanges.push({r:d,c:g,rc:n.rowCount,cc:n.colCount})},t.prototype._adjust=function(){var n=this,t=!1,i=!1,r,u;for(r in n._vBorders){t=!0;break}for(u in n._hBorders){i=!0;break}(t||i)&&n._adjustBorders();n._adjustingRanges.length>0&&n._adjustGridlines()},t.prototype._adjustGridlines=function(){for(var f,e,o,n,i=this,s=i._adjustingRanges,a=s.length,h=0;h<a;h++){var t=s[h],r=t.r,u=t.c,c=r,v=r-1,y=u-1,l=u;for(t.rc>1&&(c+=t.rc-1),t.cc>1&&(l+=t.cc-1),f=!1,e=!1,o=0;o<a;o++){if(n=s[o],n.c===l+1&&n.r===r&&(e=!0),n.r===c+1&&n.c===u&&(f=!0),f&&e)break;if(n.r>r+1&&n.c>u+1)break}f||i._adjustLineItem(c,y,i._hGridLine,!0);e||i._adjustLineItem(v,l,i._vGridLine,!1)}},t.prototype._adjustBorders=function(){for(var n=this,w=n._rowIndecies,b=n._colIndecies,ot=w.length,st=b.length,r,f,e,ft={},et={},o,s,k,d,g,nt,tt,it,rt,ut,l,p,h,c,t=0;t<ot;t++)for(f=w[t],r=0;r<st;r++)(e=b[r],l=0,p=0,h=n._queryLineItem(f,e,n._vBorders,!0),h?l++:h=n._queryLineItem(f,e-1,n._vGridLine,!0),c=n._queryLineItem(f,e,n._hBorders,!0),c?p++:c=n._queryLineItem(f-1,e,n._hGridLine,!0),h||c)&&(o=t===0?i:n._getLineItem(w[t-1],e,!0,et),o&&o.line&&!o.isGridLine&&(l++,p++),s=r===0?i:n._getLineItem(f,b[r-1],!1,ft),s&&s.line&&!s.isGridLine&&(l++,p++),h&&(k=n._getLineItem(f,e,!1,ft),k&&k.line&&!k.isGridLine&&l++,t!==ot-1&&(g=n._getLineItem(w[t+1],e,!0,et),g&&g.line&&!g.isGridLine&&l++),r!==0&&t!==ot-1&&(nt=n._getLineItem(w[t+1],b[r-1],!1,ft),nt&&nt.line&&!nt.isGridLine&&l++),t!==ot-1&&(tt=n._getLineItem(w[t+1],e,!1,ft),tt&&tt.line&&!tt.isGridLine&&l++),l>0&&(u.isDoubleLine(h.style)?v.layoutVertical(h,o,s,k,g,nt,tt):u.isSlantedLine(h.style)?y.layoutVertical(h,o,s,k,g,nt,tt):a.layoutVertical(h,o,s,k,g,nt,tt))),c&&(d=n._getLineItem(f,e,!0,et),d&&d.line&&!d.isGridLine&&p++,r!==st-1&&(it=n._getLineItem(f,b[r+1],!1,ft),it&&it.line&&!it.isGridLine&&p++),t!==0&&r!=st-1&&(rt=n._getLineItem(w[t-1],b[r+1],!0,et),rt&&rt.line&&!rt.isGridLine&&p++),r!=st-1&&(ut=n._getLineItem(f,b[r+1],!0,et),ut&&ut.line&&!ut.isGridLine&&p++),p>0&&(u.isDoubleLine(c.style)?v.layoutHorizontal(c,s,o,d,it,rt,ut):u.isSlantedLine(c.style)?y.layoutHorizontal(c,s,o,d,it,rt,ut):a.layoutHorizontal(c,s,o,d,it,rt,ut))))},t.prototype._prevCol=function(n){return n<0?-1:this._colIndecies[n-1]},t.prototype._nextCol=function(n){return this._colIndecies[n+1]},t.prototype._prevRow=function(n){return n<0?-1:this._rowIndecies[n-1]},t.prototype._nextRow=function(n){return this._rowIndecies[n+1]},t.prototype._getLineItem=function(n,t,i,r){var u=r[n],f;return u||(u=r[n]={}),f=u[t],f===s&&(f=u[t]=this._getLineItemImp(n,t,i)),f},t.prototype._getLineItemImp=function(n,t,r){if(n===s||n<0||t===s||t<0)return i;var u=this,e=r?u._vBorders:u._hBorders,f=u._queryLineItem(n,t,e,!0);if(f)return f;if(e=r?u._vGridLine:u._hGridLine,r){if(--t<0)return i}else if(--n<0)return i;return(f=u._queryLineItem(n,t,e,!0),f)?f:i},t.prototype.paint=function(n,t){var i=this;i._isInitialized&&(i._isMerged||(i._processSpans(),i._processOverflowCells(),i._adjust(),i._isMerged=!0),n.save(),n.beginPath(),i._paint(n,t),n.closePath(),n.stroke(),n.restore())},t.prototype._paint=function(n,t){this._paintGridLine(n);this._paintBorderLines(n)},t.prototype._paintGridLine=function(n){var t=this;t._paintLines(n,t._hGridLine);t._paintLines(n,t._vGridLine)},t.prototype._paintBorderLines=function(n){var t=this;t._paintLines(n,t._hBorders);t._paintLines(n,t._vBorders)},t.prototype._paintLines=function(n,t){var i,r,u,f,e;if(t)for(f in t)if(i=t[f],i)for(e in i)r=i[e],u=r&&r.line,u&&u.paint(n)},t}();t._GcBorders=p})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(n){var e,o;n.feature("core.sheet_render",["core.common","core.sheet_border","core.sheet_action","core.sheet_model","core.imageLoader"]);var t=null,u=Math.min,i=Math.max,f=Math.abs,s=Math.PI,r="undefined",h=window.document,c=function(){function o(n){this.ctx=t;this.buffer=t;this.bufferCtx=t;this._rowGroups=t;this._columnGroups=t;this._floatingObjectRenderManager=t;this._defaultFont=t;this._existTouchDragFillIndicator=!1;this._showTouchSelectionIndicator=!0;this._init(n)}return o.prototype._init=function(n){this._sheet=n},o.prototype._getCtx=function(){var i=this,u,r;if(i.ctx=t,u=i._sheet,r=u._getCanvas(),r){if(!r.getContext&&n.util._isSilverlightCanvas()&&!r.getContext)return;r.getContext&&(i.ctx=r.getContext("2d"))}return i.ctx&&(i.ctx.name="userContext"),i.ctx},o.prototype._getBufferCtx=function(){var t=this,r=t._sheet,u=r.getBounds(),f=r._canvas.width,e=r._canvas.height,i=t.buffer;if(!i||i.width!==f||i.height!==e)if(i&&n.DPIHelper.disposeCanvasForSheet(r,i),t.buffer=i=h.createElement("canvas"),i.getContext)t.bufferCtx=i.getContext("2d"),n.DPIHelper.adjustDevicePixel(t.buffer,null,t._sheet,t.bufferCtx),n.DPIHelper.setSize(i,u.width,u.height);else if(i.width=u.width,i.height=u.height,n.util._isSilverlightCanvas())if(i.getContext)t.bufferCtx=i.getContext("2d");else return;return t.bufferCtx&&(t.bufferCtx.beginPath(),t.bufferCtx.font=t._getZoomFont(t._getDefaultFont()),t.bufferCtx.name="bufferContext"),t.bufferCtx},o.prototype._getDefaultFont=function(t){return this._defaultFont||(this._defaultFont=n.DefaultFontSize+" "+this._sheet.currentTheme().bodyFont()),this._defaultFont},o.prototype._resetDefaultFont=function(){this._defaultFont=t},o.prototype._getDefaultBackground=function(){return"white"},o.prototype._getSpreadBackColor=function(){var r=this._sheet,i=r.parent,e=i?i._backColor:this._getDefaultBackground(),u=n._ThemeContext.getColor(r,e),f=i?i._backgroundImage:t;return f&&f!==""&&(u="transparent"),u},o.prototype._getGrayAreaBackColor=function(i){var e=this._sheet,r=e.parent,o=r?r.grayAreaBackColor():"gray",u=n._ThemeContext.getColor(e,o),f;return i?(f=r?r._backgroundImage:t,f&&f!==""&&(u="transparent"),u):u},o.prototype._getZoomFont=function(t){var r=this._sheet,i=r._zoomFactor;return i===1?t:n.StyleHelper._scaleFont(t,i).font},o.prototype.copyDoubleBuffer=function(t,i,r,u,f){var s,c,e,o,v,y,p,w,h,l,a;r<=0||u<=0||(s=this.buffer,c=this._getCtx(),s&&c)&&(f||(f=this._sheet.getBounds()),e=n.DPIHelper.getScaleX(s),o=n.DPIHelper.getScaleY(s),e!==1&&(t*=e,i*=o,r*=e,u*=o,f=new n.Rect(f.x*e,f.y*o,f.width*e,f.height*o)),h=f.getIntersect(t,i,r,u),h)&&(h.round(),t=h.x,i=h.y,r=h.width,u=h.height,l=s.width,l&&t+r>l&&(t=l-r,t<0&&(r+=t,t=0)),a=s.height,a&&i+u>a&&(i=a-u,i<0&&(u+=i,i=0)),n.util.browser.qtMode&&(t>0&&r--,i>0&&u--),e===1?(v=t,y=i,p=r,w=u):(v=t/e,y=i/o,p=r/e,w=u/o),c.scale(1/e,1/o),c.clearRect(t,i,r,u),c.drawImage(s,t,i,r,u,t,i,r,u),c.scale(e,o))},o.prototype.copyDoubleBufferRect=function(n,t){n&&this.copyDoubleBuffer(n.x,n.y,n.width,n.height,t)},o.prototype.copyScreen=function(t,i,r,u,f,e){var v,y;if(!(r<=0)&&!(u<=0))try{var p=this,g=p._sheet,w=p._getCtx(),k=g._getCanvas(),b=p._getBufferCtx(),d=p.buffer,nt=r,tt=u,o=f,s=e,h=nt,c=tt,l=n.DPIHelper.getScaleX(k),a=n.DPIHelper.getScaleY(k);t=Math.floor(t*l);i=Math.floor(i*a);r=Math.ceil(r*l);u=Math.ceil(u*a);o=Math.floor(o*l);s=Math.floor(s*a);h=Math.ceil(h*l);c=Math.ceil(c*a);v=d.width;y=d.height;v&&t+r>v&&(t=v-r,t<0&&(r+=t,t=0));y&&i+u>y&&(i=y-u,i<0&&(u+=i,i=0));v&&o+h>v&&(o=v-h,o<0&&(h+=o,o=0));y&&s+c>y&&(s=y-c,s<0&&(c+=s,s=0));w.scale(1/l,1/a);b.scale(1/l,1/a);w.clearRect(o,s,h,c);w.drawImage(d,t,i,r,u,o,s,h,c);b.clearRect(o,s,h,c);b.drawImage(k,o,s,h,c,o,s,h,c);w.scale(l,a);b.scale(l,a)}catch(it){}},o.prototype.repaintSelection=function(t,r,f,e){var a=this,v,y,h,s,nt,tt,l;f||(f=a._getCtx());var it=!1,c=a._sheet,o=new n.Range(-1,-1,-1,-1),p=c._isNavigateInSelection;if(t&&(o=c._allowCellOverflow?new n.Range(t.row,0,t.rowCount,c.getColumnCount()):new n.Range(t.row,t.col,t.rowCount,t.colCount),!p)){if(o.col>=0){var w=o.col,d=o.col+o.colCount-1,rt=c.getRowCount(1),b=c._getSpanModel(1);for(v=0;v<rt;v++)h=b.find(v,o.col),h&&(w=u(h.col,w)),h=b.find(v,o.col+o.colCount-1),h&&(d=i(h.col+h.colCount-1,d));o.col=w;o.colCount=d-w+1}if(o.row>=0){var k=o.row,g=o.row+o.rowCount-1,ut=c.getColumnCount(2),b=c._getSpanModel(2);for(y=0;y<ut;y++)h=b.find(o.row,y),h&&(k=u(h.row,k)),h=b.find(o.row+o.rowCount-1,y),h&&(g=i(h.row+h.rowCount-1,g));o.row=k;o.rowCount=g-k+1}}if(s=c._getRangeRect2(o),s.width>=0||s.height>=0){if(nt=s.width,tt=s.height,s.x-=9,s.y-=9,s.width+=18,s.height+=30,r&&(s=s.getIntersectRect(r),!s))return;l=c._getSheetLayout();tt>0&&!p&&(c._dirty=!0,a.paint(f,new n.Rect(l.x,i(l.frozenY,s.y),l.rowHeaderWidth,s.height),e));nt>0&&!p&&(c._dirty=!0,a.paint(f,new n.Rect(i(l.frozenX,s.x),l.y,s.width,l.colHeaderHeight),e));o.row!==-1||o.col!==-1||p||(c._dirty=!0,a.paint(f,l.headerCornerRect(),e));nt>0&&tt>0&&a.paint(f,s);it=!0}return it},o.prototype.update=function(t,i,r,u,f){var o=this._sheet,e;o._layoutSuspended>0||(e=this._getCtx(),e&&(f||(o._dirty=!0),this.paint(e,new n.Rect(t,i,r,u))))},o.prototype.repaint=function(n){var i=this._sheet,t;i._layoutSuspended>0||(t=this._getCtx(),t&&(i._dirty=!0,this.paint(t,n)))},o.prototype.paint=function(n,t,i){var r=this._sheet,u=this;!n||r._layoutSuspended>0||(i||this.paintBody(n,t),this.paintAdornment(n,t))},o.prototype.paintBody=function(t,i,r){var f=this,o=f._sheet;if(t&&!(o._layoutSuspended>0)){var h=n.util._useDoubleBuffer(),u=h?f._getBufferCtx():null,s=u?u:t,e=o.getBounds();i||(i=e);i&&i.round();r&&r.round();o._dirty&&(o._dirty=!1,u&&(u.clearRect(i.x,i.y,i.width,i.height),r&&u.clearRect(r.x,r.y,r.width,r.height),u.translate(-e.x,-e.y)),f.paintSheet(s,i),r&&f.paintSheet(s,r),u&&u.translate(e.x,e.y));u&&(f.copyDoubleBufferRect(i),r&&f.copyDoubleBufferRect(r))}},o.prototype.paintAdornment=function(n,t){var f=this,o=f._sheet,h=o._isTouchMode,e,i,s,r,u,c;if(n&&!o._paintSuspended&&!(o._layoutSuspended>0)){if(t&&t.round(),e=o._getSheetLayout(),!o._hoverCell){if(h){for(i=e.headerCornerRect(),f.copyDoubleBufferRect(i),r=0;r<=2;r++)(i=e.rowHeaderRect(r),i&&i.width!==0&&i.height!==0)&&f.copyDoubleBufferRect(i);for(u=0;u<=2;u++)(i=e.colHeaderRect(u),i&&i.width!==0&&i.height!==0)&&f.copyDoubleBufferRect(i)}for(r=0;r<=2;r++)for(u=0;u<=2;u++)(i=e.viewportRect(r,u),i&&i.width!==0&&i.height!==0)&&(s=t,h&&(r!==1||u!==1)&&(f.copyDoubleBufferRect(i),s=i),(!s||i.intersectRect(s))&&f.paintSelection(n,r,u,s));if(f.paintResizeLine(n),c=o._formulaTextBox,c)for(r=0;r<=2;r++)for(u=0;u<=2;u++)(i=e.viewportRect(r,u),i&&i.width!==0&&i.height!==0)&&f.paintFormulaTextBoxRange(n,r,u,t)}h&&(f.paintTouchResizeIndicator(n),f._existTouchDragFillIndicator?f.paintTouchDragFillIndicator(n):f.paintTouchSelectionIndicator(n));this.pri(n,t,e)}},o.prototype.pri=function(n,t,i){this._pri(n,t,i)},o.prototype._pri=function(i,r,u){var w="11pt calibri",b=this,o,p=0,e="",c="",k,v=!0,s=n.SR.ls,y,h,l,a,f;if(u=u||b._sheet._getSheetLayout(),s)if(typeof s=="string")s=s.trim(),s&&(o=[s]);else if(Array.isArray(s)){for(y=!0,o=[],f=0;f<s.length;f++)c=s[f].trim(),o.push(c),y&&c&&(y=!1);y&&(o=t)}for(o||(v=!1,o=["Pwrdb rpCt pedSet ra eso\rNtLcne o itiuin","oee yGaeiySra.hesTilVrin\no iesdfrDsrbto"]),f=0;f<o.length;f++)p=Math.max(p,o[f].length);for(f=0;f<p;f++){for(v&&(c=""),h=0;h<o.length;h++)v?c+=f>=o[h].length?"00":o[h].charAt(f)+o[h].charAt(f+1):f<o[h].length&&(e+=o[h].charAt(f));v&&(k=parseInt(c,16),e+=String.fromCharCode(k),f++)}for(l=[],a=0,f=0;f<e.length;f++)(e[f]==="\r"||e[f]==="\n")&&(l.push(e.substring(a,f)),e[f]==="\r"&&f<e.length-1&&e[f+1]==="\n"&&f++,a=f+1);for(a<e.length&&l.push(e.substring(a,e.length)),f=0;f<l.length;f++){e=l[f];var d=b._sheet._getStringWidthByCanvas(e,w),g=10,nt=20,tt=u.width-d-g,it=u.height-g-nt*(l.length-f-1);(!r||r.intersect(tt,it,d,nt))&&(i.save(),i.fillStyle="rgba(0, 0, 0, 0.5)",i.font=w,r&&(i.rect(r.x,r.y,r.width,r.height),i.clip(),i.beginPath()),i.fillText(e,tt,it),i.restore())}},o.prototype.paintTouchResizeIndicator=function(t){var i=this._sheet,w=i.getRowCount(),b=i.getColumnCount(),v=i._getSheetLayout(),o,u=16,r,e,f,p=i.getSelections(),l,a,y;if(i._isTouchMode&&p.length>0){var s=p[p.length-1],k=s.row,h=s.row+s.rowCount-1,d=s.col,c=s.col+s.colCount-1;(!i.parent||i.parent._allowUserResize)&&(k!==-1&&d===-1&&i.getRowResizable(h)?(h<i.frozenRowCount?l=0:h<w-i._frozenTrailingRowCount?l=1:h<w&&(l=2),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",r=i.getCellRect(h,i.getColumnCount(2)-1,l,-1),f=v.rowHeaderRect(l),f.y<=r.y&&r.y+r.height<=f.y+f.height&&(e=new n.Rect(v.frozenX-u,r.y+r.height-u/2,u,u))):k===-1&&d!==-1&&i.getColumnResizable(c)&&(c<i.frozenColCount?a=0:c<b-i._frozenTrailingColCount?a=1:c<b&&(a=2),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0AAAAAElFTkSuQmCC",r=i.getCellRect(i.getRowCount(1)-1,c,-1,a),f=v.colHeaderRect(a),f.x<=r.x&&r.x+r.width<=f.x+f.width&&(e=new n.Rect(r.x+r.width-u/2,v.frozenY-u,u,u))),o&&e&&(y=i._getImageLoader(),y.getState(o)?t.drawImage(y.getImage(o),e.x,e.y,e.width,e.height):y.addImage(o)))}},o.prototype._getFloatingObjectRender=function(i,r){var u=this,f,e;return n.features.floatingObject?(u._floatingObjectRenderManager||(u._floatingObjectRenderManager=[]),f=u._floatingObjectRenderManager[i],f||(u._floatingObjectRenderManager[i]=[]),e=u._floatingObjectRenderManager[i][r],e||(u._floatingObjectRenderManager[i][r]=new n._FloatingObjectRenderManager(u._sheet)),u._floatingObjectRenderManager[i][r]):t},o.prototype._getFloatingObjectRenderCount=function(){var e=this,r=e._floatingObjectRenderManager,f=0,n,t,i,u;if(!r||r.length===0)return 0;for(n=0;n<=2;n++)if(t=r[n],t&&t.length>0)for(i=0;i<=2;i++)u=t[i],u&&(f+=u.getFloatingObjectRenderCount());return f},o.prototype._paintFloatingObject=function(i,u){var f=this._sheet,h,c,e,o,s;if(!f._hoverCell&&n.features.floatingObject&&f._floatingObjectArray&&(f._floatingObjectArray.length>0||this._getFloatingObjectRenderCount()>0))for(h=f._getSheetLayout(),(u===t||typeof u===r)&&(u=f._zoomFactor),e=0;e<=2;e++)for(o=0;o<=2;o++)(c=h.viewportRect(e,o),c)&&(s=this._getFloatingObjectRender(e,o),s&&!f._eventHandler.isFloatingObjectWorking&&s._render(e,o,u))},o.prototype._paintBackground=function(n,t){n.save();n.fillStyle=this._getSpreadBackColor();n.fillRect(t.x,t.y,t.width,t.height);n.restore()},o.prototype._paintHeadersAndViewport=function(n,t,i){for(var f=this,a=f._sheet,o=a._getSheetLayout(),e,s,h,c,l,u,r=0;r<=2;r++)s=o.colHeaderRect(r),s&&(t?(u=s.getIntersectRect(t),u&&f.paintColHeader(n,r,u,i)):f.paintColHeader(n,r,s,i));for(e=0;e<=2;e++)for(h=o.rowHeaderRect(e),h&&(t?(u=h.getIntersectRect(t),u&&f.paintRowHeader(n,e,u,i)):f.paintRowHeader(n,e,h,i)),r=0;r<=2;r++)c=o.viewportRect(e,r),c&&(t?(u=c.getIntersectRect(t),u&&f.paintViewport(n,e,r,u,i)):f.paintViewport(n,e,r,c,i));l=o.headerCornerRect();l&&(t?(u=l.getIntersectRect(t),u&&f.paintColHeaderCorner(n,u,i)):f.paintColHeaderCorner(n,l,i))},o.prototype._paintGrayArea=function(n){var u=this,o=u._sheet,t=o._getSheetLayout(),e=o._getRowLayout(1),i,f,r;e.length>0?(i=e[e.length-1],i.y+i.height<t.frozenTrailingY&&(n.fillStyle=u._getGrayAreaBackColor(!1),n.fillRect(t.headerX,i.y+i.height,t.width,t.frozenTrailingY-(i.y+i.height)))):e.length===0&&(n.fillStyle=u._getGrayAreaBackColor(!1),n.fillRect(t.headerX,t.viewportY,t.width,t.frozenTrailingY-t.viewportY));f=o._getColumnLayout(1);f.length>0?(r=f[f.length-1],r.x+r.width<t.frozenTrailingX&&(n.fillStyle=u._getGrayAreaBackColor(!1),n.fillRect(r.x+r.width,t.headerY,t.frozenTrailingX-(r.x+r.width),t.height))):f.length===0&&(n.fillStyle=u._getGrayAreaBackColor(!1),n.fillRect(t.viewportX,t.headerY,t.frozenTrailingX-t.viewportX,t.height))},o.prototype._paintSheetBorder=function(n,t){var u=this,r=u._sheet;r.borderWidth>0&&(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.strokeRect(t.x+n.lineWidth/2,t.y+n.lineWidth/2,i(0,t.width-n.lineWidth),i(0,t.height-n.lineWidth)))},o.prototype.paintSheet=function(t,i){var r=this,f=r._sheet,u;!t||f._layoutSuspended>0||(n._CacheMgr.startCache(f,0,0,f.getRowCount()-1,f.getColumnCount()-1),u=f.getBounds(),t.save(),i?t.rect(i.x,i.y,i.width,i.height):t.rect(u.x,u.y,u.width,u.height),t.clip(),t.beginPath(),r._paintBackground(t,u),n.features.group&&r.paintGroup(t,i),n.features.floatingObject&&r._paintFloatingObject(i),n.features.comment&&f._commentManager.hasComment()&&(r._paintCommentFloatLayoutPanel(3),r._paintComment(i)),r._paintHeadersAndViewport(t,i,!1),r._paintGrayArea(t),r.paintFrozenLine(t),r._paintSheetBorder(t,u),n._CacheMgr.clearCache(),t.beginPath(),t.restore())},o.prototype.paintSheetForPrint=function(t,i){var f=this,u=f._sheet,r;t&&(n._CacheMgr.startCache(u,0,0,u.getRowCount()-1,u.getColumnCount()-1),r=u.getBounds(),t.save(),i?t.rect(i.x,i.y,i.width,i.height):t.rect(r.x,r.y,r.width,r.height),t.clip(),t.beginPath(),f._paintBackground(t,r),f._paintHeadersAndViewport(t,i,!0),n._CacheMgr.clearCache(),t.beginPath(),t.restore())},o.prototype.refreshDragDropIndicator=function(){var o=this,i=o._sheet,h=i._currentTarget,s,v;if(h&&h.dragInfo){var c=o._getCtx(),f=i._getSheetLayout(),e=i._actualDragRange,r=i._dragRect,t=i._getRangeRect2(e),l=i._frozenTrailingColCount,a=i._frozenTrailingRowCount,y=i.getColumnCount()-l,p=i.getRowCount()-a,u=f.viewportRect(1,1);l>0&&e.col+e.colCount<=y&&t.x+t.width>u.x+u.width&&t.intersectRect(u)&&(t=t.getIntersectRect(u));a>0&&e.row+e.rowCount<=p&&t.y+t.height>u.y+u.height&&t.intersectRect(u)&&(t=t.getIntersectRect(u));s=new n.Rect(f.frozenX,f.frozenY,f.frozenTrailingX+f.frozenTrailingWidth,f.frozenTrailingY+f.frozenTrailingHeight);t.width>0&&t.height>0?(r.x=t.x,r.y=t.y,r.width=t.width-1,r.height=t.height-1,o.paintDragDropIndicator(c,s)):(t.width===0||t.height===0)&&(r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height,o.paintDragDropIndicator(c,s));v=i._eventHandler._isDragInsert;i._dragOldRect=v===!0?i._insertDragRect:new n.Rect(r.x,r.y,r.width,r.height)}},o.prototype.paintDragDropIndicator=function(t,i){var e=this,f=e._sheet,r=f._dragRect,p=f._eventHandler._isDragInsert,a=r.hitTarget,u,h,o,c,v,s,l,y;f&&r&&a&&(t.save(),p===!0&&(r.row===-1||r.col===-1)?r.row===-1&&r.col!==-1?(o=f._getColumnLayout(0).findCol(r.hitCol),o||(o=f._getColumnLayout(1).findCol(r.hitCol)),o||(o=f._getColumnLayout(2).findCol(r.hitCol)),o&&(c=o.x,v=o.width,r.col=r.hitCol,a.x>c+v/2&&(r.col<f._getLastFullyVisibleColumn()||r.col===f._getLastVisualColumn())&&(c=o.x+o.width,r.col++),u=f._dragOldRect,u&&u.width===0||(u=f._dragRect),u&&(h=new n.Rect(u.x-2,u.y-2,u.width+4,u.height+4),e.copyDoubleBufferRect(h,i),e.repaintSelection(f._getActiveSelectedRange(),i)),f._insertDragRect=new n.Rect(c,r.y,0,r.height),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath(),e.paintDragLine(t,c,r.y,c,r.y+r.height))):r.row!==-1&&r.col===-1&&(s=f._getRowLayout(0).findRow(r.hitRow),s||(s=f._getRowLayout(1).findRow(r.hitRow)),s||(s=f._getRowLayout(2).findRow(r.hitRow)),s&&(l=s.y,y=s.height,r.row=r.hitRow,a.y>l+y/2&&(r.row<f._getLastFullyVisibleRow()||r.row===f._getLastVisualRow())&&(l=s.y+s.height,r.row++),u=f._dragOldRect,u&&u.height===0||(u=f._dragRect),u&&(h=new n.Rect(u.x-2,u.y-2,u.width+4,u.height+4),e.copyDoubleBufferRect(h,i),e.repaintSelection(f._getActiveSelectedRange(),i)),f._insertDragRect=new n.Rect(r.x,l,r.width,0),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath(),e.paintDragLine(t,r.x,l,r.x+r.width,l))):(u=f._dragOldRect,u&&(h=new n.Rect(u.x-2,u.y-2,u.width+4,u.height+4),e.copyDoubleBufferRect(h,i),e.repaintSelection(f._getActiveSelectedRange(),i)),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath(),e.paintDragRectangle(t,r)),t.beginPath(),t.restore())},o.prototype.paintDragRectangle=function(n,i){var r=this;r.paintDragLine(n,i.x,i.y,i.x+i.width,i.y);r.paintDragLine(n,i.x,i.y+i.height,i.x+i.width,i.y+i.height);r.paintDragLine(n,i.x,i.y,i.x,i.y+i.height);r.paintDragLine(n,i.x+i.width,i.y,i.x+i.width,i.y+i.height);r.pri(n,t,t)},o.prototype.paintDragLine=function(t,i,r,u,e){t.save();var o,s,h;i===u?(t.rect(i-2,r,7,f(e-r)),t.clip(),t.beginPath(),r<e?(r-=3,e+=3):(r+=3,e-=3),o=n.Line.Create(i-1,r-1,u-1,e+1,"black",7),s=n.Line.Create(i,r,u,e,"black",7),h=n.Line.Create(i+1,r-1,u+1,e+1,"black",7)):r===e&&(t.rect(i,r-2,f(u-i),7),t.clip(),t.beginPath(),i<u?(i-=3,u+=3):(i+=3,u-=3),o=n.Line.Create(i-1,r-1,u+1,e-1,"black",7),s=n.Line.Create(i,r,u,e,"black",7),h=n.Line.Create(i-1,r+1,u+1,e+1,"black",7));o.paintLine(t);s.paintLine(t);h.paintLine(t);t.stroke();t.beginPath();t.restore()},o.prototype.paintResizeLine=function(n){var t,r,e,o,l,a,s=this._sheet,h,u,f,c;if(s._eventHandler.isResizing&&(h=s._currentTarget,h)&&(u=h.resizeInfo,u)){if(f=s._getSheetLayout(),c="#000000",n.save(),n.strokeStyle!==c&&(n.strokeStyle=c),n.lineWidth!==1&&(n.lineWidth=1),n.beginPath(),u.action==="sizeRow"||u.action==="sizeHiddenRow")for(r=i(0,u.startY-.5),o=u.movingY-.5,l=f.x+f.width,t=f.x;t<l;t+=2)n.moveTo(t,r),n.lineTo(t+1,r),n.moveTo(t,o),n.lineTo(t+1,o);else for(t=i(0,u.startX-.5),e=u.movingX-.5,a=f.y+f.height,r=f.y;r<a;r+=2)n.moveTo(t,r),n.lineTo(t,r+1),n.moveTo(e,r),n.lineTo(e,r+1);n.stroke();n.beginPath();n.restore()}},o.prototype.paintColHeaderCorner=function(i,r,u){var e=this._sheet,f,s,o;i.beginPath();f=e._getSheetLayout().headerCornerRect();s=e.getActualStyle(-1,-1,0);this.paintCells(i,[{data:t,row:-1,col:-1,x:f.x,y:f.y,width:f.width,height:f.height,style:s.clone()}],0,u);o=new n._GcBorders(e,0,0,0);o.addCellLines(0,0,f.x,f.y,f.width,f.height);o.paint(i,r)},o.prototype.paintFrozenLine=function(t){var r=this._sheet,i;(r.frozenRowCount||r.frozenColCount||r._frozenTrailingRowCount||r._frozenTrailingColCount)&&(i=r._getSheetLayout(),t.save(),t.strokeStyle=n._ThemeContext.getColor(r,r._frozenlineColor),t.lineWidth=1,t.beginPath(),r.frozenColCount&&(t.moveTo(i.viewportX-.5,i.y),t.lineTo(i.viewportX-.5,i.y+i.height)),r.frozenRowCount&&(t.moveTo(i.x,i.viewportY-.5),t.lineTo(i.x+i.width,i.viewportY-.5)),r._frozenTrailingColCount&&(t.moveTo(i.frozenTrailingX-.5,i.y),t.lineTo(i.frozenTrailingX-.5,i.y+i.height)),r._frozenTrailingRowCount&&(t.moveTo(i.x,i.frozenTrailingY-.5),t.lineTo(i.x+i.width,i.frozenTrailingY-.5)),t.stroke(),t.restore())},o.prototype.paintColHeader=function(n,t,i,r){this.paintViewportImp(n,-1,t,1,i,r)},o.prototype.paintRowHeader=function(n,t,i,r){this.paintViewportImp(n,t,-1,2,i,r)},o.prototype.paintViewport=function(n,t,i,r,u){this.paintViewportImp(n,t,i,3,r,u);var f=this._sheet._cutCopyIndicatorManager;f&&f.paintCutCopyIndicator(n,r,t,i)},o.prototype.getTouchDragFillIndicatorRect=function(){var r=this._sheet,u=t,f=r.getSelections(),e=f.length;if(r._isTouchMode&&e>0){var s=f[e-1],i=r._getRangeRect2(s),o=17,h=20;u=new n.Rect(i.x+i.width-o,i.y+i.height,o,h)}return u},o.prototype.getCurrentViewportRange=function(t,i){var r=this._sheet,c=r.getRowCount(),l=r.getColumnCount(),o=1,u;0<=t&&t<r.frozenRowCount?o=0:c>t&&t>=c-r._frozenTrailingRowCount&&(o=2);u=1;0<=i&&i<r.frozenColCount?u=0:l>i&&i>=l-r._frozenTrailingColCount&&(u=2);var f=r._getViewportRowLayout(o),e=r._getViewportColumnLayout(u),s=0,a=0,h=0,v=0;return f.length>0&&(s=f[0].row,a=f[f.length-1].row),e.length>0&&(h=e[0].col,v=e[e.length-1].col),new n.Range(s,h,a-s+1,v-h+1)},o.prototype.isContainedByCurrentViewport=function(n,t){var i=this._sheet,s=i.getRowCount(),h=i.getColumnCount(),f=1,u;0<=n&&n<i.frozenRowCount?f=0:s>n&&n>=s-i._frozenTrailingRowCount&&(f=2);u=1;0<=t&&t<i.frozenColCount?u=0:h>t&&t>=h-i._frozenTrailingColCount&&(u=2);var y=i._getSheetLayout(),r=y.viewportRect(f,u),c=!1,l=i._getViewportColumnLayout(u),e=t===-1?l[0]:l.findCol(t);e&&(c=r.x<=e.x&&e.x+e.width<=r.x+r.width);var a=!1,v=i._getViewportRowLayout(f),o=n===-1?v[0]:v.findRow(n);return o&&(a=r.y<=o.y&&o.y+o.height<=r.y+r.height),c&&a},o.prototype.getSelectionIndicatorRects=function(){var l=this,i=l._sheet,it=i.getSelections(),f=[],lt,g,vt,nt,tt,y;if(i._isTouchMode&&it.length>0){var u=it[it.length-1],r=i._getRangeRect2(u),t=8,p=i._getSheetLayout(),a=u.row,e=u.row+u.rowCount-1,v=u.col,o=u.col+u.colCount-1,ot=l.getCurrentViewportRange(a,v),w=l.getCurrentViewportRange(e,o),b=ot.row,s=w.row+w.rowCount-1,k=ot.col,h=w.col+w.colCount-1,c,d,st=e===s&&l.isContainedByCurrentViewport(s,-1),ht=o===h&&l.isContainedByCurrentViewport(-1,h);if(u.row!==-1&&u.col!==-1)k<=v&&v<=h&&b<=a&&a<=s&&(f[0]=new n.Rect(r.x-t,r.y-t,t*2,t*2)),(k<=o&&o<h||ht)&&(b<=e&&e<s||st)&&(f[1]=new n.Rect(r.x+r.width-t,r.y+r.height-t,t*2,t*2));else if(u.row!==-1){c=p.viewportRect(1,0);d=p.viewportRect(1,1);var rt=c.x+(c.width+d.width)/2-t,yt=i.getColumnCount()-1-i.getFrozenTrailingColumnCount(),ct=i._getViewportColumnLayout(1),ut=ct.findCol(yt);ut&&(lt=i._getViewportColumnLayout(0),g=lt[0]||ct[0],g&&(rt=g.x+(ut.x+ut.width-g.x)/2-t));b<=a&&a<=s&&(f[0]=new n.Rect(rt,r.y-t,t*2,t*2));(b<=e&&e<s||st)&&(f[1]=new n.Rect(rt,r.y+r.height-t,t*2,t*2))}else if(u.col!==-1){c=p.viewportRect(0,1);d=p.viewportRect(1,1);var ft=c.y+(c.height+d.height)/2-t,pt=i.getRowCount()-1-i.getFrozenTrailingRowCount(),at=i._getViewportRowLayout(1),et=at.findRow(pt);et&&(vt=i._getViewportRowLayout(0),nt=vt[0]||at[0],nt&&(ft=nt.y+(et.y+et.height-nt.y)/2-t));k<=v&&v<=h&&(f[0]=new n.Rect(r.x-t,ft,t*2,t*2));(k<=o&&o<h||ht)&&(f[1]=new n.Rect(r.x+r.width-t,ft,t*2,t*2))}for(y=f.length-1;y>=0;y--)tt=f[y],(!tt||tt.x<0||tt.y<0)&&f.splice(y,1)}return f},o.prototype.paintTouchSelectionIndicator=function(t){var r=this._sheet,f,e,i,u;if(n.FocusHelper.isActiveElement(r)||r.parent&&!r.parent.hideSelection()){if(r.isEditing()||!this._showTouchSelectionIndicator)return;if(f=this.getSelectionIndicatorRects(),e=f.length,e>0){for(t.save(),t.fillStyle="white",t.strokeStyle=r.selectionBorderColor(),u=0;u<e;u++)i=f[u],t.beginPath(),t.arc(i.x+i.width/2,i.y+i.height/2,i.width/2,0,s*2,!1),t.fill(),t.stroke();t.restore()}}},o.prototype.refreshTouchSelectionIndicator=function(){var t=this._sheet,n=t.getSelections();!t._paintSuspended&&n.length>0&&this.repaintSelection(n[n.length-1],undefined,undefined,!0)},o.prototype.paintTouchDragFillIndicator=function(n){var u=this._sheet,f=17,e=20,r=this.getTouchDragFillIndicatorRect(),t,i;r&&(t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1AAAAAElFTkSuQmCC",i=u._getImageLoader(),i.getState(t)?n.drawImage(i.getImage(t),r.x,r.y,f,e):i.addImage(t))},o.prototype.paintSelection=function(t,i,r,u){var a=this,f=a._sheet,w,v,y,b,e,k,d,h,c,s,o,tt,l;if(n.FocusHelper.isActiveElement(f)||f.parent&&!f.parent.hideSelection()){var p=f._eventHandler,g=f._selectionModel,nt=g.length;if(u=a._getClipRect(i,r,u),!u)return;if(w=n.ThemeStyleHelper.getCssClassThemeStyle("gc-selection"),v=parseInt(w.zIndex),v>2007&&a.paintHeaderSelection(t,i,r,u),y=a._getPaintingRects(i,r,g,u),b=y.length,b<=0)return;for(k=!1,s=0;s<b;s++)if(e=y[s],!u.containsRect(e)){k=!0;break}if(t.save(),k&&(t.rect(u.x,u.y,u.width,u.height),t.clip()),t.beginPath(),b>0)for(d=n._ThemeContext.getColor(f,f.selectionBackColor()),t.fillStyle!==d&&(t.fillStyle=d),h=0,c=0,v>2007&&(h=1,c=-3),s=0;s<y.length;s++)e=y[s],t.fillRect(e.x+h,e.y+h,e.width+c,e.height+c);o=f.getCellRect(f._activeRowIndex,f._activeColIndex,i,r);o&&o.intersectRect(u)&&(h=1,c=-2,v>2007&&(h=0,c=0),a.copyDoubleBuffer(o.x+h,o.y+h,o.width+c,o.height+c),nt>1&&(t.strokeStyle="black",t.lineWidth=1,t.strokeRect(o.x+1.5,o.y+1.5,o.width-4,o.height-4)));t.restore();t.save();k&&(a.adjustClipRect(u,f,i,r,v),t.rect(u.x,u.y,u.width,u.height),t.clip());t.beginPath();nt===1&&(p.isDraggingFill&&p.isDragClear()&&!p._isDragAroundIndicator&&(tt=p.getCurrentFillRange(),l=f._getRangeRect(i,r,tt),l&&l.width>0&&l.height>0&&(t.fillStyle=w&&w.color,t.fillRect(l.x,l.y,l.width,l.height))),e&&e.width>=0&&e.height>=0&&a.paintSelectionBorder(t,i,r,e,u));t.beginPath();t.restore()}},o.prototype.adjustClipRect=function(n,t,i,r,u){var g=0,nt=0,tt=0,it=0,v=t.getSelections(),o=t._getSheetLayout(),y=t.getRowCount()-t._frozenTrailingRowCount-1,p=t.getColumnCount()-t._frozenTrailingColCount-1,k=t._getColumnLayout(1,3),d=t._getRowLayout(1,3);if(v.length===1&&u>2007){var s=v[0],f=s.row,e=s.col,h=s.rowCount,c=s.colCount;t.frozenRowCount>0&&(f===t.frozenRowCount?(n.y-=2,n.height+=2):f+h===t.frozenRowCount&&t.frozenRowCount===t._scrollTopRow&&(n.height+=2));t.frozenColCount>0&&(e===t.frozenColCount?(n.x-=2,n.width+=2):e+c===t.frozenColCount&&t.frozenColCount===t._scrollLeftCol&&(n.width+=2));f===0&&e===0&&(n.x-=2,n.y-=2,n.width+=2,n.height+=2);f===-1&&(f=0,h=t.getRowCount());e===-1&&(e=0,c=t.getColumnCount());var w=!1,b=!1,l=d.findRow(y),a=k.findCol(p);l&&l.y+l.height<o.viewportY+o.viewportHeight&&(w=!0);a&&a.x+a.width<o.viewportX+o.viewportWidth&&(b=!0);w&&f+h-1===y&&(n.height+=2);b&&e+c-1===p&&(n.width+=2)}},o.prototype.paintHeaderSelection=function(n,t,i,r){var y=this,u=y._sheet,it=u._selectionModel,o=u._getSheetLayout(),l=it.length,ot,st,b,g,s,v;if(!(l<=0)){var a=it[0],h=a.row,p=a.rowCount,c=a.col,w=a.colCount;if(h===-1&&(h=0),c===-1&&(c=0),p===-1&&(p=u.getRowCount()),w===-1&&(w=u.getColumnCount()),n.save(),n.beginPath(),n.lineWidth=2,n.strokeStyle=u.selectionBorderColor(),ot=!0,st=!0,l!==1||u.frozenRowCount!==0||!(u._scrollTopRow>h)||!(u._scrollTopRow<h+p))for(b=y._getColumnHeaderSelectionRects(i),s=0,v=b.length;s<v;s++){var f=b[s],k=0,d=0,rt=f.x,ut=f.x+f.width;f.x<r.x+r.width&&r.x<f.x+f.width&&(l===1&&(u.frozenRowCount===0&&u._scrollTopRow===h||u.frozenRowCount>0&&h===0)&&(k=-1,d=1),f.x<r.x&&(k=0,rt=r.x),f.x+f.width>r.x+r.width&&(d=0,ut=r.x+r.width),n.moveTo(rt+k-1,o.headerY+o.colHeaderHeight-1),n.lineTo(ut+d,o.headerY+o.colHeaderHeight-1),n.stroke())}if(l!==1||u.frozenColCount!==0||!(u._scrollLeftCol>c)||!(u._scrollLeftCol<c+w))for(g=y._getRowHeaderSelectionRects(t),s=0,v=g.length;s<v;s++){var e=g[s],nt=0,tt=0,ft=e.y,et=e.y+e.height;e.y<r.y+r.height&&r.y<e.y+e.height&&(l===1&&(u.frozenColCount===0&&u._scrollLeftCol===c||u.frozenColCount>0&&c===0)&&(nt=-1,tt=1),e.y<r.y&&(nt=0,ft=r.y),e.y+e.height>r.y+r.height&&(tt=0,et=r.y+r.height),n.moveTo(o.headerX+o.rowHeaderWidth-1,ft+nt-1),n.lineTo(o.headerX+o.rowHeaderWidth-1,et+tt),n.stroke())}n.restore()}},o.prototype._getColumnHeaderSelectionRects=function(t){for(var a,v,y,l,h,u=this._sheet,w=u._selectionModel,b=w.length,r=u._getColumnLayout(t),c=[],k=u._getSheetLayout(),p=0;p<b;p++)if(a=w[p],a)if(v=a.col,v===-1){var f=u._getColumnLayout(0,3),e=u._getColumnLayout(1,3),o=u._getColumnLayout(2,3),i=-1,s=-1;f.length>0&&(i=f[0].x,s=f[f.length-1].x+f[f.length-1].width-i,c.push(new n.Rect(i,-1,s,-1)));e.length>0&&(i=e[0].x,s=e[e.length-1].x+e[e.length-1].width-i,c.push(new n.Rect(i,-1,s,-1)));o.length>0&&(i=o[0].x,s=o[o.length-1].x+o[o.length-1].width-i,c.push(new n.Rect(i,-1,s,-1)))}else r&&(y=r.findCol(v),l=r.findCol(v+a.colCount-1),(y||l)&&(h=new n.Rect(-1,-1,-1,-1),h.x=y?y.x:r[0].x,h.width=l?l.x+l.width-h.x:r[r.length-1].x+r[r.length-1].width-h.x,c.push(h)));return c},o.prototype._getRowHeaderSelectionRects=function(t){for(var a,v,y,l,h,u=this._sheet,w=u._selectionModel,b=w.length,r=u._getRowLayout(t),c=[],k=u._getSheetLayout(),p=0;p<b;p++)if(a=w[p],a)if(v=a.row,v===-1){var f=u._getRowLayout(0,3),e=u._getRowLayout(1,3),o=u._getRowLayout(2,3),i=-1,s=-1;f.length>0&&(i=f[0].y,s=f[f.length-1].y+f[f.length-1].height-i,c.push(new n.Rect(-1,i,-1,s)));e.length>0&&(i=e[0].y,s=e[e.length-1].y+e[e.length-1].height-i,c.push(new n.Rect(-1,i,-1,s)));o.length>0&&(i=o[0].y,s=o[o.length-1].y+o[o.length-1].height-i,c.push(new n.Rect(-1,i,-1,s)))}else r&&(y=r.findRow(v),l=r.findRow(v+a.rowCount-1),(y||l)&&(h=new n.Rect(-1,-1,-1,-1),h.y=y?y.y:r[0].y,h.height=l?l.y+l.height-h.y:r[r.length-1].y+r[r.length-1].height-h.y,c.push(h)));return c},o.prototype.paintSelectionBorder=function(t,i,r,u,f){var e=this._sheet,o=e._eventHandler,s;if(u.width>=0&&u.height>=0&&(!f||u.intersect(f.x-1,f.y-1,f.width+2,f.height+2))){if(t.save(),f&&!f.containsRect(u)&&(t.rect(f.x,f.y,f.width,f.height),t.clip()),t.beginPath(),t.strokeStyle=n._ThemeContext.getColor(e,e.selectionBorderColor()),t.lineWidth=2,u.width>0&&u.height>0){if(o.isDraggingFill)switch(o._currentFillDirection){case 2:t.moveTo(u.x+.5,u.y-.5);t.lineTo(u.x+u.width-1,u.y-.5);break;case 3:t.moveTo(u.x+.5,u.y+u.height-.5);t.lineTo(u.x+u.width-1,u.y+u.height-.5);break;case 0:t.moveTo(u.x-.5,u.y+.5);t.lineTo(u.x-.5,u.y+u.height-1);break;case 1:t.moveTo(u.x+u.width-.5,u.y+.5);t.lineTo(u.x+u.width-.5,u.y+u.height-1);break;case 5:case 4:break;default:break}else s=e.parent&&e.parent._themeVersion,s>2007?t.rect(u.x-1,u.y-1,u.width+1,u.height+1):t.rect(u.x-.5,u.y-.5,u.width,u.height);t.stroke();e.canUserDragFill()&&this.paintDragFillIndicator(t,i,r,u,f)}else(u.width===0||u.height===0)&&t.strokeRect(u.x-1,u.y-1,u.width+1,u.height+1);t.beginPath();t.restore()}},o.prototype._getClipRect=function(n,i,r){var c=this._sheet,l=c._getSheetLayout(),f=l.viewportRect(n,i),e,o,s,h;return i===1&&(e=c._getColumnLayout(i),o=e.length>0?e[e.length-1]:t,o&&(f.width=u(f.width,o.x+o.width-l.viewportX))),n===1&&(s=c._getRowLayout(n),h=s.length>0?s[s.length-1]:t,h&&(f.height=u(f.height,h.y+h.height-l.viewportY))),r?r.getIntersect(f.x,f.y,f.width,f.height):f},o.prototype._getPaintingRects=function(n,t,i,r){for(var s=this._sheet,c=s._getSpanModel(),e,l=i.length,f,h=[],u,o=0;o<l;o++)f=i[o],f&&(e=c.find(f.row,f.col),e&&e.containsRange(f)&&(f=e),u=s._getRangeRect(n,t,f),u&&u.x<=r.x+r.width&&u.y<=r.y+r.height&&r.x<=u.x+u.width&&r.y<=u.y+u.height&&h.push(u));return h},o.prototype.paintFormulaTextBox=function(){var t=this,i=t._sheet,n,r;i._paintSuspended||i._layoutSuspended>0||(n=i._getSheetLayout(),r=t._getCtx(),t.copyDoubleBuffer(n.x,n.y,n.width,n.height),t.paintAdornment(r))},o.prototype.paintFormulaTextBoxRange=function(t,i,r,u){var k=this,l=k._sheet,a=l._eventHandler,b=l._formulaTextBox,g=b&&b.getRanges(),et=g&&g.length,dt=l.getName(),v,it,d,f,ht,e,w;if(!(et<=0)&&(v=k._getClipRect(i,r,u),v)){t.save();t.rect(v.x,v.y,v.width,v.height);t.clip();t.beginPath();var y=[],ot=a.isFormulaRangeHoving,st=a._formulRangeHovingInfo,yt=a.isFormulaRangeMoving,pt=a._formulaRangeMovingInfo,wt=a.isFormulaRangeResizing,bt=a._formulaRangeResizingInfo,h,p,nt,tt,s;for(e=0;e<et;e++)if(h=g[e],p=h.text,nt=h.ranges&&h.ranges.length>0?h.ranges:[a.stringToRange(p)],nt){if(w=n.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,n.features.formulatextbox&&w&&w.sheet)if(n.StringUtil.contains(p,"!")){if(it=n.StringUtil.leftBefore(p,"!"),l.getName()!==it&&"'"+l.getName()+"'"!==it)continue}else if(!l.getCustomName(n.StringUtil.leftBefore(p,"["))&&!l.findTableByName(n.StringUtil.leftBefore(p,"[")))continue;for(tt=k._getPaintingRects(i,r,nt,v),d=0;d<tt.length;d++)if(f=tt[d],f&&f.width>0&&f.height>0){if(s=b.getRangeColor(e),b.isAppendingRange(h)?(ot&&st.paramRange.index===e&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=s,t.rect(f.x+1,f.y+1,f.width-3,f.height-3),t.stroke()),k.paintDashRect(t,f,s)):ot&&st.paramRange.index===e||yt&&pt.paramRange.index===e||wt&&bt.paramRange.index===e?(t.beginPath(),t.lineWidth=2,t.strokeStyle=s,t.rect(f.x+1,f.y+1,f.width-3,f.height-3),t.stroke()):(t.beginPath(),t.lineWidth=2,t.strokeStyle=s,t.rect(f.x,f.y,f.width-1,f.height-1),t.stroke()),b.isActiveRange(h)){var kt=.1,rt=0,ut=0,ft=0,c=n.util.parseColorString(s);c.length===3?(rt=c[0],ut=c[1],ft=c[2]):c.length===4&&(rt=c[1],ut=c[2],ft=c[3]);t.beginPath();t.fillStyle="rgba("+rt+","+ut+","+ft+","+kt+")";t.fillRect(f.x+1,f.y+1,f.width-3,f.height-3)}y.push({rect:f,color:s,allowDrag:h.allowDrag})}}if(y.length>0)for(ht=y.length,e=0;e<ht;e++){f=y[e].rect;s=y[e].color;var o=5,ct=f.x-2,lt=f.x+f.width+1-o,at=f.y-2,vt=f.y+f.height+1-o;y[e].allowDrag!==!1&&((w=n.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,n.features.formulatextbox&&w&&w.text)||(t.beginPath(),t.fillStyle=s,t.fillRect(ct,at,o,o),t.fillRect(lt,at,o,o),t.fillRect(ct,vt,o,o),t.fillRect(lt,vt,o,o)))}t.beginPath();t.restore()}},o.prototype.paintDashRect=function(t,i,r){var l,s,c,e,u,o,h;if(t.save(),l=[6,6],t.setLineDash&&!n.util.browser.qtMode)t.beginPath(),t.lineWidth=2,t.strokeStyle=r,t.setLineDash(l),t.rect(i.x,i.y,i.width-1,i.height-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=r,s=l[0],c=l[1],e=i.x,u=i.y,o=i.width;o>0;)if(o>=s+c)t.moveTo(e,u),t.lineTo(e+s,u),e=e+s+c,o=o-s-c;else if(o>=s){t.moveTo(e,u);t.lineTo(e+s,u);o=o-s-c;break}else if(o>0){t.moveTo(e,u);t.lineTo(e+o,u);o=o-s-c;break}for(e=i.x+i.width-1,u=i.y+1,h=i.height-1,o<0&&(o=f(o),o>c&&(t.moveTo(e,u-2),t.lineTo(e,u+(o-c))),u+=o,h-=o);h>0;)h>=s+c?(t.moveTo(e,u),t.lineTo(e,u+s),u=u+s+c,h=h-s-c):h>=s?(t.moveTo(e,u),t.lineTo(e,u+s),h=h-s-c):h>0&&(t.moveTo(e,u),t.lineTo(e,u+h),h=h-s-c);for(e=i.x+i.width-2,u=i.y+i.height-1,o=i.width-1,h<0&&(h=f(h),h>c&&(t.moveTo(e+2,u),t.lineTo(e-(h-c),u)),e-=h,o-=h);o>0;)if(o>=s+c)t.moveTo(e,u),t.lineTo(e-s,u),e=e-s-c,o=o-s-c;else if(o>=s){t.moveTo(e,u);t.lineTo(e-s,u);o=o-s-c;break}else if(o>0){t.moveTo(e,u);t.lineTo(e-o,u);o=o-s-c;break}for(e=i.x,u=i.y+i.height-2,h=i.height-1,o<0&&(o=f(o),o>c&&(t.moveTo(e,u+2),t.lineTo(e,u-(o-c))),u-=o,h-=o);h>0;)h>=s+c?(t.moveTo(e,u),t.lineTo(e,u-s),u=u-s-c,h=h-s-c):h>=s?(t.moveTo(e,u),u-s===i.y?t.lineTo(e,u-s-1):t.lineTo(e,u-s),h=h-s-c):h>0&&(u>i.y&&(t.moveTo(e,u),t.lineTo(e,u-h)),h=h-s-c);t.stroke()}t.beginPath();t.restore()},o.prototype.getDragFillIndicatorRect=function(t,i){var e=this._sheet,o=e._getActiveSelectedRange(),s=e._getSheetLayout(),f=4,u=-2-.5,r;return i>2007&&(f=5,u=-3),r=new n.Rect(-4,-4,f,f),o.col===-1?(r.x=s.frozenX,r.y=t.y+t.height+u):o.row===-1?(r.x=t.x+t.width+u,r.y=s.frozenY):(r.x=t.x+t.width+u,r.y=t.y+t.height+u),r},o.prototype.paintDragFillIndicator=function(t,r,u,f,e){var s=this._sheet,v=s._getSheetLayout(),a=s.parent&&s.parent._themeVersion,o=this.getDragFillIndicatorRect(f,a),l=v.viewportRect(r,u),c,h;(!e||o.intersectRect(e))&&o.intersectRect(l)&&(c=-1.5,a>2007&&(c=-1),h=new n.Rect(o.x+c,o.y+c,o.width+2,o.height+2),h.x=i(h.x,l.x),h.y=i(h.y,l.y),this.copyDoubleBufferRect(h),t.save(),e&&!e.containsRect(o)&&(t.rect(e.x,e.y,e.width,e.height),t.clip()),t.beginPath(),t.fillStyle=n._ThemeContext.getColor(s,s.selectionBorderColor()),t.fillRect(o.x,o.y,o.width,o.height),s._dragFillIndicatorRect=new n.Rect(o.x,o.y,4,4),t.beginPath(),t.restore())},o.prototype._paintCommentFloatLayoutPanel=function(n){var i=this,t;n===3&&(t=i._sheet._commentRender,t&&t.renderCommentFloatPanel(i._sheet))},o.prototype._paintCommentCellAdorner=function(n,t,i){var u=this,r=u._sheet._commentRender;r&&r.renderCommentCellAdorner(n,t,i)},o.prototype._paintComment=function(n){var e=this,u=e._sheet,o=u._commentRender,s,t,i,r,f;if(!u._hoverCell)for(s=e._sheet._getSheetLayout(),i=0;i<=2;i++)for(r=0;r<=2;r++)(t=s.viewportRect(i,r),t&&t.width!==0&&t.height!==0)&&(!n||t.intersectRect(n))&&(f=u._commentManager,o&&f&&o.renderComment(f))},o.prototype.paintViewportImp=function(i,u,f,o,s,h){var g=this,et,ot,at,vt,ni,fi,tt,ti;(typeof o===r||o===t)&&(o=3);var c=g._sheet,ft=c.parent,k=c._getRowLayout(u,o),d=c._getColumnLayout(f,o);if(ft&&ft.resizeZeroIndicator()===1&&(u===-1&&d.length>0&&d[0].col>=1&&c._getActualColumnWidth(d[0].col-1)===0&&d.unshift(new n._Layout(-1,d[0].col-1,c._getSheetLayout().viewportX,-1,0,-1)),f===-1&&k.length>0&&k[0].row>=1&&c._getActualRowHeight(k[0].row-1)===0&&k.unshift(new n._Layout(k[0].row-1,-1,-1,c._getSheetLayout().viewportY,-1,0))),et=k.length,ot=d.length,!(et<0)&&!(ot<0)){var kt=c._getCellLayout(u,f,o),ii=kt.length>0,it=t,rt=t,l=t,st=c._cachePool,a,v,y=0,p=0,w=0,b=0,ht,ut,yt=st.isCaching()&&c.parent&&!c.parent.touchScrollOnRails()?new n._FastBorders(k[0].row,d[0].col,et,ot,s):new n._GcBorders(c,u,f,o),dt=[],ct=[],ri=o===3&&c._allowCellOverflow,nt=t,gt=c._getFilterButtonModel(),pt=[],ui=!h&&o===3&&c.parent&&c.parent.highlightInvalidData();i.save();s&&(i.rect(s.x,s.y,s.width,s.height),i.clip());i.beginPath();var lt=[],wt=-1,bt=-1;for(at=0;at<et;at++)for(it=k[at],vt=0;vt<ot;vt++)(rt=d[vt],l=ii&&kt.findCell(it.row,rt.col),l?(a=l.row,v=l.col,y=l.x,p=l.y,w=l.width,b=l.height):(a=it.row,v=rt.col,y=rt.x,p=it.y,w=rt.width,b=it.height),ft&&ft.resizeZeroIndicator()===1&&(u===-1&&c.getColumnVisible(v)&&c._getActualColumnWidth(v)===0&&((bt<0||bt!==v-1)&&lt.push({x1:y,y1:p,x2:y,y2:p+b,horizontal:!1}),bt=v),f===-1&&c.getRowVisible(a)&&c._getActualRowHeight(a)===0&&((wt<0||wt!==a-1)&&lt.push({x1:y,y1:p,x2:y+w,y2:p,horizontal:!0}),wt=a)),s&&(y+w<=s.x||y>=s.x+s.width||p+b<=s.y||p>=s.y+s.height))||w!==0&&b!==0&&(l&&n.ArrayHelper.contains(dt,l)||(ht=st.getValue(a,v,o),ut=st.getActualStyle(a,v,o),ni={value:undefined},ut&&(fi=n._CacheMgr.getFormattedTextByStyle(c,ut,ht,ni)),gt&&w>0&&b>0&&(tt=gt.find(a,v,o),tt&&(nt||(nt=new n._FilterButtonInfoModel),nt.push(new n._FilterButtonInfo(tt.rowFilter,tt.row,tt.col,tt.sheetArea,y,p,w,b)))),ui&&!c.isValid(a,v,ht)&&pt.push({x:y,y:p,width:w,height:b}),yt.addCellLines(a,v,y,p,w,b,ut,l),ct.push({data:ht,row:a,col:v,x:y,y:p,width:w,height:b,style:ut}),l&&dt.push(l)));ct.length>0&&(ri&&(ti=st.getCellOverflowBuilder(u,f,function(){return new e(c,u,f)}),g.buildCellOverflowValueLayout(ti,ct,yt)),g.paintCells(i,ct,o,h));nt&&nt.length>0&&g._paintFilterButtons(i,nt);yt.paint(i,s);lt.length>0&&g._paintDoubleGridLines(i,lt,1,3);pt.length>0&&g._paintValidationUI(i,pt);i.restore()}},o.prototype._paintDoubleGridLines=function(n,t,i,r){var h,y;if(t.length!==0)for(h=0,y=t.length;h<y;h++){var s=t[h],u=s.x1,f=s.y1,e=s.x2,o=s.y2,c=s.horizontal;if(n.beginPath(),n.save(),n.lineWidth=i,n.strokeStyle=this._getHeaderGridLineColor(n,c,u,f,e,o),n.fillStyle=this._getHeaderBackColor(n,c,u,f,e,o),c){var l=-3,p=1,w=-1,b=-2;n.fillRect(u,f+l,e-u-1,r+2*i);n.translate(.5,.5);n.moveTo(u+w,f+l);n.lineTo(e+b,o+l);n.moveTo(u+w,f+p);n.lineTo(e+b,o+p)}else{var a=-3,k=1,v=0,d=-1;n.fillRect(u+a,f+v,r+2*i,o-f-1);n.translate(.5,.5);n.moveTo(u+a,f+v);n.lineTo(e+a,o+d);n.moveTo(u+k,f+v);n.lineTo(e+k,o+d)}n.stroke();n.restore()}},o.prototype._getHeaderBackColor=function(t,i,r,u,f,e){var o,p=i?"rowHeader":"columnHeader",s=n.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-"+p+"-normal"),v=s&&s.backgroundColor,c=s&&s.backgroundImage,l,h,y,a;if(!i&&c&&c.indexOf("linear-gradient")!==-1)for(l=n.util.getLinearGradientColors(c),o=t.createLinearGradient(r,u,f,e),h=0,y=l.length;h<y;h++)a=l[h],o.addColorStop(a.point,a.color);else v&&(o=v);return o},o.prototype._getHeaderGridLineColor=function(t,i,r,u,f,e){var o=t.createLinearGradient(r,u,f,e),h=i?"rowHeader":"columnHeader",s=n.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-"+h+"-normal");return i?(o.addColorStop(0,s.borderTopColor),o.addColorStop(1,s.borderBottomColor)):(o.addColorStop(0,s.borderLeftColor),o.addColorStop(1,s.borderRightColor)),o},o.prototype._getFilterButtonRect=function(n){var t=this._sheet,r=t._zoomFactor,e=r>1?1:r,i=parseInt((u(20,t.defaults.rowHeight)*e).toString(),10);t.parent&&t.parent.useTouchLayout()&&(i=parseInt((t.defaults.rowHeight*r).toString(),10));var f=i,o=n.x+n.width-i,s=n.y+n.height-f;return{x:o,y:s,width:i,height:f}},o.prototype._paintFilterButtons=function(t,i){var a=this._sheet,v,u;for(t.save(),t.beginPath(),t.lineWidth=1,t.fillStyle="#FFFFFF",t.strokeStyle="#CCCCCC",v=this._getCtx(),u=0;u<i.length;u++){var r=i[u],f=this._getFilterButtonRect(new n.Rect(r.x,r.y,r.width,r.height)),e=f.width,o=f.height,s=f.x,h=f.y;t.save();t.rect(r.x,r.y,r.width,r.height);t.clip();t.beginPath();t.fillRect(s+1,h+1,e-3,o-3);t.strokeRect(s+1-.5,h+2-.5,e-3,o-4);var y=r.getState(),c=n._GcFilterDialog.getImageSrc(y),l=a._getImageLoader();try{l.getState(c)?t.drawImage(l.getImage(c),s,h+1,e-3,o-3):l.addImage(c)}catch(p){}t.beginPath();t.restore()}t.restore()},o.prototype._paintValidationUI=function(n,t){var y,e;if(t)for(y=t.length,e=0;e<y;e++){var o=t[e],r=o.x-4,f=o.y-4,c=o.width+8,l=o.height+8,p=.5522848,s=c/2*p,h=l/2*p,a=r+c,v=f+l,u=r+c/2,i=f+l/2;n.save();n.lineWidth=2;n.strokeStyle="red";n.beginPath();n.moveTo(r,i);n.bezierCurveTo(r,i-h,u-s,f,u,f);n.bezierCurveTo(u+s,f,a,i-h,a,i);n.bezierCurveTo(a,i+h,u+s,v,u,v);n.bezierCurveTo(u-s,v,r,i+h,r,i);n.closePath();n.stroke();n.restore()}},o.prototype.paintCells=function(r,u,f,e){var ut=this,o=ut._sheet,yt=f===3,ot=n.StyleHelper._scaleFont,pt=o._zoomFactor,wt=ot(ut._getDefaultFont(f),pt),bt=o.getDefaultStyle(f),ni=o.getDefaultCellType(f),ti=o._conditionalFormats,tt=o.parent&&o.parent.backColor()||"#FFFFFF",kt,ct,it,lt,at,vt,rt,y;tt=tt==="white"?"#FFFFFF":tt;kt=o._getImageLoader();r.save();r.beginPath();r.fillStyle=bt&&bt.foreColor||"#000000";r.font=wt.font;r.textAlign=yt?"right":"center";var ft=u.length,c,w,b,k,d,g,nt,a,p,s,et,dt,v,st,gt,ii=n.features.sparkline,ri=o._getModel(f),ht=[],l,h={sheet:o,row:-1,col:-1,fontInfo:t,lineHeight:-1,imageLoader:kt,conditionalFormats:ti,sheetArea:f,parentBackColor:tt};for(y=0;y<ft;y++){if(c=u[y],b=c.data,k=c.row,d=c.col,g=c.x,nt=c.y,a=c.width,p=c.height,s=c.style,et=c.cellOverflowLayout,v=s.font?ot(s.font,pt):wt,ct=!s.wordWrap&&s.shrinkToFit,ct&&(it=o.getText(k,d,f),s.watermark&&!it&&(it=s.watermark),it))for(lt={value:!1},at=0;at<3&&lt.value===!1;at++)if(vt=o._getStringWidthByCanvas(it,v.font),rt=i(0,a-4),s.hAlign!==1&&s.textIndent&&(rt=i(0,rt-s.textIndent*8)),rt<vt)v=ot(v.font,rt/vt,lt,!0);else break;s.font=v.font;a>0&&p>0&&(w=s.cellType||ni,g--,nt--,a++,p++,yt?(gt=ii&&ri.getSparkline(k,d),h.sparkline=gt):(dt=e?0:ut.getVisualState(k,d,f),h.visualState=dt),st=o._getFontHeight(v.font,ct),h.lineHeight=st,h.row=k,h.col=d,h.fontInfo=v,h.cellOverflowLayout=et,w.paint(r,b,g,nt,a,p,s,h),et&&!h.showBarIconOnly&&ht.push({cellType:w,data:b,x:g,y:nt,width:a,height:p,style:s,options:{sheet:o,row:k,col:d,fontInfo:v,lineHeight:st,cellOverflowLayout:et,parentBackColor:tt}}));!e&&n.features.comment&&o._commentManager.hasComment()&&ut._paintCommentCellAdorner(r,f,c)}if(ft=ht.length,ft>0){var ui=o.isEditing(),fi=o._activeRowIndex,ei=o._activeColIndex,oi=n.features.sparklineEx;for(y=0;y<ft;y++)(l=ht[y],w=l.cellType,b=l.data,g=l.x,nt=l.y,a=l.width,p=l.height,s=l.style,h=l.options,ui&&h.row===fi&&h.col===ei)||oi&&b instanceof n.SparklineExValue||w.paintValue&&w.paintValue(r,b,g,nt,a,p,s,h)}r.restore()},o.prototype.getVisualState=function(i,u,f){var e=this._sheet,o=0;return(n.FocusHelper.isActiveElement(e)||e.parent&&!e.parent.hideSelection())&&(f===3||typeof f===r||f===t?!e.isEditing()&&e._isActiveCell(i,u)?o=3:e._isSelected(i,u,f)&&(o=2):(e._isSelected(i,u,f)&&(o=1,e._isAllSelected(i,u,f)&&(o=2)),e._isHover(i,u,f)&&(o=4))),o},o.prototype.paintLine=function(n,t,i,r,u,f){n.lineWidth=t.width();n.strokeStyle=t.color;n.moveTo(i,r);n.lineTo(u,f)},o.prototype.paintGroup=function(t,i){var r=this._sheet,u=r._getGroupLayout(),h,e,c,o,l,s,f;if(u.width!==0||u.height!==0){if(t.save(),t.beginPath(),h=r._getSheetLayout(),u.width>0&&(!i||i.intersect(u.x,u.y,u.width,h.height)))for(e=u.rowMaxLevel,c=new n._RangeGroupHeaderPresenter(r,!0,e),c.paintGroupHeader(t),s=r._cachePool.getRowGroups(function(){for(var i=[new n._RangeGroupPresenter(r,!0,0,e),new n._RangeGroupPresenter(r,!0,1,e),new n._RangeGroupPresenter(r,!0,2,e)],t=0;t<=2;t++)i[t].createGroupInfo();return i}),f=0;f<=2;f++)s[f].paintGroups(t);if(u.height>0&&(!i||i.intersect(u.x,u.y,h.width,u.height)))for(o=u.colMaxLevel,l=new n._RangeGroupHeaderPresenter(r,!1,o),l.paintGroupHeader(t),s=r._cachePool.getColGroups(function(){for(var i=[new n._RangeGroupPresenter(r,!1,0,o),new n._RangeGroupPresenter(r,!1,1,o),new n._RangeGroupPresenter(r,!1,2,o)],t=0;t<=2;t++)i[t].createGroupInfo();return i}),f=0;f<=2;f++)s[f].paintGroups(t);t.beginPath();t.restore()}},o.prototype.groupHitTest=function(i,r){var e,u,a,l,s,o,f,h,p,v,c,w,y;if(!n.features.group||(e=this._sheet,u=e._getGroupLayout(),u.width===0&&u.height===0)||(a=e._getSheetLayout(),l=new n.Rect(u.x,u.y,u.width,a.height),!l.contains(i,r)&&(l=new n.Rect(u.x,u.y,a.width,u.height),!l.contains(i,r))))return t;if(s={what:"empty",info:t},u.width>0&&(h=u.rowMaxLevel,p=new n._RangeGroupHeaderPresenter(e,!0,h),f=p.getGroupButton(i,r),f&&(s={what:"rgh",info:f}),s.what==="empty"))for(v=[new n._RangeGroupPresenter(e,!0,0,h),new n._RangeGroupPresenter(e,!0,1,h),new n._RangeGroupPresenter(e,!0,2,h)],o=0;o<=2;o++)if(v[o].createGroupInfo(),f=v[o].getRowGroupButton(i,r),f){s={what:"rg",info:f};break}if(u.height>0&&(c=u.colMaxLevel,s.what==="empty"&&(w=new n._RangeGroupHeaderPresenter(e,!1,c),f=w.getGroupButton(i,r),f&&(s={what:"cgh",info:f})),s.what==="empty"))for(y=[new n._RangeGroupPresenter(e,!1,0,c),new n._RangeGroupPresenter(e,!1,1,c),new n._RangeGroupPresenter(e,!1,2,c)],o=0;o<=2;o++)if(y[o].createGroupInfo(),f=y[o].getColGroupButton(i,r),f){s={what:"cg",info:f};break}return s},o.prototype.buildCellOverflowValueLayout=function(t,i,r){for(var tt,ft,v,b,ht,ct,et,y=this._sheet,ot=y._cachePool,at=i.length,l,k,d,f,e,it,p,c,w,h,a,lt,g,nt,o,s,u,st={},rt=[],ut=0;ut<at;ut++){if(l=i[ut],f=l.row,e=l.col,it=l.x,p=l.y,w=l.height,nt=t.getCellOverflowLayoutModel(f),o=nt.headingOverflowlayout,s=nt.trailingOverflowLayout,!st[f]){for(tt={},ft=0;ft<nt.length;ft++)tt[nt[ft].column]=!1;o&&(tt[o.column]=!1);s&&(tt[s.column]=!1);st[f]=tt}v=st[f];u=nt.find(e);u?(u.column===e?(c=l.width,h=u.backgroundWidth,a=u.backgroundLeftWidth<0?it:u.backgroundRightWidth<0?it+c-h:it+c/2-u.backgroundLeftWidth,l.cellOverflowLayout=u,v[u.column]&&rt.push(ut)):v[u.column]||(e=u.column,d=ot.getActualStyle(f,e),k=y.getValue(f,e),c=u.columnWidth,h=u.backgroundWidth,b=y.getCellRect(f,u.column),a=u.backgroundLeftWidth<0?b.x:u.backgroundRightWidth<0?b.x+b.width-h:b.x+b.width/2-u.backgroundLeftWidth,g={data:k,row:f,col:e,x:b.x,y:p,width:c,height:w,style:d,cellOverflowLayout:u},i.push(g)),u.layout=new n.Rect(a,p,h,w),r.addCellOverlfowLayout(f,u),v[u.column]=!0):o&&!v[o.column]&&o.contains(e)?(e=o.column,d=ot.getActualStyle(f,e),k=y.getValue(f,e),c=o.columnWidth,h=o.backgroundWidth,ht=y.getCellRect(f,o.endColumn),a=ht.x+ht.width-h,g={data:k,row:f,col:e,x:a,y:p,width:c,height:w,style:d,cellOverflowLayout:o},i.push(g),o.layout=new n.Rect(a,p,h,w),r.addCellOverlfowLayout(f,o),v[o.column]=!0):s&&!v[s.column]&&s.contains(e)&&(e=s.column,d=ot.getActualStyle(f,e),k=y.getValue(f,e),c=s.columnWidth,h=s.backgroundWidth,ct=y.getCellRect(f,s.startColumn),a=ct.x,lt=ct.x+h-c,g={data:k,row:f,col:e,x:lt,y:p,width:c,height:w,style:d,cellOverflowLayout:s},i.push(g),s.layout=new n.Rect(a,p,h,w),r.addCellOverlfowLayout(f,s),v[s.column]=!0)}if(rt.length>0)for(et=rt.length-1;et>=0;et--)i.splice(rt[et],1)},o}();n._SheetRender=c;e=function(){function i(t,i,r){this.TEXT_WIDTH_OFFSET=2;var u=this;u._sheet=t;u._rowViewportIndex=i;u._colViewportIndex=r;u._colLayoutModel=t._getColumnLayout(r);u._cellLayoutModel=t._getCellLayout(i,r);u.maxCellOverflowDistance=t.maxCellOverflowDistance;u.scaleFont=n.StyleHelper._scaleFont;u.zoomFactor=t._zoomFactor;u.defaultFont=u.scaleFont(t._render._getDefaultFont(),u.zoomFactor).font;u.defaultCellType=t.getDefaultCellType();u.cachedCellOverflowModels={}}return i.prototype.getCellOverflowLayoutModel=function(i){var f=this,b=f.cachedCellOverflowModels[i],y;if(b)return b;var k=f._sheet,p=k._cachePool,l=f._colLayoutModel,d=l.length,g=l[0].col,nt=l[d-1].col,w,s,u,o,a,h,v,c=new n._CellOverflowLayoutModel,e;for(c.headingOverflowlayout=f._buildHeadingCellOverflowLayout(i),y=0;y<d;y++)(w=l[y],w.width<=0)||(s=w.col,o=p.getValue(i,s),u=p.getActualStyle(i,s),o!==t&&typeof o!==r||u.watermark)&&(u.shrinkToFit||u.wordWrap||(a=p.getZoomColWidth(s),v=n._CacheMgr.getFormattedTextByStyle(k,u,o),h=u.hAlign,h===3&&(h=n.util.getHAlignByValueType(h,o,u.formatter)),h===0?(e=f._buildCellOverflowLayoutModelForLeft({data:o,style:u,width:a,text:v},i,s,nt),e&&c.push(e)):h===2?(e=f._buildCellOverflowLayoutModelForRight({data:o,style:u,width:a,text:v},i,s,g),e&&c.push(e)):h===1&&(e=f._buildCellOverflowLayoutModelForCenter({data:o,style:u,width:a,text:v},i,s,g,nt),e&&c.push(e))));return c.trailingOverflowLayout=f._buildTrailingCellOverflowLayout(i),f.cachedCellOverflowModels[i]=c,c},i.prototype._buildCellOverflowLayoutModelForLeft=function(i,u,f,e){var s=this,tt=s._sheet,p=tt._cachePool,k=s._cellLayoutModel,it=i.width,c=i.width,w=i.data,h=i.style,o,a=i.text,v,d,g,l,b,nt,y;if(k.findCell(u,f)!==t||(g=h.cellType||s.defaultCellType,!g.allowOverflow)||!a&&!h.watermark||(!a&&h.watermark&&(a=h.watermark),l=h.font,b=h.textIndent,l=l?s.scaleFont(l,s.zoomFactor).font:s.defaultFont,v=n._WordWrapHelper._measureText(a,l)+(b?b*8:0)+s.TEXT_WIDTH_OFFSET,v<=c))return t;for(nt=f,y=f,o=f+1;o<=e;o++){if(k.findCell(u,o)!==t)break;if(w=p.getValue(u,o),w!==t&&typeof w!==r)break;if(d=p.getActualStyle(u,o),d.watermark)break;if(y=o,c+=p.getZoomColWidth(o),v<=c)break}return y==f?t:new n._CellOverflowLayout(f,nt,y,v,it,c,-1,c)},i.prototype._buildCellOverflowLayoutModelForRight=function(i,u,f,e){var s=this,tt=s._sheet,p=tt._cachePool,k=s._cellLayoutModel,it=i.width,c=i.width,w=i.data,h=i.style,rt,o,a=i.text,v,d,g,l,b,y,nt;if(k.findCell(u,f)!==t||(g=h.cellType||s.defaultCellType,!g.allowOverflow)||!a&&!h.watermark||(!a&&h.watermark&&(a=h.watermark),l=h.font,b=h.textIndent,l=l?s.scaleFont(l,s.zoomFactor).font:s.defaultFont,v=n._WordWrapHelper._measureText(a,l)+(b?b*8:0)+s.TEXT_WIDTH_OFFSET,v<=c))return t;for(y=f,nt=f,o=f-1;o>=e;o--){if(k.findCell(u,o)!==t)break;if(w=p.getValue(u,o),w!==t&&typeof w!==r)break;if(d=p.getActualStyle(u,o),d.watermark)break;if(y=o,c+=p.getZoomColWidth(o),v<=c)break}return y==f?t:new n._CellOverflowLayout(f,y,nt,v,it,c,c,-1)},i.prototype._buildCellOverflowLayoutModelForCenter=function(i,u,f,e,o){var h=this,ut=h._sheet,a=ut._cachePool,g=h._cellLayoutModel,ft=i.width,nt=i.width,c=i.data,l=i.style,s,b=i.text,v,it,rt,y,tt,k,p,d,w;if(g.findCell(u,f)!==t||(rt=l.cellType||h.defaultCellType,!rt.allowOverflow)||!b&&!l.watermark||(!b&&l.watermark&&(b=l.watermark),y=l.font,tt=l.textIndent,y=y?h.scaleFont(y,h.zoomFactor).font:h.defaultFont,v=n._WordWrapHelper._measureText(b,y)+(tt?tt*8:0)+h.TEXT_WIDTH_OFFSET,v<=nt))return t;for(k=f,p=nt/2,s=f-1;s>=e;s--){if(g.findCell(u,s)!==t)break;if(c=a.getValue(u,s),c!==t&&typeof c!==r)break;if(it=a.getActualStyle(u,s),it.watermark)break;if(k=s,p+=a.getZoomColWidth(s),v/2<=p)break}for(d=f,w=nt/2,s=f+1;s<=o;s++){if(g.findCell(u,s)!==t)break;if(c=a.getValue(u,s),c!==t&&typeof c!==r)break;if(d=s,w+=a.getZoomColWidth(s),v/2<=w)break}return k===d?t:new n._CellOverflowLayout(f,k,d,v,ft,p+w,p,w)},i.prototype._buildHeadingCellOverflowLayout=function(i){for(var w,h=this,a=h._sheet,v=a._cachePool,y=h._colLayoutModel,c=y[0].col,b=y[y.length-1].col,k=a._getSpanModel(),s,e,l,o,d=h.maxCellOverflowDistance,g=c,u,f,p=1;p<d;p++){if((u=g-p,u<0)||k.find(i,u))return t;if(e=v.getValue(i,u),l=v.getZoomColWidth(u),l>0&&e!==t&&typeof e!==r){if(s=v.getActualStyle(i,u),o=s.hAlign,o===3&&(o=n.util.getHAlignByValueType(o,e)),(o===0||o===1)&&s&&(w=n._CacheMgr.getFormattedTextByStyle(a,s,e)),o===0){if(f=h._buildCellOverflowLayoutModelForLeft({data:e,style:s,width:l,text:w},i,u,b),f&&f.endColumn>=c)return f}else if(1&&(f=h._buildCellOverflowLayoutModelForCenter({data:e,style:s,width:l,text:w},i,u,c,b),f&&f.endColumn>=c))return f;return t}}},i.prototype._buildTrailingCellOverflowLayout=function(i){for(var w,h=this,c=h._sheet,v=c._cachePool,y=h._colLayoutModel,b=y[0].col,l=y[y.length-1].col,k=c._getSpanModel(),s,e,a,o,d=h.maxCellOverflowDistance,g=c.getColumnCount(),nt=l,u,f,p=1;p<d;p++){if((u=nt+p,u>=g)||k.find(i,u))return t;if(e=v.getValue(i,u),a=v.getZoomColWidth(u),a>0&&e!==t&&typeof e!==r){if(s=v.getActualStyle(i,u),o=s.hAlign,o===3&&(o=n.util.getHAlignByValueType(o,e)),(o===2||o===1)&&s&&(w=n._CacheMgr.getFormattedTextByStyle(c,s,e)),o===2){if(f=h._buildCellOverflowLayoutModelForRight({data:e,style:s,width:a,text:w},i,u,b),f&&f.startColumn<=l)return f}else if(1&&(f=h._buildCellOverflowLayoutModelForCenter({data:e,style:s,width:a,text:w},i,u,b,l),f&&f.startColumn<=l))return f;return t}}},i}();n._CellOverflowLayoutBuilder=e;o=function(){function i(n){this._needPaintIndicator=!1;this._eventNS=".cutCopyIndicator";this._isPastedInternal=!1;this._ch=t;this._sheet=n;this._bindEvents()}return i.prototype.isPastedInternal=function(n){var t=this;if(arguments.length===0)return t._isPastedInternal;typeof n=="boolean"&&(t._isPastedInternal=n)},i.prototype.needPaintIndicator=function(n){var t=this,i;if(arguments.length===0)return t._needPaintIndicator;if(typeof n=="boolean"){if(t._needPaintIndicator===n&&n===!1)return t;t._needPaintIndicator=n;i=t._sheet;i&&i.invalidate()}return t},i.prototype.getClipboardHelper=function(){var n=this,t=n._sheet;return t&&!n._ch&&(n._ch=t._getClipboardHelper()),n._ch},i.prototype._bindEvents=function(){var t=this,i=t._sheet,r=!1;i&&(i._bind(n.Events.ClipboardChanged+t._eventNS,function(n,i){t.needPaintIndicator(!0)}),i._bind(n.Events.ValueChanged+t._eventNS,function(n,i){t.needPaintIndicator(!1)}),i._eventHandler.bind(n.Events.CellChanged+t._eventNS,function(n,i){t.needPaintIndicator(!1)}),i._bind(n.Events.ColumnChanged+t._eventNS,function(n,i){i.propertyName!=="resizable"&&i.propertyName!=="width"&&i.propertyName!=="isVisible"&&t.needPaintIndicator(!1)}),i._bind(n.Events.RowChanged+t._eventNS,function(n,i){i.propertyName!=="resizable"&&i.propertyName!=="height"&&i.propertyName!=="isVisible"&&t.needPaintIndicator(!1)}),i._bind(n.Events.RangeChanged+t._eventNS,function(n,i){t.needPaintIndicator(!1)}),i._bind(n.Events.ClipboardPasting+t._eventNS,function(n,i){r=t.needPaintIndicator()}),i._bind(n.Events.ClipboardPasted+t._eventNS,function(n,i){var u=i.cellRange,e=i.sheet,f=t.getClipboardHelper();u&&f&&f.range&&f.fromSheet&&e&&(f.range.intersect(u.row,u.col,u.rowCount,u.colCount)||!t.isPastedInternal()?t.needPaintIndicator(!1):t.needPaintIndicator(r))}))},i.prototype.paintCutCopyIndicator=function(t,i,r,u){var l,a;if(this._needPaintIndicator){var e=this._sheet,c=e._render,s=this.getClipboardHelper(),f=e.parent,v=f&&f.cutCopyIndicatorVisible?f.cutCopyIndicatorVisible():!0;if(v&&s&&s.fromSheet===e&&s.range){var y=e._getSheetLayout(),o=y.viewportRect(r,u),h=c._getPaintingRects(r,u,[s.range],i)[0];h&&o&&(t.save(),t.rect(o.x,o.y,o.width,o.height),t.clip(),h&&(l=f&&f.cutCopyIndicatorBorderColor?f.cutCopyIndicatorBorderColor():"blue",a=n._ThemeContext.getColor(e,l),c.paintDashRect(t,h,a)),t.beginPath(),t.restore())}}},i.prototype.addRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},i.prototype.deleteRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},i.prototype.addColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},i.prototype.deleteColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},i.prototype.cancelIndicator=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},i.prototype._dispose=function(){var t=this._sheet,i=this._eventNS;t._eventHandler.unbind(n.Events.CellChanged+i);t._unbind(n.Events.ClipboardChanged+i);t._unbind(n.Events.ValueChanged+i);t._unbind(n.Events.CellChanged+i);t._unbind(n.Events.ColumnChanged+i);t._unbind(n.Events.RowChanged+i);t._unbind(n.Events.RangeChanged+i);t._unbind(n.Events.ClipboardPasting+i);t._unbind(n.Events.ClipboardPasted+i)},i}();n.CutCopyIndicatorManager=o})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(n){var ut,ft;n.feature("core.sheet_ui",["core.common"]);var rt=undefined,t="backColor",i="foreColor",r="hAlign",u="vAlign",f="themeFont",e="font",o="formatter",s="borderLeft",h="borderTop",c="borderRight",l="borderBottom",a="locked",v="textIndent",y="wordWrap",p="shrinkToFit",w="backgroundImage",b="backgroundImageLayout",k="validator",d="cellType",ot="bindingPath",g="tabStop",nt="textDecoration",tt="imeMode",it="watermark",et=function(){function ut(n,t,i,r){var u=this;u.sheet=n;u.row=t;u.row2=t;u.col=i;u.col2=i;(r===rt||r===null)&&(r=3);u.sheetArea=r}return ut.prototype.value=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getValue(t.row,t.col,t.sheetArea);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setValue(i,r,n,t.sheetArea);return t}},ut.prototype.text=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getText(t.row,t.col,t.sheetArea);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setText(i,r,n,t.sheetArea);return t}},ut.prototype.formula=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getFormula(t.row,t.col,t.sheetArea);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setFormula(i,r,n,t.sheetArea);return t}},ut.prototype.bindingPath=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getBindingPath(t.row,t.col,t.sheetArea);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setBindingPath(i,r,n,t.sheetArea);return t}},ut.prototype.comment=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getComment(t.row,t.col);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setComment(i,r,n);return t}},ut.prototype.tag=function(n){var t=this,i,r;if(arguments.length===0)return t.sheet.getTag(t.row,t.col,t.sheetArea);else{for(i=t.row;i<=t.row2;i++)for(r=t.col;r<=t.col2;r++)t._isValidIndex(i,r)&&t.sheet.setTag(i,r,n,t.sheetArea);return t}},ut.prototype.dataValidator=function(n){return arguments.length==0?this._getStyleProperty(k):this._setStyleProperty(k,n)},ut.prototype.cellType=function(n){return arguments.length==0?this._getStyleProperty(d):this._setStyleProperty(d,n)},ut.prototype.backgroundImage=function(n){return arguments.length==0?this._getStyleProperty(w):this._setStyleProperty(w,n)},ut.prototype.backgroundImageLayout=function(n){return arguments.length==0?this._getStyleProperty(b):this._setStyleProperty(b,n)},ut.prototype.backColor=function(n){return arguments.length===0?this._getStyleProperty(t):this._setStyleProperty(t,n)},ut.prototype.foreColor=function(n){return arguments.length===0?this._getStyleProperty(i):this._setStyleProperty(i,n)},ut.prototype.hAlign=function(n){return arguments.length===0?this._getStyleProperty(r):this._setStyleProperty(r,n)},ut.prototype.vAlign=function(n){return arguments.length===0?this._getStyleProperty(u):this._setStyleProperty(u,n)},ut.prototype.themeFont=function(n){return arguments.length===0?this._getStyleProperty(f):this._setStyleProperty(f,n)},ut.prototype.font=function(n){return arguments.length===0?this._getStyleProperty(e):this._setStyleProperty(e,n)},ut.prototype.formatter=function(n){return arguments.length===0?this._getStyleProperty(o):this._setStyleProperty(o,n)},ut.prototype.borderLeft=function(n){return arguments.length===0?this._getStyleProperty(s):this._setStyleProperty(s,n)},ut.prototype.borderTop=function(n){return arguments.length===0?this._getStyleProperty(h):this._setStyleProperty(h,n)},ut.prototype.borderRight=function(n){return arguments.length===0?this._getStyleProperty(c):this._setStyleProperty(c,n)},ut.prototype.borderBottom=function(n){return arguments.length===0?this._getStyleProperty(l):this._setStyleProperty(l,n)},ut.prototype.locked=function(n){return arguments.length===0?this._getStyleProperty(a):this._setStyleProperty(a,n)},ut.prototype.textIndent=function(n){return arguments.length===0?this._getStyleProperty(v):this._setStyleProperty(v,n)},ut.prototype.wordWrap=function(n){return arguments.length===0?this._getStyleProperty(y):this._setStyleProperty(y,n)},ut.prototype.shrinkToFit=function(n){return arguments.length===0?this._getStyleProperty(p):this._setStyleProperty(p,n)},ut.prototype.tabStop=function(n){return arguments.length===0?this._getStyleProperty(g):this._setStyleProperty(g,n)},ut.prototype.textDecoration=function(n){return arguments.length===0?this._getStyleProperty(nt):this._setStyleProperty(nt,n)},ut.prototype.watermark=function(n){return arguments.length===0?this._getStyleProperty(it):this._setStyleProperty(it,n)},ut.prototype.imeMode=function(n){return arguments.length===0?this._getStyleProperty(tt):this._setStyleProperty(tt,n)},ut.prototype.clearStyleProperty=function(n){for(var i,u,t=this,r=t.row;r<=t.row2;r++)for(i=t.col;i<=t.col2;i++)t._isValidIndex(r,i)&&(u=t.sheet.getStyleImp(r,i,t.sheetArea),u&&u.clear(n))},ut.prototype._getStyleProperty=function(n){var t=this;return t.sheet.getStyleProperty(t.row,t.col,n,t.sheetArea)},ut.prototype._setStyleProperty=function(t,i){for(var u,e,r=this,f=r.row;f<=r.row2;f++)for(u=r.col;u<=r.col2;u++)r._isValidIndex(f,u)&&(e=r.sheet.getStyleImp(f,u,r.sheetArea),e||(e=new n.Style),e[t]=i,r.sheet.setStyle(f,u,e,r.sheetArea));return r},ut.prototype._isValidIndex=function(n,t){var r=this,i=r.sheet,u=r.sheetArea,f,e;return i&&(f=i.getRowCount(u),e=i.getColumnCount(u),0<=n&&n<f&&0<=t&&t<e)?!0:!1},ut}();n.Cell=et;ut=function(){function ut(n,t,i){var r=this;r.sheet=n;r.index=t;r.index2=t;(i===rt||i===null)&&(i=3);r.sheetArea=i}return ut.prototype.height=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getRowHeight(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setRowHeight(i,n,t.sheetArea);return t}},ut.prototype.visible=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getRowVisible(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setRowVisible(i,n,t.sheetArea);return t}},ut.prototype.resizable=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getRowResizable(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setRowResizable(i,n,t.sheetArea);return t}},ut.prototype.dataValidator=function(n){return arguments.length==0?this._getStyleProperty(k):this._setStyleProperty(k,n)},ut.prototype.cellType=function(n){return arguments.length==0?this._getStyleProperty(d):this._setStyleProperty(d,n)},ut.prototype.backgroundImage=function(n){return arguments.length==0?this._getStyleProperty(w):this._setStyleProperty(w,n)},ut.prototype.backgroundImageLayout=function(n){return arguments.length==0?this._getStyleProperty(b):this._setStyleProperty(b,n)},ut.prototype.backColor=function(n){return arguments.length===0?this._getStyleProperty(t):this._setStyleProperty(t,n)},ut.prototype.foreColor=function(n){return arguments.length===0?this._getStyleProperty(i):this._setStyleProperty(i,n)},ut.prototype.hAlign=function(n){return arguments.length===0?this._getStyleProperty(r):this._setStyleProperty(r,n)},ut.prototype.vAlign=function(n){return arguments.length===0?this._getStyleProperty(u):this._setStyleProperty(u,n)},ut.prototype.themeFont=function(n){return arguments.length===0?this._getStyleProperty(f):this._setStyleProperty(f,n)},ut.prototype.font=function(n){return arguments.length===0?this._getStyleProperty(e):this._setStyleProperty(e,n)},ut.prototype.formatter=function(n){return arguments.length===0?this._getStyleProperty(o):this._setStyleProperty(o,n)},ut.prototype.borderLeft=function(n){return arguments.length===0?this._getStyleProperty(s):this._setStyleProperty(s,n)},ut.prototype.borderTop=function(n){return arguments.length===0?this._getStyleProperty(h):this._setStyleProperty(h,n)},ut.prototype.borderRight=function(n){return arguments.length===0?this._getStyleProperty(c):this._setStyleProperty(c,n)},ut.prototype.borderBottom=function(n){return arguments.length===0?this._getStyleProperty(l):this._setStyleProperty(l,n)},ut.prototype.locked=function(n){return arguments.length===0?this._getStyleProperty(a):this._setStyleProperty(a,n)},ut.prototype.textIndent=function(n){return arguments.length===0?this._getStyleProperty(v):this._setStyleProperty(v,n)},ut.prototype.wordWrap=function(n){return arguments.length===0?this._getStyleProperty(y):this._setStyleProperty(y,n)},ut.prototype.shrinkToFit=function(n){return arguments.length===0?this._getStyleProperty(p):this._setStyleProperty(p,n)},ut.prototype.tabStop=function(n){return arguments.length===0?this._getStyleProperty(g):this._setStyleProperty(g,n)},ut.prototype.textDecoration=function(n){return arguments.length===0?this._getStyleProperty(nt):this._setStyleProperty(nt,n)},ut.prototype.imeMode=function(n){return arguments.length===0?this._getStyleProperty(tt):this._setStyleProperty(tt,n)},ut.prototype.watermark=function(n){return arguments.length===0?this._getStyleProperty(it):this._setStyleProperty(it,n)},ut.prototype.clearStyleProperty=function(n){for(var u,f,t=this,r=t.sheet,i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&(u=r.getStyleImp(i,-1,t.sheetArea),u&&(f=u[n],u.clear(n),r.triggerRowChanged({sheet:r,sheetName:r._name,row:i,sheetArea:t.sheetArea,propertyName:n,oldValue:f})))},ut.prototype.tag=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getTag(t.index,-1,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setTag(i,-1,n,t.sheetArea);return t}},ut.prototype._getStyleProperty=function(n){var t=this.sheet.getStyleImp(this.index,-1,this.sheetArea);return t?t[n]:rt},ut.prototype._setStyleProperty=function(t,i){for(var f,r=this,u=r.index;u<=r.index2;u++)r._isValidIndex(u)&&(f=r.sheet.getStyleImp(u,-1,r.sheetArea),f||(f=new n.Style),f[t]=i,r.sheet.setStyle(u,-1,f,r.sheetArea));return r},ut.prototype._isValidIndex=function(n){if(this.sheet){var t=this.sheet.getRowCount(this.sheetArea);if(0<=n&&n<t)return!0}return!1},ut}();n.Row=ut;ft=function(){function ut(n,t,i){var r=this;r.sheet=n;r.index=t;r.index2=t;(i===rt||i===null)&&(i=3);r.sheetArea=i}return ut.prototype.width=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getColumnWidth(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setColumnWidth(i,n,t.sheetArea);return t}},ut.prototype.visible=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getColumnVisible(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setColumnVisible(i,n,t.sheetArea);return t}},ut.prototype.resizable=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getColumnResizable(t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setColumnResizable(i,n,t.sheetArea);return t}},ut.prototype.dataValidator=function(n){return arguments.length==0?this._getStyleProperty(k):this._setStyleProperty(k,n)},ut.prototype.cellType=function(n){return arguments.length==0?this._getStyleProperty(d):this._setStyleProperty(d,n)},ut.prototype.backgroundImage=function(n){return arguments.length==0?this._getStyleProperty(w):this._setStyleProperty(w,n)},ut.prototype.backgroundImageLayout=function(n){return arguments.length==0?this._getStyleProperty(b):this._setStyleProperty(b,n)},ut.prototype.backColor=function(n){return arguments.length===0?this._getStyleProperty(t):this._setStyleProperty(t,n)},ut.prototype.foreColor=function(n){return arguments.length===0?this._getStyleProperty(i):this._setStyleProperty(i,n)},ut.prototype.hAlign=function(n){return arguments.length===0?this._getStyleProperty(r):this._setStyleProperty(r,n)},ut.prototype.vAlign=function(n){return arguments.length===0?this._getStyleProperty(u):this._setStyleProperty(u,n)},ut.prototype.themeFont=function(n){return arguments.length===0?this._getStyleProperty(f):this._setStyleProperty(f,n)},ut.prototype.font=function(n){return arguments.length===0?this._getStyleProperty(e):this._setStyleProperty(e,n)},ut.prototype.formatter=function(n){return arguments.length===0?this._getStyleProperty(o):this._setStyleProperty(o,n)},ut.prototype.borderLeft=function(n){return arguments.length===0?this._getStyleProperty(s):this._setStyleProperty(s,n)},ut.prototype.borderTop=function(n){return arguments.length===0?this._getStyleProperty(h):this._setStyleProperty(h,n)},ut.prototype.borderRight=function(n){return arguments.length===0?this._getStyleProperty(c):this._setStyleProperty(c,n)},ut.prototype.borderBottom=function(n){return arguments.length===0?this._getStyleProperty(l):this._setStyleProperty(l,n)},ut.prototype.locked=function(n){return arguments.length===0?this._getStyleProperty(a):this._setStyleProperty(a,n)},ut.prototype.textIndent=function(n){return arguments.length===0?this._getStyleProperty(v):this._setStyleProperty(v,n)},ut.prototype.wordWrap=function(n){return arguments.length===0?this._getStyleProperty(y):this._setStyleProperty(y,n)},ut.prototype.shrinkToFit=function(n){return arguments.length===0?this._getStyleProperty(p):this._setStyleProperty(p,n)},ut.prototype.tabStop=function(n){return arguments.length===0?this._getStyleProperty(g):this._setStyleProperty(g,n)},ut.prototype.textDecoration=function(n){return arguments.length===0?this._getStyleProperty(nt):this._setStyleProperty(nt,n)},ut.prototype.imeMode=function(n){return arguments.length===0?this._getStyleProperty(tt):this._setStyleProperty(tt,n)},ut.prototype.watermark=function(n){return arguments.length===0?this._getStyleProperty(it):this._setStyleProperty(it,n)},ut.prototype.clearStyleProperty=function(n){for(var u,f,t=this,r=t.sheet,i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&(u=r.getStyleImp(-1,i,t.sheetArea),u&&(f=u[n],u.clear(n),r.triggerColumnChanged({sheet:r,sheetName:r._name,col:i,sheetArea:t.sheetArea,propertyName:n,oldValue:f})))},ut.prototype.tag=function(n){var t=this,i;if(arguments.length===0)return t.sheet.getTag(-1,t.index,t.sheetArea);else{for(i=t.index;i<=t.index2;i++)t._isValidIndex(i)&&t.sheet.setTag(-1,i,n,t.sheetArea);return t}},ut.prototype._getStyleProperty=function(n){var t=this.sheet.getStyleImp(-1,this.index,this.sheetArea);return t?t[n]:rt},ut.prototype._setStyleProperty=function(t,i){for(var f,r=this,u=r.index;u<=r.index2;u++)r._isValidIndex(u)&&(f=r.sheet.getStyleImp(-1,u,r.sheetArea),f||(f=new n.Style),f[t]=i,r.sheet.setStyle(-1,u,f,r.sheetArea));return r},ut.prototype._isValidIndex=function(n){if(this.sheet){var t=this.sheet.getColumnCount(this.sheetArea);if(0<=n&&n<t)return!0}return!1},ut}();n.Column=ft})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){function l(n,i,r,u){throw new Error(t._StringHelper.format(t.SR.Exp_InvalidAndSpace,[n,i,r,u]));}function at(n,t,i){for(var r in b)b[r]&&(n=n.replace(b[r],b[r].source));return t===!0?(n=n.replace(/~\?/g,ct.source),n=n.replace(/~\*/g,lt.source),n=n.replace(/\?/g,"."),n=i?n.replace(/\*/g,"((.|\\n)+)"):n.replace(/\*/g,"((.|\\n)*)"),n=n.replace(ct,"\\?"),n=n.replace(lt,"\\*")):(n=n.replace(/\?/g,"\\?"),n=n.replace(/\*/g,"\\*")),n}var ht;t.feature("core.sheet",["core.common","core.stringResource","core.sheet_event","core.sheet_render","core.basecelltype","core.sheet_ui","core.sheet_model","core.sheet_action","core.sheet_border"]);var i=null,r=undefined,f=Math.min,e=Math.max,s=Math.floor,p=Math.abs,et=Math.round,ot=Math.ceil,u="undefined",v="function",h="number",c="string",y="boolean",w=window.document,st=window.ko,gt=function(){function l(n,r){this._styleComposeCache=[{},{},{},{}];this._isDisposingValidationUI=!1;var u=this;u._name="";u._id=l.sheetId++;u._visible=!0;u.defaults=i;u.gridline=i;u.borderColor="black";u.borderWidth=0;u._zoomFactor=1;u.frozenRowCount=0;u.frozenColCount=0;u.rowHeaderVisible=!0;u.colHeaderVisible=!0;u.rowHeaderAutoText=1;u.colHeaderAutoText=2;u.rowHeaderAutoTextIndex=-1;u.colHeaderAutoTextIndex=-1;u.rowRangeGroup=i;u.colRangeGroup=i;u._activeRowIndex=0;u._activeColIndex=0;u.activeRowViewportIndex=0;u.activeColViewportIndex=0;u._allowCellOverflow=!1;u.maxCellOverflowDistance=100;u.showEditingLocator=!0;u.keyMap=i;u.isProtected=!1;u._allowUndo=!0;u._paintSuspended=!1;u._layoutSuspended=0;u.checkingChanges=!1;u.autoGenerateColumns=!0;u._allowEditorReservedLocations=!0;u._sheetTabColor=i;u._frozenlineColor="black";u._frozenTrailingRowCount=0;u._frozenTrailingColCount=0;u._rowLayoutCache=i;u._colLayoutCache=i;u._dragRect=i;u._scrollTopRow=0;u._scrollLeftCol=0;u.floatingObjectKeyMap=i;u._slicerKeyMap=i;u._commentKeyMap=i;u._cachePool=new t._CachePool(this);u._composedDefaultStyle={};u._defaultRowCount=200;u._defaultColCount=20;u._defaultRowHeaderColumnCount=1;u._defaultColHeaderRowCount=1;u._defaultRowHeight=20;u._defaultColWidth=62;u._defaultRowHeaderColWidth=40;u._defaultColHeaderRowHeight=20;u._defaultShowVerticalGridline=!0;u._defaultShowHorizontalGridline=!0;u.fontHeightCache=i;u._enableFormulaTextbox=!0;u._tag=null;r||u._init(n);u._initializeActiveCell()}return l.prototype._addFloatingOjectInternal=function(n){var i=this,r=i._floatingObjectArray,u;if(r&&t.features.floatingObject)try{u=i.isPaintSuspended();i.isPaintSuspended(!0);r.add(n)}finally{i.isPaintSuspended(u)}},l.prototype._findFloatingObjectInternal=function(n){var r=this._floatingObjectArray;return t.features.floatingObject&&r&&r.length>0?r.find(n):i},l.prototype._removeFloatingObjectInternal=function(n){var r=this._floatingObjectArray,i,u;return t.features.floatingObject&&r&&r.length&&(i=r.find(n),i&&(u={sheet:this,sheetName:this._name,floatingObject:i,cancel:!1},this.triggerFloatingObjectRemoving(u),u&&u.cancel===!1))?(r.remove(i),this.triggerFloatingObjectRemoved({sheet:this,sheetName:this._name,floatingObject:i}),!0):!1},l.prototype._saveAndClearSheetSelections=function(){var u=this,r=u._selectionModel,n,i,f;if(r&&r.length>0){for(n=new t._SelectionModel,u._selectionModelCache=n,n.selectionPolicy=r.selectionPolicy,n.selectionUnit=r.selectionUnit,n.activeSelectedRangeIndex=r.activeSelectedRangeIndex,i=0,f=r.length;i<f;i++)n.push(r[i]);for(u._clearSelectionImp(),i=0,f=n.length;i<f;i++)u._render.repaintSelection(n[i])}},l.prototype._loadAndSetSheetSelections=function(){var n=this._selectionModelCache,i,r,u;if(n)for(i=new t._SelectionModel,this._selectionModel=i,i.selectionPolicy=n.selectionPolicy,i.selectionUnit=n.selectionUnit,i.activeSelectedRangeIndex=n.activeSelectedRangeIndex,r=0,u=n.length;r<u;r++)i.push(n[r])},l.prototype.unSelectAllFloatingObjects=function(){var n=this._floatingObjectArray,i;if(t.features.floatingObject&&n&&n.length>0)for(i=0;i<n.length;i++)n[i].isSelected(!1)},l.prototype.refreshObjectsAboveSheet=function(){var i=this,n=i._floatingObjectArray;t.features.floatingObject&&n&&(n.isNeedToUpdateLayout=!0)},l.prototype.unSelectAllComments=function(){var n=this;n._commentManager&&n._commentManager.deactivateComment()},l.prototype.addFloatingObject=function(n){this._floatingObjectArray&&t.features.floatingObject&&n instanceof t.CustomFloatingObject&&this._addFloatingOjectInternal(n)},l.prototype.findFloatingObject=function(n){if(!t.features.floatingObject)return i;var r=this._findFloatingObjectInternal(n);return r instanceof t.CustomFloatingObject?r:i},l.prototype.removeFloatingObject=function(n){var i,u,r;if(t.features.floatingObject){i=this;try{u=i.isPaintSuspended();i.isPaintSuspended(!0);r=i._findFloatingObjectInternal(n);r instanceof t.CustomFloatingObject&&i._floatingObjectArray.remove(r)}finally{i.isPaintSuspended(u)}}},l.prototype.getFloatingObjects=function(){var i=[],r,n,f,u;if(!t.features.floatingObject)return i;for(r=this._floatingObjectArray,n=0,f=r.length;n<f;n++)u=r[n],u instanceof t.CustomFloatingObject&&i.push(u);return i},l.prototype.addPicture=function(n,r,f,e,o,s,h,c,l,a){var y=this,p=y._floatingObjectArray,w,v;if(!p||!t.features.floatingObject)return i;try{return w=y.isPaintSuspended(),y.isPaintSuspended(!0),v=new t.Picture(n),v.owner(y),v.src(r),v.startRow(f),v.startColumn(e),v.endRow(o),v.endColumn(s),(typeof o===u||typeof s===u)&&(v._isTakeOriginalSize=!0),typeof h=="number"&&v.startRowOffset(h),typeof c=="number"&&v.startColumnOffset(c),typeof l=="number"&&v.endRowOffset(l),typeof a=="number"&&v.endColumnOffset(a),p.add(v),v}finally{y.isPaintSuspended(w)}},l.prototype.findPicture=function(n){if(!t.features.floatingObject)return i;var r=this._findFloatingObjectInternal(n);return r instanceof t.Picture?r:i},l.prototype.removePicture=function(n){var i,u,r;if(t.features.floatingObject){i=this;try{u=i.isPaintSuspended();i.isPaintSuspended(!0);r=i._findFloatingObjectInternal(n);r instanceof t.Picture&&i._floatingObjectArray.remove(r)}finally{i.isPaintSuspended(u)}}},l.prototype.getPictures=function(){var i=[],r,n,f,u;if(!t.features.floatingObject)return i;for(r=this._floatingObjectArray,n=0,f=r.length;n<f;n++)u=r[n],u instanceof t.Picture&&i.push(u);return i},l.prototype.setFloatingObjectZIndex=function(n,i){var o,r,u,f,h,c,e,s;if(!isNaN(i)&&t.features.floatingObject&&(o=this._render,r=o&&o._floatingObjectRenderManager,r))for(u=0,h=r.length;u<h;u++)if(e=r[u],e)for(f=0,c=e.length;f<c;f++)s=e[f],s&&s.setFloatingObjectZIndex(n,i)},l.prototype.getFloatingObjectZIndex=function(n){var o=this._render,f=o&&o._floatingObjectRenderManager,i,r,s,h,u,e;if(t.features.floatingObject&&f)for(i=0,s=f.length;i<s;i++)if(u=f[i],u)for(r=0,h=u.length;r<h;r++)if(e=u[r],e)return e.getFloatingObjectZIndex(n);return-1},l.prototype.getDataSource=function(){var n=this._bindingManager;return n?n.getSource():i},l.prototype.getBindingPath=function(n,t){var r=this._sheetModelManager.getDataModel(3);return r?r.getBindingPath(n,t):i},l.prototype.setBindingPath=function(n,t,i){var r=this;return r._bindToAutoRefresh(function(n,t,i){var u=r._getModel(3);return u&&u.setBindingPath(n,t,i),r})(n,t,i)},l.prototype.setDataSource=function(n,i){var r=this,u=r._bindingManager;u&&u.getSource()!==n&&r._bindToAutoRefresh(function(n,i){var f,h,o,l,c,a,s,e,v;if(i&&(r.resetImp(),r._initializeActiveCell()),u=r._bindingManager,n){if(u.bind(n),t._BindingManager.isCellBindingSource(n)){if(f=r._tableManager,f){for(f.resetTablesBindingManager(),h=f.getTables(),r.suspendCalcService(),o=0,l=h.length;o<l;o++)c=h[o],c&&c._applyBindingPath();r.resumeCalcService()}r.clearPendingChanges();return}if(r._setRowCountInternal(u.getRowCount()),r.autoGenerateColumns&&(r.setColumnCount(u.getColumnCount()),a=r._sheetModelManager.getColInfos(),s=u.getFields(),s))for(e=0,v=s.length;e<v;e++)a._setItem(e,{name:s[e]});r.getCalcService()&&!r.getCalcService().IsSuspended()&&r.recalcAll()}else t._BindingManager.isCellBindingSource(u.getSource())&&(f=r._tableManager,f&&f.resetTablesBindingManager()),r._bindingManager=new t._BindingManager(r),r.getCalcService()&&!r.getCalcService().IsSuspended()&&r.recalcAll();r.clearPendingChanges()})(n,i)},l.prototype.bindColumn=function(n,t){var i=this,r=i.isPaintSuspended();i.isPaintSuspended(!0);try{typeof t===c&&(t={name:t});this._sheetModelManager.getColInfos()._setItem(n,t);t&&t.formatter&&i.setFormatter(-1,n,t.formatter);t&&t.cellType&&i.setCellType(-1,n,t.cellType)}finally{i.isPaintSuspended(r)}},l.prototype.bindColumns=function(n){var i=this,f=i.isPaintSuspended(),u,r,t;i.isPaintSuspended(!0);try{if(n)for(u=i._sheetModelManager.getColInfos(),isNaN(n.length)||i.setColumnCount(n.length),r=0;r<n.length;r++)t=n[r],typeof t===c&&(t={name:t}),u._setItem(r,t),t&&t.formatter&&i.setFormatter(-1,r,t.formatter),t&&t.cellType&&i.setCellType(-1,r,t.cellType)}finally{i.isPaintSuspended(f)}},l.prototype.getDataItem=function(n){var f=this,o=f._bindingManager,h=f._sheetModelManager.getColInfos(),t,r,u;if(!o||o.getRowCount()===0)return i;var c=f.getColumnCount(),s={},e=o.getDataItem(n);if(e)for(t in e)e.hasOwnProperty(t)&&typeof t!==v&&(s[t]=e[t]);for(r=0;r<c;r++)u=h._getItem(r),u&&u.name&&u.name.length>0&&(s[u.name]=f.getValue(n,r));return s},l.prototype.getDirtyRows=function(){var t=this,u=[],i=t._sheetModelManager.dataModel().dirtyNodes,f,e,n,r;if(i){f=t._bindingManager;e=t.getDataSource();for(n in i)r=i[n],i.hasOwnProperty(n)&&r&&r.rs==="e"&&u.push({row:n,item:t.getDataItem(n),originalItem:r.originalItem})}return u},l.prototype.getInsertRows=function(){var i=[],t=this._sheetModelManager.dataModel().dirtyNodes,n;if(t)for(n in t)t.hasOwnProperty(n)&&t[n]&&t[n].rs==="n"&&i.push({row:n,item:this.getDataItem(n)});return i},l.prototype.getDirtyCells=function(n,u,f,e){var a=this,l,o,s,h,v,b,c,y,p,w,k,d;if((n===r||n===i)&&(n=-1),(u===r||u===i)&&(u=-1),(f===r||f<=0)&&(f=1),(e===r||e<=0)&&(e=1),l=[],o=a._sheetModelManager.dataModel().dirtyNodes,!t.GC$.isEmptyObject(o))if(n>=0&&u>=0){for(h=n;h<n+f;h++)if(o[h]&&o[h].rs==="e")for(s=o[h],c=u;c<u+e;c++)s[c]&&l.push(a._getDirtyValue(h,c,s[c].oldValue))}else if(n>=0&&u<0){for(h=n;h<n+f;h++)if(o[h]&&o[h].rs==="e"){s=o[h];for(v in s)b=parseInt(v),!isNaN(b)&&s.hasOwnProperty(v)&&s[v]&&l.push(a._getDirtyValue(h,b,s[v].oldValue))}}else if(n<0&&u>=0)for(c=u;c<u+e;c++)for(y in o)o[y]&&o[y].rs==="e"&&(s=o[y],s[c]&&l.push(a._getDirtyValue(parseInt(y),c,s[c].oldValue)));else for(p in o)if(o[p]&&o[p].rs==="e"){s=o[p];for(w in s)k=parseInt(w),d=parseInt(p),!isNaN(k)&&s.hasOwnProperty(w)&&s[w]&&l.push(a._getDirtyValue(d,k,s[w].oldValue))}return l},l.prototype._getDirtyValue=function(n,t,i){return{row:n,col:t,newValue:this.getValue(n,t),oldValue:i}},l.prototype.getDeleteRows=function(){var n=[];return this.deletedRows&&t.GC$.each(this.deletedRows,function(t,i){typeof i!==v&&i&&n.push({row:i.row,originalItem:i.data})}),n},l.prototype.hasPendingChanges=function(){var i=this,n;return this.deletedRows&&this.deletedRows.length>0?!0:(n=this._sheetModelManager.dataModel().dirtyNodes,!t.GC$.isEmptyObject(n))?!0:!1},l.prototype.clearPendingChanges=function(){var t=this._sheetModelManager.dataModel().dirtyNodes,i,n;for(i in t)n=t[i],n&&n.rs&&delete n.rs;this._sheetModelManager.dataModel().dirtyNodes={};this.deletedRows=[]},l.prototype._getProperties=function(n){var i=[],t;if(n)for(t in n)typeof n[t]!==v?i.push(t):typeof st!==u&&st.isObservable(n[t])&&i.push(t);return i},l.prototype.referenceStyle=function(n){var r=t.ReferenceStyle,i=this.getCalcService();return arguments.length===0?i&&i.useR1C1?1:0:(i&&(i.useR1C1=n===1),this)},l.prototype.recalcAll=function(){var n=this.getCalcService(),t;n&&(t=this.isPaintSuspended(),this.isPaintSuspended(!0),n.recalculateAll(!0),this.isPaintSuspended(t))},l.prototype.recalcRange=function(n,t,i,r){var u=this.getCalcService();u&&u.recalcRange(this._getSheetSource(),n,t,i,r)},l.prototype.recalcRows=function(n){var t=this.getCalcService(),i;if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this._vpSheetSource,n[i],-1);t.resume(!1)}},l.prototype._recalcCell=function(n,t,i){var r=this.getCalcService();r&&!r.ignoreDirty()&&r.recalculate(this._vpSheetSource,t,i)},l.prototype.getCalcService=function(){return!this.calcService&&t.util.hasCalc()&&(this.calcService=new t.Calc.CalcService,this._getSheetSource().setCalcService(this.calcService),this.calcService.initParserContext(this._getSheetSource())),this.calcService},l.prototype._getCalcContexts=function(){var n=this,t=[],i=n._getModel();return t.push({name:n._name,target:n,refModel:i}),t},l.prototype.suspendCalcService=function(n){this.getCalcService()&&this.getCalcService().suspend(n)},l.prototype.resumeCalcService=function(n){this.getCalcService()&&this.getCalcService().resume(n)},l.prototype._getSheetSource=function(n){return n===r||n===i||n===3?this._vpSheetSource:i},l.prototype.getCustomFunction=function(n){return this._functions&&n&&n!==""?this._functions[n.toUpperCase()]:i},l.prototype.addCustomFunction=function(n){this._addCustomFunctionCore(n);this.recalcAll()},l.prototype._addCustomFunctionCore=function(n){if(t.util.hasCalc()){if(!n||!(n instanceof t.Calc.Functions.Function))throw new Error(t.SR.Exp_InvalidCustomFunction);var i=this,r=n.name.toUpperCase();i._functions||(i._functions={});i._functions[r]=n}},l.prototype.removeCustomFunction=function(n){var t=this;t._functions&&n&&n!==""&&(n=n.toUpperCase(),t._functions.hasOwnProperty(n)&&(delete t._functions[n],t.recalcAll()))},l.prototype.clearCustomFunctions=function(){this._functions&&(delete this._functions,this.recalcAll())},l.prototype._findCustomFunction=function(n){if(!n||n==="")return i;var u=this,t=u.parent,r=u.getCustomFunction(n);return!r&&t&&t.getCustomFunction&&(r=t.getCustomFunction(n)),r},l.prototype.addCustomFunctionDescription=function(n){if(n&&n.name&&!this.getCustomFunctionDescription(n.name)){var t=this._functionDescriptions;t||(t=this._functionDescriptions=[]);t.push(n)}},l.prototype.getCustomFunctionDescription=function(n){var u=this._functionDescriptions,f,t,r;if(u&&n)for(n=n.toUpperCase(),f=u.length,r=0;r<f;r++)if(t=u[r],t.name&&t.name.toUpperCase()===n)return t;return i},l.prototype.removeCustomFunctionDescription=function(n){var i=this._functionDescriptions,u,r,t;if(i&&n)for(n=n.toUpperCase(),u=i.length,t=0;t<u;t++)if(r=i[t],r.name&&r.name.toUpperCase()===n){i.splice(t,1);break}},l.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=i)},l.prototype.getCustomName=function(n){var t=this._names;return t?t[n.toUpperCase()]:i},l.prototype.getCustomNames=function(){var n=[],i=this._names;return i&&t.GC$.each(i,function(t,i){n.push(i)}),n},l.prototype.addCustomName=function(n,t,i,r){this._addCustomNameCore(n,t,i,r,!1)},l.prototype._addCustomNameCore=function(n,i,r,u,f){var e,c,l,o;if(!n||n===""||!i||i==="")throw new Error(t.SR.Exp_InvalidCustomName);e=this;e._names||(e._names={});var s=e.getCalcService(),h=e._getSheetSource(),a=e._getCalcModel();if(s&&h){if(f)try{c=s.parse(h,i,r,u,!1,!0)}catch(v){}else c=s.parse(h,i,r,u);l=n.toUpperCase();e._names[l]=new t.NameInfo(n,c,r,u);o=a._getNameCalc(l,!0);o&&(o.updateListening(!0,!0),o.addToDirty());e.recalcAll()}},l.prototype.removeCustomName=function(n){var t=this,i,u,r;t._names&&n&&n!==""&&(i=n.toUpperCase(),t._names[i]&&(delete t._names[i],u=t._getCalcModel(),u&&(r=u._getNameCalc(i),r&&(r.updateListening(!0,!1),r.addToDirty())),t.recalcAll()))},l.prototype.clearCustomNames=function(){var n=this,r,i,u,t;if(n._names){if(r=n._names,delete n._names,i=n._getCalcModel(),i)for(u in r)t=i._getNameCalc(u),t&&(t.updateListening(!0,!1),t.addToDirty());n.recalcAll()}},l.prototype._findCustomName=function(n){if(!n||n==="")return i;var u=this,t=u.parent,r=u.getCustomName(n);return!r&&t&&t.getCustomName&&(r=t.getCustomName(n)),r},l.prototype.setFormula=function(n,t,i){this._setFormulaCore(n,t,i,!1)},l.prototype._setFormulaCore=function(n,u,f,e,o){var s=this,y,l,h,c,a,v;if(o!==1&&o!==2){if((o===r||o===i)&&(o=3),y=t.Events,n<0||n>=s.getRowCount()||u<0||u>=s.getColumnCount()){s._raiseInvalidOperation(0,t.SR.Exp_IndexOutOfRange);return}if(l=s._tableManager,o===3&&n>=0&&u>=0&&l&&(h=l.find(n,u),h)){if(h.showHeader()&&n===h.headerIndex()&&f)return;h.showFooter()&&n===h.footerIndex()&&h._setFooterFormula(u,f)}c=s._getCalcModel();a=s._conditionalFormats;c&&(v=c.getFormula(n,u),c.setFormula(n,u,f,e),a&&a._clearCache(),s._eventHandler._eventSuspended<1&&s._raiseCellChanged("formula",n,u,v,f,o));s._paintSuspended||(s.invalidateLayout(),s.repaint())}},l.prototype.setArrayFormula=function(n,t,i,r,u){this._setArrayFormulaCore(n,t,i,r,u,!1)},l.prototype._setArrayFormulaCore=function(n,u,f,e,o,s,h){var c=this;c._bindToAutoRefresh(function(n,u,f,e,o,h){var k,y,l,p,w,b,a,v;if(h!==1&&h!==2){if((h===r||h===i)&&(h=3),k=t.Events,n<0||n+f>c.getRowCount()||u<0||u+e>c.getColumnCount()){c._raiseInvalidOperation(0,t.SR.Exp_IndexOutOfRange);return}if(c._hasSpans(n,u,f,e)){c._raiseInvalidOperation(0,t.SR.Exp_ArrayFromulaSpan);return}if(y=c._tableManager,h===3&&n>=0&&u>=0&&y&&(l=y.find(n,u),l)){if(f>1||e>1){c._raiseInvalidOperation(0,t.SR.Exp_ArrayFormulaTable);return}if(l.showHeader()&&n===l.headerIndex()&&o)return;l.showFooter()&&n===l.footerIndex()&&l._setFooterFormula(u,o)}if(p=c._getCalcModel(),w=c._conditionalFormats,p&&(c.suspendEvent(),p.setArrayFormula(n,u,f,e,o,s),c.resumeEvent(),w&&w._clearCache(),c._eventHandler._eventSuspended<1)){for(b=[],a=n;a<n+f;a++)for(v=u;v<u+e;v++)b.push(new t.CellPosition(a,v));c._raiseRangeDataChanged(n,u,f,e,b,5)}}})(n,u,f,e,o,h)},l.prototype.getFormula=function(n,t){var r=this._getCalcModel();return r?r.getFormula(n,t):i},l.prototype.getFormulaInformation=function(n,i){var u=new t.FormulaInformation,f=this._getCalcModel(3),e,r;return f&&(e=f.getExpr(n,i),e&&(r=f.getArray(n,i),u.hasFormula=!0,r&&(u.baseRange=new t.Range(r.row,r.col,r.rowCount,r.colCount)),u.isArrayFormula=!!r,n=r?r.row:n,i=r?r.col:i,u.formula=this.calcService.unparse(this._vpSheetSource,e,n,i),u.hasFormula=!!u.formula)),u},l.prototype.hasFormula=function(n,t){var i=this._getCalcModel();return i?i.hasFormula(n,t):!1},l.prototype._findFormulas=function(n,t,i,r){},l.prototype._rebuildCalcNodes=function(){var n=this._getCalcModel(),t,i;if(n)for(var r=0,u=n.rC(),f=n.cC();r<u;){for(t=0;t<f;)i=n._getCellCalc(r,t),i&&(i.stopListening(),i.startListening()),t++;r++}},l.prototype._setValueToDataTable=function(n,t,i,r){var u=n[t],f;u||(u=n[t]={});f=u[i];f||(f=u[i]={});f.value=r},l.prototype._serializeSheetDataSource=function(n){var t=this,u,f,e;if(!t.getDataSource())return r;var o=t.getRowCount(),s=t.getColumnCount(),h=t._bindingManager;for(u=0;u<o;u++)for(f=0;f<s;f++)e=h.getValue(u,f).value,e!==i&&e!==r&&t._setValueToDataTable(n,u,f,e)},l.prototype._serializeColumnHeaderNames=function(n){var t=this,i,u,f,o;if(!t.getDataSource())return r;var s=t.getRowCount(1),h=t.getColumnCount(1),c=t._sheetModelManager.getColInfos()._getItems(),e=t.colHeaderAutoTextIndex;for(i=0;i<s;i++)if(e>=0&&i===e||e===-1&&i===s-1)for(u=0;u<h;u++)f=c[u],f&&(o=f.displayName||f.name,o&&t._setValueToDataTable(n,i,u,o))},l.prototype._serializeTablesDataSource=function(n){for(var t,u,e,h=this,c=h.getTables(),o=0,v=c.length;o<v;o++){var s=c[o],y=s.getSource(),f=s.dataRange(),l=f.row,a=f.col,p=l+f.rowCount-1,w=a+f.colCount-1;if(y)for(t=l;t<=p;t++)for(u=a;u<=w;u++)e=s._getValue(t,u).value,e!==i&&e!==r&&h._setValueToDataTable(n,t,u,e)}},l.prototype.toJSON=function(n){var u=this,h=u._sheetModelManager,g=u._sparklineGroupManager,nt=u._commentManager,tt=u._conditionalFormats,it=u._tableManager,rt=u._floatingObjectArray,ut=u.rowRangeGroup,ft=u.colRangeGroup,et=u._rowFilter,ot=u._printInfo,st=u._slicerCollection,f={defaults:u.defaults,columns:u._toArray(h.getColInfos()._getItems(),u.getColumnCount()),rows:u._toArray(h.getRowInfos()._getItems(),u.getRowCount()),autoGenerateColumns:u.autoGenerateColumns,frozenRowCount:u.frozenRowCount,frozenColCount:u.frozenColCount,frozenTrailingRowCount:u._frozenTrailingRowCount,frozenTrailingColCount:u._frozenTrailingColCount,rowCount:u.getRowCount(),columnCount:u.getColumnCount(),sparklineGroups:g?g.toJSON():i,comments:nt?nt.toJSON():i,spans:u._getSpanModel().toJSON(),selectionBackColor:u._selectionBackColor,selectionBorderColor:u._selectionBorderColor,activeRow:u._activeRowIndex,activeCol:u._activeColIndex,gridline:u.gridline,allowCellOverflow:u._allowCellOverflow,referenceStyle:u.referenceStyle(),zoomFactor:u._zoomFactor,theme:u.currentTheme(),showRowRangeGroup:u._showRowRangeGroup,showColumnRangeGroup:u._showColumnRangeGroup,conditionalFormats:tt?tt.toJSON():i,sheetTabColor:u._sheetTabColor,frozenlineColor:u._frozenlineColor,rowHeaderAutoText:u.rowHeaderAutoText,colHeaderAutoText:u.colHeaderAutoText,rowHeaderAutoTextIndex:u.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:u.colHeaderAutoTextIndex,rowHeaderVisible:u.rowHeaderVisible,colHeaderVisible:u.colHeaderVisible,rowHeaderColCount:u.getColumnCount(2),colHeaderRowCount:u.getRowCount(1),rowHeaderSpan:u._getSpanModel(2).toJSON(),colHeaderSpan:u._getSpanModel(1).toJSON(),rowHeaderColInfos:u._toArray(h.getColInfos(2)._getItems(),u.getColumnCount(2)),colHeaderRowInfos:u._toArray(h.getRowInfos(1)._getItems(),u.getRowCount(1)),clipBoardOptions:u._clipBoardOptions,isProtected:u.isProtected,protectionOption:u._protectionOption,borderColor:u.borderColor,borderWidth:u.borderWidth,allowUndo:u._allowUndo,allowEditorReservedLocations:u._allowEditorReservedLocations,tables:it?it.toJSON():i,floatingObjects:rt?rt.toJSON():i,visible:u._visible,rowHeaderData:u._getModel(2).toJSON(2),colHeaderData:u._getModel(1).toJSON(1),data:u._getModel().toJSON(),rowRangeGroup:ut?ut.toJSON():r,colRangeGroup:ft?ft.toJSON():r,tag:u._tag,customFunctions:u._functions,printInfo:ot?ot.toJSON():r,slicers:st?st.toJSON():i},s,c,e,w,l,a,o,b,v,y,k,d;n&&n.includeBindingSource&&(s=f.data.dataTable||{},u._serializeSheetDataSource(s),u._serializeTablesDataSource(s),t.GC$.isEmptyObject(s)||(f.data.dataTable=s),c=f.colHeaderData.dataTable||{},u._serializeColumnHeaderNames(c),t.GC$.isEmptyObject(c)||(f.colHeaderData.dataTable=c));e={name:u._name,selections:u._selectionModel.toJSON(),rowFilter:et?et.toJSON():r};for(o in f)w=f[o],u._isDefaultValue(o,w)||(e[o]=w);if(l=[],a=u._namedStyles,a)for(o in a)b=a[o],b&&l.push(b.toJSON());if(l.length>0&&(e.namedStyles=l),v=[],y=u._names,y&&u.getCalcService())for(k in y)if(u._names.hasOwnProperty(k)){var p=y[k],lt=p.getName(),ht=p.getRow(),ct=p.getColumn(),at=p.getExpression(),vt=u.getCalcService().unparseWithoutCulture(u._getSheetSource(),at,ht,ct,!0);v.push({name:lt,formula:vt,row:ht,col:ct})}return v.length>0&&(e.names=v),d=u._vpCalcSheetModel,d&&d.toJSON(e),e},l.prototype._isDefaultValue=function(n,r){var u=this;switch(n){case"defaults":return r.rowHeight===u._defaultRowHeight&&r.colWidth===u._defaultColWidth&&r.rowHeaderColWidth===u._defaultRowHeaderColWidth&&r.colHeaderRowHeight===u._defaultColHeaderRowHeight;case"columns":return!r||r.length===0;case"rows":return!r||r.length===0;case"autoGenerateColumns":return r===!0;case"sparklineGroups":return r===i;case"comments":return r===i;case"frozenRowCount":return r===0;case"frozenColCount":return r===0;case"frozenTrailingRowCount":return r===0;case"frozenTrailingColCount":return r===0;case"gridline":return r.color===t.ThemeStyleHelper.getCssClassThemeStyle("gc-gridlineColor").borderTopColor&&r.showHorizontalGridline===u._defaultShowHorizontalGridline&&r.showVerticalGridline===u._defaultShowVerticalGridline;case"allowCellOverflow":return r===!1;case"referenceStyle":return r===0;case"zoomFactor":return r===1;case"showRowRangeGroup":return r===!0;case"showColumnRangeGroup":return r===!0;case"conditionalFormats":return r===i;case"sheetTabColor":return r===i;case"frozenlineColor":return r==="black";case"rowHeaderAutoText":return r===1;case"colHeaderAutoText":return r===2;case"rowHeaderAutoTextIndex":return r===-1;case"colHeaderAutoTextIndex":return r===-1;case"rowHeaderVisible":return r===!0;case"colHeaderVisible":return r===!0;case"rowHeaderColCount":return r===1;case"colHeaderRowCount":return r===1;case"rowHeaderColInfos":return!r||r.length===0;case"colHeaderRowInfos":return!r||r.length===0;case"clipBoardOptions":return r===0;case"isProtected":return r===!1;case"protectionOption":return t.GC$.isEmptyObject(r);case"borderColor":return r==="black";case"borderWidth":return r===0;case"allowUndo":return r===!0;case"allowEditorReservedLocations":return r===!0;case"tables":return r===i;case"floatingObjects":return r===i;case"visible":return r===!0;case"data":return t.GC$.isEmptyObject(r);case"rowHeaderData":return t.GC$.isEmptyObject(r);case"colHeaderData":return t.GC$.isEmptyObject(r);case"tag":return r===i;case"printInfo":return t.GC$.isEmptyObject(r);case"slicers":return r===i;default:return!1}},l.prototype.fromJSON=function(r,f,e){var o,h,ci,li,k,d,y,vt,yt,w,ai,l,vi,pt,wt,rt,yi,bt,kt,dt,ut,g,nt,b,tt,it,ft,gt,et,ni,pi,ti,ot,st,ii,s,bi,ct,p,ri,ui,a,lt,at,fi,ei,oi,si,hi;if(r){o=this;t.features.binding&&(o._bindingManager=new t._BindingManager(o));typeof f===u&&(f=!0);h=o._sheetModelManager;ci=o.isPaintSuspended();o.isPaintSuspended(!0);li=n.Sheets.Culture();n.Sheets.switchCulture("");k=r.rowCount;d=r.columnCount;try{if(o._name=r.name,o._names={},r.defaults&&(o.defaults=r.defaults),typeof k===u&&(k=o._defaultRowCount),o.setRowCount(k),typeof d===u&&(d=o._defaultColCount),o._setColumnCountCore(d),typeof r.activeRow!==u&&(o._activeRowIndex=r.activeRow),typeof r.activeCol!==u&&(o._activeColIndex=r.activeCol),typeof r.frozenRowCount!==u&&o.setFrozenRowCount(r.frozenRowCount),typeof r.frozenColCount!==u&&o.setFrozenColumnCount(r.frozenColCount),typeof r.frozenTrailingRowCount!==u&&o.setFrozenTrailingRowCount(r.frozenTrailingRowCount),typeof r.frozenTrailingColCount!==u&&o.setFrozenTrailingColumnCount(r.frozenTrailingColCount),typeof r.gridline!==u&&(o.gridline=r.gridline),typeof r.allowCellOverflow!==u&&(o._allowCellOverflow=r.allowCellOverflow),typeof r.autoGenerateColumns!==u&&(o.autoGenerateColumns=r.autoGenerateColumns),y=r.tag,typeof y!==u&&(vt=y.typeName,typeof vt===c&&(yt=t.getTypeFromString(vt),yt&&(y=new yt,y.fromJSON&&y.fromJSON(r.tag))),o.tag(y)),e&&(r.dataSource&&(w=o._bindingManager,w&&w.bind(r.dataSource)),r.dataBinding&&(w=o._bindingManager,w&&w.fromJSON(r.dataBinding,e))),r.rows&&(h.getRowInfos()._setItems(r.rows),h.getRowInfos().length=k),r.columns&&(h.getColInfos()._setItems(r.columns),h.getColInfos().length=d),r.colStyles)for(l in r.colStyles)isNaN(l)||(ai=parseInt(l,10),o.setStyle(-1,ai,r.colStyles[l],3));if(r.rowStyles)for(l in r.rowStyles)isNaN(l)||(vi=parseInt(l,10),o.setStyle(vi,-1,r.rowStyles[l],3));if(typeof r.rowHeaderAutoText!==u&&(o.rowHeaderAutoText=r.rowHeaderAutoText),typeof r.colHeaderAutoText!==u&&(o.colHeaderAutoText=r.colHeaderAutoText),typeof r.rowHeaderAutoTextIndex!==u&&(o.rowHeaderAutoTextIndex=r.rowHeaderAutoTextIndex),typeof r.colHeaderAutoTextIndex!==u&&(o.colHeaderAutoTextIndex=r.colHeaderAutoTextIndex),typeof r.rowHeaderVisible!==u&&(o.rowHeaderVisible=r.rowHeaderVisible),typeof r.colHeaderVisible!==u&&(o.colHeaderVisible=r.colHeaderVisible),pt=r.rowHeaderColCount,wt=r.colHeaderRowCount,typeof r.rowHeaderColCount===u&&(pt=this._defaultRowHeaderColumnCount),typeof r.colHeaderRowCount===u&&(wt=this._defaultColHeaderRowCount),o.setColumnCount(pt,2),o.setRowCount(wt,1),r.rowHeaderData&&h.rowHeaderModel().fromJSON(r.rowHeaderData,e),r.colHeaderData&&h.colHeaderModel().fromJSON(r.colHeaderData,e),r.rowHeaderSpan&&o._getSpanModel(2).fromJSON(r.rowHeaderSpan,e),r.colHeaderSpan&&o._getSpanModel(1).fromJSON(r.colHeaderSpan,e),r.rowHeaderColInfos&&h.getColInfos(2)._setItems(r.rowHeaderColInfos),r.colHeaderRowInfos&&h.getRowInfos(1)._setItems(r.colHeaderRowInfos),(typeof r._zoomFactor!==u||typeof r.zoomFactor!==u)&&(o._zoomFactor=typeof r.zoomFactor===u?r._zoomFactor:r.zoomFactor),r.spans&&o._getSpanModel().fromJSON(r.spans,e),r.selections&&(o._clearSelectionImp(),o._selectionModel.fromJSON(r.selections,e)),typeof r.referenceStyle!==u&&o.referenceStyle(r.referenceStyle),o.clearCustomFunctions(),rt=r.customFunctions,rt)for(yi in rt)bt=rt[yi],kt=t.getTypeFromString(bt.typeName),kt&&(dt=new kt,dt.fromJSON(bt,e),o._addCustomFunctionCore(dt));if(f&&r.names){for(ut=0;ut<r.names.length;ut++)g=r.names[ut],o._addCustomNameCore(g.name,g.formula,g.row,g.col,!0);o._rebuildCalcNodes()}if(r.data&&(h.dataModel().fromJSON(r.data,e),nt=r.data.dataTable,f&&nt))for(b in nt)if(typeof b!==v)for(tt in nt[b])typeof tt!==v&&(it=nt[b][tt],ft=it.formula,ft&&(it.arrayInfo?o._setArrayFormulaCore(parseInt(b,10),parseInt(tt,10),parseInt(it.arrayInfo.rowCount,10),parseInt(it.arrayInfo.colCount,10),ft,!0):o._setFormulaCore(parseInt(b,10),parseInt(tt,10),ft,!0)));if(gt=e?r.sparklineGroupManager?r.sparklineGroupManager.groups:i:r.sparklineGroups,f&&gt&&(et=o._sparklineGroupManager,et))for(et.fromJSON(gt,e),ni=et.groups(),pi=h.getDataModel(),a=0;a<ni.length;a++)for(ti=ni[a]._innerList,st=0;st<ti.length;st++)ot=ti[st],pi.setSparkline(ot.row,ot.column,ot);if(ii=e?r.commentManager:r.comments,ii&&o._commentManager.fromJSON(ii,e),r.theme)if(s=r.theme,typeof s=="string"||typeof s===u)o.currentTheme(s);else{var ht=s.themeColor?s.themeColor:s._themeColor,ki=ht.name?ht.name:ht._name,wi=new t.ThemeColor(ki);wi.fromJSON(ht,e);bi=new t.SpreadTheme(s.name?s.name:s._name,wi,s.headingFont?s.headingFont:s._headingFont,s.bodyFont?s.bodyFont:s._bodyFont);o.currentTheme(bi)}if(typeof r.showRowRangeGroup!==u&&(o._showRowRangeGroup=r.showRowRangeGroup),typeof r.showColumnRangeGroup!==u&&(o._showColumnRangeGroup=r.showColumnRangeGroup),r.rowRangeGroup&&o.rowRangeGroup&&o.rowRangeGroup.fromJSON(r.rowRangeGroup,e),r.colRangeGroup&&o.colRangeGroup&&o.colRangeGroup.fromJSON(r.colRangeGroup,e),ct=r.rowFilter,ct&&t.features.filter&&(ri=ct.typeName,ri?(ui=t.getTypeFromString(ri),ui&&(p=new ui)):p=new t.HideRowFilter,p&&(o._rowFilter=p,p.sheet=o,p.fromJSON(ct,e),p.reFilter())),r.conditionalFormats&&t.features.conditionalFormat&&o.getConditionalFormats().fromJSON(r.conditionalFormats,e),r.sheetTabColor&&o.sheetTabColor(r.sheetTabColor),r.frozenlineColor&&o.frozenlineColor(r.frozenlineColor),typeof r.clipBoardOptions!==u&&(o._clipBoardOptions=r.clipBoardOptions),typeof r.isProtected!==u&&(o.isProtected=r.isProtected),o._protectionOption=typeof r.protectionOption!==u?r.protectionOption:{},r.borderColor&&(o.borderColor=r.borderColor),typeof r.borderWidth!==u&&(o.borderWidth=r.borderWidth),typeof r.allowUndo!==u&&o.allowUndo(r.allowUndo),typeof r.allowEditorReservedLocations!==u&&o.allowEditorReservedLocations(r.allowEditorReservedLocations),o._namedStyles={},r.namedStyles)for(a=0;a<r.namedStyles.length;a++)lt=r.namedStyles[a],at=new t.Style,at.fromJSON(lt,e),typeof lt.validator!==u&&(t.features.dataValidator&&(fi=new n.Sheets.DefaultDataValidator,fi.fromJSON(lt.validator,e)),at.validator=fi),o._addNamedStyleImp(at,!1);r.selectionBackColor&&o.selectionBackColor(r.selectionBackColor);r.selectionBorderColor&&o.selectionBorderColor(r.selectionBorderColor);ei=e?r.tableManager?r.tableManager.tables:i:r.tables;typeof ei!==u&&o._tableManager&&o._tableManager.fromJSON(ei,e);oi=e?r.floatingObjectArray?r.floatingObjectArray.floatingObjects:i:r.floatingObjects;typeof oi!==u&&o._floatingObjectArray&&o._floatingObjectArray.fromJSON(oi,e);si=r.slicers;typeof si!==u&&o._slicerCollection&&o._slicerCollection.fromJSON(si);typeof r.visible!==u&&(o._visible=r.visible);hi=this.printInfo();hi&&typeof r.printInfo!==u&&hi.fromJSON(r.printInfo);this.clearPendingChanges()}finally{n.Sheets.switchCulture(li);o.isPaintSuspended(ci)}}},l.prototype.formulaFromJSON=function(n,t){var r,s,h,o,p,w,b,u,nt,tt,f,e,c,k,l,d,it,g,a,v,y;if(n){if(r=this,s=n.names,s)for(h=0;h<s.length;h++)o=s[h],r._addCustomNameCore(o.name,o.formula,o.row,o.col,!0);if(p=n.data,p&&(w=p.dataTable,w))for(nt=r.getRowCount(),tt=r.getColumnCount(),f=0;f<nt;f++)if(b=w[f],b)for(e=0;e<tt;e++)u=b[e],c=u&&u.formula,c&&(u.arrayInfo?r._setArrayFormulaCore(f,e,parseInt(u.arrayInfo.rowCount,10),parseInt(u.arrayInfo.colCount,10),c,!0):r._setFormulaCore(f,e,c,!0));if(k=t?n.sparklineGroupManager?n.sparklineGroupManager.groups:i:n.sparklineGroups,k&&(l=r._sparklineGroupManager,l))for(l.fromJSON(k,t),d=l.groups(),it=r._sheetModelManager.getDataModel(),v=0;v<d.length;v++)for(g=d[v]._innerList,y=0;y<g.length;y++)a=g[y],it.setSparkline(a.row,a.column,a)}},l.prototype._toArray=function(n,t){var f,u;if(!n)return i;for(f=[],u=0;u<t;u++)n[u]!==r&&(f[u]=n[u]);return f},l.prototype.isPaintSuspended=function(n){var t=this;return arguments.length===0?t._paintSuspended:(t._paintSuspended!==n&&(t._paintSuspended=n,!n&&t._layoutSuspended<=0&&(!t.parent||t.parent.getActiveSheet&&t.parent.getActiveSheet()===t)&&(t.invalidateLayout(),t.repaint())),t)},l.prototype.getName=function(){return this._name},l.prototype.setName=function(n){var r=this,i=r.parent;if(!r._isValidSheetName(n))throw t.SR.Exp_NotSupport;this.setNameCore(n);i&&i._doTabHSResize&&i._doTabHSResize()},l.prototype.setNameCore=function(n){var t=o.getDataValidatorsBeforeSetSheetName(this);this._name=n;o.adjustModelFormulasAfterSetSheetName(this);o.adjustValidatorsAfterSetSheetName(this,t)},l.prototype.visible=function(n){var u=this,r,i;if(arguments.length==0)return u._visible;if(u._visible=n,r=u.parent,r){var f=r.sheets,o=f.length,e=t.util.inArray(u,f),s=r.getActiveSheetIndex();if(n)s<0?r._setActiveSheetIndexImp(e,1):r._doTabHSResize();else if(e===s){for(i=e+1;i<o&&!f[i]._visible;)i++;if(i>=o)for(i=e-1;i>=0&&!f[i]._visible;)i--;i<0?(u._dispose(!1),r._activeSheetIndex=i,r._doResize()):(i<r._tab._firstTab&&(r._tab._firstTab=i),r._setActiveSheetIndexImp(i,1))}else r._doTabHSResize();return u}},l.prototype.allowCellOverflow=function(n){var t=this;return arguments.length===0?t._allowCellOverflow:t._bindToAutoRefresh(function(n){return t._allowCellOverflow=n,t})(n)},l.prototype.allowUndo=function(n){var t=this,i;return arguments.length===0?t._allowUndo:(t._allowUndo=n,i=t.undoManager(),i&&(i._allowUndo=n),t)},l.prototype.allowEditorReservedLocations=function(n){return arguments.length===0?this._allowEditorReservedLocations:(this._allowEditorReservedLocations=n,this)},l.prototype.sheetTabColor=function(n){var t=this,i=t.parent;return arguments.length===0?t._sheetTabColor:(t._sheetTabColor=n,i&&i._doTabHSResize&&i._doTabHSResize(),t)},l.prototype.frozenlineColor=function(n){var t=this;return arguments.length===0?t._frozenlineColor:t._bindToAutoRefresh(function(n){return n&&(t._frozenlineColor=n),t})(n)},l.prototype.enableFormulaTextbox=function(n){var t=this;return arguments.length===0?t._enableFormulaTextbox:(t._enableFormulaTextbox=n,t)},l.prototype.addRows=function(n,i){var d,u,g,nt,c,l,a,tt,s,v,y,p,w,b,h,k;if(!(i<=0)){var r=this,f=r.getRowCount(),e=r.getDataSource();if(e&&t._BindingManager.isDataViewSource(e)){if(!e.canAdd||!e.canAdd())return;n=f}d=r.isPaintSuspended();r.isPaintSuspended(!0);try{if((n<0||n>f)&&(n=f),u=r._getCalcModel(),u){if(!r._checkArrayFormula(n,0,0,r.getColumnCount()))return;u.getCalcService().getOperatorAdjustor().onBeforeAddRemoveRows(u,n)}if(g=this._sheetModelManager.getRowInfos(),g.addItems(n,i),nt=this._sheetModelManager.getDataModel(),nt.addRows(n,i),c=r._cutCopyIndicatorManager,c&&c.addRows(),l=r._bindingManager,l&&l.addItems(n,i),o.adjustCustomNameOnInsertRemove(r,n,i,!0,!0),a=r._getCalcModel(),a&&a.addRows(n,i),tt=r._getModel(2),tt.addRows(n,i),s=r._getSpanModel(2),s.addRows(n,i),s=r._getSpanModel(),s.addRows(n,i),v=r._rowFilter,v&&v._addRows(n,i),y=r.rowRangeGroup,y&&y._add(n,i),p=r._sparklineGroupManager,p&&p._addRows(n,i),w=r._conditionalFormats,w&&w._addRows(n,i),b=r._tableManager,b&&b.addRows(n,i),u)u.getCalcService().getOperatorAdjustor().onAfterAddRemoveRows(u,n,i,!0);h=r._floatingObjectArray;h&&h.length>0&&h.addRows(n,i);k=r._commentManager;k&&k.addRows(n,i);r._needSyncVScrollbarSize=!0;r.triggerRowChanged({sheet:r,sheetName:r._name,row:n,oldValue:f,sheetArea:3,propertyName:"addRows"})}finally{r.isPaintSuspended(d)}}},l.prototype.deleteRows=function(n,r){var u=this,w=u.getRowCount(),a,ot,e,h,c,st,f,b,k,d,ht,g,ct,y,nt,tt,it,rt,ut,v,s,l,p,ft,et;if(!(0>n)&&!(n>=w)&&!(r<=0)&&(a=u.getDataSource(),!a||!t._BindingManager.isDataViewSource(a)||a.canRemove&&a.canRemove())){ot=u.isPaintSuspended();u.isPaintSuspended(!0);try{if(e=u._getCalcModel(),e){if(!u._checkArrayFormula(n,0,r,u.getColumnCount()))return;e.getCalcService().getOperatorAdjustor().onBeforeAddRemoveRows(e,n)}if(h=u._getModel(),u.deletedRows||(u.deletedRows=[]),c=u._bindingManager,c)for(st=c.getRowCount(),f=0;f<r&&n+f<h.getRowCount();f++)b=null,n+f<st&&(b=c.getDataItem(n+f)),k=i,h.dataTable&&h.dataTable[n+f]&&(k=h.dataTable[n+f].key),u.deletedRows.push({row:n+f,data:b,key:k});if(o.adjustCustomNameOnInsertRemove(u,n,r,!1,!0),d=u._getCalcModel(),d&&d.deleteRows(n,r),ht=this._sheetModelManager.getRowInfos(),ht.deleteItems(n,r),h.deleteRows(n,r),c&&c.removeItems(n,r),g=u._cutCopyIndicatorManager,g&&g.deleteRows(),ct=u._getModel(2),ct.deleteRows(n,r),y=u._getSpanModel(2),y.removeRows(n,r),y=u._getSpanModel(),y.removeRows(n,r),nt=u._rowFilter,nt&&nt._removeRows(n,r),tt=u.rowRangeGroup,tt&&tt._remove(n,r),it=u._sparklineGroupManager,it&&it._removeRows(n,r),rt=u._conditionalFormats,rt&&rt._removeRows(n,r),ut=u._tableManager,ut&&ut.removeRows(n,r),v=u._scrollTopRow,v>=0){for(s=-1,l=v;l>=u.frozenRowCount;l--)if(u.getRowVisible(l)&&u._getZoomRowHeight(l)>0){s=l;break}s===-1&&(s=0);v!==s&&(u._scrollTopRow=s,u._syncVScrollbarPosition(),u.triggerTopRowChanged({sheet:u,sheetName:u._name,oldTopRow:v,newTopRow:s}))}if(e)e.getCalcService().getOperatorAdjustor().onAfterAddRemoveRows(e,n,r,!1);p=u._floatingObjectArray;p&&p.length>0&&p.removeRows(n,r);ft=u._commentManager;ft&&ft.removeRows(n,r);et=w;u.getActiveRowIndex()>=et&&u.setActiveCell(et-1,u.getActiveColumnIndex());u._needSyncVScrollbarSize=!0;u.triggerRowChanged({sheet:u,sheetName:u._name,row:n,oldValue:w,sheetArea:3,propertyName:"deleteRows"})}finally{u.isPaintSuspended(ot)}}},l.prototype.addColumns=function(n,t){if(!(t<=0)){var i=this,r=i.getColumnCount();i._bindToAutoRefresh(function(n,t){var u,w,b,s,h,k,f,c,l,a,v,y,e,p;if((n<0||n>r)&&(n=r),!i.parent||!i.parent.gcSpreadsheet){if(u=i._getCalcModel(),u){if(!i._checkArrayFormula(0,n,i.getRowCount(),0))return;u.getCalcService().getOperatorAdjustor().onBeforeAddRemoveColumns(u,n)}if(w=i._sheetModelManager.getColInfos(),w.addItems(n,t),b=i._getModel(),b.addColumns(n,t),s=i._cutCopyIndicatorManager,s&&s.addColumns(),o.adjustCustomNameOnInsertRemove(i,n,t,!0,!1),h=i._getCalcModel(),h&&h.addColumns(n,t),k=i._getModel(1),k.addColumns(n,t),f=i._getSpanModel(1),f.addColumns(n,t),f=i._getSpanModel(),f.addColumns(n,t),c=i._rowFilter,c&&c._addColumns(n,t),l=i.colRangeGroup,l&&l._add(n,t),a=i._sparklineGroupManager,a&&a._addColumns(n,t),v=i._conditionalFormats,v&&v._addColumns(n,t),y=i._tableManager,y&&y.addColumns(n,t),u)u.getCalcService().getOperatorAdjustor().onAfterAddRemoveColumns(u,n,t,!0);e=i._floatingObjectArray;e&&e.length>0&&e.addColumns(n,t);p=i._commentManager;p&&p.addColumns(n,t);i._needSyncHScrollbarSize=!0;i.triggerColumnChanged({sheet:i,sheetName:i._name,col:n,oldValue:r,sheetArea:3,propertyName:"addColumns"})}})(n,t)}},l.prototype.deleteColumns=function(n,t){var i=this,r=i.getColumnCount();0>n||n>=r||t<=0||i.parent&&i.parent.gcSpreadsheet||i._bindToAutoRefresh(function(n,t){var f=i._getCalcModel(),l,g,nt,a,tt,h,v,y,p,w,b,s,u,e,c,k,d;if(f){if(!i._checkArrayFormula(0,n,i.getRowCount(),t))return;f.getCalcService().getOperatorAdjustor().onBeforeAddRemoveColumns(f,n)}if(o.adjustCustomNameOnInsertRemove(i,n,t,!1,!1),l=i._getCalcModel(),l&&l.deleteColumns(n,t),g=i._sheetModelManager.getColInfos(),g.deleteItems(n,t),nt=i._getModel(),nt.deleteColumns(n,t),a=i._cutCopyIndicatorManager,a&&a.deleteColumns(),tt=i._getModel(1),tt.deleteColumns(n,t),h=i._getSpanModel(1),h.removeColumns(n,t),h=i._getSpanModel(3),h.removeColumns(n,t),v=i._rowFilter,v&&v._removeColumns(n,t),y=i.colRangeGroup,y&&y._remove(n,t),p=i._sparklineGroupManager,p&&p._removeColumns(n,t),w=i._conditionalFormats,w&&w._removeColumns(n,t),b=i._tableManager,b&&b.removeColumns(n,t),s=i._scrollLeftCol,s>=0){for(u=-1,e=s;e>=i.frozenColCount;e--)if(i.getColumnVisible(e)&&i._getZoomColumnWidth(e)>0){u=e;break}u===-1&&(u=0);s!==u&&(i._scrollLeftCol=u,i._syncHScollbarPosition(),i.triggerLeftColumnChanged({sheet:i,sheetName:i._name,oldLeftCol:s,newLeftCol:u}))}if(f)f.getCalcService().getOperatorAdjustor().onAfterAddRemoveColumns(f,n,t,!1);c=i._floatingObjectArray;c&&c.length>0&&c.removeColumns(n,t);k=i._commentManager;k&&k.removeColumns(n,t);d=r;i.getActiveColumnIndex()>=d&&i.setActiveCell(i.getActiveRowIndex(),d-1);i._needSyncHScrollbarSize=!0;i.triggerColumnChanged({sheet:i,sheetName:i._name,col:n,oldValue:r,sheetArea:3,propertyName:"deleteColumns"})})(n,t)},l.prototype.setFrozenCount=function(n,t){(typeof n===u||n===i||n<0||isNaN(n))&&(n=0);(typeof t===u||t===i||t<0||isNaN(t))&&(t=0);var r=this;(r.frozenRowCount!==n||r.frozenColCount!==t)&&r._bindToAutoRefresh(function(n,t){var i=!1;r.frozenRowCount!==n&&(r._scrollTopRow+=n-r.frozenRowCount,r.frozenRowCount=n,i=!0);r.frozenColCount!==t&&(r._scrollLeftCol+=t-r.frozenColCount,r.frozenColCount=t,i=!0);i&&(r._needSyncVScrollbarSize=!0,r._needSyncHScrollbarSize=!0)})(n,t)},l.prototype.setFrozenColumnCount=function(n){(typeof n===u||n===i||n<0||isNaN(n))&&(n=0);var t=this;t.frozenColCount!==n&&t._bindToAutoRefresh(function(n){t._scrollLeftCol+=n-t.frozenColCount;t.frozenColCount=n;t._needSyncHScrollbarSize=!0})(n)},l.prototype.setFrozenRowCount=function(n){(typeof n===u||n===i||n<0||isNaN(n))&&(n=0);var t=this;t.frozenRowCount!==n&&t._bindToAutoRefresh(function(n){t._scrollTopRow+=n-t.frozenRowCount;t.frozenRowCount=n;t._needSyncVScrollbarSize=!0})(n)},l.prototype.setFrozenTrailingRowCount=function(n){(typeof n===u||n===i||n<0||isNaN(n))&&(n=0);var t=this;t._frozenTrailingRowCount!==n&&t._bindToAutoRefresh(function(n){t._frozenTrailingRowCount=n;t._needSyncVScrollbarSize=!0})(n)},l.prototype.setFrozenTrailingColumnCount=function(n){(n===r||n===i||n<0||isNaN(n))&&(n=0);var t=this;t._frozenTrailingColCount!==n&&t._bindToAutoRefresh(function(n){t._frozenTrailingColCount=n;t._needSyncHScrollbarSize=!0})(n)},l.prototype.getRowCount=function(n){var t=this._sheetModelManager.getDataModel(n);return t&&t.getRowCount()||0},l.prototype.getColumnCount=function(n){var t=this._sheetModelManager.getDataModel(n);return t&&t.getColumnCount()||0},l.prototype.setRowCount=function(n,u){(u===r||u===i)&&(u=3);var f=this.getDataSource();(!f||t._BindingManager.isCellBindingSource(f)||u!==3&&u!==2)&&this._setRowCountInternal(n,u)},l.prototype._setRowCountInternal=function(n,t){if(n=parseInt(n,10),!isNaN(n)){var u=this;n<0||n===u.getRowCount(t)||u._bindToAutoRefresh(function(n,t){var f,e,o;(t===r||t===i)&&(t=3);f=u._sheetModelManager;t===3||t===2?(f.dataModel().getRowCount()>n&&u.deleteRows(n,f.dataModel().getRowCount()-n),f.dataModel().setRowCount(n),f.rowHeaderModel().setRowCount(n),u.frozenRowCount>n&&u.setFrozenRowCount(n),u.rowRangeGroup&&u.rowRangeGroup._setCount(n)):t===1&&(e=f.colHeaderModel(),e.getRowCount()>n&&(o=f.getRowInfos(t),o.deleteItems(n,e.getRowCount()-n)),e.setRowCount(n));u._conditionalFormats&&u._conditionalFormats._resetCache();u._needSyncVScrollbarSize=!0;u._activeRowIndex>=n&&(t===3||t===2)&&u.setActiveCell(n-1,u.getActiveColumnIndex());u.clearPendingChanges()})(n,t)}},l.prototype.setColumnCount=function(n,t){if(n=parseInt(n,10),!isNaN(n)){var u=this;n<0||n===u.getColumnCount(t)||u._bindToAutoRefresh(function(n,t){var f,e,o;(t===r||t===i)&&(t=3);f=u._sheetModelManager;t===3||t===1?(f.dataModel().getColumnCount()>n&&u.deleteColumns(n,f.dataModel().getColumnCount()-n),u._setColumnCountCore(n)):t===2&&(e=f.rowHeaderModel(),e.getColumnCount()>n&&(o=f.getColInfos(t),o.deleteItems(n,e.getColumnCount()-n)),e.setColumnCount(n));u._conditionalFormats&&u._conditionalFormats._resetCache();u._needSyncHScrollbarSize=!0;u._activeColIndex>=n&&(t===3||t===1)&&u.setActiveCell(u.getActiveRowIndex(),n-1);u.clearPendingChanges()})(n,t)}},l.prototype._setColumnCountCore=function(n){var t=this,i=t._sheetModelManager;i.dataModel().setColumnCount(n);i.colHeaderModel().setColumnCount(n);t.frozenColCount>n&&t.setFrozenColumnCount(n);t.colRangeGroup&&t.colRangeGroup._setCount(n)},l.prototype.getText=function(n,t,r){var o;(typeof r===u||r===i)&&(r=3);var f=this,s=f.getValue(n,t,r),h=f.getCellType(n,t,r),e=f.getStyleProperty(n,t,"formatter",r);return e||(e=f.getStyleProperty(n,t,"_autoFormatter",r)),o={sheet:f,row:n,col:t,sheetArea:r},h.format(s,e,o)},l.prototype.setText=function(n,u,f,e){var o=this;o._bindToAutoRefresh(function(n,u,f,e){var h,l,c,y;(e===r||e===i)&&(e=3);h=t._NumberHelper.replaceCultureSymbolToNormal(f);l=t.util.isStringNumber(h);t.features.formatter&&l?(c={},(new t.GeneralFormatter).GetPreferredDisplayFormatter(h,c),typeof c.value=="number"&&(f=c.value)):h=f;var s=f,a=o.getCellType(n,u,e),v=o.getCell(n,u,e).formatter();a&&v&&(y={sheet:o,row:n,col:u,sheetArea:e},s=a.parse(h,v,y),s=s===i||s===r?f:s);o._setValueInternal(n,u,s,e)})(n,u,f,e)},l.prototype.getValue=function(n,f,e){var s,c,o,h,l,y,a,v,p,w;return((typeof e===u||e===i)&&(e=3),s=this,c=s._getModel(e),!c)?i:(o=s._getValueImp(c,n,f,e),e===1?(o===r||o===i)&&(l=s.getDataSource(),l&&(y=window.ko,(t._BindingManager.isDataViewSource(l)||l.length>0||y&&y.isObservable(l))&&(a=s._sheetModelManager.getColInfos()._getItem(f),v=s.colHeaderAutoTextIndex,a&&(v>=0&&n===v||v===-1&&n===c.getRowCount()-1)&&(o=a.displayName||a.name))),(o===r||o===i)&&(h=s.colHeaderAutoTextIndex,(h<0||h>=c.getRowCount())&&(h=c.getRowCount()-1),n===h&&(p=s.colHeaderAutoText,p===2?o=s._indexToLetters(f+1):p===1&&(o=f+1)))):e===2&&(o===r||o===i)&&(h=this.rowHeaderAutoTextIndex,(h<0||h>=c.getColumnCount())&&(h=c.getColumnCount()-1),f===h&&(w=s.rowHeaderAutoText,w===2?o=s._indexToLetters(n+1):w===1&&(o=n+1))),o)},l.prototype._getCurrentValue=function(n,t){var i=this;return i._isValidatingCell&&i._validatingRow===n&&i._validatingColumn===t?i._validatingValue:i.getValue(n,t)},l.prototype._getValuesForCalc=function(n,t,i,r,u,f){var e=this,l=e._getModel(),s,h;if(l){var v=e.getRowCount(),y=e.getColumnCount(),p,w,c,o,a=e._isValidatingCell;for(s=0;s<r;s++)for(f||(c=[],n.push(c)),h=0;h<u;h++)a&&e._validatingRow===s+t&&e._validatingColumn===h+i?(o=e._validatingValue,a=!1):o=e._getValueImp(l,t,i,3),f?n.push(o):c.push(o)}},l.prototype.setValue=function(n,t,i,r,u){this._setValueInternal(n,t,i,r,u);this.invalidate()},l.prototype._setValueInternal=function(n,f,e,s,h){var l,a,tt,it,v,rt,y,w,ut,b,g,nt,ft;if(((typeof s===u||s===i)&&(s=3),l=this,a=l._getModel(s),a)&&(tt=a.getRowCount(),it=a.getColumnCount(),!(n<0)&&!(n>=tt)&&!(f<0)&&!(f>=it))){v=s===3;e=o.tryConvertDateToOADate(e);var k=l._getValueImp(a,n,f,s),p=!1,d=l._tableManager,c;if(v&&d&&d._tableList.length>0&&(c=d.find(n,f),c))if(c.showHeader()&&n===c.headerIndex()){if(c._hasColumnName(e))return;rt=e!==r&&e!==i&&typeof e!="string"?e.toString():e;c._setHeaderName(f,rt)}else c.showFooter()&&n===c.footerIndex()?c._setFooterValue(f,e):p=c._setValue(n,f,e);v?(y=l._bindingManager,!p&&y&&y._dataSource&&(w=y.getValue(n,f),w.hasBinding&&e!==w.value&&(ut=t.GC$.extend({},l.getDataItem(n)),a._updateDirty(n,f,{originalItem:ut,oldValue:k}),y.setValue(n,f,e)),p=w.hasBinding),(!p||l.checkingChanges)&&a.setValue(n,f,e)):a.setValue(n,f,e);v&&!h&&l._recalcCell(a,n,f);v&&c&&c.hasSlicerData()&&(b=c.dataRange(),b.contains(n,f)&&(g=c.getSlicerData(),g&&g.onDataChanged(n-b.row,f-b.col,{value:l.getValue(n,f),text:l.getText(n,f)})));nt=l._conditionalFormats;nt&&nt._clearCache();ft=l._eventHandler._eventSuspended>0;ft||k===e||l._raiseCellChanged(vt,n,f,k,e,s)}},l.prototype.sortRange=function(n,i,u,f,e,o){var s=this,h=t.util.hasCalc()&&t.Calc.CalcOperatorAdjustor;return s._bindToAutoRefresh(function(n,i,u,f,e,o){var vt,ht,tt,d,g,it,rt,at;if(s._checkArrayFormula(n,0,u,s.getColumnCount(),!1)){vt=s.isPaintSuspended();s.isPaintSuspended(!0);s.suspendEvent();s.suspendCalcService();try{if(ht=s.getSpans(new t.Range(n,i,u,f)),ht&&ht.length>0)return!1;var ct=s.getRowCount(),lt=s.getColumnCount(),k,b,c,l,v,y,ut,ft,et,ot,st,wt=[];if(n===-1&&(n=0),u===-1&&(u=ct),i===-1&&(i=0),f===-1&&(f=lt),n<0||n>=ct||i<0||i>=lt||u<0||n+u>ct||f<0||i+f>lt||!o)return!1;if(tt=[],ut=s._quickSort(n,i,u,f,e,o),ut){var yt=s._getModel(),a=s._getCalcModel(),pt=s._getSheetSource(),nt,p,w;if(e){for(b=n;b<n+u;b++)if(nt=s._getSwapIndex(ut,n,b),wt[nt]=b,b!==nt)for(c=b,v=nt,k=i;k<i+f;k++)l=k,ft=s.getValue(c,l),et=s.getValue(v,l),ot=s.getComment(c,l),st=s.getComment(v,l),a&&pt&&(d=a._getCellCalc(c,l,!1),d&&d.hasListeners()&&d.addListenersToAdjust(),g=a._getCellCalc(v,l,!1),g&&g.hasListeners()&&g.addListenersToAdjust(),a._swapNode(c,l,v,l),p=h._copyExpression(a._getExpr(c,l),c,l,0,0),a._setExpr(c,l,p),w=a._getCellCalc(c,l,!!p),w&&w.startListening(),p=h._copyExpression(a._getExpr(v,l),v,l,0,0),a._setExpr(v,l,p),w=a._getCellCalc(v,l,!!p),w&&w.startListening()),yt.swapNode(c,l,v,l),s.setComment(c,l,st),s.setComment(v,l,ot),s.setValue(c,l,et),s.setValue(v,l,ft),tt.push(new t.CellPosition(c,l)),tt.push(new t.CellPosition(v,l))}else for(k=i;k<i+f;k++)if(nt=s._getSwapIndex(ut,i,k),k!==nt)for(l=k,y=nt,b=n;b<n+u;b++)c=b,ft=s.getValue(c,l),et=s.getValue(c,y),ot=s.getComment(c,l),st=s.getComment(c,y),a&&pt&&(d=a._getCellCalc(c,l,!1),d&&d.hasListeners()&&d.addListenersToAdjust(),g=a._getCellCalc(c,y,!1),g&&g.hasListeners()&&g.addListenersToAdjust(),a._swapNode(c,l,c,y),p=h._copyExpression(a._getExpr(c,l),c,l,0,0),a._setExpr(c,l,p),w=a._getCellCalc(c,l,!!p),w&&w.startListening(),p=h._copyExpression(a._getExpr(c,y),c,y,0,0),a._setExpr(c,y,p),w=a._getCellCalc(c,y,!!p),w&&w.startListening()),yt.swapNode(c,l,c,y),s.setComment(c,l,st),s.setComment(c,y,ot),s.setValue(c,l,et),s.setValue(c,y,ft),tt.push(new t.CellPosition(c,l)),tt.push(new t.CellPosition(c,y));for(it=n;it<n+u;it++)for(rt=i;rt<i+f;rt++)at=a.getExpression(it,rt),at&&a.setExpression(it,rt,at,r);return!0}return!1}finally{s.resumeCalcService(!1);s.resumeEvent();s.isPaintSuspended(vt);s._raiseRangeDataChanged(n,i,u,f,tt,4)}}})(n,i,u,f,e,o)},l.prototype.canDoSort=function(){return!this.isProtected||this._protectionOption.allowSort!==!1},l.prototype.clearStyleCache=function(){this._styleComposeCache=[{},{},{},{}]},l.prototype.getActualStyle=function(n,f,e,o,s){var it,g,rt,ut,ft;if((typeof e===u||e===i)&&(e=3),n===-1&&f===-1)return this.getDefaultStyle(e);var l=this,h,c,a,v,y,at=l._styleComposeCache,k,d,p,et,nt,ot,st,ht,tt=this._sheetModelManager.getDataModel(e);if(!tt)return new t.Style;if(a=tt.getStyle(n,f),v=tt.getStyle(n,-1),y=tt.getStyle(-1,f),a=a?a:i,v=v?v:i,y=y?y:i,ot=a?a.charAt?a:"__spreadJSDefault"+a._id:"__undefined",st=v?v.charAt?v:"__spreadJSDefault"+v._id:"__undefined",ht=y?y.charAt?y:"__spreadJSDefault"+y._id:"__undefined",et=at[e],k=et[ot],it=l._tableManager,it&&it.getCount()>0&&e===3&&(nt=it.find(n,f)),nt||(k||(k=et[ot]={}),d=k[st],d?p=d[ht]:d=k[st]={}),p||(c=l.getCompositeStyle(n,f,e,a,v,y,nt)),e===3&&!o&&(p||(g=c.formatter,g&&g.HasFormatedColor&&g.HasFormatedColor()&&(rt={value:i},g.Format(l.getValue(n,f),rt),rt.value&&(h=new t.Style,h.foreColor=rt.value))),ut=l._conditionalFormats,ut&&ut.count()>0)){var ct=ut.getRules(n,f),lt=ct.length,w,b=i;if(lt>0)for(ct.sort(function(n,t){return n.priority()-t.priority()}),ft=0;ft<lt;ft++)if((w=ct[ft],w)&&(w.isScaleRule()?(w instanceof t.TwoScaleRule||w instanceof t.ThreeScaleRule)&&(b=w.evaluate(l,n,f,l.getValue(n,f,e)),b&&(h||(h=new t.Style),h.backColor===r&&(h.backColor=b))):(b=w.evaluate(l,n,f,l.getValue(n,f,e)),b&&(h||(h=new t.Style),h.compose(b))),w.stopIfTrue()&&b))break}if(h)h.compose(p?p:c),c=h;else if(p)return s?p:p.clone();return(typeof c.locked===u||c.locked===i)&&(c.locked=!0),c=c._normalize(l._currentTheme),h||nt||(d[ht]=c.clone()),c},l.prototype.getStyleProperty=function(n,f,e,o){var h,s,d,p,w,c,l,b,k,g,nt,tt,y,it,ut;if((typeof o===u||o===i)&&(o=3),h=this,w=h._getModel(o),!w)return r;if(l=!1,o===3&&(e==="foreColor"&&(k=h.getStyleProperty(n,f,"formatter",o),k&&k.HasFormatedColor&&k.HasFormatedColor()&&(g={value:i},k.Format(h.getValue(n,f),g),g.value&&(c=g.value,l=!0))),nt=h._conditionalFormats,nt&&nt.count()>0)){var rt=nt.getRules(n,f),ft=rt.length,a,v=i;if(ft>0)for(rt.sort(function(n,t){return n.priority()-t.priority()}),tt=0;tt<ft;tt++)if(a=rt[tt],a){if(a.isScaleRule()){if(e==="backColor"&&(a instanceof t.TwoScaleRule||a instanceof t.ThreeScaleRule)&&(v=a.evaluate(h,n,f,h.getValue(n,f,o)),v)){c=v;l=!0;break}}else if(v=a.evaluate(h,n,f,h.getValue(n,f,o)),v&&v[e]!==r){c=v[e];l=!0;break}if(a.stopIfTrue()&&v)break}}for(y=0;!l&&y<=4;)if(y===0?s=w.getStyle(n,f):y===1?(it=h._tableManager,it&&it.getCount()>0&&o===3&&(ut=it.find(n,f),ut&&t.TableStyle[e]&&(s=new t.Style,ut._compose(n,f,s)))):s=y===2?w.getStyle(n,-1):y===3?w.getStyle(-1,f):h.getDefaultStyle(),y++,s){if(s.charAt&&typeof s=="string"&&(s=h._name2Style(s)),e==="font"&&s.themeFont&&!b&&(b=s.themeFont),s[e]!==r){c=s[e];l=!0;break}for(d=s.parentName;d;){if(p=h._name2Style(d),!p)break;if(p[e]!==r){c=p[e];l=!0;break}d=p.parentName}}if(e==="locked")return c===r||c===i?!0:c;else if(l||b)return(e==="foreColor"||e==="backColor"||e==="font"||e==="borderLeft"||e==="borderTop"||e==="borderRight"||e==="borderBottom")&&(s=new t.Style,s[e]=c,e==="font"&&b&&(s.themeFont=b),s._normalize(h._currentTheme),c=s[e]),c;return r},l.prototype.getStyle=function(n,t,i){return this.getStyleImp(n,t,i,!0)},l.prototype.getStyleImp=function(n,u,f,e){var s,o,h,c;if((f===r||f===i)&&(f=3),s=this._sheetModelManager.getDataModel(f),s)if(o=s.getStyle(n,u),o instanceof t.Style)return e&&this.clearStyleCache(),o;else if(typeof o=="string"&&(h=this._name2Style(o),h!==i))return c=new t.Style,c.compose(h),e&&this.clearStyleCache(),c;return i},l.prototype.addNamedStyle=function(n){this._addNamedStyleImp(n,!0)},l.prototype._addNamedStyleImp=function(n,u){var f,e;if(n!==i&&n!==r){if(n.name===i||n.name===r||n.name==="")throw new Error(t.SR.Exp_EmptyNamedStyle);u?(f=this,this._bindToAutoRefresh(function(n){var t=n.name.toUpperCase();f._namedStyles[t]=n})(n)):(e=n.name.toUpperCase(),this._namedStyles[e]=n)}},l.prototype.getNamedStyle=function(n){return this.getNamedStyleImp(n,!0)},l.prototype.getNamedStyleImp=function(n,t){var u=this._namedStyles,r;return u&&n?(n=n.toUpperCase(),r=u[n]||i,r&&t&&this.clearStyleCache(),r):i},l.prototype.getNamedStyles=function(){var n=[],i=this._namedStyles;return i&&t.GC$.each(i,function(t,i){n.push(i)}),this.clearStyleCache(),n},l.prototype.removeNamedStyle=function(n){var t=this;t._namedStyles&&n!==r&&n!=i&&n!==""&&(n=n.toUpperCase(),t._namedStyles.hasOwnProperty(n)&&(delete t._namedStyles[n],t.invalidate()))},l.prototype.setStyle=function(n,t,r,f){(typeof f===u||f===i)&&(f=3);this.setStyleObject(n,t,r,f);n===-1&&t===-1&&(this._composedDefaultStyle[f]=i);this.clearStyleCache();this.invalidate()},l.prototype.setStyleWithoutLocked=function(n,i,u,f){var s=this,o=s.getStyle(n,i,f),e;u?(e=o?o.locked:r,u.locked!==e&&(u.locked=e),s.setStyle(n,i,u,f)):o&&(e=o.locked,e!==r&&(u=new t.Style,u.locked=e),s.setStyle(n,i,u,f))},l.prototype.getStyleName=function(n,i,r){var u=this.getStyleObject(n,i,r);return u instanceof t.Style?u.name:u},l.prototype.setStyleName=function(n,t,i,r){typeof i=="string"&&(this.setStyleObject(n,t,i,r),this.invalidate())},l.prototype.getStyleObject=function(n,t,u){(u===r||u===i)&&(u=3);var f=i,e=this._getModel(u);return e&&(f=e.getStyle(n,t),f!==r&&f!==i)?f:i},l.prototype.setStyleObject=function(n,r,f,e){var y,p,c,l,a;(typeof e===u||e===i)&&(e=3);var o=this,s=o.getStyleObject(n,r,e),w=s&&s.formatter,h=o._getModel(e);if(h){if(y=h.getRowCount(),p=h.getColumnCount(),n<-1||n>=y||r<-1||r>=p)return;c=h.getStyle(n,r);h.setStyle(n,r,f);t._DataValidatorCache.setStyle(f,o,n,r);n===o._activeRowIndex&&r===o._activeColIndex&&(f&&f.cellType&&f.cellType.typeName)!==(s&&s.cellType&&s.cellType.typeName)&&t.FocusHelper.isActiveElement(o)&&o._eventHandler.changeFocusHolder();f&&f.formatter&&t.features.formatter&&(l=f.formatter,l&&typeof l.Init===v&&l.Init());a="[styleinfo]";n!==-1&&r!==-1?o._raiseCellChanged(a,n,r,c,f,e):n!==-1&&r===-1?o.triggerRowChanged({sheet:o,sheetName:o._name,row:n,sheetArea:e,propertyName:a,oldValue:c}):n===-1&&r!==-1&&o.triggerColumnChanged({sheet:o,sheetName:o._name,col:r,sheetArea:e,propertyName:a,oldValue:c})}},l.prototype.getDefaultStyle=function(n){var f,s,e,r,h,o;return((typeof n===u||n===i)&&(n=3),f=this._composedDefaultStyle,s=f[n],s)?s:(e=this._sheetModelManager.getDataModel(n),e)?(r=e.getStyle(-1,-1),typeof r=="string"&&(r=this._name2Style(r)),r||(r=new t.Style,e.setStyle(-1,-1,r)),h=n===1||n===2,typeof r.hAlign===u&&(r.hAlign=h?1:3),typeof r.vAlign===u&&(r.vAlign=h?1:0),typeof r.imeMode===u&&(r.imeMode=1),r.font||typeof r.themeFont!==u||(r.themeFont="Body"),f[n]=r,r):(o=new t.Style,o.locked=!0,f[n]=o,o)},l.prototype.setDefaultStyle=function(n,r){(typeof r===u||r===i)&&(r=3);var f=this._sheetModelManager.getDataModel(r);f&&(f.setStyle(-1,-1,n),t._DataValidatorCache.setStyle(n,this,-1,-1));this._composedDefaultStyle[r]=i;this.clearStyleCache()},l.prototype._name2Style=function(n){var r=this.getNamedStyleImp(n,!1),t;return r?r:(t=this.parent,t&&t.getNamedStyleImp)?t.getNamedStyleImp(n,!1):i},l.prototype.getCompositeStyle=function(n,r,f,e,o,s,h){var d,g,c,k,p;(typeof f===u||f===i)&&(f=3);var v=this,y=new t.Style,l,a,w=!1,b=v._sheetModelManager.getDataModel(f);if(b){if(d=b.getRowCount(),g=b.getColumnCount(),0<=n&&n<d&&0<=r&&r<g&&(c=e!==undefined?e:b.getStyle(n,r),c&&c.charAt&&(c=v._name2Style(c)),c))for(y.compose(c,!0),w=!0,a=c.parentName;a;){if(l=v._name2Style(a),!l)break;y.compose(l);a=l.parentName}if(h===undefined&&(k=v._tableManager,k&&k.getCount()>0&&f===3&&(h=k.find(n,r))),h&&(h._compose(n,r,y),w=!0),0<=n&&n<d&&(c=o!==undefined?o:b.getStyle(n,-1),c&&c.charAt&&(c=v._name2Style(c)),c))for(y.compose(c,!w),w=!0,a=c.parentName;a;){if(l=v._name2Style(a),!l)break;y.compose(l);a=l.parentName}if(0<=r&&r<g&&(c=s!==undefined?s:b.getStyle(-1,r),c&&c.charAt&&(c=v._name2Style(c)),c))for(y.compose(c,!w),w=!0,a=c.parentName;a;){if(l=v._name2Style(a),!l)break;y.compose(l);a=l.parentName}}if(p=v.getDefaultStyle(f),p&&p.charAt&&(p=v._name2Style(p)),p)for(y.compose(p,!w),a=p.parentName;a;){if(l=v._name2Style(a),!l)break;y.compose(l);a=l.parentName}return y},l.prototype.getCellType=function(n,t,i){return this.getStyleProperty(n,t,"cellType",i)||this.getDefaultCellType(i)},l.prototype.getDefaultCellType=function(n){(typeof n===u||n===i)&&(n=3);var r=this._defaultCellType;return r||(r=this._defaultCellType=new t.TextCellType),n===3?r:n===1?new t.ColumnHeaderCellType:n===2?new t.RowHeaderCellType:n===0?new t.CornerCellType:r},l.prototype.setCellType=function(n,i,r,u){var f=this.getStyleImp(n,i,u);f||(f=new t.Style);f.cellType=r;this.setStyle(n,i,f,u)},l.prototype.getFormatter=function(n,t,i){return this.getStyleProperty(n,t,"formatter",i)},l.prototype.setFormatter=function(n,i,r,u){var f=this.getStyleImp(n,i,u);f||(f=new t.Style);f.formatter=r;this.setStyle(n,i,f,u)},l.prototype.getDataValidator=function(n,t,i){return this.getStyleProperty(n,t,"validator",i)},l.prototype.setDataValidator=function(n,u,f,e){var o,h,c,s,a,l;(e===r||e===i)&&(e=3);o=this;h=o.getStyleImp(n,u,e);h||(h=new t.Style);c=h.validator;h.validator=f;o.suspendEvent();o.setStyle(n,u,h,e);o.resumeEvent();t.features.conditionalFormat&&f&&f.condition instanceof t.FormulaCondition&&(s=f.condition,(s._baseRow===r||s._baseRow===i)&&(s._baseRow=n!==-1?n:0),(s._baseCol===r||s._baseCol===i)&&(s._baseCol=u!==-1?u:0));a=t.Events;l="validator";o._raiseCellChanged(l,n,u,c,f,e);n!==-1&&u===-1?o.triggerRowChanged({sheet:o,sheetName:o._name,row:n,sheetArea:e,propertyName:l,oldValue:c}):n===-1&&u!==-1&&o.triggerColumnChanged({sheet:o,sheetName:o._name,col:u,sheetArea:e,propertyName:l,oldValue:c})},l.prototype.isValid=function(n,t,r){var u,f;try{if(u=this,u._validatingRow=n,u._validatingColumn=t,u._validatingValue=r,u._isValidatingCell=!0,f=u.getDataValidator(n,t),f)return f.isValid(u,n,t,r)}finally{u._validatingRow=-1;u._validatingColumn=-1;u._validatingValue=i;u._isValidatingCell=!1}return!0},l.prototype.addSelection=function(n,i,r,u){var f=this;f._bindToAutoRefresh(function(n,i,r,u){var s=n,h=i,c=r,l=u,o,e;s!==-1&&h!==-1&&(o=f._getSpanModel().getSpans(),o&&o.length>0&&(e=f._cellRangeInflate(o,new t.Range(n,i,r,u)),s=e.row,h=e.col,c=e.rowCount,l=e.colCount));f._selectionModel.add(s,h,c,l)})(n,i,r,u)},l.prototype.setSelection=function(n,t,i,r){this._setSelectionImp(n,t,i,r,2)},l.prototype._setSelectionImp=function(n,i,r,u,f){var e=this,a=e.getRowCount(),v=e.getColumnCount(),o,s,h,c,l;n>=a&&(n=a-1);o=n;o<0&&(o=0);s=i;i>=v&&(i=v-1);s<0&&(s=0);e._clearSelectionImp();h=!0;switch(f){case 1:h=!0;break;case 0:h=!1;break;case 2:h=t.FocusHelper.isActiveElement(e);break}c=1;o<e.frozenRowCount?c=0:o>=a-e._frozenTrailingRowCount&&(c=2);l=1;s<e.frozenColCount?l=0:s>=v-e._frozenTrailingColCount&&(l=2);e._setActiveCellImp(o,s,c,l,!h);e.addSelection(n,i,r,u)},l.prototype.getSelections=function(){return this._selectionModel.toArray()},l.prototype.canSelect=function(n,t,i){var f=this,e=f._protectionOption.allowSelectLockedCells!==!1,l=f._protectionOption.allowSelectUnlockedCells!==!1,s,a,c,o,r,u;if(!f.isProtected||e&&l)return!0;if(!e&&!l)return!1;if(s=i?i.locked:f.getStyleProperty(n,t,"locked"),e===s&&(n<0||t<0)){var p=t<0,w=n<0,b=n<0?f.getRowCount():1;n=n<0?0:n;a=t<0?f.getColumnCount():1;t=t<0?0:t;var h=f._getModel(),k=h.dataTable,v=n+b-1,y=t+a-1;for(r=n;r<=v;r++)if(c=k[r],c)for(u=t;u<=y;u++)if(o=c[u],o&&o.style&&e!==o.style.locked)return!1;if(w)for(r=n;r<=v;r++)if(i=h.getStyle(r,-1),i&&e!==i.locked)return!1;if(p)for(u=t;u<=y;u++)if(i=h.getStyle(-1,u),i&&e!==i.locked)return!1}return e===s},l.prototype.canSelectFloatingObject=function(n){return!this.isProtected||!n.isLocked()||this._protectionOption.allowEditObjects},l.prototype.canEditComment=function(n){return!this.isProtected||this._protectionOption.allowEditObjects||n&&!n.locked()},l.prototype.canEditFloatingObject=function(n){return!this.isProtected||!n.isLocked()||this._protectionOption.allowEditObjects},l.prototype.canDoResizeRows=function(){return!this.isProtected||this._protectionOption.allowResizeRows},l.prototype.canDoResizeColumns=function(){return!this.isProtected||this._protectionOption.allowResizeColumns},l.prototype._addSpanImp=function(n,u,f,e,o){var s=this;s._bindToAutoRefresh(function(n,u,f,e,o){var l,a,v,h,c;if((o===r||o===i)&&(o=3),l=s._getSpanModel(o),l.clear(n,u,f,e),a=new t.Range(n,u,f,e),v=s._getActualRange(a,o),l.addSpan(v),o===3){for(h=s.getSelections(),c=0;c<h.length;c++)h[c].intersect(n,u,f,e)&&(h[c]=h[c].union(a));s._selectionModel.fromArray(h)}})(n,u,f,e,o)},l.prototype.addSpan=function(n,i,r,u,f){var e=this,o,s;if((r!==1||u!==1)&&f!==0&&(o=!0,(f===3||f===undefined)&&(o=e._checkArrayFormula(n,i,r,u,!1)),o)){if(s=e._getSpanModel(f),s.hasPartSpans(n,i,r,u))throw new Error(t.SR.Exp_InvalidRange);e._addSpanImp(n,i,r,u,f);e._updateCommentsInSpanChangedArea(!0,n,i,r,u)}},l.prototype.removeSpan=function(n,t,u){var f=this;this._bindToAutoRefresh(function(n,t,u){var o,e,s;for((u===r||u===i)&&(u=3),o=f._getSpanModel(u),e=0;e<o.length;e++)if(s=o[e],s.row===n&&s.col===t){o.removeSpan(e,1);return}})(n,t,u);f._updateCommentsInSpanChangedArea(!1,n,t)},l.prototype._updateCommentsInSpanChangedArea=function(n,t,r,u,f){var e=this,l,s,o,a;if(n&&e._commentManager)for(l=e._commentManager.getCommentList(),s=0;s<l.length;s++){var o=l[s],h=o._rowIndex,c=o._colIndex;(h!==t||c!==r)&&h>=t&&h<t+u&&c>=r&&c<r+f&&e.setComment(h,c,i)}o=e.getComment(t,r);o&&(a=e._commentManager.getCommentView(o),a&&a.updateLayoutWhenCellSpanChanged())},l.prototype.repaint=function(n){this._paintSuspended||this._render.repaint(n)},l.prototype.startEdit=function(n,t){var r=this;r._startEditImp(r._getCanvas(),r._activeRowIndex,r._activeColIndex,i,i,n,t)},l.prototype.editorStatus=function(){return this._editorStatus?this._editorStatus:0},l.prototype.isEditing=function(){return this._editorStatus===1||this._editorStatus===2},l.prototype.doKeyDown=function(n){this._eventHandler.doKeyDown(n)},l.prototype.doKeyUp=function(n){this._eventHandler.doKeyUp(n)},l.prototype.doCompositionStart=function(n){this._eventHandler.doCompositionStart(n)},l.prototype.removeKeyMap=function(n,t,i,r,u){this.removeKeyMapInternal(n,t,i,r,u,this.keyMap)},l.prototype.removeKeyMapInternal=function(n,t,i,r,u,f){var o,e;if(f)for(u=typeof u=="function"?!1:u,o=0;o<f.length;o++)if(e=f[o],e&&e.key===n&&e.ctrl===t&&e.shift===i&&e.alt===r&&e.meta===u){f.splice(o,1);break}},l.prototype.removeFloatingObjectKeyMap=function(n,t,i,r,u){this.removeKeyMapInternal(n,t,i,r,u,this.floatingObjectKeyMap)},l.prototype.removeSlicerKeyMap=function(n,t,i,r,u){this.removeKeyMapInternal(n,t,i,r,u,this._slicerKeyMap)},l.prototype.removeCommentKeyMap=function(n,t,i,r,u){this.removeKeyMapInternal(n,t,i,r,u,this._commentKeyMap)},l.prototype.addKeyMap=function(n,t,i,r,u,f){this.keyMap||(this.keyMap=[]);this.addKeyMapInternal(n,t,i,r,u,f,this.keyMap)},l.prototype.addKeyMapInternal=function(n,i,r,u,f,e,o){var h=this;o||(o=[]);var c=e&&f||!1,l=e||f,f=c,e=l,s=h._getKeyActionInternal(n,i,r,u,f,o);s?s.action=e:o.push(new t.KeyMap(n,i,r,u,f,e))},l.prototype.addFloatingObjectKeyMap=function(n,t,i,r,u,f){this.floatingObjectKeyMap||(this.floatingObjectKeyMap=[]);this.addKeyMapInternal(n,t,i,r,u,f,this.floatingObjectKeyMap)},l.prototype.addSlicerKeyMap=function(n,t,i,r,u,f){this._slicerKeyMap||(this._slicerKeyMap=[]);this.addKeyMapInternal(n,t,i,r,u,f,this._slicerKeyMap)},l.prototype.addCommentKeyMap=function(n,t,i,r,u,f){this._commentKeyMap||(this._commentKeyMap=[]);this.addKeyMapInternal(n,t,i,r,u,f,this._commentKeyMap)},l.prototype._moveFormulaTextBoxCell=function(n,r,f,e){var o=this,a=o._formulaTextBox,w,c,l,b,k,s,v;if(a&&a.canAppendRange()&&(!o.parent||o.parent.canUserEditFormula())&&o._enableFormulaTextbox){var h=o._getKeyboardAppendingInfo(),d=h.anchorRow,g=h.anchorCol,y=h.leadingRow,p=h.leadingCol;(typeof f===u||f===i)&&(f=d);(typeof e===u||e===i)&&(e=g);w=o._eventHandler;switch(n){case 3:s=o._getMoveLeftCell(f,e,r,y);break;case 4:s=o._getMoveRightCell(f,e,r,y);break;case 1:s=o._getMoveUpCell(f,e,r,p);break;case 2:s=o._getMoveDownCell(f,e,r,p);break;case 5:s=o._getMoveFirstCell();break;case 6:s=o._getMoveLastCell();break;default:break}s&&(c=s.row,l=s.col,b=s.leadingCellRow?s.leadingCellRow:c,k=s.leadingCellCol?s.leadingCellCol:l,o._canMoveCurrentTo(c,l))&&(h.anchorRow=c,h.anchorCol=l,h.leadingRow=b,h.leadingCol=k,v=w.rangeToString(new t.Range(c,l,1,1)),v&&a.appendRange(v,!1,!0),c>=0&&l>=0&&o._scrollByMoveCell(c,l))}},l.prototype._changeFormulaTextBoxActiveRange=function(n,i){var r=this,u=r._formulaTextBox,l,a,e;if(u&&u.canAppendRange()&&(!r.parent||r.parent.canUserEditFormula())&&r._enableFormulaTextbox){var o=r._eventHandler,s=r._getKeyboardAppendingInfo(),h=s.anchorRow,c=s.anchorCol,f;u.isAppending()?(l=u.getActiveRange(),f=o.stringToRange(l.text)):f=new t.Range(h,c,1,1);f&&(a=r._getKeyboardSelectedRange(f,n,i,h,c),e=o.rangeToString(a),e&&u.appendRange(e,!0,!1))}},l.prototype._getKeyboardAppendingInfo=function(){var n=this,i=n._formulaTextBox,t=n._eventHandler;return i.isAppending()?t._formulaRangeAppendingInfo:t._formulaRangeAppendingInfo={anchorRow:n._activeRowIndex,anchorCol:n._activeColIndex,leadingRow:n._leadingCellRow,leadingCol:n._leadingCellCol}},l.prototype.moveActiveCell=function(n,u,f,e){var o=this,s={sheet:o,sheetName:o._name,row:o._activeRowIndex,col:o._activeColIndex,cancel:!1},h,c,l;(o.triggerLeaveCell(s),s&&s.cancel===!0)||o.endEdit()&&(h=o._activeRowIndex,c=o._activeColIndex,(f===r||f===i)&&(f=o._activeRowIndex),(e===r||e===i)&&(e=o._activeColIndex),l=t.Direction,n===3?o._moveActiveCellLeft(f,e,u):n===4?o._moveActiveCellRight(f,e,u):n===1?o._moveActiveCellUp(f,e,u):n===2?o._moveActiveCellDown(f,e,u):n===5?o._moveActiveCellFirst():n===6&&o._moveActiveCellLast(),o.moveActiveCellEnd(n,h,c))},l.prototype._moveActiveCellInSelection=function(n){var t=this,i={sheet:t,sheetName:t._name,row:t._activeRowIndex,col:t._activeColIndex,cancel:!1},r,u;(t.triggerLeaveCell(i),i&&i.cancel===!0)||t.endEdit()&&(r=t._activeRowIndex,u=t._activeColIndex,n===3?t._moveActiveCellLeftInSelection(t._activeRowIndex,t._activeColIndex):n===4&&t._moveActiveCellRightInSelection(t._activeRowIndex,t._activeColIndex),t.moveActiveCellEnd(n,r,u))},l.prototype.doDataItemChanged=function(){var n=this._bindingManager;n&&n.doDataItemChanged()},l.prototype.moveActiveCellEnd=function(n,i,r){var u=this,k=u._eventHandler,d=u._selectionModel.toArray(),g=!1,v,p,ut,ft,o,w,b,a;u._isNavigateInSelection||(v=u._fixRange(u._getActiveSelectedRange()),(u._selectionModel.length>1||v.rowCount>1||v.colCount>1)&&(g=!0),u._clearSelectionImp());var e=u._activeRowIndex,s=u._activeColIndex,y=u._getSpanModel().find(e,s);if(y?(u._activeRowCount=y.rowCount,u._activeColCount=y.colCount):(u._activeRowCount=1,u._activeColCount=1),!u._isNavigateInSelection){var f=u._getExtendedRange(e,s),nt=u.selectionPolicy(),tt=u.selectionUnit();nt===0?u._selectionModel.clear():nt===1&&u._selectionModel.clear();tt===1?(f.col=-1,f.colCount=-1):tt===2&&(f.row=-1,f.rowCount=-1);u._replaceActiveSelectedRange(f.row,f.col,f.rowCount,f.colCount,!1);p=u._selectionModel.toArray();k._notEqualSelecions(d,p)&&(ut=t.Events,u.triggerSelectionChanging({sheet:u,sheetName:u._name,oldSelections:d,newSelections:p}),u.triggerSelectionChanged({sheet:u,sheetName:u._name}))}if(ft=u._scrollTopRow,u._scrollByMoveCell(e,s),i!=e&&u.doDataItemChanged(),o=u._render,g){var h=u._getSheetLayout(),c=h.headerX,l=h.headerY,it=h.width-c,rt=h.height-l;o.copyDoubleBuffer(c,l,it,rt);o.repaint(new t.Rect(c,l,it,h.colHeaderHeight));o.repaint(new t.Rect(c,l,h.rowHeaderWidth,rt));o.paintAdornment(o._getCtx())}else a=u._getSpanModel().find(i,r),a?(w=a.rowCount,b=a.colCount):(w=1,b=1),o.repaintSelection(new t.Range(e,s,u._activeRowCount,u._activeColCount).union(new t.Range(i,r,w,b)));u.triggerEnterCell({sheet:u,sheetName:u._name,row:e,col:s});k._updateValidationUI(e,s)},l.prototype._scrollByMoveCell=function(n,t){var i=this,a=i.frozenColCount?i._getNextVisualColumn(i.frozenColCount-1):i._getFirstVisualColumn(),v=i.frozenRowCount?i._getNextVisualRow(i.frozenRowCount-1):i._getFirstVisualRow(),s,c,l;if(t<i._scrollLeftCol&&t>=a&&i._setLeftColumn(i._getPrevVisualColumn(t+1)),t>i._getLastFullyVisibleColumn()&&t<=i._getLastVisualColumn()){var o=0,r=t,y=i._getSheetLayout(),f=i._getSpanModel().find(n,r);for(f&&(r=f.col+f.colCount-1);r>i._scrollLeftCol;){if(o+=i._getZoomColumnWidth(r),o>y.viewportWidth)break;r--}s=i._getNextVisualColumn(r);i._setLeftColumn(s)}if(n<i._scrollTopRow&&n>=v&&i._setTopRow(i._getPrevVisualRow(n+1)),n>i._getLastFullyVisibleRow()&&n<=i._getLastVisualRow()){var h=0,u=n,e=i._getSpanModel().find(u,t);for(e&&(u=e.row+e.rowCount-1),c=i._getSheetLayout();u>i._scrollTopRow;){if(h+=i._getZoomRowHeight(u),h>c.viewportHeight)break;u--}l=i._getNextVisualRow(u);i._setTopRow(l)}n===i._getLastVisualRow()&&i._setTopRow(i._getLastPageTopRow());t===i._getLastVisualColumn()&&i._setLeftColumn(i._getLastPageLeftColumn())},l.prototype.commitArrayFormula=function(){this._endEditImp(!1,1)},l.prototype._endEditImp=function(n,t){var i=this,r,u;if(!i.isEditing())return!0;r=i.isPaintSuspended();i.isPaintSuspended(!0);try{u=i._endEditCore(n,t)}finally{return u?i.isPaintSuspended(r):i._paintSuspended=r,u}},l.prototype._endEditCore=function(n,r){var u=this,v=u._eventHandler,f=u._editor,c,e=u.getCellType(u._activeRowIndex,u._activeColIndex),o={sheet:u,row:u._activeRowIndex,col:u._activeColIndex,sheetArea:3},l,s,y,p,k,a,d,g,b,h,nt;if(!e.isImeAware(o)&&v&&v.changeFocusHolder(),f&&f.parentNode){if(l=e.getEditorValue(f,o),s={sheet:u,sheetName:u._name,row:u._activeRowIndex,col:u._activeColIndex,editor:f,editingText:l,cancel:!1},u.triggerEditEnd(s),s&&s.cancel===!0)return;if(u.triggerEditEnding(s),s&&s.cancel===!0)return;if(u._detachFormulaTextBox(),y=this.parent&&this.parent._attachedFormulaTextBox,w.activeElement===(y&&y._host)&&v.changeFocusHolder(),u._activeRowIndex>=0&&u._activeColIndex>=0&&(p=f._oldValue,e.isEditingValueChanged(p,l,o)||r===1))if(n)e.setEditorValue(f,p,o),e.selectAll(f,o);else if(k=e.hasOwnProperty("_autoFormatValue")?e._autoFormatValue:!0,a={row:u._activeRowIndex,col:u._activeColIndex,newValue:l,autoFormat:k},r===1&&(d=[u._getActiveSelectedRange()],a.ranges=d,a.endEditType=r),c=new t.UndoRedo.CellEditUndoAction(u,a),u._doCommand(c),g=c.applyResult===2,g===!0)return e.focus(f,o),u._attachFormulaTextBox(e.getEditingElement()),!1;if(u._dirty=!0,e.deactivateEditor(f,o),e.isImeAware(o))t.GC$(f).css("width","0"),t.GC$(f).css("height","0"),t.GC$(f).css("overflow","hidden");else for(b=u._getHost(),h=f;h;)h.parentNode===b?b.removeChild(h):h=h.parentNode}return(u._editingTimeValue=!1,u.triggerEditEnded({sheet:u,sheetName:u._name,row:u._activeRowIndex,col:u._activeColIndex,editingText:l}),u._editorStatus!==0&&(nt=u._editorStatus,u._editorStatus=0,u.triggerEditorStatusChanged({sheet:u,sheetName:u._name,oldStatus:nt,newStatus:0})),u._editor=i,c&&c.applyResult===1)?!1:!0},l.prototype.endEdit=function(n){return this._endEditImp(n)},l.prototype.hitTest=function(n,t,u){var e=this,f,l,o,s,h,c,a,v,y,p,w,b;return e._getSheetLayout(),f={x:n,y:t,rowViewportIndex:i,colViewportIndex:i,row:-1,col:-1,resizeInfo:i,hitTestType:i,groupHitInfo:i,filterButtonHitInfo:i,dragInfo:i,cellTypeHitInfo:i,floatingObjectHitInfo:i,formulaRangeHitInfo:i,commentHitInfo:i},l=e._render.groupHitTest(n,t),l?f.groupHitInfo=l:(o=e._getRowViewportIndexFromY(t),s=e._getColumnViewportIndexFromX(n),f.rowViewportIndex=o,f.colViewportIndex=s,f.row=e._getRowIndexFromY(t,o),f.col=e._getColumnIndexFromX(n,s),o>=0&&o<=2&&s>=0&&(h=e._getCellLayoutByCell(o,s,r,f.row,f.col),h&&u!==!0&&(f.row=h.row,f.col=h.col)),f.hitTestType=e._getSheetArea(o,s),c=e._eventHandler,(y=c.getDragInfo(f,n,t))?f.dragInfo=y:(a=c.getResizingRowCol(f,n,t,5))?f.resizeInfo=a:(w=c.getFormulaRangeHitInfo(f,n,t))?f.formulaRangeHitInfo=w:(b=this._getCommentHitInfo(n,t))?f.commentHitInfo=b:(v=this._getFloatingObjectHitInfo(n,t))?f.floatingObjectHitInfo=v:(p=e._getFilterButtonHitInfo(f,n,t))?f.filterButtonHitInfo=p:f.cellTypeHitInfo=e._getCellTypeHitInfo(f,n,t)),f},l.prototype.getCellRect=function(n,r,f,e){var s=3,o,h;if(f===-1?s=1:e===-1&&(s=2),o=this,h=o._getSheetLayout(),f===-1&&e===-1)return new t.Rect(h.headerX,h.headerY,h.rowHeaderWidth,h.colHeaderHeight);var l=o.getBounds(),y=o.getRowCount(),p=o.getColumnCount();(typeof f===u||f===i)&&(n<o.frozenRowCount?f=0:n<y-o._frozenTrailingRowCount?f=1:n<y&&(f=2));(typeof e===u||e===i)&&(r<o.frozenColCount?e=0:r<p-o._frozenTrailingColCount?e=1:r<p&&(e=2));var a=o._getRowLayout(f,s).findRow(n),v=o._getColumnLayout(e,s).findCol(r),c=o._getCellLayout(f,e,s).findCell(n,r);return c?new t.Rect(c.x-l.x,c.y-l.y,c.width,c.height):a&&v?new t.Rect(v.x-l.x,a.y-l.y,v.width,a.height):new t.Rect},l.prototype._setActiveCellCore=function(n,t,u){var f=this,o=f._eventHandler,e=!1;n!==i&&n!==r&&(f._activeRowIndex=n,e=!0);t!==i&&t!==r&&(f._activeColIndex=t,e=!0);!u&&o&&e&&o.changeFocusHolder()},l.prototype._setActiveCellImp=function(n,i,r,u,f){var e=this,h=e._activeRowIndex,c=e._activeColIndex,o=e._getSpanModel().find(n,i);if(o?(e._activeRowCount=o.rowCount,e._activeColCount=o.colCount):(e._activeRowCount=1,e._activeColCount=1),!e._paintSuspended){var s=e._getSpanModel().find(h,c),l=1,a=1;s&&(l=s.rowCount,a=s.colCount);e._render.repaintSelection(new t.Range(h,c,l,a))}e.activeRowViewportIndex=r;e.activeColViewportIndex=u;e._setActiveCellCore(n,i,f);e._leadingCellRow=n;e._leadingCellCol=i},l.prototype.setActiveCell=function(n,t,i,r){this._setActiveCellAndSelection(n,t,i,r,2)},l.prototype._setActiveCellAndSelection=function(n,i,r,u,f){var e=this;e._bindToAutoRefresh(function(n,i,r,u,f){var h=e.getRowCount(),c=e.getColumnCount(),s,o;n<0?n=0:n>=h&&(n=h-1);i<0?i=0:i>=c&&(i=c-1);e._clearSelectionImp();s=!0;switch(f){case 1:s=!0;break;case 0:s=!1;break;case 2:s=t.FocusHelper.isActiveElement(e);break}e._setActiveCellImp(n,i,r,u,!s);o=e._getSpanModel().find(n,i);o?e._setSelectedRange(o.row,o.col,o.rowCount,o.colCount):e._setSelectedRange(n,i,1,1)})(n,i,r,u,f)},l.prototype.getActiveRowIndex=function(){return this._activeRowIndex},l.prototype.getActiveColumnIndex=function(){return this._activeColIndex},l.prototype.selectionPolicy=function(n){return arguments.length===0?this._selectionModel.selectionPolicy:(this._selectionModel.selectionPolicy=n,this)},l.prototype.selectionUnit=function(n){return arguments.length===0?this._selectionModel.selectionUnit:(this._selectionModel.selectionUnit=n,this)},l.prototype.getRowResizable=function(n,t){return this._sheetModelManager.getRowInfos(t).getResizeable(n)},l.prototype.setRowResizable=function(n,t,i){this.setRowColInfo(n,t,"resizable",!0,i)},l.prototype.setRowColInfo=function(n,t,r,f,e){(typeof e===u||e===i)&&(e=3);var h=this,o=h._sheetModelManager[f?"getRowInfos":"getColInfos"](e),s;switch(r){case"resizable":s=o.getResizeable(n);o.setResizeable(n,t);break;case"pageBreak":s=o.getPageBreak(n);o.setPageBreak(n,t);break;case"isVisible":s=o.getVisible(n);o.setVisible(n,t);break;case pt:s=o.getSize(n);o.setSize(n,t);e===3&&s!==t&&(s===0||t===0)&&h.recalcRows([n]);break;case yt:s=o.getSize(n);o.setSize(n,t);break}f?h.triggerRowChanged({sheet:h,sheetName:h._name,row:n,sheetArea:e,propertyName:r,oldValue:s}):h.triggerColumnChanged({sheet:h,sheetName:h._name,col:n,sheetArea:e,propertyName:r,oldValue:s})},l.prototype.getColumnResizable=function(n,t){return this._sheetModelManager.getColInfos(t).getResizeable(n)},l.prototype.setColumnResizable=function(n,t,i){this.setRowColInfo(n,t,"resizable",!1,i)},l.prototype.getRowHeight=function(n,t){var r=this,o,h,f,s,e;return((typeof t===u||t===i)&&(t=3),(t===3||t===2)&&((o=this._sheetModelManager.getDataModel(t),h=o&&o.getRowCount()||0,n<0||n>=h)||r.filterRowsVisibleInfo&&!r.filterRowsVisibleInfo.getRowVisible(n)||(f=r.rowRangeGroup,f&&!f._isEmpty()&&f.isCollapsed(n))))?0:(s=r.defaults.rowHeight,t===1&&(s=r.defaults.colHeaderRowHeight),e=r._sheetModelManager.getRowInfos(t).getSize(n),e||e===0?e:s)},l.prototype._getActualRowHeight=function(n,t){var f,r;return(typeof t===u||t===i)&&(t=3),f=this.defaults.rowHeight,t===1&&(f=this.defaults.colHeaderRowHeight),r=this._sheetModelManager.getRowInfos(t).getActualSize(n),r||r===0?r:f},l.prototype.setRowHeight=function(n,t,i){this.setRowColInfo(n,t,pt,!0,i);this._needSyncVScrollbarSize=!0;this.invalidate()},l.prototype.getRowVisible=function(n,t){var f=this,r;return((typeof t===u||t===i)&&(t=3),f.isRowFilterOut(n,t))?!1:(t===3||t===2)&&(r=f.rowRangeGroup,r&&!r._isEmpty()&&0<=n&&n<f.getRowCount(t)&&r.isCollapsed(n))?!1:this._sheetModelManager.getRowInfos(t).getVisible(n)},l.prototype.isRowFilterOut=function(n,t){var r=this;return((typeof t===u||t===i)&&(t=3),(t===3||t===2)&&r.filterRowsVisibleInfo&&!r.filterRowsVisibleInfo.getRowVisible(n))?!0:!1},l.prototype.hasRowFilterOut=function(){return this.filterRowsVisibleInfo&&this.filterRowsVisibleInfo.hasFilterOut()},l.prototype.setRowVisible=function(n,t,i){var r=this;r._bindToAutoRefresh(function(n,t,i){r.setRowColInfo(n,t,"isVisible",!0,i);r._needSyncVScrollbarSize=!0})(n,t,i)},l.prototype.getColumnWidth=function(n,t){var e=this,o,s,h,r,f;return((typeof t===u||t===i)&&(t=3),o=e.defaults.colWidth,t===2&&(o=e.defaults.rowHeaderColWidth),(t===3||t===1)&&((s=this._sheetModelManager.getDataModel(t),h=s&&s.getColumnCount()||0,n<0||n>=h)||(r=e.colRangeGroup,r&&!r._isEmpty()&&r.isCollapsed(n))))?0:(f=this._sheetModelManager.getColInfos(t).getSize(n),f||f===0?f:o)},l.prototype._getActualColumnWidth=function(n,t){var f,r;return(typeof t===u||t===i)&&(t=3),f=this.defaults.colWidth,t===2&&(f=this.defaults.rowHeaderColWidth),r=this._sheetModelManager.getColInfos(t).getActualSize(n),r||r===0?r:f},l.prototype.setColumnWidth=function(n,t,i){this.setRowColInfo(n,t,yt,!1,i);this._needSyncHScrollbarSize=!0;this.invalidate()},l.prototype.getColumnVisible=function(n,t){if((typeof t===u||t===i)&&(t=3),t===3||t===1){var r=this.colRangeGroup;if(r&&!r._isEmpty()&&0<=n&&n<this.getColumnCount(t)&&r.isCollapsed(n))return!1}return this._sheetModelManager.getColInfos(t).getVisible(n)},l.prototype.setColumnVisible=function(n,t,i){var r=this;r._bindToAutoRefresh(function(n,t,i){this.setRowColInfo(n,t,"isVisible",!1,i);r._needSyncHScrollbarSize=!0})(n,t,i)},l.prototype.zoom=function(n){var t=this;return arguments.length===0?t._zoomFactor:(n=parseFloat(n),isNaN(n)||!isFinite(n))?t:(n>4?n=4:n<.25&&(n=.25),t._bindToAutoRefresh(function(n){t.showEditingLocator&&t._showEditingLocator();t._zoomFactor=n;t._needSyncHScrollbarSize=!0;t._needSyncVScrollbarSize=!0})(n),t)},l.prototype.invalidateLayout=function(){var n=this,r=n._eventHandler;n._layoutModel=i;n._cachedGroupLayout=i;n._rowLayoutCache={colHeader:i,viewport:i,colFooter:i};n._colLayoutCache={rowHeader:i,viewport:i};n._filterButtonsModel=i;r&&t.FocusHelper.isActiveElement(n)&&r._updateValidationUI(n._activeRowIndex,n._activeColIndex);n._needSyncHScrollbarSize&&(n._syncHScrollbarSize(),n._needSyncHScrollbarSize=!1);n._needSyncVScrollbarSize&&(n._syncVScrollbarSize(),n._needSyncVScrollbarSize=!1);n._dirty=!0},l.prototype.invalidate=function(){var n=this;!n._paintSuspended&&n._layoutSuspended<=0&&(n.invalidateLayout(),n.repaint())},l.prototype.getViewportHeight=function(n){var t=this._getSheetLayout();return n===0?t.frozenHeight:n===1?t.viewportHeight:n===2?t.frozenTrailingHeight:0},l.prototype.getViewportWidth=function(n){var t=this._getSheetLayout();return n===0?t.frozenWidth:n===1?t.viewportWidth:n===2?t.frozenTrailingWidth:0},l.prototype.getViewportTopRow=function(n){var t=this;return n===0?0:n===1?e(t.frozenRowCount,t._scrollTopRow):n===2?e(t.frozenRowCount,t.getRowCount()-t._frozenTrailingRowCount):-1},l.prototype.getViewportBottomRow=function(n){var t=this,i;if(n===2)return t.getRowCount()-1;var u=t.getViewportTopRow(n),s=t.getViewportHeight(n),e=0,o=0,r=t.getRowCount()-t._frozenTrailingRowCount;for(n===0&&(r=f(t.frozenRowCount,r)),i=u;i<r&&e<s;i++,o++)e+=t._getZoomRowHeight(i);return u+o-1},l.prototype.getViewportLeftColumn=function(n){var t=this;return n===0?0:n===1?e(t.frozenColCount,t._scrollLeftCol):n===2?e(t.frozenColCount,t.getColumnCount()-t._frozenTrailingColCount):-1},l.prototype.getViewportRightColumn=function(n){var t=this,i;if(n===2)return t.getColumnCount()-1;var u=t.getViewportLeftColumn(n),s=t.getViewportWidth(n),e=0,o=0,r=t.getColumnCount()-t._frozenTrailingColCount;for(n===0&&(r=f(t.frozenColCount,r)),i=u;i<r&&o<s;i++,e++)o+=t._getZoomColumnWidth(i);return u+e-1},l.prototype.clearSelection=function(){var n=this;this._bindToAutoRefresh(function(){n._clearSelectionImp();n._setActiveCellImp(0,0);n.unSelectAllComments()})()},l.prototype._clearSelectionImp=function(){this._selectionModel.clear()},l.prototype._validationError=function(n,t,i){var r=this,f=r.getDataValidator(n,t),u={sheet:r,sheetName:r._name,row:n,col:t,validator:f,validationResult:0};return r.triggerValidationError(u),u.validationResult},l.prototype.getSpans=function(n,t){(t===r||t===i)&&(t=3);var u=this._getSpanModel(t);return u?u.getSpans(n):[]},l.prototype.getSpan=function(n,t,u){(u===r||u===i)&&(u=3);var f=this._getSpanModel(u);return f.find(n,t)},l.prototype.getCell=function(n,i,r){return new t.Cell(this,n,i,r)},l.prototype.getCells=function(n,t,i,r,u){var f=this.getCell(n,t,u);return f.row2=i,f.col2=r,f},l.prototype.getRow=function(n,i){return new t.Row(this,n,i)},l.prototype.getRows=function(n,t,i){var r=this.getRow(n,i);return r.index2=t,r},l.prototype.getColumn=function(n,i){return new t.Column(this,n,i)},l.prototype.getColumns=function(n,t,i){var r=this.getColumn(n,i);return r.index2=t,r},l.prototype.setBorder=function(n,t,u,f){var s,y;(f===r||f===i)&&(f=3);s=this;y=s.isPaintSuspended();s.isPaintSuspended(!0);try{var v=s._getActualRange(n,f),h=v.row,c=v.col,l=v.rowCount,a=v.colCount,e,o;if(u.left||u.all||u.outline)for(e=0;e<l;e++)s.getCell(h+e,c,f).borderLeft(t);if(u.top||u.all||u.outline)for(o=0;o<a;o++)s.getCell(h,c+o,f).borderTop(t);if(u.right||u.all||u.outline)for(e=0;e<l;e++)s.getCell(h+e,c+a-1,f).borderRight(t);if(u.bottom||u.all||u.outline)for(o=0;o<a;o++)s.getCell(h+l-1,c+o,f).borderBottom(t);if(u.innerHorizontal||u.all||u.inside)for(e=0;e<l-1;e++)for(o=0;o<a;o++)s.getCell(h+e,c+o,f).borderBottom(t),s.getCell(h+e+1,c+o,f).borderTop(t);if(u.innerVertical||u.all||u.inside)for(o=0;o<a-1;o++)for(e=0;e<l;e++)s.getCell(h+e,c+o,f).borderRight(t),s.getCell(h+e,c+o+1,f).borderLeft(t)}finally{s.isPaintSuspended(y)}},l.prototype.search=function(n){var r,e,v,u,o;if(!n||!t.features.search)return i;var f=this,y=n.sheetArea,s=n.searchString,h=n.searchTarget,l=n.searchFlags,p=f.getRowCount(y),w=f.getColumnCount(y);if(!s||h===0||p<=0&&w<=0)return new t.SearchResult;for(n.rowStart===-1&&(n.rowStart=0),n.columnStart===-1&&(n.columnStart=0),n.findBeginRow===-1&&(n.findBeginRow=n.rowStart),n.findBeginColumn===-1&&(n.findBeginColumn=n.columnStart),n.rowEnd===-1&&(n.rowEnd=p-1),n.columnEnd===-1&&(n.columnEnd=w-1),r=new t.SearchResult,e=new t.CellsEnumerator(f,n),(l&8)>0&&(e.isBlockRange=!0);e.moveNext();){var b=e.currentRow,k=e.currentColumn,a=e.current();if(a&&((h&1)>0&&(v=a.text(),f._trySearch(v,s,l)&&v!==""&&(r.searchFoundFlag|=1,r.foundString=v)),(h&8)>0&&(u=a.formula(),u=typeof u===c?u.toString():i,f._trySearch(u,s,l)&&u!==""&&(r.searchFoundFlag|=8,r.foundString=u)),(h&4)>0&&(o=a.tag(),typeof o===c&&f._trySearch(o,s,l)&&o!==""&&(r.searchFoundFlag|=4,r.foundString=o)),r.searchFoundFlag!==0))return r.foundRowIndex=b,r.foundColumnIndex=k,r}return new t.SearchResult},l.prototype.showCell=function(n,t,i,r){var u=this,h=u.getRowCount(),c=u.getColumnCount(),f,s;if(!(n<0)&&!(n>=h)&&!(t<0)&&!(t>=c)){var e=u._getColumnViewportIndex(t),o=u._getRowViewportIndex(n),l=u.getViewportTopRow(o),a=u.getViewportLeftColumn(e);e===1&&(t=u._getNewLeftColumn(t,r));o===1&&(n=u._getNewTopRow(n,i));f=!1;o===1&&n!==l&&(n>u._getLastVisualScrollRow()&&(n=u._getLastVisualScrollRow()),u._scrollTopRow=n,u._syncVScrollbarPosition(),f=!0);e===1&&t!==a&&(t>u._getLastVisualScrollColumn()&&(t=u._getLastVisualScrollColumn()),u._scrollLeftCol=t,u._syncHScollbarPosition(),f=!0);f&&(s=u.parent,s&&!s._scrollbarShowMax&&(u._needSyncHScrollbarSize=!0,u._needSyncVScrollbarSize=!0),u.invalidateLayout(),u.repaint())}},l.prototype._getRowViewportIndex=function(n){var t=this,i=1;return n<t.frozenRowCount?i=0:n>=t.getRowCount()-t._frozenTrailingRowCount&&(i=2),i},l.prototype._getColumnViewportIndex=function(n){var t=this,i=1;return n<t.frozenColCount?i=0:n>=t.getColumnCount()-t._frozenTrailingColCount&&(i=2),i},l.prototype._getNewLeftColumn=function(n,t){var i=this,u=i._zoomFactor,f=i._getColumnViewportIndex(n),e=i.getViewportLeftColumn(f),r;if(t!==0)if(t===1){for(r=s((i.getViewportWidth(f)-s(i.getColumnWidth(n)*u))/2);0<n;n--)if(r-=s(i.getColumnWidth(n-1)*u),r<0)break}else if(t===2){for(r=i.getViewportWidth(f)-s(i.getColumnWidth(n)*u);0<n;n--)if(r-=s(i.getColumnWidth(n-1)*u),r<0)break}else if(t===3&&n>=e)for(r=i.getViewportWidth(f)-s(i.getColumnWidth(n)*u);e<n;n--)if(r-=s(i.getColumnWidth(n-1)*u),r<0)break;return n},l.prototype._getNewTopRow=function(n,t){var i=this,u=i._zoomFactor,f=i._getRowViewportIndex(n),e=i.getViewportTopRow(f),r;if(t!==0)if(t===1){for(r=s((i.getViewportHeight(f)-s(i.getRowHeight(n)*u))/2);0<n;n--)if(r-=s(i.getRowHeight(n-1)*u),r<0)break}else if(t===2){for(r=i.getViewportHeight(f)-s(i.getRowHeight(n)*u);0<n;n--)if(r-=s(i.getRowHeight(n-1)*u),r<0)break}else if(t===3&&!(n<e||e===-1))for(r=i.getViewportHeight(f)-s(i.getRowHeight(n)*u);e<n;n--)if(r-=s(i.getRowHeight(n-1)*u),r<0)break;return n},l.prototype.showColumn=function(n,t){this.showCell(this._scrollTopRow,n,0,t)},l.prototype.showRow=function(n,t){this.showCell(n,this._scrollLeftCol,t,0)},l.prototype.bind=function(n,t,i){this._eventHandler.bind(n+a,t,i)},l.prototype.unbind=function(n,t){this._eventHandler.unbind(n+a,t)},l.prototype.unbindAll=function(){this._eventHandler.unbind(a)},l.prototype._bind=function(n,t,i){n.indexOf(".")>=0?this._eventHandler.bind(n,t,i):this._eventHandler.bind(n+d,t,i)},l.prototype._unbind=function(n,t){n.indexOf(".")>=0?this._eventHandler.unbind(n,t):this._eventHandler.unbind(n+d,t)},l.prototype._unbindAll=function(){this._eventHandler.unbind(d)},l.prototype.suspendEvent=function(){this._eventHandler._eventSuspended++},l.prototype.resumeEvent=function(){var n=this._eventHandler;n._eventSuspended--;n._eventSuspended<0&&(n._eventSuspended=0)},l.prototype.currentTheme=function(n){var i=this;return arguments.length===0?(i._currentTheme||i.resetCurrentTheme(),i._currentTheme):(typeof n===c&&(n=t.SpreadThemes.hasOwnProperty(n)?t.SpreadThemes[n]:new t.SpreadTheme(n)),i._bindToAutoRefresh(function(n){i._currentTheme=n;i._render._resetDefaultFont();i.clearStyleCache()})(n),i)},l.prototype.resetCurrentTheme=function(){this._currentTheme=this._getDefaultSpreadTheme()},l.prototype._getDefaultSpreadTheme=function(){var n=t.ThemeStyleHelper.getCssClassThemeStyle(""),i=parseInt(n.zIndex);return i>2007?t.SpreadThemes.Office:t.SpreadThemes.Office2007},l.prototype._createSheetModelManager=function(n){return new t.SheetModelManager(this,n)},l.prototype.reset=function(){var n=this;n._bindToAutoRefresh(function(){n.resetImp()})()},l.prototype.resetImp=function(){var n=this,u,r,f;n.defaults={rowHeight:n._defaultRowHeight,colWidth:n._defaultColWidth,rowHeaderColWidth:n._defaultRowHeaderColWidth,colHeaderRowHeight:n._defaultColHeaderRowHeight};n.gridline={color:t.ThemeStyleHelper.getCssClassThemeStyle("gc-gridlineColor").borderTopColor,showVerticalGridline:n._defaultShowVerticalGridline,showHorizontalGridline:n._defaultShowHorizontalGridline};n._rowLayoutCache={colHeader:i,viewport:i,colFooter:i};n._colLayoutCache={rowHeader:i,viewport:i};n._dragRect={};n._render=new t._SheetRender(n);u=i;n._eventHandler&&(u=n._eventHandler._elem);n._eventHandler=n._createEventHandler();n._eventHandler._elem=u;r=n.parent;r&&(f=r.getActiveSheet(),f&&n.getName()===f.getName()&&n._setHost(r._vp));n._composedDefaultStyle={};this._sheetModelManager=this._createSheetModelManager(this._name);n._selectionModel=new t._SelectionModel;n.resetCurrentTheme();n._allowDragDrop=!0;n._allowDragFill=!0;n._defaultDragFillType=5;n._showDragFillSmartTag=!0;n._protectionOption={};t.util.hasCalc()&&(n._vpSheetSource=new t.Calc.SheetSource(n));t.features.group&&(n.rowRangeGroup=new t.RangeGroup(n.getRowCount()),n.colRangeGroup=new t.RangeGroup(n.getColumnCount()),n.rowRangeGroup.groupChangeHandler=function(){n._invalidateVScrollbar()},n.colRangeGroup.groupChangeHandler=function(){n._invalidateHScrollbar()});n._showRowRangeGroup=!0;n._showColumnRangeGroup=!0;n.autoGenerateColumns=!0;n._rowFilter=i;t.features.filter&&(n.filterRowsVisibleInfo=new t.FilterRowsVisibleInfo);n._initDefaultKeyMap();t.features.floatingObject&&n._initDefaultFloatingObjectKeyMap();t.features.tableSlicer&&n._initDefaultSlicerKeyMap();t.features.comment&&n._initDefaultCommentKeyMap();n._scrollTopRow=0;n._scrollLeftCol=0;n.frozenRowCount=0;n.frozenColCount=0;n._frozenTrailingRowCount=0;n._frozenTrailingColCount=0;t.features.binding&&(n._bindingManager=new t._BindingManager(n));t.features.sparkline&&(n._sparklineGroupManager=new t.WorksheetSparklineGroupManager(n,n));t.features.table&&(n._tableManager=new t._SheetTableManager(n));t.features.floatingObject&&(n._floatingObjectArray=new t._FloatingObjectArray(n));n._namedStyles={};n._needSyncHScrollbarSize=!0;n._needSyncVScrollbarSize=!0;n._cutCopyIndicatorManager=new t.CutCopyIndicatorManager(n);n.invalidateLayout();n._clipBoardOptions=0;n._containerDiv=i;t.features.comment&&(n._commentManager=new t.CommentManager(n));t.features.tableSlicer&&(n._slicerCollection=new t.SlicerCollection(n))},l.prototype.initCalc=function(n){var i=this,r=i.calcService;(!r||n)&&t.util.hasCalc()&&(i.calcService=n?n:new t.Calc.CalcService,i._getSheetSource().setCalcService(i.calcService),i.calcService.initParserContext(i._getSheetSource()),r&&n?n.setSourceModel(i._getSheetSource(),r.getSourceModel(i._vpSheetSource)):i._vpCalcSheetModel=i.calcService.getSourceModel(i._vpSheetSource))},l.prototype.onAttached=function(t){if(t instanceof n.Sheets.Spread){var r=t,i=this,u=r.isPaintSuspended();i._paintSuspended!==u&&(i._paintSuspended=u);i.enableFormulaTextbox(r.enableFormulaTextbox());i.initCalc(r.calcService)}else i.initCalc();i.parent=t},l.prototype.onDettached=function(){},l.prototype._createEventHandler=function(){return new t._SheetEventHandler(this)},l.prototype.undoManager=function(){var n=this,i=n.parent;return n._undoManager||(n._undoManager=i&&i._undoManager?i._undoManager:new t._UndoManager(n,-1,n.allowUndo())),n._undoManager},l.prototype.clipBoardOptions=function(n){return arguments.length===0?this._clipBoardOptions:(this._clipBoardOptions=n,this)},l.prototype.doCommand=function(n){this._doCommand(n)},l.prototype.copyTo=function(n,t,i,r,u,f,e){this.copyToCore(n,t,i,r,u,f,e)},l.prototype.copyToCore=function(n,t,i,r,u,f,e,s){var h=this,c=h.isPaintSuspended();h.isPaintSuspended(!0);h.suspendEvent();o.copyTo(h,n,t,h,i,r,u,f,e,s);h.resumeEvent();h.isPaintSuspended(c)},l.prototype.moveTo=function(n,t,i,r,u,f,e){var s=this,h=s.isPaintSuspended();s.isPaintSuspended(!0);s.suspendEvent();o.moveTo(s,n,t,s,i,r,u,f,e);s.resumeEvent();s.isPaintSuspended(h)},l.prototype.setCsv=function(n,t,i,r,u,f){var e=this,s=e.isPaintSuspended();e.isPaintSuspended(!0);e.suspendEvent();o.setRangeText(e,n,t,i,r,u,'"',f);e.resumeEvent();e.isPaintSuspended(s)},l.prototype.getCsv=function(n,t,i,r,u,f){return o.getRangeText(this,n,i,t,r,u,f,'"',!0,0)},l.prototype.canUserDragDrop=function(n){var i=this,t=i.parent;return arguments.length===0?(t&&t.canUserDragDrop&&(i._allowDragDrop=t.canUserDragDrop()),i._allowDragDrop):(t&&t.canUserDragDrop?t.canUserDragDrop(n):i._allowDragDrop=n,i)},l.prototype.canUserDragFill=function(n){var i=this,r=i.parent,u;return arguments.length===0?t.features.fill?(r&&r.canUserDragFill&&(i._allowDragFill=r.canUserDragFill()),i._allowDragFill):!1:(u=i.canUserDragFill(),u!==n&&(r&&r.canUserDragFill?r.canUserDragFill(n):i._allowDragFill=n,i.getSelections().length!==1||i._paintSuspended||i._render.repaintSelection(i.getSelections()[0])),i)},l.prototype.showDragFillSmartTag=function(n){var t=this,i=t.parent,r;return arguments.length===0?(i&&i.showDragFillSmartTag&&(t._showDragFillSmartTag=i.showDragFillSmartTag()),t._showDragFillSmartTag):(r=t.showDragFillSmartTag(),typeof n=="boolean"&&r!==n&&(i&&i.showDragFillSmartTag?i.showDragFillSmartTag(n):t._showDragFillSmartTag=n),t)},l.prototype.defaultDragFillType=function(n){var i=this,u=i.parent,f;return arguments.length===0?(u&&u.defaultDragFillType&&(i._defaultDragFillType=u.defaultDragFillType()),i._defaultDragFillType):(f=i.defaultDragFillType(),t.AutoFillType[n]!==r&&n!==4&&n!==f&&(u&&u.defaultDragFillType?u.defaultDragFillType(n):i._defaultDragFillType=n),i)},l.prototype.isColumnBound=function(n){var i=this,r,t;return n<0||n>=i.getColumnCount()?!1:(r=i.getDataSource(),r)?(t=this._sheetModelManager.getColInfos()._getItem(n),!!(t&&t.name)):!1},l.prototype.getDataColumnName=function(n){var r=this,u,t;return n<0||n>=r.getColumnCount()?i:(u=r.getDataSource(),u)?(t=this._sheetModelManager.getColInfos()._getItem(n),t&&(t.displayName||t.name)):i},l.prototype.getSparkline=function(n,t){if(!this._sparklineGroupManager)return i;var r=3,u=this._sheetModelManager.getDataModel(r);return u.getSparkline(n,t)},l.prototype.setSparkline=function(n,u,f,e,o,s,h,c){var l=this,a=l._sparklineGroupManager;return a?l._bindToAutoRefresh(function(n,u,f,e,o,s,h,c){var w=f,v=new t.Sparkline(n,u,w,e,o,s),y,p;return h&&c!==r&&c!==i&&(v.dateAxisData(h),v.dateAxisOrientation(c),v.group().displayDateAxis=!0),y=l.getSparkline(n,u),l.removeSparkline(n,u),p=l._getModel(),p.setSparkline(n,u,v),a.add(v.group()),l._raiseCellChanged("sparkline",n,u,y,v,3),v})(n,u,f,e,o,s,h,c):i},l.prototype.removeSparkline=function(n,t){var r=this,u=r._sparklineGroupManager;u&&r._bindToAutoRefresh(function(n,t){var s=3,o=r._getModel(s),e=o.getSparkline(n,t),f;e&&(f=e.group(),f.remove(e),f.count()<=0&&u.remove(f));o.setSparkline(n,t,i)})(n,t)},l.prototype.groupSparkline=function(n){var t=this._sparklineGroupManager,r;return t?(r=this,this._bindToAutoRefresh(function(n){for(var r,f,u=i,e=0;e<n.length;e++)if(r=n[e],r){if(!u){u=r.group();continue}f=r.group();f.remove(r);u.add(r);f.count()<=0&&t.remove(f)}return u})(n)):i},l.prototype.ungroupSparkline=function(n){var i=this,t=i._sparklineGroupManager;t&&i._bindToAutoRefresh(function(n){var i,r,u,f;if(n){for(i=[],i=i.concat(n._innerList),r=0;r<i.length;r++)u=i[r],u&&(n.remove(u),f=n.clone(),f.add(u),t.add(f));t.remove(n)}})(n)},l.prototype.fillAuto=function(n,i,r){if(t.features.fill){if(!i)throw new Error(t.SR.Exp_RangeIsNull);var u=this;u._checkFillRange(n,i,r)&&u._bindToAutoRefresh(function(n,i,r){n&&(u._eventHandler._dragFillStartRange=n);var f=new t.FillImp(u);f.fillAuto(i,r)})(n,i,r)}},l.prototype.fillAutobyDirection=function(n,r,u){if(t.features.fill){if(!r)throw new Error(t.SR.Exp_RangeIsNull);var f=this;f._checkFillRange(n,r,i,u)&&f._bindToAutoRefresh(function(n,i,r){n&&(f._eventHandler._dragFillStartRange=n);var u=new t.FillImp(f);u.fillAutobyDirection(i,r)})(n,r,u)}},l.prototype.fillLinear=function(n,i,r,u,f){if(t.features.fill){if(!i)throw new Error(t.SR.Exp_RangeIsNull);var e=this;e._checkFillRange(n,i,r)&&e._bindToAutoRefresh(function(n,i,r,u,f){n&&(e._eventHandler._dragFillStartRange=n);var o=new t.FillImp(e);o.fillLinear(i,r,u,f)})(n,i,r,u,f)}},l.prototype.fillGrowth=function(n,i,r,u,f){if(t.features.fill){if(!i)throw new Error(t.SR.Exp_RangeIsNull);var e=this;e._checkFillRange(n,i,r)&&e._bindToAutoRefresh(function(n,i,r,u,f){n&&(e._eventHandler._dragFillStartRange=n);var o=new t.FillImp(e);o.fillGrowth(i,r,u,f)})(n,i,r,u,f)}},l.prototype.fillDate=function(n,u,f,e,o,s){if(t.features.fill){if(!u)throw new Error(t.SR.Exp_RangeIsNull);var h=this;h._checkFillRange(n,u,f)&&h._bindToAutoRefresh(function(n,u,f,e,o,s){n&&(h._eventHandler._dragFillStartRange=n);var l=new t.FillImp(h),c=i;s!==r&&s!==i&&(c=new t._DateTimeHelper(s).toOADate());l.fillDate(u,f,e,o,c)})(n,u,f,e,o,s)}},l.prototype._checkFillRange=function(n,t,u,f){if(!n||!t||!t.containsRange(n))return!1;if(u!==r&&u!==i)if(u===1){if(n.row===t.row&&n.rowCount===t.rowCount)return!0}else if(u===0&&n.col===t.col&&n.colCount===t.colCount)return!0;if(f!==r&&f!==i)if(f===2||f===3){if(n.col===t.col&&n.colCount===t.colCount)return!0}else if((f===0||f===1)&&n.row===t.row&&n.rowCount===t.rowCount)return!0;return!1},l.prototype.clear=function(n,t,i,r,u,f){this.clearCore(n,t,i,r,u,f)},l.prototype._checkArrayFormula=function(n,i,r,u,f){return(f=f===undefined?!0:!1,f&&this._hasPartArrayFormulas(n,i,r,u)||!f&&this._hasArrayFormula(n,i,r,u))?(this._raiseInvalidOperation(4,t.SR.Exp_ChangePartOfArray),!1):!0},l.prototype.clearCore=function(n,t,u,f,e,o,s){var h=this;h._bindToAutoRefresh(function(n,t,u,f,e,o){var c,a,l,v,d,it,w,g,y,p,nt,b,tt;h.suspendCalcService();try{if(d=3,e===r||e===i||e===d){if(!h._checkArrayFormula(n,t,u,f))return!1;if(o&1){if(h.getDataSource()){for(h.suspendEvent(),c=n;c<n+u;c++)if(!s||!h.isRowFilterOut(c))for(a=t;a<t+f;a++)h.setValue(c,a,i,e);h.resumeEvent()}h._conditionalFormats&&h._conditionalFormats._clearCache();h._rowFilter&&h._rowFilter.range&&h._rowFilter._clear(n,t,u,f)}if(o&16&&h._sparklineGroupManager&&h._sparklineGroupManager.clear(n,t,u,f),h._tableManager){it=h._tableManager.clear(n,t,u,f,o);h.onTableRemoved(it)}o&4&&h._commentManager&&h._commentManager.clear(n,t,u,f)}if(w=h._getModel(e),g=h._getCalcModel(e),w){for(c=n===-1?0:n,y=n===-1?w.getRowCount():u,a=t===-1?0:t,p=t===-1?w.getColumnCount():f,nt=[],b=c;b<y;b++)s&&h.isRowFilterOut(b)&&nt.push(b);if(w.clear(c,a,y,p,o,nt),g&&o&1&&(h._getCalcModel().unlinkCellExpression(c,a,y,p),g.clear(c,a,y,p)),o&8&&!(n>=0&&t>=0))if(t>=0)for(v=0;v<p;v++)h.setTag(-1,a+v,i,e);else if(n>=0)for(l=0;l<y;l++)s&&h.isRowFilterOut(c+l)||h.setTag(c+l,-1,i,e);else h.setTag(-1,-1,i,e);if(o&2&&!(n>=0&&t>=0))if(t>=0)for(v=0;v<p;v++)h.setStyle(-1,a+v,i,e);else if(n>=0)for(l=0;l<y;l++)s&&h.isRowFilterOut(c+l)||h.setStyle(c+l,-1,i,e);else h.setStyle(-1,-1,i,e);if(o&32&&!(n>=0&&t>=0))if(t>=0)for(v=0;v<p;v++)h.setColumnVisible(a+v,!0,e),h.setColumnResizable(a+v,!0,e),h.setColumnWidth(a+v,e===2?h.defaults.rowHeaderColWidth:h.defaults.colWidth,e);else if(n>=0)for(l=0;l<y;l++)s&&h.isRowFilterOut(c+l)||(h.setRowVisible(c+l,!0,e),h.setRowResizable(c+l,!0,e),h.setRowHeight(c+l,e===1?h.defaults.colHeaderRowHeight:h.defaults.rowHeight,e));else{for(v=0;v<p;v++)h.setColumnVisible(a+v,!0,e),h.setColumnResizable(a+v,!0,e),h.setColumnWidth(a+v,e===2?h.defaults.rowHeaderColWidth:h.defaults.colWidth,e);for(l=0;l<y;l++)s&&h.isRowFilterOut(c+l)||(h.setRowVisible(c+l,!0,e),h.setRowResizable(c+l,!0,e),h.setRowHeight(c+l,e===1?h.defaults.colHeaderRowHeight:h.defaults.rowHeight,e))}for(l=0;l<y;l++)for(v=0;v<p;v++)c=n+l,a=t+v,o&1&&h._raiseCellChanged(vt,c,a,r,i,e),o&8&&h._raiseCellChanged(k,c,a,r,i,e),o&2&&h._raiseCellChanged("style",c,a,r,i,e),o&16&&h._raiseCellChanged("sparkline",c,a,r,i,e),o&4&&h._raiseCellChanged("comment",c,a,r,i,e),o&32&&h._raiseCellChanged("axis",c,a,r,i,e),o&64&&h._raiseCellChanged("bindingPath",c,a,r,i,e)}(e===r||e===i||e===d)&&(o&1)==1&&(tt=h._getCalcModel(),tt&&tt._addCellsToDirty(n,t,u,f))}finally{h.resumeCalcService(!1)}})(n,t,u,f,e,o)},l.prototype.getConditionalFormats=function(){var n=this;return!n._conditionalFormats&&t.features.conditionalFormat&&(n._conditionalFormats=new t.ConditionalFormats(n)),n._conditionalFormats},l.prototype.rowFilter=function(n){var t=this;return arguments.length===0?t._rowFilter:t._bindToAutoRefresh(function(n){return t._rowFilter&&t._rowFilter.reset(),t._rowFilter=n,t._rowFilter?t._rowFilter.sheet=t:(t.refreshObjectsAboveSheet(),t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.reset()),t})(n)},l.prototype.autoFitColumn=function(n){if(!(n<0)&&!(n>=this.getColumnCount())){var i=new t.UndoRedo.ColumnAutoFitUndoAction(this,[{col:n}],!1);i.execute(this)}},l.prototype.autoFitRow=function(n){if(!(n<0)&&!(n>=this.getRowCount())){var i=new t.UndoRedo.RowAutoFitUndoAction(this,[{row:n}],!1);i.execute(this)}},l.prototype.setGridlineOptions=function(n){var t=this;t._bindToAutoRefresh(function(n){if(n){t.gridline||(t.gridline={});var u=t.gridline;n.color&&(u.color=n.color);n.showVerticalGridline!==i&&n.showVerticalGridline!==r&&(u.showVerticalGridline=n.showVerticalGridline);n.showHorizontalGridline!==i&&n.showHorizontalGridline!==r&&(u.showHorizontalGridline=n.showHorizontalGridline)}})(n)},l.prototype.getGridlineOptions=function(){var i=this,t,n;return i.gridline||(i.gridline={}),t=i.gridline,n={},n.color=t.color,n.showVerticalGridline=t.showVerticalGridline,n.showHorizontalGridline=t.showHorizontalGridline,n},l.prototype.getFrozenRowCount=function(){return this.frozenRowCount},l.prototype.getFrozenColumnCount=function(){return this.frozenColCount},l.prototype.getFrozenTrailingRowCount=function(){return this._frozenTrailingRowCount},l.prototype.getFrozenTrailingColumnCount=function(){return this._frozenTrailingColCount},l.prototype.setRowHeaderVisible=function(n){var t=this;this._bindToAutoRefresh(function(i){t.rowHeaderVisible=n})(n)},l.prototype.getRowHeaderVisible=function(){return this.rowHeaderVisible},l.prototype.setColumnHeaderVisible=function(n){var t=this;this._bindToAutoRefresh(function(i){t.colHeaderVisible=n})(n)},l.prototype.getColumnHeaderVisible=function(){return this.colHeaderVisible},l.prototype.setRowHeaderAutoText=function(n){var t=this;this._bindToAutoRefresh(function(n){t.rowHeaderAutoText=n})(n)},l.prototype.getRowHeaderAutoText=function(){return this.rowHeaderAutoText},l.prototype.setColumnHeaderAutoText=function(n){var t=this;this._bindToAutoRefresh(function(n){t.colHeaderAutoText=n})(n)},l.prototype.getColumnHeaderAutoText=function(){return this.colHeaderAutoText},l.prototype.setRowHeaderAutoTextIndex=function(n){var t=this;this._bindToAutoRefresh(function(n){t.rowHeaderAutoTextIndex=n})(n)},l.prototype.getRowHeaderAutoTextIndex=function(){return this.rowHeaderAutoTextIndex},l.prototype.setColumnHeaderAutoTextIndex=function(n){var t=this;this._bindToAutoRefresh(function(n){t.colHeaderAutoTextIndex=n})(n)},l.prototype.getColumnHeaderAutoTextIndex=function(){return this.colHeaderAutoTextIndex},l.prototype.setIsProtected=function(n){var t=this;this._bindToAutoRefresh(function(n){t.isProtected=n;t.undoManager().clear();t.adjustActiveCellToSelectable()})(n)},l.prototype.getIsProtected=function(){return this.isProtected},l.prototype.protectionOption=function(n){var t=this;return arguments.length===0?t._protectionOption:(t._bindToAutoRefresh(function(n){t._protectionOption=n;t.adjustActiveCellToSelectable()})(n),t)},l.prototype.adjustActiveCellToSelectable=function(){var n=this,r=n.protectionOption(),t,i;n.isProtected&&(r.allowSelectLockedCells===!1||r.allowSelectUnlockedCells===!1)&&(t=n._activeRowIndex,i=n._activeColIndex,n.canSelect(t,i)||(n._clearSelectionImp(),n._moveActiveCellRight(t,i,!0),n.moveActiveCellEnd(4,t,i)))},l.prototype.setArray=function(n,i,r,u){var f=this,e=f.getRowCount(),o=f.getColumnCount(),s;if(r&&0<=n&&n<e&&0<=i&&i<o){f.suspendCalcService();s=f.isPaintSuspended();f.isPaintSuspended(!0);try{t.GC$.each(r,function(r,s){if(s instanceof Array)t.GC$.each(s,function(t,s){var h=n+r,c=i+t;h<e&&c<o&&(u?f.setFormula(h,c,s):f.setValue(h,c,s,3,!0))});else{var h=n+r,c=i;h<e&&c<o&&(u?f.setFormula(h,c,s):f.setValue(h,c,s,3,!0))}})}finally{f.resumeCalcService();f.isPaintSuspended(s)}}},l.prototype.getArray=function(n,t,i,r,u){var o=this,s=[],h=o.getRowCount(),c=o.getColumnCount(),f,e;if(0<=n&&n<h&&0<=t&&t<c)for(n+i>h&&(i=h-n),t+r>c&&(r=c-t),f=0;f<i;f++)for(s[f]=[],e=0;e<r;e++)s[f][e]=u?o.getFormula(n+f,t+e):o.getValue(n+f,t+e);return s},l.prototype.showRowRangeGroup=function(n){var i=this;return arguments.length===0?t.features.group?i._showRowRangeGroup:!1:(i._showRowRangeGroup!==n&&i._bindToAutoRefresh(function(n){i._showRowRangeGroup=n})(n),i)},l.prototype.showColumnRangeGroup=function(n){var i=this;return arguments.length===0?t.features.group?i._showColumnRangeGroup:!1:(i._showColumnRangeGroup!==n&&i._bindToAutoRefresh(function(n){i._showColumnRangeGroup=n})(n),i)},l.prototype.addTable=function(n,u,f,e,o,s){var h=this,c=h._tableManager,l;if(!c)return i;h._checkCanAddTable(n,u,f,e,o,!0);s===r&&(s=t.TableStyles.medium2());l=h.isPaintSuspended();h.isPaintSuspended(!0);try{return c.add(h._createTable(n,u,f,e,o,s))}finally{h.isPaintSuspended(l)}},l.prototype.addTableByDataSource=function(n,u,f,e,o){var s=this,v=s._tableManager,c,h,l,y,a;if(!v||!t.features.binding)return i;if(!e)throw new Error(t.SR.Exp_TableDataSourceNullError);s._checkCanAddTable(n,u,f,1,1,!0);c=new t._BindingManager;c.bind(e);h=c.getRowCount();l=c.getColumnCount();h=h+1;u+h>s.getRowCount()&&s.setRowCount(u+h);f+l>s.getColumnCount()&&s.setColumnCount(f+l);s._checkCanAddTable(n,u,f,h,l,!0);o===r&&(o=t.TableStyles.medium2());y=s.isPaintSuspended();s.isPaintSuspended(!0);try{return a=v.add(s._createTable(n,u,f,h,l,o)),a._bind(c),s.clearPendingChanges(),a}finally{s.isPaintSuspended(y)}},l.prototype._createTable=function(n,i,r,u,f,e){return new t.SheetTable(n,i,r,u,f,e)},l.prototype.findTable=function(n,t){var r=this._tableManager;return r?r.find(n,t):i},l.prototype.findTableByName=function(n){var t=this._tableManager,r=i,u,f;if(t&&(r=t.findByName(n)),!r&&(u=this.parent&&this.parent.sheets,u))for(f=0;f<u.length;f++)if(t=u[f]._tableManager,t&&(r=t.findByName(n),r))break;return r},l.prototype.removeTable=function(n){var t=this,i=t._tableManager,r;if(!n||!i)return t;r=t.isPaintSuspended();t.isPaintSuspended(!0);t.suspendCalcService();try{if(n=i.remove(n),n)this.onTableRemoved([n]);return t}finally{t.resumeCalcService(!1);t.isPaintSuspended(r)}},l.prototype.onTableRemoved=function(n){n&&o.adjustNamesOnRemoveTables(this,n)},l.prototype.removeTableByName=function(n){var t=this.findTableByName(n);return t&&this.removeTable(t),this},l.prototype.moveTable=function(n,t,i){var r=this,f=r._tableManager,o;if(!f||!n||t<0||i<0)return r;var e=n.range(),s=e.rowCount,h=e.colCount,u=f.findByRange(t,i,s,h);if(u)if(u.length>1)return r;else if(u.length===1&&u[0]!==n)return r;o=r.isPaintSuspended();r.isPaintSuspended(!0);try{return n._moveTo(t,i),r}finally{r.isPaintSuspended(o)}},l.prototype.moveTableByName=function(n,t,i){var r=this.findTableByName(n);return r&&this.moveTable(r,t,i),this},l.prototype.resizeTable=function(n,i){var u=this,e=u._tableManager,f,s;if(!e||!n)return u;var o=n.range(),h=o.row,c=o.col,r=i;if((arguments.length===3&&(r=new t.Range(h,c,arguments[1],arguments[2])),!r||r.rowCount<0||r.colCount<0)||(f=e.findByRange(r.row,r.col,r.rowCount,r.colCount),f&&f.length>1))return u;s=u.isPaintSuspended();u.isPaintSuspended(!0);try{return n._resize(r),u}finally{u.isPaintSuspended(s)}},l.prototype.resizeTableByName=function(n,i){var r=this.findTableByName(n),u,f;return r&&(u=r.range(),f=i,arguments.length===3&&(f=new t.Range(u.row,u.col,arguments[1],arguments[2])),this.resizeTable(r,f)),this},l.prototype.getTables=function(){var n=this._tableManager;if(n)return n.getTables()},l.prototype.clearTables=function(){var n=this,t=n._tableManager,i,r;if(t){i=n.isPaintSuspended();n.isPaintSuspended(!0);n.suspendCalcService();try{r=t.getTables();t.clearTables();n.onTableRemoved(r)}finally{n.resumeCalcService(!1);n.isPaintSuspended(i)}}return n},l.prototype.selectionBackColor=function(n){var i=this,r;return arguments.length===0?i._selectionBackColor?i._selectionBackColor:(r=t.ThemeStyleHelper.getCssClassThemeStyle("gc-selection"),r.backgroundColor):i._bindToAutoRefresh(function(n){return n&&(i._selectionBackColor=n),i})(n)},l.prototype.selectionBorderColor=function(n){var i=this,r;return arguments.length===0?i._selectionBorderColor?i._selectionBorderColor:(r=t.ThemeStyleHelper.getCssClassThemeStyle("gc-selection"),r.borderTopColor):i._bindToAutoRefresh(function(n){return n&&(i._selectionBorderColor=n),i})(n)},l.prototype._addTableInternal=function(n){var i=this._tableManager,t;i&&(t=n.range(),this._checkCanAddTable(n.name(),t.row,t.col,t.rowCount,t.colCount))&&i.add(n)},l.prototype._checkCanAddTable=function(n,i,r,u,f,e){var o=this,s,h,c;if(!n){if(e)throw new Error(t.SR.Exp_TableEmptyNameError);return!1}if(i<0||u<1||i+u>o.getRowCount()){if(e)throw new Error(t.SR.Exp_TableInvalidRow);return!1}if(r<0||f<1||r+f>o.getColumnCount()){if(e)throw new Error(t.SR.Exp_TableInvalidColumn);return!1}if(o._hasTable(i,r,u,f)){if(e)throw new Error(t.SR.Exp_TableIntersectError);return!1}if(o.parent&&o.parent._findTable(n)||!o.parent&&o.findTableByName(n)){if(e)throw new Error(t.SR.Exp_TableHasSameNameError);return!1}if(s=o._getsArrayFormulas(i,r,u,f),s&&s.ranges&&s.ranges.length>0)for(h=0;h<s.ranges.length;h++)if(c=s.ranges[h],c.rowCount>1||c.colCount>1){if(e)throw new Error(t.SR.Exp_ArrayFormulaTable);return!1}return!0},l.prototype.setComment=function(n,i,r){var u,s;if(t.features.comment){var f=this,e=this._commentManager,o=f.getSpan(n,i);o&&(o.row!==n||o.col!==i)&&r||(u=f.getComment(n,i),u&&e&&e.containsComment(u)&&e.removeComment(u),s=f._getModel(3),s.setComment(n,i,r),e.addComment(n,i,r),f._raiseCellChanged("comment",n,i,u,r,3))}},l.prototype.getComment=function(n,r){if(!t.features.comment)return i;var u=this._getModel(3);return u.getComment(n,r)},l.prototype.getComments=function(){if(t.features.comment)return this._commentManager.getCommentList()},l.prototype.setTag=function(n,t,r,f){var e,s,l,a,h,c;if((typeof f===u||f===i)&&(f=3),e=this,s=e._getModel(f),s){if(l=s.getRowCount(),a=s.getColumnCount(),n<-1||n>=l||t<-1||t>=a)return;r=o.tryConvertDateToOADate(r);c=e._eventHandler._eventSuspended>0;c||(h=s.getTag(n,t));s.setTag(n,t,r);c||h===r||(n!==-1&&t!==-1?e._raiseCellChanged(k,n,t,h,r,f):n!==-1&&t===-1?e.triggerRowChanged({sheet:e,sheetName:e._name,row:n,sheetArea:f,propertyName:k,oldValue:h}):n===-1&&t!==-1&&e.triggerColumnChanged({sheet:e,sheetName:e._name,col:t,sheetArea:f,propertyName:k,oldValue:h}))}},l.prototype.getTag=function(n,t,u){var s=this,f,e;return((u===r||u===i)&&(u=3),f=s._getModel(u),f)?(e=f.getTag(n,t),o.tryConvertOADateToDate(e)):i},l.prototype.tag=function(n){var t=this;return arguments.length===0?o.tryConvertOADateToDate(t._tag):(t._tag=o.tryConvertDateToOADate(n),t)},l.prototype.getParent=function(){return this.parent},l.prototype.addSlicer=function(n,i,r,u){var e=this.findTableByName(i),f;return!e||e.getColumnIndexInTable(r)===-1?null:(f=new t.Slicer(n,e,r),u&&f.style(u),this.addSlicerInternal(f),f)},l.prototype.addSlicerInternal=function(n){var t=this,i=t._slicerCollection;n&&i&&(i.addSlicer(n),t.addFloatingObject(n))},l.prototype.removeSlicer=function(n){var i=this,t=i._slicerCollection;t&&n&&(t.removeSlicer(t.getSlicer(n)),i.removeFloatingObject(n))},l.prototype.getSlicer=function(n){var t=this;if(t._slicerCollection&&n)return t._slicerCollection.getSlicer(n)},l.prototype.getSlicers=function(){return this._slicerCollection?this._slicerCollection.getSlicers():[]},l.prototype.getSlicersFromTable=function(n){return n?this._slicerCollection?this._slicerCollection.getSlicers(n):[]:[]},l.prototype.printInfo=function(n){var i=this;return arguments.length===0?(!i._printInfo&&t.features.print&&(i._printInfo=new t.PrintInfo),i._printInfo):(i._printInfo=n,i)},l.prototype.getRowPageBreak=function(n){return this._sheetModelManager.getRowInfos(3).getPageBreak(n)},l.prototype.setRowPageBreak=function(n,t){this.setRowColInfo(n,t,"pageBreak",!0,3)},l.prototype.getColumnPageBreak=function(n){return this._sheetModelManager.getColInfos(3).getPageBreak(n)},l.prototype.setColumnPageBreak=function(n,t){this.setRowColInfo(n,t,"pageBreak",!1)},l.prototype._bindToAutoRefresh=function(n,t){return t||(t=this),function(){var i=n.apply(t,arguments);return t._paintSuspended||(typeof t.invalidateLayout===v&&t.invalidateLayout(),typeof t.repaint===v&&t.repaint()),i}},l.prototype._isValidSheetName=function(n){var t,u,r,e,i,f;if(!n||n==="")return!1;for(i=0;i<n.length;i++)if(t=n.charAt(i),t==="*"||t===":"||t==="["||t==="]"||t==="?"||t==="\\"||t==="/")return!1;if(u=this,r=u.parent,!r)return!0;for(e=r.sheets.length,i=0;i<e;i++)if(f=r.sheets[i],f!==u&&n===f._name)return!1;return!0},l.prototype._init=function(n){this._name=n;this.setBounds(new t.Rect(0,0,0,0));this.resetImp()},l.prototype.applyOptions=function(n){var f,e,r;if(n){var t=this,i=t.defaults,u=t.gridline;typeof n.name===c&&n.name.length>0&&(t._name=n.name);n.data&&t.setDataSource(n.data);typeof n.defaultRowHeight===h&&(i.rowHeight=n.defaultRowHeight);typeof n.defaultColWidth===h&&(i.colWidth=n.defaultColWidth);typeof n.defaultRowHeaderColWidth===h&&(i.rowHeaderColWidth=n.defaultRowHeaderColWidth);typeof n.defaultColHeaderRowHeight===h&&(i.colHeaderRowHeight=n.defaultColHeaderRowHeight);typeof n.rowCount===h&&t.setRowCount(n.rowCount);typeof n.colCount===h&&t.setColumnCount(n.colCount);typeof n.frozenRowCount===h&&(t.frozenRowCount=n.frozenRowCount);typeof n.frozenColCount===h&&(t.frozenColCount=n.frozenColCount);typeof n.frozenTrailingRowCount===h&&(t._frozenTrailingRowCount=n.frozenTrailingRowCount);typeof n.frozenTrailingColCount===h&&(t._frozenTrailingColCount=n.frozenTrailingColCount);n.gridlineColor&&(u.color=n.gridlineColor);typeof n.showVerticalGridline===y&&(u.showVerticalGridline=n.showVerticalGridline);typeof n.showHorizontalGridline===y&&(u.showHorizontalGridline=n.showHorizontalGridline);n.borderColor&&(t.borderColor=n.borderColor);typeof n.borderWidth===h&&(t.borderWidth=n.borderWidth);typeof n._zoomFactor===h&&(t._zoomFactor=n._zoomFactor);typeof n.rowHeaderVisible===y&&(t.rowHeaderVisible=n.rowHeaderVisible);typeof n.colHeaderVisible===y&&(t.colHeaderVisible=n.colHeaderVisible);typeof n.autoGenerateColumns===y&&(t.autoGenerateColumns=n.autoGenerateColumns);n.rowHeaderAutoText&&(t.rowHeaderAutoText=n.rowHeaderAutoText);n.colHeaderAutoText&&(t.colHeaderAutoText=n.colHeaderAutoText);typeof n._activeRowIndex===h&&(f=n._activeRowIndex);typeof n._activeColIndex===h&&(e=n._activeColIndex);t._setActiveCellCore(f,e);typeof n._allowCellOverflow===y&&(t._allowCellOverflow=n._allowCellOverflow);typeof n.isProtected===y&&(t.isProtected=n.isProtected);typeof n.allowUndo===y&&t.allowUndo(n.allowUndo);r=n.columns;r&&r.length>0&&(t.autoGenerateColumns=!1,t.bindColumns(r))}},l.prototype._initDefaultFloatingObjectKeyMap=function(){var u=t.util.isMacOS(),i=!u,r=u,n=this;n.addFloatingObjectKeyMap(27,!1,!1,!1,!1,t.SpreadActions.unSelectAllFloatingObjects);n.addFloatingObjectKeyMap(46,!1,!1,!1,!1,t.SpreadActions.deleteFloatingObject);n.addFloatingObjectKeyMap(9,!1,!1,!1,!1,t.SpreadActions.navigationNextFloatingObject);n.addFloatingObjectKeyMap(9,!1,!0,!1,!1,t.SpreadActions.navigationPreviousFloatingObject);n.addFloatingObjectKeyMap(88,i,!1,!1,r,t.SpreadActions.clipboardCutFloatingObject);n.addFloatingObjectKeyMap(67,i,!1,!1,r,t.SpreadActions.clipboardCopyFloatingObject);n.addFloatingObjectKeyMap(86,i,!1,!1,r,t.SpreadActions.clipboardPasteFloatingObject);n.addFloatingObjectKeyMap(65,i,!1,!1,r,t.SpreadActions.selectAllFloatingObjects);n.addFloatingObjectKeyMap(38,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectUp);n.addFloatingObjectKeyMap(40,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectDown);n.addFloatingObjectKeyMap(37,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectLeft);n.addFloatingObjectKeyMap(39,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectRight)},l.prototype._initDefaultSlicerKeyMap=function(){var n=this;n.addSlicerKeyMap(67,!1,!1,!0,!1,t.SpreadActions.unfilterSlicer)},l.prototype._initDefaultCommentKeyMap=function(){var i=t.util.isMacOS(),r=!i,u=i,n=this;n.addCommentKeyMap(46,!1,!1,!1,!1,t.SpreadActions.deleteComment);n.addCommentKeyMap(27,!1,!1,!1,!1,t.SpreadActions.deactivateComment);n.addCommentKeyMap(38,!1,!1,!1,!1,t.SpreadActions.moveCommentUp);n.addCommentKeyMap(40,!1,!1,!1,!1,t.SpreadActions.moveCommentDown);n.addCommentKeyMap(37,!1,!1,!1,!1,t.SpreadActions.moveCommentLeft);n.addCommentKeyMap(39,!1,!1,!1,!1,t.SpreadActions.moveCommentRight)},l.prototype._initDefaultKeyMap=function(){var u=t.util.isMacOS(),i=!u,r=u,n=this;n.addKeyMap(37,!1,!1,!1,!1,t.SpreadActions.navigationLeft);n.addKeyMap(39,!1,!1,!1,!1,t.SpreadActions.navigationRight);n.addKeyMap(38,!1,!1,!1,!1,t.SpreadActions.navigationUp);n.addKeyMap(40,!1,!1,!1,!1,t.SpreadActions.navigationDown);n.addKeyMap(37,i,!1,!1,r,t.SpreadActions.navigationHome2);n.addKeyMap(39,i,!1,!1,r,t.SpreadActions.navigationEnd2);n.addKeyMap(38,i,!1,!1,r,t.SpreadActions.navigationTop);n.addKeyMap(40,i,!1,!1,r,t.SpreadActions.navigationBottom);n.addKeyMap(36,!1,!1,!1,!1,t.SpreadActions.navigationHome);n.addKeyMap(36,!0,!1,!1,!1,t.SpreadActions.navigationFirst);n.addKeyMap(35,!1,!1,!1,!1,t.SpreadActions.navigationEnd);n.addKeyMap(35,!0,!1,!1,!1,t.SpreadActions.navigationLast);n.addKeyMap(9,!1,!1,!1,!1,t.SpreadActions.moveToNextCell);n.addKeyMap(9,!1,!0,!1,!1,t.SpreadActions.moveToPreviousCell);n.addKeyMap(33,!1,!1,!1,!1,t.SpreadActions.navigationPageUp);n.addKeyMap(34,!1,!1,!1,!1,t.SpreadActions.navigationPageDown);n.addKeyMap(33,i,!1,!1,r,t.SpreadActions.navigationPreviousSheet);n.addKeyMap(34,i,!1,!1,r,t.SpreadActions.navigationNextSheet);n.addKeyMap(46,!1,!1,!1,!1,t.SpreadActions.clear);n.addKeyMap(8,!1,!1,!1,!1,t.SpreadActions.clearAndEditing);n.addKeyMap(13,!1,!1,!1,!1,t.SpreadActions.commitInputNavigationDown);n.addKeyMap(13,!1,!0,!1,!1,t.SpreadActions.commitInputNavigationUp);n.addKeyMap(27,!1,!1,!1,!1,t.SpreadActions.cancelInput);n.addKeyMap(13,!0,!0,!1,!1,t.SpreadActions.commitArrayFormula);n.addKeyMap(37,!1,!0,!1,!1,t.SpreadActions.selectionLeft);n.addKeyMap(39,!1,!0,!1,!1,t.SpreadActions.selectionRight);n.addKeyMap(38,!1,!0,!1,!1,t.SpreadActions.selectionUp);n.addKeyMap(40,!1,!0,!1,!1,t.SpreadActions.selectionDown);n.addKeyMap(36,!1,!0,!1,!1,t.SpreadActions.selectionHome);n.addKeyMap(35,!1,!0,!1,!1,t.SpreadActions.selectionEnd);n.addKeyMap(33,!1,!0,!1,!1,t.SpreadActions.selectionPageUp);n.addKeyMap(34,!1,!0,!1,!1,t.SpreadActions.selectionPageDown);n.addKeyMap(37,i,!0,!1,r,t.SpreadActions.selectionHome);n.addKeyMap(39,i,!0,!1,r,t.SpreadActions.selectionEnd);n.addKeyMap(38,i,!0,!1,r,t.SpreadActions.selectionTop);n.addKeyMap(40,i,!0,!1,r,t.SpreadActions.selectionBottom);n.addKeyMap(36,!0,!0,!1,!1,t.SpreadActions.selectionFirst);n.addKeyMap(35,!0,!0,!1,!1,t.SpreadActions.selectionLast);n.addKeyMap(67,i,!1,!1,r,t.SpreadActions.copy);n.addKeyMap(88,i,!1,!1,r,t.SpreadActions.cut);n.addKeyMap(86,i,!1,!1,r,t.SpreadActions.paste);n.addKeyMap(90,i,!1,!1,r,t.SpreadActions.undo);n.addKeyMap(89,i,!1,!1,r,t.SpreadActions.redo)},l.prototype._setHost=function(n){var h,c,o,s,e;if(n&&(h=t.util._isStandardCanvas(),c=t.util._isSilverlightCanvas(),h||!c)){var i=this,r=i._eventHandler,f=w.createElement("canvas");t.DPIHelper.adjustDevicePixel(f,null,i);f.setAttribute("id",n.getAttribute("id")+"_vp");t.GC$(f).html("You need a browser which full supports HTML5 Canvas to run SpreadJS");n.appendChild(f);f.gcObject=!0;o=i._canvas;o&&(t.GC$(o).unbind(g).unbind(nt).unbind(tt).unbind(it).unbind(rt).unbind(ut).unbind(ft),i._unbindTouchEvents(),o.parentNode&&o.parentNode.removeChild(o));i._canvas=f;t.features.comment&&(i._commentRender=i.parent?i.parent._commentRender:new t.CommentRender(i._getContainerDiv()));f.setAttribute("renderMethod","auto");s=t.util.device();e=s.ipad||s.iphone;i._mouseDownDelegate=function(n){if(!e){var u=i._touchManager;if(u&&u.preProcessMouseDown(n)){t.util.cancelDefault(n);return}return r.doMouseDown(n)}};i._mouseMoveDelegate=function(n){if(!e){var u=i._touchManager;if(u&&u.preProcessMouseMove(n)){t.util.cancelDefault(n);return}r._isMouseCapture||r.doMouseMove(n)}};i._mouseUpDelegate=function(n){if(!e){var u=i._touchManager;if(u&&u.preProcessMouseUp(n)){t.util.cancelDefault(n);return}if(!i._continueMouseUpBubble)return r._isMouseCapture?void 0:r.doMouseUp(n)}};i._mouseOutDelegate=function(n){if(!e)return r.doMouseOut(n)};i._dblClickDelegate=function(n){var u,s,f,c,h,o,l,a,v,y;if(!e&&(u=i,!u._isTouchMode)){if(h=u._currentTarget,h&&(u.triggerCellDoubleClick({sheet:u,sheetName:u._name,sheetArea:h.hitTestType,row:h.row,col:h.col}),o=h.resizeInfo,o)){if(o.action==="sizeRow"||o.action==="sizeHiddenRow"){if(l=[],u._isRowSelected(o.index)){for(s=0;s<u._selectionModel.length;s++)if(f=u._selectionModel[s],f.col===-1)for(f=u._getActualRange(f),a=0;a<f.rowCount;a++)l.push({row:f.row+a})}else l.push({row:o.index});c=new t.UndoRedo.RowAutoFitUndoAction(u,l,o.sheetArea===1);u._doCommand(c)}else{if(v=[],u._isColumnSelected(o.index)){for(s=0;s<u._selectionModel.length;s++)if(f=u._selectionModel[s],f.row===-1)for(f=u._getActualRange(f),y=0;y<f.colCount;y++)v.push({col:f.col+y})}else v.push({col:o.index});c=new t.UndoRedo.ColumnAutoFitUndoAction(u,v,o.sheetArea===2);u._doCommand(c)}return}return r.startEdit(n)}};i._mouseWheelDelegate=function(n){var i,f,l;if(!e){if(n=n?n:window.event,i=n.detail?n.detail:n.wheelDelta/-40,f=0,t.util.isMacOS()){var o=n.wheelDeltaY,h=n.deltaY,s=n.wheelDeltaX,c=n.deltaX;p(o)>=p(s)?s=0:o=0;t.util.browser.safari?(typeof o!==u&&typeof h!==u&&(i=et(-o/p(h))),typeof s!==u&&typeof c!==u&&(f=et(-s/p(c)))):t.util.browser.chrome&&(typeof o!==u&&(i=o/-40,i=(i>=0?1:-1)*ot(p(i))),typeof s!==u&&(f=s/-40,f=(f>=0?1:-1)*ot(p(f))))}return l=r.doMouseWheel(n,parseInt(i,10)||0,parseInt(f,10)||0),l?void 0:!1}};t.GC$(f).bind(g,i._mouseDownDelegate).bind(nt,i._mouseMoveDelegate).bind(tt,i._mouseUpDelegate).bind(it,i._mouseOutDelegate).bind(rt,i._dblClickDelegate).bind(ut,i._mouseWheelDelegate).bind(ft,i._mouseWheelDelegate);i._bindTouchEvents();r.doResize();i.parent&&i.parent._paintSpreadBackgroundImage()}},l.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.detach()},l.prototype._bindTouchEvents=function(){if(t.features.touch){var n=this,i=n.parent,u=i&&i._touchEventProvider?i._touchEventProvider:new t.TouchEventProvider,r=new t.TouchManager(n._canvas,n,u);r.attach();n._touchManager=r}},l.prototype._disposeValidationUI=function(){var n=this,r,u,f,t;return n._isDisposingValidationUI?!1:(n._isDisposingValidationUI=!0,r=n._validationInputMessage,r&&(t=r.parentNode,t&&t.removeChild(r),n._validationInputMessage=i),u=n._validationButton,u&&(t=u.parentNode,t&&t.removeChild(u),n._validationButton=i),f=n._validationSelect,f&&(t=f.parentNode,t&&t.removeChild(f),n._validationSelect=i),n._isDisposingValidationUI=!1,!0)},l.prototype._disposeFloatingObjectUI=function(){var e=this._render,n=e&&e._floatingObjectRenderManager,r,u,o,s,t,f;if(n){for(r=0,o=n.length;r<o;r++)if(t=n[r],t){for(u=0,s=t.length;u<s;u++)f=t[u],f&&f._dispose();t.length=0}n.length=0;n=i}this._floatingObjectArray&&this._floatingObjectArray.dispose()},l.prototype._disposeComment=function(){var t=this,n=t._commentManager;n&&n.hideAllComments()},l.prototype._dispose=function(n){var r=this,u,f,e,o,s,h;t.DPIHelper.disposeSheet(r);r.isEditing()&&r.endEdit();u=r._canvas;u&&(t.GC$(u).unbind(g).unbind(nt).unbind(tt).unbind(it).unbind(rt).unbind(ut).unbind(ft),u.parentNode&&u.parentNode.removeChild(u),r._canvas=i);r._unbindTouchEvents();t.GC$(window).unbind(ni);t.StyleHelper._disposeMeasureSpan();f=r._eventHandler;f&&(f._dispose(),f._disposeFocusHolders());e=r._filterDialiog;e&&e.close();o=r._smartTag;o&&o.close();s=r._editor;s&&t.GC$(s).remove();h=r._cutCopyIndicatorManager;h&&h._dispose();r._disposeValidationUI();r._disposeFloatingObjectUI();r._disposeComment();r._disposeStringWidthPre();r._disposeStringWidthSpan();n!==!1&&r.clearCache()},l.prototype._disposeStringWidthSpan=function(){var n=this._editingSpan;n&&(t.GC$(n).remove(),this._editingSpan=r)},l.prototype._disposeStringWidthPre=function(){var n=this._editingPre;n&&(t.GC$(n).remove(),this._editingPre=r)},l.prototype.clearCache=function(){var t=this,n=t._conditionalFormats;n&&n.clearCellRuleCache()},l.prototype._getModel=function(n){return this._sheetModelManager.getDataModel(n)},l.prototype._getCalcModel=function(n){return!this._vpCalcSheetModel&&t.util.hasCalc()&&(this._vpCalcSheetModel=this.getCalcService().getSourceModel(this._vpSheetSource)),this._vpCalcSheetModel},l.prototype._getValueImp=function(n,r,f,e){var y=this,h,c,w,v;(typeof e===u||e===i)&&(e=3);var p=e===3,s=i,l=!1,b=!1,a=y._tableManager;return p&&a&&a._tableList.length>0&&(h=a.find(r,f),h&&(h.showHeader()&&r===h.headerIndex()?(b=!0,s=h._getHeaderName(f),s!==i&&typeof s!==u&&(s=t.util.toString(s)),l=!0):h.hasBinding()&&(s=h._getValue(r,f),s.hasBinding?(l=!0,s=s.value):s=i))),l||(c=y._bindingManager,w=c&&c._dataSource,w&&p?(v=c.getValue(r,f),s=v.hasBinding?v.value:n.getValue(r,f)):s=n.getValue(r,f)),o.tryConvertOADateToDate(s)},l.prototype._getSwapIndex=function(n,t,i){for(var r=n[i-t];r.index<i;)r=n[r.index-t];return r.index},l.prototype._quickSortImp=function(n){var t,i;if(n.length<=1)return n;var e=s(n.length/2),o=n[e],r=[],u=[],f=[];for(t=0;t<n.length;t++)i=this._sortCompare(n[t],o),i<0?r.push(n[t]):i>0?u.push(n[t]):f.push(n[t]);return this._quickSortImp(r).concat(f,this._quickSortImp(u))},l.prototype._quickSort=function(n,t,i,r,u,f){var a=u?i:r,s=[],e,h,c,o,l;if(u)for(e=0;e<a;e++)s[e]={sheet:this,index:n+e,byRows:u,sortInfo:f};else for(e=0;e<a;e++)s[e]={sheet:this,index:t+e,byRows:u,sortInfo:f};if(u)for(h=[],o=s.length-1;o>=0;o--)c=s[o],this.isRowFilterOut(c.index)&&(s.splice(o,1),h.push({index:o,value:c}));if(s=this._quickSortImp(s),u)for(o=h.length-1;o>=0;o--)l=h[o],s.splice(l.index,0,l.value);return s},l.prototype._isEquals=function(n,i){return n instanceof Date&&i instanceof Date?new t._DateTimeHelper(n).toOADate()===new t._DateTimeHelper(i).toOADate():typeof n===c&&typeof i===c?n.toLowerCase()===i.toLowerCase():n===i},l.prototype._isGreaterThan=function(n,i){return(typeof n=="boolean"?n=n?1:0:n instanceof Date&&(n=new t._DateTimeHelper(n).toOADate()),typeof i=="boolean"?i=i?1:0:i instanceof Date&&(i=new t._DateTimeHelper(i).toOADate()),typeof n!=typeof i&&(typeof n=="number"||typeof i=="number"))?typeof i=="number":typeof n===c&&typeof i===c?n.toLowerCase()>i.toLowerCase():n>i},l.prototype._sortCompare=function(n,t){var l,e,u,f,o,s,h,a,c;if(n.sortInfo&&n.sortInfo.length>0){for(l=this,e=0,h=0;h<n.sortInfo.length;h++)if(n.sortInfo[h]&&(a=n.sortInfo[h].ascending,c=n.sortInfo[h].index,0<=c&&(n.byRows?(u=n.sheet.getValue(n.index,c),f=t.sheet.getValue(t.index,c),o=u===r||u===i||u===""||typeof u=="number"&&isNaN(u),s=f===r||f===i||f===""||typeof f=="number"&&isNaN(f),o||s?o&&s?e=0:o&&!s?e=1:!o&&s&&(e=-1):e=l._isEquals(u,f)?0:l._isGreaterThan(u,f)?a?1:-1:a?-1:1):(u=n.sheet.getValue(c,n.index),f=t.sheet.getValue(c,t.index),o=u===r||u===i||u===""||typeof u=="number"&&isNaN(u),s=f===r||f===i||f===""||typeof f=="number"&&isNaN(f),o||s?o&&s?e=0:o&&!s?e=1:!o&&s&&(e=-1):e=l._isEquals(u,f)?0:l._isGreaterThan(u,f)?a?1:-1:a?-1:1))),e!==0)break;return e}return 0},l.prototype._getActualRange=function(n,r){(typeof r===u||r===i)&&(r=3);var f=new t.Range(-1,-1,-1,-1);return n===i||typeof n===u?f:(f.col=n.col,f.row=n.row,f.colCount=n.colCount,f.rowCount=n.rowCount,f.col===-1&&(f.col=0,f.colCount=this.getColumnCount(r)),f.row===-1&&(f.row=0,f.rowCount=this.getRowCount(r)),f)},l.prototype._getRangeRect=function(n,i,r){var e=new t.Rect(-1,-1,-1,-1),o=this,c=o._getSheetLayout(),l,a;if(c.width===0||c.height===0||(l=o._getViewportColumnLayout(i),a=o._getViewportRowLayout(n),!l||l.length===0||!a||a.length===0))return e;var b=o._getActualRange(r),k=o._cachePool,v=function(n,t){for(var r=0,i=n;i<=t;i++)r+=k.getZoomColWidth(i);return r},y=function(n,t){for(var r=0,i=n;i<=t;i++)r+=k.getZoomRowHeight(i);return r},u=b.row,s=b.row+b.rowCount-1,f=b.col,h=b.col+b.colCount-1,d=o.frozenRowCount,g=o.getRowCount()-o._frozenTrailingRowCount-1,nt=o.frozenColCount,tt=o.getColumnCount()-o._frozenTrailingColCount-1,p=l[0].col,it=l[l.length-1].col,w=a[0].row,rt=a[a.length-1].row,ut=function(n,t){while(n>t)if(n--,o.getColumnVisible(n))return n;return n},ft=function(n,t){while(n<t)if(n++,o.getColumnVisible(n))return n;return n},et=function(n,t){while(n>t)if(n--,o.getRowVisible(n))return n;return n},ot=function(n,t){while(n<t)if(n++,o.getRowVisible(n))return n;return n};return(f<p&&(f=ut(p,f)),h>it&&(h=ft(it,h)),u<w&&(u=et(w,u)),s>rt&&(s=ot(rt,s)),h<f||s<u)?e:(i===0?f<nt&&(e.x=c.frozenX+v(0,f-1),e.width=v(f,h)):i===1?f<=tt&&h>=nt&&(e.x=f<p?l[0].x-v(f,p-1):l[0].x+v(p,f-1),e.width=v(f,h)):i===2&&h>tt&&(e.x=f<p?c.frozenTrailingX-v(f,p-1):c.frozenTrailingX+v(p,f-1),e.width=v(f,h)),n===0?u<d&&(e.y=c.frozenY+y(0,u-1),e.height=y(u,s)):n===1?u<=g&&s>=d&&(e.y=u<w?a[0].y-y(u,w-1):a[0].y+y(w,u-1),e.height=y(u,s)):n===2&&s>g&&(e.y=u<w?c.frozenTrailingY-y(u,w-1):c.frozenTrailingY+y(w,u-1),e.height=y(u,s)),e)},l.prototype._getRangeRect2=function(n){var o=this,i=new t.Rect(-1,-1,-1,-1),w=o._getSheetLayout();if(w.width===0||w.height===0)return i;var d=o._getActualRange(n),g=isNaN(o.frozenColCount)?0:o.frozenColCount,nt=isNaN(o.frozenRowCount)?0:o.frozenRowCount,b=isNaN(o._frozenTrailingColCount)?0:o._frozenTrailingColCount,k=isNaN(o._frozenTrailingRowCount)?0:o._frozenTrailingRowCount,tt=o._cachePool,y=function(n,t){for(var r=0,i=n;i<=t;i++)r+=tt.getZoomColWidth(i);return r},p=function(n,t){for(var r=0,i=n;i<=t;i++)r+=tt.getZoomRowHeight(i);return r},a=d.row,s=d.row+d.rowCount-1,v=d.col,h=d.col+d.colCount-1,c=o.getRowCount(),l=o.getColumnCount(),r,u;if(v<g)i.x=w.frozenX+y(0,v-1),i.width=y(v,f(h,g-1)),g<=h&&h<l-b?(r=o._getViewportColumnLayout(1),r&&r.length>0&&(i.width+=y(r[0].col,f(h,r[r.length-1].col)))):h>=l-b&&(r=o._getViewportColumnLayout(2),r&&r.length>0&&(i.width=r[0].x-i.x,i.width+=y(l-b,f(h,l-1))));else if(v<l-b){if(r=o._getViewportColumnLayout(1),!r||r.length===0||v>r[r.length-1].col||h<r[0].col)return i;i.x=w.viewportX+y(r[0].col,v-1);g<=h&&h<l-b?i.width=y(e(v,r[0].col),f(h,r[r.length-1].col)):h>=l-b&&(r=o._getViewportColumnLayout(2),r&&r.length>0&&(i.width=r[0].x-i.x,i.width+=y(l-b,f(h,l-1))))}else v<l&&(r=o._getViewportColumnLayout(2),r&&r.length>0&&(i.x=w.frozenTrailingX+y(r[0].col,v-1),i.width=y(v,f(h,l-1))));if(a<nt)i.y=w.frozenY+p(0,a-1),i.height=p(a,f(s,nt-1)),nt<=s&&s<c-k?(u=o._getViewportRowLayout(1),u&&u.length>0&&(i.height+=p(u[0].row,f(s,u[u.length-1].row)))):s>=c-k&&(u=o._getViewportRowLayout(2),u&&u.length>0&&(i.height=u[0].y-i.y,i.height+=p(c-k,f(s,c-1))));else if(a<c-k){if(u=o._getViewportRowLayout(1),!u||u.length===0||a>u[u.length-1].row||s<u[0].row)return i;i.y=w.viewportY+p(u[0].row,a-1);nt<=s&&s<c-k?i.height=p(e(a,u[0].row),f(s,u[u.length-1].row)):s>=c-k&&(u=o._getViewportRowLayout(2),u&&u.length>0&&(i.height=u[0].y-i.y,i.height+=p(c-k,f(s,c-1))))}else a<c&&(u=o._getViewportRowLayout(2),u&&u.length>0&&(i.y=w.frozenTrailingY+p(u[0].row,a-1),i.height+=p(a,f(s,c-1))));return i},l.prototype._getCanvas=function(){var n=this._canvas;return!n&&this.parent&&(n=this.parent.canvas),n&&!n.getContext&&n.firstChild&&(n.getContext=n.firstChild.getContext),n},l.prototype._getStringWidth=function(n,t){return this._getStringWidthByCanvas(n,t)+1},l.prototype._getStringWidthByCanvas=function(n,i){var r="",u=this._render;return r=i?i:u._getZoomFont(u._getDefaultFont()),t._WordWrapHelper._measureText(n,r)},l.prototype._getFontHeight=function(n,t){var i=this,r=i.fontHeightCache,f,u,e;if(!t)if(r){if(f=r[n],f)return f}else r=i.fontHeightCache={};return u=i._getEditingSpan(),u.style.font=n?n:i._render._getDefaultFont(),u.innerHTML="H",e=u.offsetHeight,t||(r[n]=e),e},l.prototype._getEditingSpan=function(){if(!this._editingSpan){var n=w.createElement("span"),t=n.style;t.visibility=wt;t.top="-10000px";t.left="-10000px";t.position="absolute";n.className="gcStringWidthSpanStyle";n.setAttribute("gcUIElement","gcStringWidthSpan");w.body.insertBefore(n,i);this._editingSpan=n}return this._editingSpan},l.prototype._getColumnViewportIndexFromX=function(n){var t=this._getSheetLayout(),r=i;return t.headerX<n&&n<t.headerX+t.rowHeaderWidth?r=-1:t.frozenX<n&&n<t.frozenX+t.frozenWidth?r=0:t.viewportX<n&&n<t.viewportX+t.viewportWidth?r=1:t.frozenTrailingX<n&&n<t.frozenTrailingX+t.frozenTrailingWidth&&(r=2),r},l.prototype._getRowViewportIndexFromY=function(n){var t=this._getSheetLayout(),r=i;return t.headerY<n&&n<t.headerY+t.colHeaderHeight?r=-1:t.frozenY<n&&n<t.frozenY+t.frozenHeight?r=0:t.viewportY<n&&n<t.viewportY+t.viewportHeight?r=1:t.frozenTrailingY<n&&n<t.frozenTrailingY+t.frozenTrailingHeight&&(r=2),r},l.prototype._getRowIndexFromY=function(n,t){var r=i,u;return r=t===-1?this._getColumnHeaderRowLayout():this._getViewportRowLayout(t),r&&(u=r.findY(n),u)?u.row:void 0},l.prototype._getColumnIndexFromX=function(n,t){var r=i,u;return r=t===-1?this._getRowHeaderColumnLayout():this._getViewportColumnLayout(t),r&&(u=r.findX(n),u)?u.col:void 0},l.prototype._isActiveCell=function(n,t){var i=this;return i._activeRowIndex<=n&&n<i._activeRowIndex+i._activeRowCount&&i._activeColIndex<=t&&t<i._activeColIndex+i._activeColCount},l.prototype._isColumnSelected=function(n){for(var t,r,i=0;i<this._selectionModel.length;i++)if(t=this._selectionModel[i],r=t.col===-1?0:t.col,t.row===-1&&n>=r&&n<r+t.colCount)return!0;return!1},l.prototype._isRowSelected=function(n){for(var t,r,i=0;i<this._selectionModel.length;i++)if(t=this._selectionModel[i],r=t.row===-1?0:t.row,t.col===-1&&n>=r&&n<r+t.rowCount)return!0;return!1},l.prototype._isSelected=function(n,t,r){for(var o,f,e=!1,h=this._selectionModel,s=0,c=h.length;s<c;s++)if(o=h[s],f=this._getActualRange(o),r===3||typeof r===u||r===i?e=f.row<=n&&n<f.row+f.rowCount&&f.col<=t&&t<f.col+f.colCount:r===2?e=f.row<=n&&n<f.row+f.rowCount:r===1?e=f.col<=t&&t<f.col+f.colCount:r===0&&(e=o.row===-1&&o.col===-1),e)return e;return e},l.prototype._isAllSelected=function(n,t,u){for(var f,h,c,o=this,e=!1,l=o.getRowCount(),a=o.getColumnCount(),s=0;s<o._selectionModel.length;s++)if(f=o._selectionModel[s],u!==r&&u!==i&&u!==3&&(u===2?(h=f.row===-1?0:f.row,e=f.col===-1&&n>=h&&n<h+f.rowCount):u===1?(c=f.col===-1?0:f.col,e=f.row===-1&&t>=c&&t<c+f.colCount):u===0&&(e=f.row===-1&&f.col===-1&&f.rowCount===l&&f.colCount===a)),e)return e;return e},l.prototype._isHover=function(n,t,r){var h=!1,f=this._currentTarget,e,o,s;if(f&&!f.resizeInfo&&typeof r!==u&&r!==i)if(r===1)return e=!1,o=this._getSpanModel(1).find(f.row,f.col),o&&(e=o.contains(n,t,1,1)),s=n===f.row&&t===f.col||e,f.hitTestType===r&&s;else if(r===2)return e=!1,o=this._getSpanModel(2).find(f.row,f.col),o&&(e=o.contains(n,t,1,1)),s=n===f.row&&t===f.col||e,f.hitTestType===r&&s;else if(r===3)return f.hitTestType===r&&n===f.row&&t===f.col;else if(r===0)return f.hitTestType===r;return h},l.prototype._indexToLetters=function(n){for(var r="A",u=r.charCodeAt(0),t="",i;n>0;n=(n-1)/26)i=parseInt((n-1)%26,10),(n===1||i>=0&&n>1)&&(t=String.fromCharCode(u+i)+t);return t},l.prototype._doStartEdit=function(n,t,i){var u=this,o=u.hitTest(t,i),f,e,c,s,h;if(o&&(f=o.row,e=o.col,f>=0&&e>=0&&o.rowViewportIndex>=0&&o.colViewportIndex>=0&&!o.resizeInfo&&!o.dragInfo&&f===u._activeRowIndex&&e===u._activeColIndex&&(c=u.isEditing(),u._startEditImp(n,f,e),!c&&u.isEditing()&&(s=o.hitTestType,h=u.getCellType(f,e),h._triggerButtonClicked)))){var a=s===1?-1:r,v=s===2?-1:r,y=u.getCellRect(f,e,a,v),p=u.getActualStyle(f,e,s),w={sheet:u,row:f,col:e,sheetArea:s},l=h.getHitInfo(t,i,p,y,w);l&&l.isReservedLocation&&h._triggerButtonClicked(u,f,e,3)}},l.prototype._getSheetArea=function(n,t){if(n>=0&&n<=2&&t>=0)return 3;else if(n>=0&&n<=2&&t<0)return 2;else if(n<0&&t>=0)return 1;else if(n<0&&t<0)return 0;return i},l.prototype.setFocus=function(){var n=this._eventHandler;n&&n.setFocus()},l.prototype._getHost=function(){var i=this,n,r=i.parent,t;return n=r&&r._host,n||(t=i._canvas,n=t&&t.parentElement),n},l.prototype._startEditImp=function(n,u,f,e,o,s,h){var c,v,k,l,d,a,g,tt,b,nt,ot,st,w;if(!(u<0)&&!(f<0)&&(c=this,!c.isEditing())){v=c._eventHandler;v&&v.setFocus();var y=u,p=f,b=c.getCellRect(y,p);if(b&&!(b.width<=0)&&!(b.height<=0)&&(c.showCell(c._activeRowIndex,c._activeColIndex,3,3),k=c.getActualStyle(u,f),!c.isProtected||k.locked===!1)&&(l=c.getCellType(y,p),l)&&(a={sheet:c,row:u,col:f,sheetArea:3},l.isImeAware(a)?v&&(d=v._cellTypeFocusHolder):d=l.createEditorElement(a),d)){if(c._editor=d,g={sheet:c,sheetName:c._name,row:y,col:p,cancel:!1},c.triggerEditStarting(g),g&&g.cancel===!0){t.util.device().ipad&&v&&v.changeFocusHolder();return}var it=c.getValue(y,p),rt=c.getFormula(y,p),ht=c._editorStatus;c._editorStatus=c._startEditByKeydown?1:(it===i||it===r)&&(rt===i||rt===r)?1:2;c.triggerEditorStatusChanged({sheet:c,sheetName:c._name,oldStatus:ht,newStatus:c._editorStatus});tt=c._getSheetLayout();b=c.getCellRect(y,p,e,o);l.isImeAware(a)&&v._resetFocusHolder();l.activateEditor(c._editor,k,b,a);c._setEditorValue(l,c._editor,y,p,k,h);var ut=1,ft=2,et=c._getHost();c.showEditingLocator&&(nt=l._getLocator(),d._editingLocator=nt,ot=this.getValue(this._sheetModelManager.getDataModel(ut).getRowCount()-1,f,ut),st=this.getValue(u,this._sheetModelManager.getDataModel(ft).getColumnCount()-1,ft),nt.innerHTML=ot+""+st,l._updateEditorLocator(c._editor,a),et.insertBefore(nt,i));l.isImeAware(a)||et.insertBefore(c._editor,i);l.updateEditor(c._editor,k,b,a);l.isImeAware(a)&&s||l.focus(c._editor,a);s&&l.selectAll(c._editor,a);c._allowCellOverflow&&(w=c.getCellRect(u,f,e,o),w.x-=2,w.y-=2,w.width+=4,w.height+=4,w.x=tt.frozenX,w.width=tt.viewportWidth,c.repaint(w));c._render.refreshTouchSelectionIndicator();c._attachFormulaTextBox(l.getEditingElement());t.FocusHelper.setActiveElement(c);c.triggerEditStarted({sheet:c,sheetName:c._name,row:y,col:p})}}},l.prototype._setEditorValue=function(n,t,u,f,e,o){var h=this,s=h.getFormula(u,f),c,l,a;s&&(s="="+s);c=s;l={sheet:h,row:u,col:f,sheetArea:3};s&&s.length!==0||(s=h.getValue(u,f),a=h.parent?h.parent.canUserEditFormula():!0,s&&s.length>0&&/^=/ig.test(s)&&a&&(s="'"+s),c=s,s=n._formatEditorValue(t,e,s,l));t._oldValue=s;o!==i&&o!==r&&(s=o);n.setEditorValue(t,s,l);t._originalValue=c},l.prototype._attachFormulaTextBox=function(i){var r=this,e,s,f;if(t.features.formulatextbox&&i&&(!r.parent||r.parent.canUserEditFormula())&&r._enableFormulaTextbox){r._formulaTextBox&&r._formulaTextBox.destroy();r._formulaTextBox=new t.FormulaTextBox(i,r.parent);e=r._formulaTextBox.text();s=r.getFormulaInformation(r._activeRowIndex,r._activeColIndex);s&&s.hasFormula||e[0]==="="&&(e="'"+e,r._formulaTextBox.text(e));var u=r._formulaTextBox,h=r._eventHandler,o=r._render;u.bind("AppendStarted",function(t){u.close();var f=n.Sheets.EditorStatus,i=r._editorStatus;i!==1&&(r._editorStatus=1,r.triggerEditorStatusChanged({sheet:r,sheetName:r._name,oldStatus:i,newStatus:1}))});u.bind("AppendEnded",function(n){o.paintFormulaTextBox()});u.bind("TextChanged",function(n,t){if(t&&t.type!=="input"){h.updateEditingEditor(t);var i=r._activeRowIndex,f=r._activeColIndex,e=r.getCellType(i,f);r.triggerEditChange({sheet:r,sheetName:r._name,row:i,col:f,editingText:e.getEditorValue(r._editor)})}o.paintFormulaTextBox();r.triggerFormulaTextBoxTextChanged({sheet:r,sheetName:r._name,text:u.text()})});u.bind("CaretChanged",function(){o.paintFormulaTextBox();r.triggerFormulaTextBoxCaretChanged({sheet:r,sheetName:r._name,caret:u.caret()})});u.add(t.SR.getHelpFuncs());f=this._functionDescriptions;f&&f.length>0&&u.add(f);f=this.parent&&this.parent._functionDescriptions;f&&f.length>0&&u.add(f);o.paintFormulaTextBox()}},l.prototype._detachFormulaTextBox=function(){var n=this;n._formulaTextBox&&(n._formulaTextBox.destroy(),n._formulaTextBox=i,n._render.paintFormulaTextBox())},l.prototype._showEditingLocator=function(){var n=this,i,r,s,h;if(n.isEditing()!==!1&&(i=n._editor,r=i&&i._editingLocator,r)){var e=t.GC$(i),u=parseInt(e.css(ti),10)+n.getColumnWidth(n._activeColIndex)/2,f=parseInt(e.css(ii),10)+n.getRowHeight(n._activeRowIndex)/2,o=t.GC$(n._getCanvas()).offset();u-=o.left;f-=o.top;s=n._getRowIndexFromY(f,n._getRowViewportIndexFromY(f));h=n._getColumnIndexFromX(u,n._getColumnViewportIndexFromX(u));s===n._activeRowIndex&&h===n._activeColIndex?t.GC$(r).css(bt,wt):t.GC$(r).css(bt,"visible")}},l.prototype._getKeyAction=function(n,t,i,r,u){return this._getKeyActionInternal(n,t,i,r,u,this.keyMap)},l.prototype._getKeyActionInternal=function(n,t,r,u,f,e){var h,o,s;if(!e)return i;for(h=e.length,s=0;s<h;s++)if(o=e[s],o&&o.key===n&&o.ctrl===t&&o.shift===r&&o.alt===u&&o.meta===f)return o;return i},l.prototype._getFloatingObjectKeyAction=function(n,t,i,r,u){return this._getKeyActionInternal(n,t,i,r,u,this.floatingObjectKeyMap)},l.prototype._getSlicerKeyAction=function(n,t,i,r,u){return this._getKeyActionInternal(n,t,i,r,u,this._slicerKeyMap)},l.prototype._getCommentKeyAction=function(n,t,i,r,u){return this._getKeyActionInternal(n,t,i,r,u,this._commentKeyMap)},l.prototype._moveActiveCellUp=function(n,t,i){var r=this,u=r._getMoveUpCell(n,t,i,r._leadingCellCol||0);if(u){var f=u.row,e=u.col,o=u.leadingCellCol;r._canMoveCurrentTo(f,e)&&(r._leadingCellRow=f,r._leadingCellCol=o,r._setActiveCellCore(f,e))}},l.prototype._getMoveUpCell=function(n,t,u,f){var o=n,e=t;if(o===0&&!u)return i;var s=this,c=s.getRowCount(),l=s.getColumnCount(),h=s._getPrevRow(o,f);return(u||s._adjustCell(h),o=h.r,e=h.c,o<0&&u&&(e=s._getPrevVisualColumn(e),(e<0||e===r||e===i)&&(e=s._getPrevVisualColumn(l)),f=e,h=s._getPrevRow(c,e),o=h.r,e=h.c,e===t&&o<=n))?i:{row:o,col:e,leadingCellCol:f}},l.prototype._moveActiveCellDown=function(n,t,i){var r=this,u=r._getMoveDownCell(n,t,i,r._leadingCellCol||0);if(u){var f=u.row,e=u.col,o=u.leadingCellCol;r._canMoveCurrentTo(f,e)&&(r._leadingCellRow=f,r._leadingCellCol=o,r._setActiveCellCore(f,e))}},l.prototype._getMoveDownCell=function(n,t,u,f){var o=this,c=o.getRowCount(),l=o.getColumnCount(),s=n,e=t,h;if(s!==c-1||u)return(h=o._getNextRow(s,f),u||o._adjustCell(h),s=h.r,e=h.c,s===c&&u&&(e=o._getNextVisualColumn(e),(e>=l||e===r||e===i)&&(e=o._getNextVisualColumn(-1)),f=e,h=o._getNextRow(-1,e),s=h.r,e=h.c,e===t&&s>=n))?void 0:{row:s,col:e,leadingCellCol:f}},l.prototype._moveActiveCellLast=function(){var n=this,t=n._getMoveLastCell(),i,r;t&&(i=t.row,r=t.col,n._leadingCellRow=i,n._leadingCellCol=r,n._setActiveCellCore(i,r))},l.prototype._getMoveLastCell=function(){var t=this,r=t._getLastVisualRow(),e=t._getLastVisualColumn(),n=e,u,f,o;if(!r&&!n)return i;if(u=t._protectionOption.allowSelectLockedCells!==!1,f=t._protectionOption.allowSelectUnlockedCells!==!1,!t.isProtected||u&&f)return{row:r,col:n};if(!u&&!f)return i;for(;r!==i&&r>=0;r=t._getPrevVisualRow(r))for(n=e;n!==i&&n>=0;n=t._getPrevVisualColumn(n))if(o=t.getStyleProperty(r,n,"locked"),u===o)return{row:r,col:n};return i},l.prototype._moveActiveCellFirst=function(){var n=this,t=n._getMoveFirstCell(),i,r;t&&(i=t.row,r=t.col,n._leadingCellRow=i,n._leadingCellCol=r,n._setActiveCellCore(i,r))},l.prototype._getMoveFirstCell=function(){var n=this,r=n._getFirstVisualRow(),e=n._getFirstVisualColumn(),t=e,s=n._getLastVisualRow(),h=n._getLastVisualColumn(),u,f,o;if(r===i||t===i)return i;if(u=n._protectionOption.allowSelectLockedCells!==!1,f=n._protectionOption.allowSelectUnlockedCells!==!1,!n.isProtected||u&&f)return{row:r,col:t};if(!u&&!f)return i;for(;r!==i&&r<=s;r=n._getNextVisualRow(r))for(t=e;t!==i&&t<=h;t=n._getNextVisualColumn(t))if(o=n.getStyleProperty(r,t,"locked"),u===o)return{row:r,col:t};return i},l.prototype._moveActiveCellLeft=function(n,t,i){var r=this,u=r._getMoveLeftCell(n,t,i,r._leadingCellRow||0);if(u){var e=u.row,f=u.col,o=u.leadingCellRow;r._canMoveCurrentTo(e,f)&&(r._leadingCellRow=o,r._leadingCellCol=f,r._setActiveCellCore(e,f))}},l.prototype._getMoveLeftCell=function(n,t,u,f){var e=n,o=t;if(o===0&&!u)return i;var h=this,c=h.getRowCount(),l=h.getColumnCount(),s=h._getPrevColumn(f,o),a=f;for(u||h._adjustCell(s),e=s.r,o=s.c;o<0&&u;)if(e=h._getPrevVisualRow(e,3,!0),(e<0||e===r||e===i)&&(e=h._getPrevVisualRow(c,3,!0)),f=e,s=h._getPrevColumn(f,l),e=s.r,o=s.c,e===n&&o<t)return i;else if(e===n&&o===t){if(f===a)return i;s=h._getPrevColumn(f,o);e=s.r;o=s.c}return{row:e,col:o,leadingCellRow:f}},l.prototype._adjustCell=function(n){var t=this;n.r<0?n.r=t._getFirstVisualRow():n.r>=t.getRowCount()&&(n.r=t._getLastVisualRow());n.c<0?n.c=t._getFirstVisualColumn():n.c>=t.getColumnCount()&&(n.c=t._getLastVisualColumn())},l.prototype._fixRange=function(n){var i=n.row<0?0:n.row,r=n.col<0?0:n.col,u=n.row<0?this.getRowCount():n.rowCount,f=n.col<0?this.getColumnCount():n.colCount;return new t.Range(i,r,u,f)},l.prototype._moveActiveCellLeftInSelection=function(n,t){for(var i=this,s=i._selectionModel,v=s.activeSelectedRangeIndex,h=-1,e=i._fixRange(i._getActiveSelectedRange()),c=e.row,l=e.col,a=e.col+e.colCount-1,r=n,f=t,o,u;;){if(o=i._getPrevColumnInSelection(r,f),r=o.r,f=o.c,f>=l)break;if(h===v&&r===n&&f<=t)return;r--;r>=c?f=a+1:(u=i._fixRange(i._getActiveSelectedRange(3)),h=s.activeSelectedRangeIndex,c=u.row,l=u.col,a=u.col+u.colCount-1,r=u.row+u.rowCount-1,f=u.col+u.colCount)}r>=0&&(i._setActiveCellCore(r,f),i._leadingCellRow=r,i._leadingCellCol=f)},l.prototype._moveActiveCellRightInSelection=function(n,t){for(var i=this,s=i._selectionModel,v=s.activeSelectedRangeIndex,h=-1,e=i._fixRange(i._getActiveSelectedRange()),c=e.col,l=e.row+e.rowCount-1,a=e.col+e.colCount-1,r=n,u=t,o,f;;){if(o=i._getNextColumnInSelection(r,u),r=o.r,u=o.c,u<=a)break;if(h===v&&r===n&&u>=t)return;r++;r<=l?u=c-1:(f=i._fixRange(i._getActiveSelectedRange(4)),h=s.activeSelectedRangeIndex,c=f.col,l=f.row+f.rowCount-1,a=f.col+f.colCount-1,r=f.row,u=f.col-1)}r>=0&&(i._setActiveCellCore(r,u),i._leadingCellRow=r,i._leadingCellCol=u)},l.prototype._moveActiveCellRight=function(n,t,i){var r=this,u=r._getMoveRightCell(n,t,i,r._leadingCellRow||0);if(u){var e=u.row,f=u.col,o=u.leadingCellRow;r._canMoveCurrentTo(e,f)&&(r._leadingCellRow=o,r._leadingCellCol=f,r._setActiveCellCore(e,f))}},l.prototype._getMoveRightCell=function(n,t,u,f){var h=this,a=h.getRowCount(),c=h.getColumnCount(),e=n,s=t,o,l;if(s===c-1&&!u)return i;if(o=h._getNextColumn(f,s),l=f,!u){if(o.c===c)return i;h._adjustCell(o)}for(e=o.r,s=o.c;s===c&&u;)if(e=h._getNextVisualRow(e,!0),(e>=a||e===r||e===i)&&(e=h._getNextVisualRow(-1,!0)),f=e,o=h._getNextColumn(f,-1),e=o.r,s=o.c,e===n&&s>t)return i;else if(e===n&&s===t){if(f===l)return i;o=h._getNextColumn(f,s);e=o.r;s=o.c}return{row:e,col:s,leadingCellRow:f}},l.prototype._getPrevColumn=function(n,i){for(var f={r:n,c:i},r,u;i>=0;){if(n=f.r,i--,i<0)break;if(r=this.getSpans(new t.Range(n,i,1,1)),r&&r.length>0&&(u=r[0],i>=u.col&&(i=u.col,n=u.row)),this._canMoveCurrentTo(n,i))return{r:n,c:i}}return{r:n,c:i}},l.prototype._getPrevColumnInSelection=function(n,t){for(var i,r;t>=0;){if(t--,t<0)break;if(i=this._getSpanModel().find(n,t),i){if(r=this._getActiveSelectedRange(),r.row<=i.row&&i.row+i.rowCount<=r.row+r.rowCount&&r.col<=i.col&&i.col+i.colCount<=r.col+r.colCount){if(!(i.row===n&&i.col===t))continue}else continue;t>=i.col&&(t=i.col,n=i.row)}if(this._canMoveCurrentTo(n,t))return{r:n,c:t}}return{r:n,c:t}},l.prototype._getNextColumn=function(n,i){for(var f=this,s=f.getColumnCount(),h={r:n,c:i},o,u,r;i<s;){if(n=h.r,o=this._getSpanModel().find(n,i),o?i+=o.colCount:i++,i>=s)break;if(u=f.getSpans(new t.Range(n,i,1,1)),u&&u.length>0&&(r=u[0],i>r.col?i=e(i,r.col+r.colCount):n=r.row),f._canMoveCurrentTo(n,i))return{r:n,c:i}}return{r:n,c:i}},l.prototype._getNextColumnInSelection=function(n,t){for(var u=this,o=u.getColumnCount(),f,i,r;t<o;){if(f=this._getSpanModel().find(n,t),f?t+=f.colCount:t++,t>=o)break;if(i=this._getSpanModel().find(n,t),i){if(r=u._getActiveSelectedRange(),r.row<=i.row&&i.row+i.rowCount<=r.row+r.rowCount&&r.col<=i.col&&i.col+i.colCount<=r.col+r.colCount){if(!(i.row===n&&i.col===t))continue}else continue;t>i.col?t=e(t,i.col+i.colCount):n=i.row}if(u._canMoveCurrentTo(n,t))return{r:n,c:t}}return{r:n,c:t}},l.prototype._canMoveCurrentTo=function(n,t){var i=this,r=!1,e=i.getRowVisible(n),o=i.getColumnVisible(t),s=i._getZoomRowHeight(n),h=i._getZoomColumnWidth(t),u,f;return(r=n>=0&&n<i.getRowCount()&&t>=0&&t<i.getColumnCount()&&e&&o&&s>0&&h>0,!i.canSelect(n,t))?!1:(u=!!i._isTabNavigation,r===!0&&u===!0&&(f=i.getStyleProperty(n,t,"tabStop"),f===!1&&(r=!1)),r)},l.prototype._getPrevRow=function(n,i){for(var f={r:n,c:i},r,u;n>=0;){if(n--,n<0)break;if(r=this.getSpans(new t.Range(n,i,1,1)),r&&r.length>0&&(u=r[0],n>=u.row&&(n=u.row,i=u.col)),this._canMoveCurrentTo(n,i))return{r:n,c:i}}return{r:n,c:i}},l.prototype._getNextRow=function(n,i){for(var f=this,s=f.getRowCount(),h={r:n,c:i},o,u,r;n<s;){if(o=this._getSpanModel().find(n,i),o?n+=o.rowCount:n++,n>=s)break;if(u=f.getSpans(new t.Range(n,i,1,1)),u&&u.length>0&&(r=u[0],n>r.row?n=e(n,r.row+r.rowCount):i=r.col),f._canMoveCurrentTo(n,i))return{r:n,c:i}}return{r:n,c:i}},l.prototype._setSelectedRange=function(n,t,i,r,u){this._selectionModel.add(n,t,i,r);u&&!this._paintSuspended&&this._render.repaintSelection()},l.prototype._extendSelectedRange=function(n,t,i){var r=this,u=r._getExtendedRange(n,t,r._activeRowIndex,r._activeColIndex),f=u.row,e=u.col,o=u.rowCount,s=u.colCount,h=r.selectionPolicy(),c=r.selectionUnit();if(h===0)return;else h===1&&r._selectionModel.clear();c===1?(e=-1,s=-1):c===2&&(f=-1,o=-1);r._replaceActiveSelectedRange(f,e,o,s,i)},l.prototype._getExtendedRange=function(n,i,r,f){var e=this,h,c,l,a,o,s;return typeof r===u&&(r=e._activeRowIndex),typeof f===u&&(f=e._activeColIndex),h=new t.Range(r,f,1,1),c=this._getSpanModel().find(r,f),c&&(h=c),l=new t.Range(n,i,1,1),a=this._getSpanModel().find(n,i),a&&(l=a),o=h.union(l),s=e.getSpans(),s&&s.length>0&&(o=e._inflateRangeToCoverSpans(s,o)),o},l.prototype._replaceActiveSelectedRange=function(n,i,r,u,f){var o=this,s=o._getActiveSelectedRange(),e,h;if(o._selectionModel.length>0?o._selectionModel.splice(o._selectionModel.activeSelectedRangeIndex,1,new t.Range(n,i,r,u)):o._selectionModel.add(n,i,r,u),f&&!o._paintSuspended){if(e=o._getActiveSelectedRange(),e.row===s.row&&e.col===s.col&&e.rowCount===s.rowCount&&e.colCount===s.colCount)return;h=o._render;s.containsRange(e)?h.repaintSelection(s):e.containsRange(s)?h.repaintSelection(e):(h.repaintSelection(s),h.repaintSelection(e))}},l.prototype._changeActiveSelectedRange=function(n,t){var i=this,f,r,u;if(!(i._selectionModel.length<=0)&&(f=i._getActiveSelectedRange(),r=i._getKeyboardSelectedRange(f,n,t),r)){var e=i._selectionModel.toArray(),o=r.row,s=r.col,h=r.rowCount,c=r.colCount,l=i.selectionPolicy(),a=i.selectionUnit();if(l===0)return;else l===1&&i._selectionModel.clear();a===1?(s=-1,c=-1):a===2&&(o=-1,h=-1);i._replaceActiveSelectedRange(o,s,h,c,!0);u=i._selectionModel.toArray();i._eventHandler._notEqualSelecions(e,u)&&(i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:e,newSelections:u}),i.triggerSelectionChanged({sheet:i,sheetName:i._name}))}},l.prototype._getKeyboardSelectedRange=function(n,t,r,u,f){var e=this,o=e._fixRange(n),s=i;return t===37?s=r?e._searchSelectedRangebyLeftCtrl(o,!1,u,f):e._searchSelectedRangebyLeft(o,u,f):t===39?s=r?e._searchSelectedRangebyRightCtrl(o,!1,u,f):e._searchSelectedRangebyRight(o,u,f):t===38?s=r?e._searchSelectedRangebyUpCtrl(o,!1,u,f):e._searchSelectedRangebyUp(o,u,f):t===40?s=r?e._searchSelectedRangebyDownCtrl(o,!1,u,f):e._searchSelectedRangebyDown(o,u,f):t===36?s=r?e._searchSelectedRangebyHomeCtrl(o,u,f):e._searchSelectedRangebyHome(o,u,f):t===35?s=r?e._searchSelectedRangebyEndCtrl(o,u,f):e._searchSelectedRangebyEnd(o,u,f):t===33?s=e._searchSelectedRangebyPageUp(o,u,f):t===34&&(s=e._searchSelectedRangebyPageDown(o,u,f)),s&&(n.row<0&&(s.row=-1,s.rowCount=-1),n.col<0&&(s.col=-1,s.colCount=-1)),s},l.prototype._searchSelectedRangebyLeft=function(n,r,u){for(var s=this,c=n.col+n.colCount-1,d=0,b={r:n.row+n.rowCount-1,c:c},o,l,h,k,a,v,y,p,w;c>d;)if((c--,s._canMoveCurrentTo(b.r,c))&&(o=s._getExtendedRange(b.r,c,r,u),l=f(n.row,o.row),h=f(n.col,o.col),k=e(n.row+n.rowCount-1,o.row+o.rowCount-1),a=f(n.col+n.colCount-1,o.col+o.colCount-1),v=k-l+1,y=a-h+1,!(l===n.row&&h===n.col&&v===n.rowCount&&y===n.colCount)))return p=s._scrollLeftCol,w=s._activeColIndex,n.col<w?h<=p&&s._setLeftColumn(h):n.col===w&&a<=p&&s._setLeftColumn(a),new t.Range(l,h,v,y);return i},l.prototype._searchSelectedRangebyLeftCtrl=function(n,u,o,s){var h=this,k=h.frozenColCount?h._getNextVisualColumn(h.frozenColCount-1):h._getFirstVisualColumn(),l=u?k:h._getFirstVisualColumn(),c,a,v,y,p,w,b;if(l===r||l===i)return;else(h.frozenColCount<=0||u)&&h._setLeftColumn(l);return c=h._getExtendedRange(n.row,l,o,s),a=f(n.row,c.row),v=f(n.col,c.col),y=e(n.row+n.rowCount-1,c.row+c.rowCount-1),p=f(n.col+n.colCount-1,c.col+c.colCount-1),w=y-a+1,b=p-v+1,new t.Range(a,v,w,b)},l.prototype._searchSelectedRangebyRight=function(n,r,u){for(var o=this,c=n.col,d=o.getColumnCount()-1,b={r:n.row+n.rowCount-1,c:c},s,l,h,k,a,v,y,p,w;c<d;)if((c++,o._canMoveCurrentTo(b.r,c))&&(s=o._getExtendedRange(b.r,c,r,u),l=f(n.row,s.row),h=e(n.col,s.col),k=e(n.row+n.rowCount-1,s.row+s.rowCount-1),a=e(n.col+n.colCount-1,s.col+s.colCount-1),v=k-l+1,y=a-h+1,!(l===n.row&&h===n.col&&v===n.rowCount&&y===n.colCount)))return p=o._getPageRightColumn(),w=o._activeColIndex,n.col<w?h>=p&&o._setLeftColumn(o._getNewLeftColumn(h,2)):n.col===w&&a>=p&&o._setLeftColumn(o._getNewLeftColumn(a,2)),new t.Range(l,h,v,y);return i},l.prototype._searchSelectedRangebyRightCtrl=function(n,u,o,s){var c=this,l=c._getLastPageLeftColumn(),a,h,v,y,p,w,b,k;if(l===r||l===i)return;else c._setLeftColumn(l);return a=c._getLastVisualColumn(),u||(a+=c._frozenTrailingColCount),h=c._getExtendedRange(n.row,a,o,s),v=f(n.row,h.row),y=e(n.col,h.col),p=e(n.row+n.rowCount-1,h.row+h.rowCount-1),w=e(n.col+n.colCount-1,h.col+h.colCount-1),b=p-v+1,k=w-y+1,new t.Range(v,y,b,k)},l.prototype._searchSelectedRangebyUp=function(n,r,u){for(var s=this,c=n.row+n.rowCount-1,d=0,b={r:c,c:n.col+n.colCount-1},o,h,l,a,k,v,y,p,w;c>d;)if((c--,s._canMoveCurrentTo(c,b.c))&&(o=s._getExtendedRange(c,b.c,r,u),h=f(n.row,o.row),l=f(n.col,o.col),a=f(n.row+n.rowCount-1,o.row+o.rowCount-1),k=e(n.col+n.colCount-1,o.col+o.colCount-1),v=a-h+1,y=k-l+1,!(h===n.row&&l===n.col&&v===n.rowCount&&y===n.colCount)))return p=s._scrollTopRow,w=s._activeRowIndex,n.row<w?h<=p&&s._setTopRow(h):n.row===w&&a<=p&&s._setTopRow(a),new t.Range(h,l,v,y);return i},l.prototype._searchSelectedRangebyUpCtrl=function(n,u,o,s){var h=this,k=h.frozenRowCount?h._getNextVisualRow(h.frozenRowCount-1):h._getFirstVisualRow(),l=u?k:h._getFirstVisualRow(),c,a,v,y,p,w,b;if(l===r||l===i)return;else(h.frozenRowCount<=0||u)&&h._setTopRow(l);return c=h._getExtendedRange(l,n.col,o,s),a=f(n.row,c.row),v=f(n.col,c.col),y=f(n.row+n.rowCount-1,c.row+c.rowCount-1),p=e(n.col+n.colCount-1,c.col+c.colCount-1),w=y-a+1,b=p-v+1,new t.Range(a,v,w,b)},l.prototype._searchSelectedRangebyDown=function(n,r,u){for(var o=this,c=n.row,d=o.getRowCount()-1,b={r:c,c:n.col+n.colCount-1},s,h,l,a,k,v,y,p,w;c<d;)if((c++,o._canMoveCurrentTo(c,b.c))&&(s=o._getExtendedRange(c,b.c,r,u),h=e(n.row,s.row),l=f(n.col,s.col),a=e(n.row+n.rowCount-1,s.row+s.rowCount-1),k=e(n.col+n.colCount-1,s.col+s.colCount-1),v=a-h+1,y=k-l+1,!(h===n.row&&l===n.col&&v===n.rowCount&&y===n.colCount)))return p=o._getPageBottomRow(),w=o._activeRowIndex,n.row<w?h>=p&&o._setTopRow(o._getNewTopRow(h,2)):n.row===w&&a>=p&&o._setTopRow(o._getNewTopRow(a,2)),new t.Range(h,l,v,y);return i},l.prototype._searchSelectedRangebyDownCtrl=function(n,u,o,s){var c=this,l=c._getLastPageTopRow(),a,h,v,y,p,w,b,k;if(l===r||l===i)return;else c._setTopRow(l);return a=c._getLastVisualRow(),u||(a+=c._frozenTrailingRowCount),h=c._getExtendedRange(a,n.col,o,s),v=e(n.row,h.row),y=f(n.col,h.col),p=e(n.row+n.rowCount-1,h.row+h.rowCount-1),w=e(n.col+n.colCount-1,h.col+h.colCount-1),b=p-v+1,k=w-y+1,new t.Range(v,y,b,k)},l.prototype._searchSelectedRangebyHome=function(n,r,u){for(var o=this,h=o.frozenColCount?o.frozenColCount-1:-1,b=o._activeColIndex,a={r:n.row+n.rowCount-1,c:n.col},s,c,l,v,y,p,w;h<b;)if(h++,o._canMoveCurrentTo(a.r,h)){if(n.col<=h&&n.col+n.colCount-1===o._activeColIndex)break;return s=o._getExtendedRange(a.r,h,r,u),c=f(n.row,s.row),l=f(n.col,s.col),v=e(n.row+n.rowCount-1,s.row+s.rowCount-1),y=f(n.col+n.colCount-1,s.col+s.colCount-1),p=v-c+1,w=y-l+1,o._setLeftColumn(o._getFirstVisualColumn()),new t.Range(c,l,p,w)}return i},l.prototype._searchSelectedRangebyHomeCtrl=function(n,t,i){return n=this._searchSelectedRangebyLeftCtrl(n,!0,t,i),this._searchSelectedRangebyUpCtrl(n,!0,t,i)},l.prototype._searchSelectedRangebyEnd=function(n,r,u){for(var o=this,h=o.getColumnCount(),b=o._activeColIndex,a={r:n.row+n.rowCount-1,c:n.col+n.colCount-1},s,c,l,v,y,p,w;h>b;)if(h--,o._canMoveCurrentTo(a.r,h)){if(n.col+n.colCount-1>=h&&n.col===o._activeColIndex)break;return s=o._getExtendedRange(a.r,h,r,u),c=f(n.row,s.row),l=e(n.col,s.col),v=e(n.row+n.rowCount-1,s.row+s.rowCount-1),y=e(n.col+n.colCount-1,s.col+s.colCount-1),p=v-c+1,w=y-l+1,o._setLeftColumn(o._getLastPageLeftColumn()),new t.Range(c,l,p,w)}return i},l.prototype._searchSelectedRangebyEndCtrl=function(n,t,i){return n=this._searchSelectedRangebyRightCtrl(n,!0,t,i),this._searchSelectedRangebyDownCtrl(n,!0,t,i)},l.prototype._searchSelectedRangebyPageUp=function(n,u,o){var s=this,l=s._getPrevPageTopRow(),c,a,v,y,p,w,b;if(l===r||l===i)return i;var k=s._getRowLayout(1),d=s._setTopRow(l),h=-1;return d?h=s._getNextVisualRow(n.row+n.rowCount-1-k.length):s.frozenRowCount<=0&&(h=s._getFirstVisualRow()),h<s._scrollTopRow?h=s._scrollTopRow:h>=s._getPageBottomRow()&&(h=s._getPrevVisualRow(s._getPageBottomRow())),c=s._getExtendedRange(h,n.col,u,o),a=f(n.row,c.row),v=f(n.col,c.col),y=f(n.row+n.rowCount-1,c.row+c.rowCount-1),p=e(n.col+n.colCount-1,c.col+c.colCount-1),w=y-a+1,b=p-v+1,new t.Range(a,v,w,b)},l.prototype._searchSelectedRangebyPageDown=function(n,u,o){var s=this,l=s._getNextPageTopRow(),y,c,h,a,v,p,w,b,k;return l===r||l===i?i:(y=s._getRowLayout(1),s._setTopRow(l),c=s._getPrevVisualRow(n.row+n.rowCount-1+y.length),c<s._scrollTopRow?c=s._scrollTopRow:c>=s._getPageBottomRow()&&(c=s._scrollTopRow>=s._getLastPageTopRow()?s._getPageBottomRow():s._getPrevVisualRow(s._getPageBottomRow())),h=s._getExtendedRange(c,n.col,u,o),a=e(n.row,h.row),v=f(n.col,h.col),p=e(n.row+n.rowCount-1,h.row+h.rowCount-1),w=e(n.col+n.colCount-1,h.col+h.colCount-1),b=p-a+1,k=w-v+1,new t.Range(a,v,b,k))},l.prototype._getPrevPageTopRow=function(){var n=this,r=n._getRowLayout(1);if(!r||r.length<=0)return i;for(var f=n.frozenRowCount?n._getNextVisualRow(n.frozenRowCount-1):n._getFirstVisualRow(),u=0,t=n._scrollTopRow,e=n._getSheetLayout();t>f;){if(u+=n._getZoomRowHeight(t),u>e.viewportHeight)break;t--}return t},l.prototype._getPrevPageLeftColumn=function(){var n=this,r=n._getColumnLayout(1);if(!r||r.length<=0)return i;for(var f=n.frozenColCount?n._getNextVisualColumn(n.frozenColCount-1):n._getFirstVisualColumn(),u=0,t=n._scrollLeftCol,e=n._getSheetLayout();t>f;){if(u+=n._getZoomColumnWidth(t),u>e.viewportWidth)break;t--}return t},l.prototype._getNextPageTopRow=function(){var n=this._getRowLayout(1);return!n||n.length<=0?i:this._getLastVisualRow()===n[n.length-1].row?this._scrollTopRow:n[n.length-1].row},l.prototype._getLastPageTopRow=function(){var n=this,i,t,r,u,f;if(n._getLastVisualRow()===n._getPageBottomRow()&&(i=n._getSheetLayout(),t=n._getRowLayout(1),t&&t.length>=1&&(r=t[t.length-1],r.y+r.height<=i.viewportY+i.viewportHeight)))return n._scrollTopRow;u=n._scrollTopRow;try{return n._scrollTopRow=n._getLastVisualRow(),f=n._getPrevPageTopRow(),n._getNextVisualRow(f)}catch(e){}finally{n._scrollTopRow=u}},l.prototype._getLastPageLeftColumn=function(){var n=this,i,r,u,f,t;if(n._getLastVisualColumn()===n._getPageRightColumn()&&(i=n._getSheetLayout(),r=n._getColumnLayout(1),r&&r.length>=1&&(u=r[r.length-1],u.x+u.width<=i.viewportX+i.width)))return n._scrollLeftCol;for(i=n._getSheetLayout(),f=0,t=n._getLastVisualColumn();t>0;){if(f+=n._getZoomColumnWidth(t),f>i.viewportWidth)break;t--}return t>0&&(t=n._getNextVisualColumn(t)),t},l.prototype._getPageBottomRow=function(){var n=this._getRowLayout(1);return!n||n.length<=0?i:n[n.length-1].row},l.prototype._getPageRightColumn=function(){var n=this._getColumnLayout(1);return!n||n.length<=0?i:n[n.length-1].col},l.prototype._getLastFullyVisibleRow=function(){var n=this._getRowLayout(1),r,t;return!n||n.length<=0?i:(r=this._getSheetLayout(),t=n.length-1,n[t].y+n[t].height<=r.viewportY+r.viewportHeight?n[t].row:n[e(t-1,0)].row)},l.prototype._getLastFullyVisibleColumn=function(){var n=this._getColumnLayout(1),r,t;return!n||n.length<=0?i:(r=this._getSheetLayout(),t=n.length-1,n[t].x+n[t].width<=r.viewportX+r.viewportWidth?n[t].col:n[e(t-1,0)].col)},l.prototype._getFirstVisualRow=function(){return this._getNextVisualRow(-1)},l.prototype._getLastVisualRow=function(n){(n===r||n===i)&&(n=3);var t=this.getRowCount(n);return(n===3||n===2)&&(t=t-this._frozenTrailingRowCount),this._getPrevVisualRow(t,n)},l.prototype._getFirstVisualColumn=function(){return this._getNextVisualColumn(-1)},l.prototype._getLastVisualColumn=function(n){(n===r||n===i)&&(n=3);var t=this.getColumnCount(n);return(n===3||n===1)&&(t=t-this._frozenTrailingColCount),this._getPrevVisualColumn(t,n)},l.prototype._getFirstPageLeftColumn=function(){var n=this,t=isNaN(n.frozenColCount)?0:n.frozenColCount;return t>0?n._getNextVisualColumn(t-1):n._getFirstVisualColumn()},l.prototype._getFirstPageTopRow=function(){var n=this,t=isNaN(n.frozenRowCount)?0:n.frozenRowCount;return t>0?n._getNextVisualRow(t-1):n._getFirstVisualRow()},l.prototype._getNextVisualRow=function(n,t){for(var r=this,u=t?r.getRowCount()-1:r.getRowCount()-1-r._frozenTrailingRowCount;n<u;)if(n++,r.getRowVisible(n)&&r._getZoomRowHeight(n)>0)return n;return i},l.prototype._getPrevVisualRow=function(n,t,r){for(var u=r?0:this.frozenRowCount;n>u;)if(n--,this.getRowVisible(n,t)&&this._getZoomRowHeight(n,t)>0)return n;return i},l.prototype._getNextVisualColumn=function(n){for(var t=this,r=t.getColumnCount()-1-t._frozenTrailingColCount;n<r;)if(n++,t.getColumnVisible(n)&&t._getZoomColumnWidth(n)>0)return n;return i},l.prototype._getPrevVisualColumn=function(n,t){while(n>this.frozenColCount)if(n--,this.getColumnVisible(n,t)&&this._getZoomColumnWidth(n,t)>0)return n;return i},l.prototype._inflateRangeToCoverSpans=function(n,t){var r,i;if(n&&n.length>0)for(r=0;r<n.length;r++)if(i=n[r],t.intersect(i.row,i.col,i.rowCount,i.colCount))return n.splice(r--,1),this._inflateRangeToCoverSpans(n,t.union(i));return t},l.prototype._getActiveSelectedRange=function(n){var i=this,r=new t.Range(-1,-1,0,0);return i._selectionModel.length<=0?r:(n===3?(i._selectionModel.activeSelectedRangeIndex--,i._selectionModel.activeSelectedRangeIndex<0&&(i._selectionModel.activeSelectedRangeIndex=i._selectionModel.length-1)):n===4&&(i._selectionModel.activeSelectedRangeIndex++,i._selectionModel.activeSelectedRangeIndex>=i._selectionModel.length&&(i._selectionModel.activeSelectedRangeIndex=0)),i._selectionModel.activeSelectedRangeIndex>=0&&(r=i._selectionModel[i._selectionModel.activeSelectedRangeIndex]),r)},l.prototype._initializeActiveCell=function(){var n=this,s=n._activeRowIndex,h=n._activeColIndex,c=n._selectionModel;if(s===r||s===i||h===r||h===i||c.length<=0){var t=0,u=0,f=1,e=1,o=this._getSpanModel().find(t,u);o&&(f=o.rowCount,e=o.colCount);c.add(t,u,f,e);n._activeRowIndex=t;n._activeColIndex=u;n._activeRowCount=f;n._activeColCount=e;n._leadingCellRow=t;n._leadingCellCol=u}},l.prototype._isResizeInfoEqual=function(n,t){var i=!1;return n||t?n&&t&&(i=n.action===t.action&&n.index===t.index&&n.sheetArea===t.sheetArea):i=!0,i},l.prototype._setHoverCell=function(n){var u=this,o=!1,r=u._currentTarget,s,h,f;if(r||(o=!0),o||n||(o=!0),o||(o=n.col!==r.col||n.row!==r.row||n.colViewportIndex!==r.colViewportIndex||n.rowViewportIndex!==r.rowViewportIndex||n.hitTestType!==r.hitTestType||!u._isResizeInfoEqual(n.resizeInfo,r.resizeInfo)),u._currentTarget=n,o){u._hoverCell=!0;var e=u._getSheetLayout(),l=u._render,t=i,c=!1;r&&(r.rowViewportIndex<0||r.colViewportIndex<0)&&(t=u.getCellRect(r.row,r.col,r.rowViewportIndex,r.colViewportIndex),t&&t.width>0&&t.height>0&&(s=0,h=0,f=u._getGroupLayout(),f&&(s=f.width,h=f.height),(t.x<e.rowHeaderWidth+s||t.y<e.colHeaderHeight+h||t.y>=e.height-e.footerHeight)&&(l.update(t.x,t.y,t.width,t.height),c=u._isHoverOnHeaderSelection(r))));n&&(n.rowViewportIndex<0||n.colViewportIndex<0)&&(t=u.getCellRect(n.row,n.col,n.rowViewportIndex,n.colViewportIndex),t&&t.width>0&&t.height>0&&(s=0,h=0,f=u._getGroupLayout(),f&&(s=f.width,h=f.height),(t.x<e.rowHeaderWidth+s||t.y<e.colHeaderHeight+h||t.y>=e.height-e.footerHeight)&&(l.update(t.x,t.y,t.width,t.height),c||(c=u._isHoverOnHeaderSelection(n)))));u._hoverCell=!1;c&&l.repaintSelection()}},l.prototype._isHoverOnHeaderSelection=function(n){var i=this,t;return i.parent&&i.parent._themeVersion>2007&&(t=3,n.rowViewportIndex<0&&(t=1),n.colViewportIndex<0&&(t=2),t!==3&&i._isSelected(n.row,n.col,t))?!0:!1},l.prototype._getAvailableActiveCell=function(n,t,i){var r=this._skipSpanCell(n,t,i);return this._skipInvisibleCell(r)},l.prototype._skipSpanCell=function(n,i,r){var u=this._getSpanModel().find(n,i);if(u){if(r&&u.rowCount===1||!r&&u.colCount===1)return u}else return new t.Range(n,i,1,1);return r?i++:n++,this._skipSpanCell(n,i,r)},l.prototype._skipInvisibleCell=function(n){for(var r=this,f=n.row,o=r.getRowCount(),u,e,i=f;i<o;i++)if(r.getRowVisible(i)===!0)break;for(i<o&&(f=i),u=n.col,e=r.getColumnCount(),i=u;i<e;i++)if(r.getColumnVisible(i)===!0)break;return i<e&&(u=i),new t.Range(f,u,n.rowCount,n.colCount)},l.prototype._processKeyMap=function(n){var u=n.ctrlKey,f=n.shiftKey,e=n.altKey,o=n.metaKey,s=n.keyCode,i=this._getKeyAction(s,u,f,e,o),r;return i&&typeof i.action===v?(r=i.action.call(this),r&&t.util.cancelDefault(n),r):!1},l.prototype._processSlicerKeyMap=function(n){var r=this,u=r._slicerCollection,f,i,e;return u?(f=u.getSelectedSlicers(),f.length!==1)?!1:(i=r._getSlicerKeyAction(n.keyCode,n.ctrlKey,n.shiftKey,n.altKey,n.metaKey),i&&i.action)?(e=i.action.call(r),e&&t.util.cancelDefault(n),!0):!1:!1},l.prototype._processFloatingObjectsKeyMap=function(n){var u,r,f;if(!t.features.floatingObject||(u=n.keyCode===90&&n.ctrlKey===!0||n.keyCode===89&&n.ctrlKey===!0,u))return!1;var i=this,o=i._eventHandler,e=n.keyCode===86&&n.ctrlKey===!0;return i._hasFloatingObjectsSelected()||e&&i.isPasteFloatingObject()?(r=i._getFloatingObjectKeyAction(n.keyCode,n.ctrlKey,n.shiftKey,n.altKey,n.metaKey),r&&r.action&&(f=r.action.call(i),f&&t.util.cancelDefault(n)),!0):!1},l.prototype.isPasteFloatingObject=function(){var i=this,r=i._eventHandler,e=i._getFloatingObjectClipboardHelper(),u=e.fromSheet,t=u&&u._eventHandler,f=!0,n;return(r||t)&&(n=r._getClipboardFloatingObjectData(),!n&&t&&(n=t._getClipboardFloatingObjectData()),n&&n.length||(f=!1)),f},l.prototype._processCommentKeyMap=function(n){var f,i,u,r,e;if(!t.features.comment||(f=n.keyCode===90&&n.ctrlKey===!0||n.keyCode===89&&n.ctrlKey===!0,f))return!1;if(i=this,u=i._commentManager.getActiveComment(),u){if(n.keyCode===9)return t.util.cancelDefault(n),!0;if(r=i._getCommentKeyAction(n.keyCode,n.ctrlKey,n.shiftKey,n.altKey,n.metaKey),r&&r.action)return e=r.action.call(i),e&&t.util.cancelDefault(n),!0;else if(i._eventHandler.allowEnterEditing(n))return u.commentState(2),!0}return!1},l.prototype._hasFloatingObjectsSelected=function(){var f=this,n=f._floatingObjectArray,i,r,u;if(t.features.floatingObject&&n&&n.length>0)for(i=0,r=n.length;i<r;i++)if(u=n[i],u.isSelected())return!0;return!1},l.prototype._getZoomRowHeight=function(n,t){var i=this.getRowHeight(n,t),r=this._zoomFactor;return r!==1&&(i*=r),s(i)},l.prototype._getZoomColumnWidth=function(n,t){var i=this.getColumnWidth(n,t),r=this._zoomFactor;return r!==1&&(i*=r),s(i)},l.prototype._getGroupLayout=function(){var n=this;return n._cachedGroupLayout||(n._cachedGroupLayout=n._createGroupLayout()),n._cachedGroupLayout},l.prototype._getGroupButtonWidth=function(){return 17},l.prototype._getGroupButtonHeight=function(){return 17},l.prototype._getGroupPadding=function(){return 2},l.prototype._createGroupLayout=function(){var t={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},n=this,o=n._getGroupButtonWidth(),s=n._getGroupButtonHeight(),h=n._getGroupPadding(),u=n.rowRangeGroup,e=n.colRangeGroup,v=n._showRowRangeGroup,y=n._showColumnRangeGroup,c=n._zoomFactor,i,l,r,a;return v&&u&&!u._isEmpty()&&(i=u.getMaxLevel(),i>=0&&(l=f(o,o*c),t.width=l*(i+2)+h*2,t.rowMaxLevel=i)),y&&e&&!e._isEmpty()&&(r=e.getMaxLevel(),r>=0&&(a=f(s,s*c),t.height=a*(r+2)+h*2,t.colMaxLevel=r)),t},l.prototype._createLayout=function(){var u=this,v=u.getBounds(),c=new t.Rect(v.x+u.borderWidth,v.y+u.borderWidth,e(0,v.width-2*u.borderWidth),e(0,v.height-2*u.borderWidth)),a=c.width,l=c.height,n={x:c.x,y:c.y,width:c.width,height:c.height,rowHeaderWidth:0,colHeaderHeight:0,frozenWidth:0,frozenHeight:0,frozenTrailingWidth:0,frozenTrailingHeight:0,footerHeight:0,footerWidth:0,footerX:0,footerY:0,frozenX:0,frozenY:0,frozenTrailingX:0,frozenTrailingY:0,viewportX:0,viewportY:0,viewportHeight:0,viewportWidth:0,headerX:0,headerY:0,headerCornerRect:function(){var n=this;return new t.Rect(n.x,n.y,n.rowHeaderWidth,n.colHeaderHeight)},colHeaderRect:function(n){var r=this;return n===0?new t.Rect(r.frozenX,r.y,r.frozenWidth,r.colHeaderHeight):n===1?new t.Rect(r.viewportX,r.y,r.viewportWidth,r.colHeaderHeight):n===2?new t.Rect(r.frozenTrailingX,r.y,r.frozenTrailingWidth,r.colHeaderHeight):i},rowHeaderRect:function(n){var r=this;return n===0?new t.Rect(r.x,r.frozenY,r.rowHeaderWidth,r.frozenHeight):n===1?new t.Rect(r.x,r.viewportY,r.rowHeaderWidth,r.viewportHeight):n===2?new t.Rect(r.x,r.frozenTrailingY,r.rowHeaderWidth,r.frozenTrailingHeight):i},viewportRect:function(n,r){var u=this;return n===0?r===0?new t.Rect(u.frozenX,u.frozenY,u.frozenWidth,u.frozenHeight):r===1?new t.Rect(u.viewportX,u.frozenY,u.viewportWidth,u.frozenHeight):r===2?new t.Rect(u.frozenTrailingX,u.frozenY,u.frozenTrailingWidth,u.frozenHeight):i:n===1?r===0?new t.Rect(u.frozenX,u.viewportY,u.frozenWidth,u.viewportHeight):r===1?new t.Rect(u.viewportX,u.viewportY,u.viewportWidth,u.viewportHeight):r===2?new t.Rect(u.frozenTrailingX,u.viewportY,u.frozenTrailingWidth,u.viewportHeight):i:n===2?r===0?new t.Rect(u.frozenX,u.frozenTrailingY,u.frozenWidth,u.frozenTrailingHeight):r===1?new t.Rect(u.viewportX,u.frozenTrailingY,u.viewportWidth,u.frozenTrailingHeight):r===2?new t.Rect(u.frozenTrailingX,u.frozenTrailingY,u.frozenTrailingWidth,u.frozenTrailingHeight):i:i},footerRect:function(n){var r=this;return n===0?new t.Rect(r.frozenX,r.footerY,r.frozenWidth,r.footerHeight):n===1?new t.Rect(r.viewportX,r.footerY,r.viewportWidth,r.footerHeight):n===2?new t.Rect(r.frozenTrailingX,r.footerY,r.frozenTrailingWidth,r.footerHeight):i},footerCornerRect:function(){var n=this;return new t.Rect(n.footerX,n.footerY,n.footerWidth,n.footerHeight)}},y=u._getGroupLayout(),f,s,o,h;if(n.x+=y.width,n.y+=y.height,a-=y.width,l-=y.height,u.rowHeaderVisible===i||u.rowHeaderVisible===r||u.rowHeaderVisible)for(h=u.getColumnCount(2),o=0;o<h;o++)n.rowHeaderWidth+=u._getZoomColumnWidth(o,2);if(u.colHeaderVisible===i||u.colHeaderVisible===r||u.colHeaderVisible)for(s=u.getRowCount(1),f=0;f<s;f++)n.colHeaderHeight+=u._getZoomRowHeight(f,1);if(u.frozenColCount>0)for(h=u.getColumnCount(),o=0;o<u.frozenColCount&&o<h;o++)u.getColumnVisible(o)&&(n.frozenWidth+=u._getZoomColumnWidth(o));if(u.frozenRowCount>0)for(s=u.getRowCount(),f=0;f<u.frozenRowCount&&f<s;f++)u.getRowVisible(f)&&(n.frozenHeight+=u._getZoomRowHeight(f));if(u._frozenTrailingColCount>0)for(h=u.getColumnCount(),o=e(u.frozenColCount,h-u._frozenTrailingColCount);o<h;o++)n.frozenTrailingWidth+=u._getZoomColumnWidth(o);if(u._frozenTrailingRowCount>0)for(s=u.getRowCount(),f=e(u.frozenRowCount,s-u._frozenTrailingRowCount);f<s;f++)n.frozenTrailingHeight+=u._getZoomRowHeight(f);return a-=n.rowHeaderWidth,l-=n.colHeaderHeight,a-=n.frozenWidth,l-=n.frozenHeight,a-=n.frozenTrailingWidth,l-=n.frozenTrailingHeight,l-=n.footerHeight,n.viewportWidth=e(0,a),n.viewportHeight=e(0,l),n.headerX=n.x,n.headerY=n.y,n.frozenX=n.headerX+n.rowHeaderWidth,n.frozenY=n.headerY+n.colHeaderHeight,n.viewportX=n.frozenX+n.frozenWidth,n.viewportY=n.frozenY+n.frozenHeight,n.frozenTrailingX=n.viewportX+n.viewportWidth,n.frozenTrailingY=n.viewportY+n.viewportHeight,n.footerX=n.headerX,n.footerY=n.y+n.height-n.footerHeight,n},l.prototype._getSheetLayout=function(){var n=this;return n._layoutModel||(n._layoutModel=n._createLayout()),n._layoutModel},l.prototype._getColumnLayout=function(n,t){if(typeof t===u||t===i||t===3||t===1)return this._getViewportColumnLayout(n);else if(t===2)return this._getRowHeaderColumnLayout();return i},l.prototype._getRowHeaderColumnLayout=function(){var n=this;return n._colLayoutCache.rowHeader||(n._colLayoutCache.rowHeader=n._createRowHeaderColumnLayout()),n._colLayoutCache.rowHeader},l.prototype._getViewportColumnLayout=function(n){var t=this;return t._colLayoutCache.viewport||(t._colLayoutCache.viewport={}),t._colLayoutCache.viewport[n]||(t._colLayoutCache.viewport[n]=t._createViewportColumnLayout(n)),t._colLayoutCache.viewport[n]},l.prototype._createRowHeaderColumnLayout=function(){for(var r=new t._LayoutModel,f=this._getSheetLayout(),u=f.headerX,i,e=this.getColumnCount(2),n=0;n<e;n++)i=this._getZoomColumnWidth(n,2),r.push(new t._Layout(-1,n,u,-1,i,-1)),u+=i;return r},l.prototype._createViewportColumnLayout=function(n){var r=this,h=new t._LayoutModel,c=r._getSheetLayout(),s=r.getColumnCount(),i,o,u,l=r._cachePool,a,v;if(n===0)for(o=c.frozenX,s=isNaN(r.frozenColCount)?0:f(r.frozenColCount,s),i=0;i<s;i++)u=l.getZoomColWidth(i),h.push(new t._Layout(-1,i,o,-1,u,-1)),o+=u;else if(n===1)for(o=c.viewportX,s=s-r._frozenTrailingColCount,a=c.viewportWidth,v=e(r.frozenColCount,r._scrollLeftCol),i=v;a>0&&i<s;i++)u=l.getZoomColWidth(i),h.push(new t._Layout(-1,i,o,-1,u,-1)),o+=u,a-=u;else if(n===2)for(o=c.frozenTrailingX,i=e(r.frozenColCount,s-r._frozenTrailingColCount);i<s;i++)u=l.getZoomColWidth(i),h.push(new t._Layout(-1,i,o,-1,u,-1)),o+=u;return h},l.prototype._getRowLayout=function(n,t){if(typeof t===u||t===i||t===3||t===2)return this._getViewportRowLayout(n);else if(t===1)return this._getColumnHeaderRowLayout();return i},l.prototype._getAllRowLayout=function(n){for(var i,r=new t._LayoutModel,u=0;u<3;u++)i=this._getRowLayout(u,n),i&&i.length>0&&(r=t.GC$.merge(r,i));return r},l.prototype._getAllColumnLayout=function(n){for(var i,r=new t._LayoutModel,u=0;u<3;u++)i=this._getColumnLayout(u,n),i&&i.length>0&&(r=t.GC$.merge(r,i));return r},l.prototype._getColumnHeaderRowLayout=function(){var n=this;return n._rowLayoutCache.colHeader||(n._rowLayoutCache.colHeader=n._createColumnHeaderRowLayout()),n._rowLayoutCache.colHeader},l.prototype._getViewportRowLayout=function(n){var t=this;return t._rowLayoutCache.viewport||(t._rowLayoutCache.viewport={}),t._rowLayoutCache.viewport[n]||(t._rowLayoutCache.viewport[n]=t._createViewportRowLayout(n)),t._rowLayoutCache.viewport[n]},l.prototype._createColumnHeaderRowLayout=function(){for(var r=new t._LayoutModel,f=this._getSheetLayout(),u=f.headerY,i,e=this.getRowCount(1),n=0;n<e;n++)i=this._getZoomRowHeight(n,1),r.push(new t._Layout(n,-1,-1,u,-1,i)),u+=i;return r},l.prototype._createViewportRowLayout=function(n){var r=this,h=new t._LayoutModel,c=r._getSheetLayout(),s=r.getRowCount(),i,o,u,l=r._cachePool,a,v;if(n===0)for(o=c.frozenY,s=isNaN(r.frozenRowCount)?0:f(r.frozenRowCount,s),i=0;i<s;i++)u=l.getZoomRowHeight(i),h.push(new t._Layout(i,-1,-1,o,-1,u)),o+=u;else if(n===1)for(o=c.viewportY,s=s-r._frozenTrailingRowCount,a=c.viewportHeight,v=e(r.frozenRowCount,r._scrollTopRow),i=v;a>0&&i<s;i++)u=l.getZoomRowHeight(i),h.push(new t._Layout(i,-1,-1,o,-1,u)),o+=u,a-=u;else if(n===2)for(o=c.frozenTrailingY,i=e(r.frozenRowCount,s-r._frozenTrailingRowCount);i<s;i++)u=l.getZoomRowHeight(i),h.push(new t._Layout(i,-1,-1,o,-1,u)),o+=u;return h},l.prototype._getCellLayout=function(n,i,r){var u=this,v=u.getRowCount(r),y=u.getColumnCount(r),f=u._getRowLayout(n,r),e=u._getColumnLayout(i,r),c=new t._LayoutModel;if(f&&f.length>0&&e&&e.length>0){var o=f[0].row,s=e[0].col,l=f[f.length-1].row,a=e[e.length-1].col,h=u.getSpans(new t.Range(o,s,l-o+1,a-s+1),r);h&&h.length>0&&u._addCellLayout(h,o,s,l,a,c,v,y,r,f,e)}return c},l.prototype._getCellLayoutByCell=function(n,r,u,f,e){var o=this,v=o.getRowCount(u),y=o.getColumnCount(u),h=o._getRowLayout(n,u),c=o._getColumnLayout(r,u),l=new t._LayoutModel,a;if(h&&h.length>0&&c&&c.length>0){var p=h[0].row,w=c[0].col,s=o.getSpan(f,e,u);return(s&&(a=[],a.push(s),o._addCellLayout(a,p,w,s.row+s.rowCount,s.col+s.colCount,l,v,y,u,h,c)),l.length>0)?l[0]:i}return i},l.prototype._addCellLayout=function(n,i,r,u,f,e,o,s,h,c,l){var ot=n.length,ut,v,ft,et,a;if(!(ot<=0)){var w=this,b=u+1,k=f+1,y=new Array(b),p=new Array(k),nt=new Array(k),tt=new Array(b),d=0,g=0;for(a=i-1;a>=0;a--)y[a]=w._getZoomRowHeight(a,h),g-=y[a],tt[a]=g;for(g=0,a=i;a<b;a++)tt[a]=g,y[a]=w._getZoomRowHeight(a,h),g+=y[a];for(a=r-1;a>=0;a--)p[a]=w._getZoomColumnWidth(a,h),d-=p[a],nt[a]=d;for(d=0,a=r;a<k;a++)nt[a]=d,p[a]=w._getZoomColumnWidth(a,h),d+=p[a];for(ut=0;ut<ot;ut++)if(v=n[ut],v.intersect(i,r,u-i+1,f-r+1)){if(ft=v.row+v.rowCount,ft>b){for(a=b;a<ft;a++)y.push(w._getZoomRowHeight(a,h)),tt.push(tt[a-1]+y[a]);b=ft}if(et=v.col+v.colCount,et>k){for(a=k;a<et;a++)p.push(w._getZoomColumnWidth(a,h)),nt.push(nt[a-1]+p[a]);k=et}for(var d=nt[v.col],g=tt[v.row],st=0,ht=0,it,rt=v.col;rt<v.col+v.colCount&&rt<s;rt++)st+=p[rt];for(it=v.row;it<v.row+v.rowCount&&it<o;it++)ht+=y[it];e.push(new t._Layout(v.row,v.col,l[0].x+d,c[0].y+g,st,ht,v.rowCount,v.colCount))}}},l.prototype._getRowViewportIndexNearY=function(n){var t=this._getSheetLayout();return this.frozenRowCount>0&&n<t.frozenY+t.frozenHeight?0:this._frozenTrailingRowCount>0&&n>t.frozenTrailingY?2:1},l.prototype._getColumnViewportIndexNearX=function(n){var t=this._getSheetLayout();return this.frozenColCount>0&&n<t.frozenX+t.frozenWidth?0:this._frozenTrailingColCount>0&&n>t.frozenTrailingX?2:1},l.prototype._getViewportColumnLayoutNearX=function(n,t){var r=this._getColumnLayout(n);return r?r.findNearX(t):i},l.prototype._getViewportRowLayoutNearY=function(n,t){var r=this._getRowLayout(n);return r?r.findNearY(t):i},l.prototype._syncHScollbarPosition=function(){var n=this,t=n.parent,i=n._getScrollableColumn(n._scrollLeftCol);i!==-1&&i!==n._scrollLeftCol&&(n._scrollLeftCol=i);t&&t._scrollbarH&&t._scrollbarH.value(n._getVisibleColIndex(n._scrollLeftCol))},l.prototype._syncVScrollbarPosition=function(){var n=this,t=n.parent,i=n._getScrollableRow(n._scrollTopRow);i!==-1&&i!==n._scrollTopRow&&(n._scrollTopRow=i);t&&t._scrollbarV&&t._scrollbarV.value(n._getVisibleRowIndex(n._scrollTopRow))},l.prototype._syncHScrollbarSize=function(){var t=this,n=t.parent;n&&n._resizeHScrollBar&&(n.scrollIgnoreHidden()&&(t._columnIndexInfo=t._getColumnIndexInfo(!0)),n._resizeHScrollBar())},l.prototype._syncVScrollbarSize=function(){var t=this,n=t.parent;n&&n._resizeVScrollBar&&(n.scrollIgnoreHidden()&&(t._rowIndexInfo=t._getRowIndexInfo(!0)),n._resizeVScrollBar())},l.prototype._invalidateVScrollbar=function(){var n=this.parent;n&&n.scrollIgnoreHidden()&&(this._needSyncVScrollbarSize=!0);this._syncVScrollbarPosition()},l.prototype._invalidateHScrollbar=function(){var n=this.parent;n&&n.scrollIgnoreHidden()&&(this._needSyncHScrollbarSize=!0);this._syncHScollbarPosition()},l.prototype._getVisibleRowIndex=function(n){var t=this.parent,i;return t&&t.scrollIgnoreHidden()?(i=this._getRowIndexInfo().visibleIndex,i[n]):n},l.prototype._getOriginalRowIndex=function(n){var t=this.parent,i;return t&&t.scrollIgnoreHidden()?(i=this._getRowIndexInfo().originalIndex,i[n]):n},l.prototype._getVisibleColIndex=function(n){var t=this.parent,i;return t&&t.scrollIgnoreHidden()?(i=this._getColumnIndexInfo().visibleIndex,i[n]):n},l.prototype._getOriginalColIndex=function(n){var t=this.parent,i;return t&&t.scrollIgnoreHidden()?(i=this._getColumnIndexInfo().originalIndex,i[n]):n},l.prototype._getColumnIndexInfo=function(n){var i=this,r,t;if(i._columnIndexInfo&&!n)return i._columnIndexInfo;var s=i.getColumnCount()-i._frozenTrailingColCount-i.frozenColCount,f=i.frozenColCount,e=f+s-1,o=i._cachePool,u={visibleIndex:{},originalIndex:{}};if(e-f+1<=0)return u;for(r=0,t=f;t<=e;t++)u.originalIndex[r]=t,u.visibleIndex[t]=r,o.getZoomColWidth(t)>0&&r++;for(t--,r--;o.getZoomColWidth(t)<=0&&t>=f;)u.originalIndex[r]=t,u.visibleIndex[t]=r,t--;return u},l.prototype._getRowIndexInfo=function(n){var i=this,r,t;if(i._rowIndexInfo&&!n)return i._rowIndexInfo;var s=i.getRowCount()-i._frozenTrailingRowCount-i.frozenRowCount,f=i.frozenRowCount,e=f+s-1,o=i._cachePool,u={visibleIndex:{},originalIndex:{}};if(e-f+1<=0)return u;for(r=0,t=f;t<=e;t++)u.originalIndex[r]=t,u.visibleIndex[t]=r,o.getZoomRowHeight(t)>0&&r++;for(t--,r--;o.getZoomRowHeight(t)<=0&&t>=f;)u.originalIndex[r]=t,u.visibleIndex[t]=r,t--;return u},l.prototype._getScrollableRow=function(n,t){var u=this,f=u.getFrozenRowCount(),e=u.getRowCount()-u.getFrozenTrailingRowCount()-1,r;if(t){if(n>e&&(n=e),r=u._getPrevVisualRow(n+1),r!=i&&r>=f)return r}else if(n<f&&(n=f),r=u._getNextVisualRow(n-1),r!=i&&r<=e)return r;return-1},l.prototype._getScrollableColumn=function(n,t){var u=this,f=u.getFrozenColumnCount(),e=u.getColumnCount()-u.getFrozenTrailingColumnCount()-1,r;if(t){if(n>e&&(n=e),r=u._getPrevVisualColumn(n+1),r!=i&&r>=f)return r}else if(n<f&&(n=f),r=u._getNextVisualColumn(n-1),r!=i&&r<=e)return r;return-1},l.prototype._getTopRowWhenLastRowShowComplete=function(n,t,i){var u,o,r,f,e;if(i<t)return i;for(u=0,o=this._cachePool,r=i,f=i;r>=t;r--)if(e=o.getZoomRowHeight(r),!(e<=0)){if(u+=e,u>n)break;f=r}return f},l.prototype._getBottomRowWhenFirstRowShowComplete=function(n,t,i){var u,o,r,f,e;if(i<t)return i;for(u=0,o=this._cachePool,r=t,f=t;r<=i;r++)if(e=o.getZoomRowHeight(r),!(e<=0)){if(u+=e,u>n)break;f=r}return f},l.prototype._getLeftColWhenLastColShowComplete=function(n,t,i){var u,o,r,f,e;if(i<t)return i;for(u=0,o=this._cachePool,r=i,f=i;r>=t;r--)if(e=o.getZoomColWidth(r),!(e<=0)){if(u+=e,u>n)break;f=r}return f},l.prototype._getPageValueH=function(){var e=this._getSheetLayout(),i=this._getColumnLayout(1,3),f=0,n=0,t,r,u;if(i)for(t=0;t<i.length;t++)r=i[t].width,f+=r,r>0&&n++;return(n=n===0?1:n,u=f/n,u===0)?1:s(e.viewportWidth/u)},l.prototype._getPageValueV=function(){var e=this._getSheetLayout(),i=this._getRowLayout(1,3),f=0,n=0,t,r,u;if(i)for(t=0;t<i.length;t++)r=i[t].height,f+=r,r>0&&n++;return(n=n===0?1:n,u=f/n,u===0)?1:s(e.viewportHeight/u)},l.prototype._getRightColWhenFirstColShowComplete=function(n,t,i){var u,o,r,f,e;if(i<t)return i;for(u=0,o=this._cachePool,r=t,f=t;r<=i;r++)if(e=o.getZoomColWidth(r),!(e<=0)){if(u+=e,u>n)break;f=r}return f},l.prototype._getLastVisualScrollRow=function(n){var s,u,f;(n===r||n===i)&&(n=3);var t=this,e=t.parent,o=t.frozenRowCount;return e&&e._scrollbarMaxAlign?(s=t._getSheetLayout(),t._getTopRowWhenLastRowShowComplete(s.viewportHeight,o,t.getRowCount()-t._frozenTrailingRowCount-1)):(u=t.getRowCount(n),(n===3||n===2)&&(u=u-t._frozenTrailingRowCount),f=t._getPrevVisualRow(u,n),f===i&&(f=o),f)},l.prototype._getLastVisualScrollColumn=function(n){var s,u,f;(n===r||n===i)&&(n=3);var t=this,e=t.parent,o=t.frozenColCount;return e&&e._scrollbarMaxAlign?(s=t._getSheetLayout(),t._getLeftColWhenLastColShowComplete(s.viewportWidth,o,t.getColumnCount()-t._frozenTrailingColCount-1)):(u=t.getColumnCount(n),(n===3||n===1)&&(u=u-t._frozenTrailingColCount),f=t._getPrevVisualColumn(u,n),f===i&&(f=o),f)},l.prototype._getLastNonNullRowAndCol=function(){var r=this,n=r.frozenRowCount,t=r.frozenColCount,v=r._floatingObjectArray,rt=r.getRowCount()-r._frozenTrailingRowCount-1,ut=r.getColumnCount()-r._frozenTrailingColCount-1,u=r._sheetModelManager,y,p,e,s,w,b,h,k,d,nt,g,tt,f,l,it,a,i,c,o;if(u&&(y=u.getRowInfos(3),p=u.getColInfos(3),y&&y._getItems()&&(e=y._getItems(),e.length>0&&e.length-1>n&&(n=e.length-1)),p&&p._getItems()&&(e=p._getItems(),e.length>0&&e.length-1>t&&(t=e.length-1)),s=u.getDataModel(3),s&&(s._lastNonNullRow>n&&(n=s._lastNonNullRow),s._lastNonNullColumn>t&&(t=s._lastNonNullColumn)),w=u.getDataModel(2),w&&w._lastNonNullRow>n&&(n=w._lastNonNullRow),b=u.getDataModel(1),b&&b._lastNonNullColumn>t&&(t=b._lastNonNullColumn)),h=u.getSpanModel(3),h&&(h._lastNonNullRow>n&&(n=h._lastNonNullRow),h._lastNonNullColumn>t&&(t=h._lastNonNullColumn)),k=u.getSpanModel(2),k&&k._lastNonNullRow>n&&(n=k._lastNonNullRow),d=u.getSpanModel(1),d&&d._lastNonNullColumn>t&&(t=d._lastNonNullColumn),nt=r._tableManager,nt&&(g=nt.getTables(),g))for(i=0,c=g.length;i<c;i++)tt=g[i],tt&&(f=tt.range(),f.row+f.rowCount-1>n&&(n=f.row+f.rowCount-1),f.col+f.colCount-1>t&&(t=f.col+f.colCount-1));if(v&&v.length>0)for(i=0,c=v.length;i<c;i++)l=v[i],l&&(l.endRow()>n&&(n=l.endRow()),l.endColumn()>t&&(t=l.endColumn()));if(it=r._commentManager,it&&(a=it._commentViewList,a&&a.length>0))for(i=0,c=a.length;i<c;i++)o=a[i],o&&o._comment&&(o._endRow>n&&(n=o._endRow),o._endColumn>t&&(t=o._endColumn));return n>rt&&(n=rt),t>ut&&(t=ut),{lastNonNullRow:n,lastNonNullCol:t}},l.prototype._setTopRow=function(n){var t=this,r=t._scrollTopRow,i;n>=t._getFirstPageTopRow()&&n<=t._getLastVisualScrollRow()&&n!==r&&(t._eventHandler.vScrollTo(n),t._syncVScrollbarPosition(),i=t.parent,i&&!i._scrollbarShowMax&&t._syncVScrollbarSize())},l.prototype._setLeftColumn=function(n){var t=this,r=t._scrollLeftCol,i;n>=t._getFirstPageLeftColumn()&&n<=t._getLastVisualScrollColumn()&&n!==r&&(t._eventHandler.hScrollTo(n),t._syncHScollbarPosition(),i=t.parent,i&&!i._scrollbarShowMax&&t._syncHScrollbarSize())},l.prototype._getSpanModel=function(n){return this._sheetModelManager.getSpanModel(n)},l.prototype._clipboardFloatingObjectCopy=function(n,r,u){var s,e,h;if(t.features.floatingObject){var f=this,o=f._getFloatingObjectClipboardHelper(),c=o.fromSheet,l=c&&c._eventHandler;for(l&&l._setClipboardFloatingObjectData(i),o.fromSheet=f,o.isCutting=r,s=new t.NamedObjectArray,e=0;e<n.length;e++)h=f._findFloatingObjectInternal(n[e]),h&&s.push(h);f._eventHandler._setClipboardFloatingObjectData(s)}},l.prototype._clipboardCopy=function(n,t,r){var h;if(n){var c="\t",l="\r\n",a='"',u=this,e=u._eventHandler,s=o.getRangeText(u,n.row,n.rowCount,n.col,n.colCount,l,c,a,!1,0),f=u._getClipboardHelper();f.fromSheet=u;f.range=n;f.isCutting=t;u._clearFloatingObjectClipboardHelper();try{h={sheet:u,sheetName:u._name,copyData:s,cancel:!1};u.triggerClipboardChanging(h);h&&h.cancel===!1?(e&&!r&&e._switchFocusForClipboard(s),u.triggerClipboardChanged({sheet:u,sheetName:u._name,copyData:s}),setTimeout(function(){e&&!r&&e._switchBackFocusAfterClipboard()},100)):(f.fromSheet=i,f.range=i)}catch(v){}finally{return s}}},l.prototype._trySearch=function(n,i,r){var l,u,o,s,h,e,c,f;return n?(l=t.SearchFlags,n=n.toString(),i=i.toString(),u=(r&2)>0,u&&(r&4)==0?(r&1)>0?(o=n.toLowerCase(),s=i.toLowerCase(),o===s):n===i:(h=(r&1)>0,e=(r&4)>0,c=h?new RegExp(at(i,e,u),"i"):new RegExp(at(i,e,u)),f=n.search(c)>-1,u&&f&&i.search(/\*/)<=-1&&(f=n.length===i.length),f)):!1},l.prototype._getFilterButtonModel=function(){var n=this;return!n._filterButtonsModel&&t.features.filter_ui&&(n._filterButtonsModel=n._createFilterButtonModle()),n._filterButtonsModel},l.prototype._createFilterButtonModle=function(){var o=this,y=new t._FilterButtonInfoModel,e=o.rowFilter(),c,l,a,p,f,v,u,n,s,i,r;if(e&&e.range){var n=e.range,i=n.col<0?0:n.col,w=n.col<0?o.getColumnCount():n.col+n.colCount,u,h;if(n.row<1?(u=o.getRowCount(1)-1,h=1):(u=n.row-1,h=3),u>=0)while(i<w)e.filterButtonVisible&&e.filterButtonVisible(i)?(r=new t._FilterButtonInfo(e),r.sheetArea=h,r.row=u,c=o.getSpans(new t.Range(u,i,1,1),h),c&&c.length>0?(l=c[0],r.row=l.row,r.col=l.col,i+=l.colCount):(r.col=i,i++),y.push(r)):i++}for(a=o.getTables(),p=a?a.length:0,v=0;v<p;v++)if(f=a[v],f&&f.showHeader()&&(u=f.headerIndex(),u>=0))for(n=f.range(),s=0;s<n.colCount;s++)i=n.col+s,f.filterButtonVisible(s)&&(r=new t._FilterButtonInfo(f.rowFilter(),u,i,3),y.push(r));return y},l.prototype._getFilterButtonHitInfo=function(n,r,u){var s,w,f;if(!t.features.filter_ui)return i;var e=this,p=n.rowViewportIndex,y=n.colViewportIndex,l,a,v;if(n.hitTestType===1?(l=e._getColumnHeaderRowLayout().findY(u),a=e._getViewportColumnLayout(y).findX(r),v=1):n.hitTestType===3&&(l=e._getViewportRowLayout(p).findY(u),a=e._getViewportColumnLayout(y).findX(r),v=3),!l||!a)return i;var h=l.row,c=a.col,o=e.getSpan(h,c,v);if(o){if(h!==o.row+o.rowCount-1||c!==o.col+o.colCount-1)return i;h=o.row;c=o.col}return(s=e._getFilterButtonModel().find(h,c,v),s&&(w=e.getCellRect(h,c,p,y),f=e._render._getFilterButtonRect(w),f.x<=r&&r<=f.x+f.width&&f.y<=u&&u<=f.y+f.height))?new t._FilterButtonInfo(s.rowFilter,s.row,s.col,s.sheetArea,f.x,f.y,f.width,f.height):i},l.prototype._getCellTypeHitInfo=function(n,t,u){var f=this,e=n.row,o=n.col,s=n.hitTestType;if(e===i||e===r||o===i||o===r)return i;var h=f.getActualStyle(e,o,s),c=s===1?-1:r,l=s===2?-1:r,a=f.getCellRect(e,o,c,l),v={sheet:f,row:e,col:o,sheetArea:s},y=h.cellType||f.getDefaultCellType(s);return f._allowEditorReservedLocations?y.getHitInfo(t,u,h,a,v):i},l.prototype._getFloatingObjectHitInfo=function(n,r){var f=this,o=f._floatingObjectArray,e=f._getSheetLayout(),s,u;if(t.features.floatingObject&&e&&o&&o.length>0)for(s=o.length-1;s>=0;s--)if(u=o[s],f.canSelectFloatingObject(u)){var h=u.position().x*f._zoomFactor+e.headerX+e.rowHeaderWidth,c=u.position().y*f._zoomFactor+e.headerY+e.colHeaderHeight,l=u.width(),a=u.height();if(n>=h&&n<h+l&&r>=c&&r<c+a)return{x:n,y:r,floatingObject:u}}return i},l.prototype._getCommentHitInfo=function(n,r){return t.features.comment?this._commentManager.getCommentHitInfo(n,r):i},l.prototype._disposeUserEvents=function(){this.unbindAll();this._unbindAll()},l.prototype._doCommand=function(n){var t=this.undoManager();return t.doAction(n)},l.prototype._refreshTabStrip=function(){var n=this;n.parent&&n.parent._tab&&n.parent._tab.repaint&&n.parent._tab.repaint()},l.prototype._isAnyCellInRangeLocked=function(n){for(var i,t=this._getActualRange(n),u=t.row,f=t.col,o=u+t.rowCount,s=f+t.colCount,e,r=u;r<o;r++)for(i=f;i<s;i++)if(e=this.getActualStyle(r,i),e.locked===!0)return!0;return!1},l.prototype._isValidRange=function(n,t,i,r,u,f){if(-1<=n&&n<u&&-1<=t&&t<f)if(n===-1&&t===-1)return!0;else if(n===-1){if(r!==0&&t+r<=f)return!0}else if(t===-1){if(i!==0&&n+i<=u)return!0}else if(r!==0&&t+r<=f&&i!==0&&n+i<=u)return!0;return!1},l.prototype._isValidPastedRange=function(n,t,i,r,u,f){return this._isValidRange(n,t,i,r,u,f)},l.prototype._hasPartSpans=function(n,t,r,u){var e,f,o,s,h,c;if(n<0&&t<0)return!1;else if(n<0){if(o=this._getSpanModel(1),o&&o.length!==0)for(e=o.getEnumerator(-1,t,-1,u),f=i;e.moveNext();)if(f=e.current(),f.col<t||f.col+f.colCount>t+u)return!0}else if(t<0&&(s=this._getSpanModel(2),s&&s.length!==0))for(e=s.getEnumerator(n,-1,r,-1),f=i;e.moveNext();)if(f=e.current(),f.row<n||f.row+f.rowCount>n+r)return!0;if(h=this._getSpanModel(),h&&h.length!==0)for(c=h.getEnumerator(n,t,r,u),f=i;c.moveNext();)if((f=c.current(),n!==-1&&(f.row<n||f.row+f.rowCount>n+r))||t!==-1&&(f.col<t||f.col+f.colCount>t+u))return!0;return!1},l.prototype._hasSpans=function(n,t,i,r){var f=this._getSpanModel(),u,e,o;if(f)for(u=0,e=f.length;u<e;u++)if(o=f[u],o.intersect(n,t,i,r))return!0;return!1},l.prototype._hasPartTable=function(n,i,r,u){var e=this.getTables(),s,h,f,o;if(e&&e.length>0)for(s=new t.Range(n,i,r,u),h=e.length,o=0;o<h;o++)if(f=e[o].range(),s.intersect(f.row,f.col,f.rowCount,f.colCount)&&!s.containsRange(f))return!0;return!1},l.prototype._hasTable=function(n,t,i,r){return this._tableManager&&this._tableManager.has(n,t,i,r)?!0:!1},l.prototype._hasPartArrayFormulas=function(n,t,i,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(n,t,i,r,!0,!0)},l.prototype._getsArrayFormulas=function(n,t,i,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(n,t,i,r,!1,!0)},l.prototype._hasArrayFormula=function(n,t,i,r){var u=this._getsArrayFormulas(n,t,i,r);return u&&u.formulas&&u.formulas.length>0},l.prototype._suspendInvalidate=function(){this._layoutSuspended++},l.prototype._resumeInvalidate=function(){var n=this;if(n._layoutSuspended--,n._layoutSuspended<=0){if(!n.isPaintSuspended())return n.invalidateLayout(),n.repaint(),!0;n._layoutSuspended=0}return!1},l.prototype._nextNonNullRow=function(n,t){var r=this,f=r._bindingManager,o=r.getDataSource(),u,i;for(n++,u=t?r._getModel(2):r._getModel(3),i=u.getRowCount(),t===!1&&o&&(i=e(i,f.getRowCount()));n>=0&&n<i;){if(u.dataTable.hasOwnProperty(n)&&u.dataTable[n])break;if(t===!1&&o&&f.getDataItem(n))break;n++}return n<i?n:-1},l.prototype._nextNonNullColumn=function(n,t,u){var o=this,h=o._bindingManager,c=o.getDataSource(),f=i,e=u?o._getModel(1):o._getModel(3),s;if(n>=0&&n<e.getRowCount()&&e.dataTable.hasOwnProperty(n)&&(f=e.dataTable[n]),u===!1&&!f&&c&&n>=0&&n<h.getRowCount()&&(f=h.getDataItem(n)),!f)return-1;for(t++;t>=0&&(t<e.getColumnCount()||t<f.length);){if(f.hasOwnProperty(t)&&f[t])break;if(u===!1&&c&&(s=o._getValueImp(e,n,t),s!==r&&s!==i))break;t++}return t<e.getColumnCount()||u===!1&&f&&t<f.length?t:-1},l.prototype._closeDragFillPopup=function(){this._smartTag&&this._smartTag.close()},l.prototype._cellRangeInflate=function(n,t){var r,i;if(n&&n.length>0)for(r=0;r<n.length;r++)if(i=n[r],t.intersect(i.row,i.col,i.rowCount,i.colCount))return n.splice(r--,1),this._cellRangeInflate(n,this._unionCellRange(t,i));return t},l.prototype._unionCellRange=function(n,i){var r=f(n.row,i.row),u=f(n.col,i.col),o=e(n.row+n.rowCount-1,i.row+i.rowCount-1),s=e(n.col+n.colCount-1,i.col+i.colCount-1);return r>=0&&u>=0?new t.Range(r,u,o-r+1,s-u+1):r>=0?new t.Range(r,-1,o-r+1,-1):u>=0?new t.Range(-1,u,-1,s-u+1):new t.Range(-1,-1,-1,-1)},l.prototype._getClipboardHelper=function(){var n=this;return!n._clipboardHelper&&n.parent&&n.parent._clipboardHelper?n._clipboardHelper=n.parent._clipboardHelper:n._clipboardHelper||(n._clipboardHelper={fromSheet:i,range:i,isCutting:!1}),n._clipboardHelper},l.prototype._getFloatingObjectClipboardHelper=function(){var n=this;return!n._floatingObjectClipboardHelper&&n.parent&&n.parent._floatingObjectClipboardHelper?n._floatingObjectClipboardHelper=n.parent._floatingObjectClipboardHelper:n._floatingObjectClipboardHelper||(n._floatingObjectClipboardHelper={fromSheet:i,isCutting:!1}),n._floatingObjectClipboardHelper},l.prototype._clearFloatingObjectClipboardHelper=function(){var t=this,n=t._getFloatingObjectClipboardHelper();n.fromSheet&&n.fromSheet._eventHandler._setClipboardFloatingObjectData(i);n.fromSheet=i;n.isCutting=!1},l.prototype._checkPastedRange=function(n,r,u,f,e,o){var c=t.SR.Exp_PasteSourceCellsLocked,s,h;if(o.pastedInternal=!1,o.pastedRange=i,!n&&(!e||e===""))return!1;if(s=this,h=s,s._isPastedInternal(n,r,h,e)||!e){if(o.pastedInternal=!0,f&&n.isProtected&&n._isAnyCellInRangeLocked(r))return s._raiseInvalidOperation(1,c),!1;o.pastedRange=s._getPastedRange(n,r,h,u,f)}else o.pastedRange=s._getPastedRangefromText(u,e);return s._checkPasteRangeImp(n,r,u,f,o)},l.prototype._checkPasteRangeImp=function(n,i,r,u,f){var g=t.SR.Exp_InvalidCopyPasteSize,it=t.SR.Exp_PasteDestinationCellsLocked,k=t.SR.Exp_PasteChangeMergeCell,d=t.SR.Exp_ChangePartOfArray,h=this,o=h,a,v,nt,tt,w,b,e;if(!f.pastedRange)return h._raiseInvalidOperation(1,g),!1;if(o.isProtected&&o._isAnyCellInRangeLocked(f.pastedRange))return h._raiseInvalidOperation(1,it),!1;if(f.pastedInternal){if(n._hasPartSpans(i.row,i.col,i.rowCount,i.colCount))return h._raiseInvalidOperation(1,k),!1;if(u&&n._hasPartArrayFormulas(i.row,i.col,i.rowCount,i.colCount))return h._raiseInvalidOperation(1,d),!1;var y=f.pastedRange.row<0?o.getRowCount():f.pastedRange.rowCount,p=f.pastedRange.col<0?o.getColumnCount():f.pastedRange.colCount,c=i.row<0?n.getRowCount():i.rowCount,l=i.col<0?n.getColumnCount():i.colCount;if(y>c||p>l)for(a=r.row,v=r.col,r.row<0&&c<o.getRowCount()&&(a=0),r.col<0&&l<o.getColumnCount()&&(v=0),y%c==0&&p===1?(p=l,f.pastedRange=new t.Range(a,v,y,p)):y===1&&p%l==0?(y=c,f.pastedRange=new t.Range(a,v,y,p)):(y%c!=0||p%l!=0)&&(y=c,p=l,f.pastedRange=new t.Range(a,v,y,p)),nt=s(y/c),tt=s(p/l),w=0;w<nt;w++)for(b=0;b<tt;b++){if(!h._isSingleCellToSpanCell(i,f.pastedRange)&&o._hasPartSpans(a<0?-1:a+w*c,v<0?-1:v+b*l,a<0?-1:c,v<0?-1:l))return h._raiseInvalidOperation(1,k),!1;if(o._hasPartArrayFormulas(a<0?-1:a+w*c,v<0?-1:v+b*l,a<0?-1:c,v<0?-1:l))return h._raiseInvalidOperation(1,d),!1}else{if(e=f.pastedRange,!h._isSingleCellToSpanCell(i,e)&&o._hasPartSpans(e.row,e.col,e.rowCount,e.colCount))return h._raiseInvalidOperation(1,k),!1;if(o._hasPartArrayFormulas(e.row,e.col,e.rowCount,e.colCount))return h._raiseInvalidOperation(1,d),!1}}else{if(e=f.pastedRange,o._hasPartSpans(e.row,e.col,e.rowCount,e.colCount))return h._raiseInvalidOperation(1,k),!1;if(o._hasPartArrayFormulas(e.row,e.col,e.rowCount,e.colCount))return h._raiseInvalidOperation(1,d),!1;if(!o._isValidPastedRange(e.row,e.col,e.rowCount,e.colCount,o.getRowCount(),o.getColumnCount()))return h._raiseInvalidOperation(1,g),!1}return!0},l.prototype._isSingleCellToSpanCell=function(n,t){if(n&&n.rowCount===1&&n.colCount===1){var i=this.getSpan(t.row,t.col);if(i&&i.equals(t))return!0}return!1},l.prototype._isPastedInternal=function(n,i,r,u){if(n&&i&&r){var e=o.getRangeText(n,i.row,i.rowCount,i.col,i.colCount,"\r\n","\t",'"',!1,0),f=e===u;return!f&&(t.util.browser.chrome||t.util.browser.safari||t.util.browser.webkit)&&(f=e===u+"\r\n"),f}return!1},l.prototype._getPastedRange=function(n,r,u,f,e){var v=r.row<0?0:r.row,y=r.col<0?0:r.col,h=r.row<0?n.getRowCount():r.rowCount,c=r.col<0?n.getColumnCount():r.colCount,l=f.row<0?0:f.row,a=f.col<0?0:f.col,o=f.row<0?u.getRowCount():f.rowCount,s=f.col<0?u.getColumnCount():f.colCount,p;if((e?(o=h,s=c):o%h==0&&s===1?s=c:o===1&&s%c==0?o=h:(o%h!=0||s%c!=0)&&(o=h,s=c),!this._isValidPastedRange(v,y,h,c,n.getRowCount(),n.getColumnCount()))||!this._isValidPastedRange(l,a,o,s,u.getRowCount(),u.getColumnCount()))return i;if(p=new t.Range(l,a,o,s),!e&&n._name===u._name)if(p.contains(v,y,h,c)){if((v-l)%h!=0||(y-a)%c!=0)return i}else if(p.intersect(v,y,h,c)&&(o>h||s>c))return i;return f.row===-1&&(l=-1,o=-1),f.col===-1&&(a=-1,s=-1),new t.Range(l,a,o,s)},l.prototype._getPastedRangefromText=function(n,r){var f=i,u=o.parseCsv(r,"\r\n","\t",'"');if(u){var h=n.row<0?0:n.row,c=n.col<0?0:n.col,e=u.length,s=o.getMaxLength(u);e>0&&s>0&&(f=new t.Range(h,c,e,s))}return f},l.prototype._clearClipboard=function(){var n=this._getClipboardHelper();n&&(n.fromSheet=i,n.range=i,n.isCutting=!1)},l.prototype._clipboardPaste=function(n,r,u,f,e,h,c){var v,y,l,a,p,w,it,d,b,k,rt,ut,tt,g,ot;if(n&&u._name===n._name&&u.parent&&!t.ArrayHelper.contains(u.parent.sheets,n)){n._clearClipboard();return}if(it=t.UndoRedo.ClipboardPasteRangeUndoAction.convertPasteOption,d=it(c),n&&r){if((d&2)!=0&&(e&&n._hasPartArrayFormulas(r.row,r.col,r.rowCount,r.colCount)||u._hasPartArrayFormulas(f.row,f.col,f.rowCount,f.colCount)))throw t.SR.Exp_ChangePartOfArray;if(e)o.moveTo(n,r.row,r.col,u,f.row,f.col,r.rowCount,r.colCount,d),n._clearClipboard();else if(b=f.row<0?u.getRowCount():f.rowCount,k=f.col<0?u.getColumnCount():f.colCount,l=r.row<0?n.getRowCount():r.rowCount,a=r.col<0?n.getColumnCount():r.colCount,b>l||k>a){v=f.row;y=f.col;f.row<0&&l<u.getRowCount()&&(v=0);f.col<0&&a<u.getColumnCount()&&(y=0);b%l==0&&k===1?k=a:b===1&&k%a==0?b=l:(b%l!=0||k%a!=0)&&(b=l,k=a);rt=s(b/l);ut=s(k/a);n.suspendCalcService();u.suspendCalcService();try{for(p=0;p<rt;p++)for(w=0;w<ut;w++)o.copyTo(n,r.row,r.col,u,v<0?-1:v+p*l,y<0?-1:y+w*a,v<0?-1:l,y<0?-1:a,d,!0)}finally{n.resumeCalcService(!1);u.resumeCalcService(!1)}}else o.copyTo(n,r.row,r.col,u,f.row,f.col,r.rowCount,r.colCount,d,!0)}else{v=f.row;y=f.col;l=f.rowCount;a=f.colCount;for(var ft=u._getSpanModel(),et=ft.getEnumerator(v,y,l,a),nt=[];et.moveNext();)tt=et.current(),tt&&nt.push(tt);for(g=0,ot=nt.length;g<ot;g++)ft.remove(nt[g]);if((d&1)>0&&o.clearFormula(u,v,y,l,a,!0),h&&h!=="")u.setCsv(v,y,h,"\r\n","\t",16);else for(p=0;p<l;p++)for(w=0;w<a;w++)u.setValue(v+p,y+w,i)}},l.prototype._copyFormula=function(n,i,r,u,f,e){t.Calc.CalcOperatorAdjustor.copyFormula(this._getCalcModel(),n,i,this._getCalcModel(),r,u,f,e)},l.prototype._getAutoFitType=function(){if(this.parent!=i){var n=this.parent;return n.autoFitType()}return 0},l.prototype._doCut=function(n){if(!this.isEditing()){var t=this.getSelections();if(t&&t.length===1)return this._clipboardCopy(t[0],!0,n)}return i},l.prototype._doCopy=function(n){if(!this.isEditing()){var t=this.getSelections();if(t&&t.length===1)return this._clipboardCopy(t[0],!1,n)}return i},l.prototype._doFloatingObjectCopy=function(n){var i=this,r,t,e,u,f;if(i._hasFloatingObjectsSelected()){for(r=[],u=i._floatingObjectArray,t=0,e=u.length;t<e;t++)f=u[t],f.isSelected()&&r.push(f.name());i._clipboardFloatingObjectCopy(r,!1,n)}},l.prototype._doFloatingObjectCut=function(n){var i=this,r,u,o,f,e,s,h;if(i._hasFloatingObjectsSelected()){for(r=[],f=i._floatingObjectArray,u=0,o=f.length;u<o;u++)e=f[u],e.isSelected()&&r.push(e.name());i._clipboardFloatingObjectCopy(r,!0,n);s={names:r};h=new t.UndoRedo.DeleteFloatingObjectUndoAction(i,s);i._doCommand(h)}},l.prototype._doFloatingObjectPaste=function(n,i){var r=this;if(!r.isEditing()&&t.features.floatingObject){var u=r._getFloatingObjectClipboardHelper(),f=u.fromSheet,e=f._eventHandler,o=u.isCutting;setTimeout(function(){var u=n,s,o,h,c;if(e&&!n&&(u=e._getClipboardFloatingObjectData()),u&&u.length){for(s=[],o=0,h=u.length;o<h;o++)s.push(u[o].name());c=new t.UndoRedo.ClipboardPasteFloatingObjectUndoAction(r,{names:s},f);r._doCommand(c)}i&&i()},100)}},l.prototype._doPaste=function(n,t){var i=this,r=i._eventHandler;i.isEditing()||(r&&!n&&r._switchFocusForClipboard(""),setTimeout(function(){var f=n,u,e;(r&&!n&&(f=r._getClipboardData(),r._switchBackFocusAfterClipboard()),u=i._getPasteInfo(f),u)&&(e=i._createPasteAction(u),i._doCommand(e),t&&t())},100))},l.prototype._createPasteAction=function(n){var i=this,r=n.pastedRanges,u=n.fromSheet,f=n.fromRange,e=n.isCutting,o=n.pasteOption,s=n.clipboardText,h={fromRange:f,pastedRanges:r.slice(0),isCutting:e,clipboardText:s};return new t.UndoRedo.ClipboardPasteUndoAction(i,u,i,h,o)},l.prototype._getPasteInfo=function(n){var r=this,k=r._eventHandler,b=t.SR.Exp_InvalidPastedArea,y=r._getClipboardHelper(),e=y.fromSheet,o=y.range,s=y.isCutting,l,p,w,a,v;s&&e&&o&&e.isProtected&&e._isAnyCellInRangeLocked(o)&&(s=!1);var u={pastedRange:i,pastedInternal:!1},h=[],c=r.getSelections(),f;if(c.length>1)for(l=0;l<c.length;l++){if(f=c[l],!r._checkPastedRange(e,o,f,s,n,u))return;if(f.containsRange(u.pastedRange)&&!f.equals(u.pastedRange)){r._raiseInvalidOperation(1,b);return}h.push(u.pastedRange)}else if(c.length>0){if(f=c[0],!r._checkPastedRange(e,o,f,s,n,u))return;h.push(u.pastedRange)}else{if(f=r._getSpanModel().find(r._activeRowIndex,r._activeColIndex),f||(f=new t.Range(r._activeRowIndex,r._activeColIndex,1,1)),!r._checkPastedRange(e,o,f,s,n,u))return;h.push(u.pastedRange)}for(p=r._cutCopyIndicatorManager,p&&p.isPastedInternal(u.pastedInternal),u.pastedInternal||(e=i,o=i,s=!1),w=r.clipBoardOptions(),s&&(w=0),a=0;a<h.length;a++)v=h[a],r._isSingleCellToSpanCell(o,v)&&(v.rowCount=1,v.colCount=1);return{fromSheet:e,fromRange:o,isCutting:s,pasteOption:w,pastedRanges:h,clipboardText:n}},l.prototype._getImageLoader=function(){if(!this.imageLoader){var n=this;this.imageLoader=new t._GcImageLoader(function(){n.repaint()})}return this.imageLoader},l.prototype._getContainerDiv=function(){var n=this;return!n._containerDiv&&n._canvas&&n._canvas.parentNode&&(n._containerDiv=w.createElement("div"),t.GC$(n._containerDiv).css({position:"absolute",left:0,top:0,width:0,height:0}),t.GC$(n._canvas.parentNode).prepend(n._containerDiv)),n._containerDiv},l.prototype._raiseDragDropBlock=function(n,t,i,r,u,f,e,o,s){var h={sheet:this,sheetName:this._name,fromRow:n,fromCol:t,toRow:i,toCol:r,rowCount:u,colCount:f,copy:e,insert:o,copyOption:s,cancel:!1};return this.triggerDragDropBlock(h),h&&h.cancel===!0},l.prototype._raiseDragDropBlockCompleted=function(n,t,i,r,u,f,e,o,s){var h={sheet:this,sheetName:this._name,fromRow:n,fromCol:t,toRow:i,toCol:r,rowCount:u,colCount:f,copy:e,insert:o,copyOption:s};this.triggerDragDropBlockCompleted(h)},l.prototype._raiseInvalidOperation=function(n,t){var i={sheet:this,sheetName:this._name,invalidType:n,message:t};this.triggerInvalidOperation(i)},l.prototype._raiseSelectionChanging=function(n,t){var i=this,r=i._eventHandler._notEqualSelecions(n,t);return r===!0?(i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:n,newSelections:t}),!0):!1},l.prototype._raiseSelectionChanged=function(){this.triggerSelectionChanged({sheet:this,sheetName:this._name})},l.prototype._raiseDragFillBlock=function(n){return n.cancel=!1,this.triggerDragFillBlock(n),n&&n.cancel===!0},l.prototype._raiseDragFillBlockCompleted=function(n){this.triggerDragFillBlockCompleted(n)},l.prototype._raiseCellChanged=function(n,t,i,r,u,f){var e={sheet:this,sheetName:this._name,row:t,col:i,sheetArea:f,propertyName:n,oldValue:r,newValue:u};this.triggerCellChanged(e)},l.prototype._raiseClipboardPasting=function(n,t){var i={sheet:this,sheetName:this._name,cellRange:n,pasteOption:t,cancel:!1};return this.triggerClipboardPasting(i),i.cancel===!0},l.prototype._raiseClipboardPasted=function(n,t){var i={sheet:this,sheetName:this._name,cellRange:n,pasteOption:t};this.triggerClipboardPasted(i)},l.prototype._raiseValueChanged=function(n,t,i,r){var u={sheet:this,sheetName:this._name,row:n,col:t,oldValue:i,newValue:r};this.triggerValueChanged(u)},l.prototype._raiseRangeDataChanged=function(n,t,i,r,u,f){var e={sheet:this,sheetName:this._name,row:n,column:t,rowCount:i,columnCount:r,changedCells:u,action:f};this.triggerRangeChanged(e)},l.prototype._trigger=function(n,t){var i=this._eventHandler;i._eventSuspended===0&&i.trigger(n,t)},l.prototype.triggerValidationError=function(n){this._trigger(t.Events.ValidationError,n)},l.prototype.triggerCellClick=function(n){this._trigger(t.Events.CellClick,n)},l.prototype.triggerCellDoubleClick=function(n){this._trigger(t.Events.CellDoubleClick,n)},l.prototype.triggerEnterCell=function(n){this._trigger(t.Events.EnterCell,n)},l.prototype.triggerLeaveCell=function(n){this._trigger(t.Events.LeaveCell,n)},l.prototype.triggerValueChanged=function(n){this._trigger(t.Events.ValueChanged,n)},l.prototype.triggerTopRowChanged=function(n){this._trigger(t.Events.TopRowChanged,n)},l.prototype.triggerLeftColumnChanged=function(n){this._trigger(t.Events.LeftColumnChanged,n)},l.prototype.triggerInvalidOperation=function(n){this._trigger(t.Events.InvalidOperation,n)},l.prototype.triggerRangeFiltering=function(n){this._trigger(t.Events.RangeFiltering,n)},l.prototype.triggerRangeFiltered=function(n){this._trigger(t.Events.RangeFiltered,n)},l.prototype.triggerTableFiltering=function(n){this._trigger(t.Events.TableFiltering,n)},l.prototype.triggerTableFiltered=function(n){this._trigger(t.Events.TableFiltered,n)},l.prototype.triggerRangeSorting=function(n){this._trigger(t.Events.RangeSorting,n)},l.prototype.triggerRangeSorted=function(n){this._trigger(t.Events.RangeSorted,n)},l.prototype.triggerClipboardChanging=function(n){this._trigger(t.Events.ClipboardChanging,n)},l.prototype.triggerClipboardChanged=function(n){this._trigger(t.Events.ClipboardChanged,n)},l.prototype.triggerClipboardPasting=function(n){this._trigger(t.Events.ClipboardPasting,n)},l.prototype.triggerClipboardPasted=function(n){this._trigger(t.Events.ClipboardPasted,n)},l.prototype.triggerColumnWidthChanging=function(n){this._trigger(t.Events.ColumnWidthChanging,n)},l.prototype.triggerColumnWidthChanged=function(n){this._trigger(t.Events.ColumnWidthChanged,n)},l.prototype.triggerRowHeightChanging=function(n){this._trigger(t.Events.RowHeightChanging,n)},l.prototype.triggerRowHeightChanged=function(n){this._trigger(t.Events.RowHeightChanged,n)},l.prototype.triggerDragDropBlock=function(n){this._trigger(t.Events.DragDropBlock,n)},l.prototype.triggerDragDropBlockCompleted=function(n){this._trigger(t.Events.DragDropBlockCompleted,n)},l.prototype.triggerDragFillBlock=function(n){this._trigger(t.Events.DragFillBlock,n)},l.prototype.triggerDragFillBlockCompleted=function(n){this._trigger(t.Events.DragFillBlockCompleted,n)},l.prototype.triggerEditStarting=function(n){this._trigger(t.Events.EditStarting,n)},l.prototype.triggerEditChange=function(n){this._trigger(t.Events.EditChange,n)},l.prototype.triggerEditEnding=function(n){this._trigger(t.Events.EditEnding,n)},l.prototype.triggerEditEnded=function(n){this._trigger(t.Events.EditEnded,n)},l.prototype.triggerRangeGroupStateChanging=function(n){this._trigger(t.Events.RangeGroupStateChanging,n)},l.prototype.triggerRangeGroupStateChanged=function(n){this._trigger(t.Events.RangeGroupStateChanged,n)},l.prototype.triggerSelectionChanging=function(n){this._trigger(t.Events.SelectionChanging,n)},l.prototype.triggerSelectionChanged=function(n){this._trigger(t.Events.SelectionChanged,n)},l.prototype.triggerSheetNameChanging=function(n){this._trigger(t.Events.SheetNameChanging,n)},l.prototype.triggerSheetNameChanged=function(n){this._trigger(t.Events.SheetNameChanged,n)},l.prototype.triggerUserZooming=function(n){this._trigger(t.Events.UserZooming,n)},l.prototype.triggerUserFormulaEntered=function(n){this._trigger(t.Events.UserFormulaEntered,n)},l.prototype.triggerCellChanged=function(n){this._trigger(t.Events.CellChanged,n)},l.prototype.triggerColumnChanged=function(n){this._trigger(t.Events.ColumnChanged,n)},l.prototype.triggerRowChanged=function(n){this._trigger(t.Events.RowChanged,n)},l.prototype.triggerSparklineChanged=function(n){this._trigger(t.Events.SparklineChanged,n)},l.prototype.triggerRangeChanged=function(n){n.changedCells&&n.changedCells.length>0&&this._trigger(t.Events.RangeChanged,n)},l.prototype.triggerEditorStatusChanged=function(n){this._trigger(t.Events.EditorStatusChanged,n)},l.prototype.triggerFloatingObjectChanged=function(n){this._trigger(t.Events.FloatingObjectChanged,n)},l.prototype.triggerFloatingObjectSelectionChanged=function(n){this._trigger(t.Events.FloatingObjectSelectionChanged,n)},l.prototype.triggerPictureChanged=function(n){this._trigger(t.Events.PictureChanged,n)},l.prototype.triggerPictureSelectionChanged=function(n){this._trigger(t.Events.PictureSelectionChanged,n)},l.prototype.triggerCustomFloatingObjectLoaded=function(n){this._trigger(t.Events.CustomFloatingObjectLoaded,n)},l.prototype.triggerTouchToolStripOpening=function(n){this._trigger(t.Events.TouchToolStripOpening,n)},l.prototype.triggerCommentChanged=function(n){this._trigger(t.Events.CommentChanged,n)},l.prototype.triggerEditEnd=function(n){this._trigger(t.Events.EditEnd,n)},l.prototype.triggerEditStarted=function(n){this._trigger(t.Events.EditStarted,n)},l.prototype.triggerFormulaTextBoxTextChanged=function(n){this._trigger("FormulaTextBoxTextChanged",n)},l.prototype.triggerFormulaTextBoxCaretChanged=function(n){this._trigger("FormulaTextBoxCaretChanged",n)},l.prototype.triggerSlicerChanged=function(n){this._trigger(t.Events.SlicerChanged,n)},l.prototype.triggerFloatingObjectRemoving=function(n){this._trigger(t.Events.FloatingObjectRemoving,n)},l.prototype.triggerFloatingObjectRemoved=function(n){this._trigger(t.Events.FloatingObjectRemoved,n)},l.prototype.triggerCommentRemoving=function(n){this._trigger(t.Events.CommentRemoving,n)},l.prototype.triggerCommentRemoved=function(n){this._trigger(t.Events.CommentRemoved,n)},l.prototype.getBounds=function(){var n=this._bounds;return new t.Rect(n.x,n.y,n.width,n.height)},l.prototype.setBounds=function(n){var i=this._bounds=new t.Rect(0,0,0,0);i.x=n.x;i.y=n.y;i.width=n.width;i.height=n.height},l.sheetId=1,l}();t.Sheet=gt;ht=function(){function n(n){var i=1,r=2,u=8,f=16,t=this;t.rowHeader=(n&i)===i;t.columnHeader=(n&r)===r;t.unFormatted=(n&u)===u;t.formula=(n&f)===f;t.expandRows=!0;t.expandColumns=!0}return n.prototype.fixOptions=function(n){n&&(n.getColumnCount(2)<=0&&(this.rowHeader=!1),n.getRowCount(1)<=0&&(this.columnHeader=!1))},n}();var o=function(){function n(){}return n.saveTable=function(n,i,r,u,e,o,s,h){var v=[],a=n.getTables(),y,p,c,l;if(a)for(i<0&&(i=0,s=f(n.getRowCount(),u.getRowCount())),r<0&&(r=0,h=f(n.getColumnCount(),u.getColumnCount())),y=n._tableManager,p=new t.Range(i,r,s,h),c=a.length-1;c>=0;c--)l=a[c],p.containsRange(l.range())&&(y._tableList.splice(c,1),l._clearSheetModelFormula(),v.push(l));return v},n.restoreTableForCopyTo=function(n,i,u,f,e,o,s,h,c){var w,v,a,y,p,b;for(u<0&&(u=0),f<0&&(f=0),o<0&&(o=0),s<0&&(s=0),w=i._tableManager,v=0;v<n.length;v++)a=n[v],a._setOwner(w),w._tableList.push(a),a._syncSheetModelFormula();for(y=e._tableManager,p=0;p<n.length;p++){var a=n[p],d=JSON.stringify(a.toJSON()),k=a.bindingPath()?r:a.getSource(),l=new t.SheetTable;l._setOwner(y);l.fromJSON(JSON.parse(d));b=l.range();l.name(y.getNoConflictTableName(l.name()));l._moveToCore(o+b.row-u,s+b.col-f);y._tableList.push(l);l._syncSheetModelFormula();k&&l.copyDataSourceImp(k)}},n.restoreTableForMoveTo=function(n,t,i,r,u,f,e,o,s){var l,c,h,a;for(i<0&&(i=0),r<0&&(r=0),f<0&&(f=0),e<0&&(e=0),l=u._tableManager,c=0;c<n.length;c++)h=n[c],h._setOwner(l),a=h.range(),h._moveToCore(f+a.row-i,e+a.col-r),l._tableList.push(h),h._syncSheetModelFormula()},n.copyTo=function(r,u,f,e,o,s,h,c,l,a){var v=n,d=r._getCalcModel(),g=e._getCalcModel(),b,p,w,y;v.checkArguments(r,u,f,e,o,s,h,c);(l&64)>0&&v.copyStyle(r,u,f,e,o,s,h,c,a);(l&1)>0&&(l&2)>0&&(b=v.saveTable(r,u,f,e,o,s,h,c));r.suspendCalcService();e.suspendCalcService();p=i;(l&256)>0&&(p=v.copyBindingPath(r,u,f,e,o,s,h,c,a));try{if((l&1)>0&&(v.copyValue(r,u,f,e,o,s,h,c,a),(l&2)==0&&v.clearFormula(e,o,s,h,c,a),(l&256)>0)){var nt=p.length,k=o<0?0:o,tt=s<0?0:s;for(w=0;w<nt;w++)(y=p[w],a&&e.isRowFilterOut(k+y.row))||e.setValue(k+y.row,tt+y.col,y.value)}(l&1)>0&&(l&2)>0&&v.restoreTableForCopyTo(b,r,u,f,e,o,s,h,c);(l&2)>0&&t.Calc.CalcOperatorAdjustor.copyFormula(d,u,f,g,o,s,h,c,a)}finally{r.resumeCalcService(!1);e.resumeCalcService(!1)}(l&512)>0&&v.copyConditionalFormatRules(r,u,f,e,o,s,h,c);(l&4)>0&&v.copyComment(r,u,f,e,o,s,h,c,a);(l&128)>0&&v.copyTag(r,u,f,e,o,s,h,c);(l&16)>0&&v.copySparkline(r,u,f,e,o,s,h,c);(l&8)>0&&(u<0&&v.copyColumnRangeGroup(r,f,e,s,c),f<0&&v.copyRowRangeGroup(r,u,e,o,h));(l&32)>0&&(h===1&&c===1||v.copySpan(r,u,f,e,o,s,h,c));u<0&&v.copyColumnAxis(r,f,e,s,c,l);f<0&&v.copyRowAxis(r,u,e,o,h,l,a);u<0&&o<0&&f<0&&s<0&&v.copySheetInfo(r,e,l)},n.checkArguments=function(n,i,r,u,e,o,s,h){var c,v,a,y;if(!n)throw new Error(t.SR.Exp_SrcIsNull);if(!u)throw new Error(t.SR.Exp_DestIsNull);(i<-1||i>=n.getRowCount())&&l("from row index",i,"-1",n.getRowCount()-1);(r<-1||r>=n.getColumnCount())&&l("from column index",r,"-1",n.getColumnCount()-1);(e<-1||e>=u.getRowCount())&&l("to row index",e,"-1",u.getRowCount()-1);(o<-1||o>=u.getColumnCount())&&l("to column index",o,"-1",u.getColumnCount()-1);c=r;r<0&&(c=0,h=n.getColumnCount());v=o<0?0:o;(h<1||c+h>n.getColumnCount()||v+h>u.getColumnCount())&&l("column count",h,"1",f(n.getColumnCount()-c,u.getColumnCount()-v));a=i;i<0&&(a=0,s=n.getRowCount());y=e<0?0:e;(s<1||a+s>n.getRowCount()||y+s>u.getRowCount())&&l("row count",s,"1",f(n.getRowCount()-a,u.getRowCount()-y))},n.copyValue=function(r,e,o,s,h,c,l,a,v){var st=!(r===s&&r._name===s._name),b,k,y,p,w,ht,lt,yt;if(e<0){var d=1,g=o,ft=c;if(b=f(r.getRowCount(d),s.getRowCount(d)),k=a,o<0&&(g=0,k=r.getColumnCount()),c<0&&(ft=0),st)for(y=0;y<b;y++)for(p=0;p<k;p++)w=r._sheetModelManager.getDataModel(d).getValue(y,g+p),(typeof w===u||w===i)&&r.isColumnBound(g+p)&&(y===r.colHeaderAutoTextIndex||y===b-1&&r.colHeaderAutoTextIndex===-1)&&(w=r.getDataColumnName(g+p)),typeof w===u||w===i?s._setValueInternal(y,ft+p,i,d,!1):s._setValueInternal(y,ft+p,n.cloneObject(w),d,!1);else{for(ht=new t._GcSheetModel(b,k,i),y=0;y<b;y++)for(p=0;p<k;p++)w=r._sheetModelManager.getDataModel(d).getValue(y,g+p),(typeof w===u||w===i)&&r.isColumnBound(g+p)&&(y===r.colHeaderAutoTextIndex||y===b-1&&r.colHeaderAutoTextIndex===-1)&&(w=r.getDataColumnName(g+p)),typeof w!==u&&w!==i&&ht.setValue(y,p,n.cloneObject(w));for(y=0;y<b;y++)for(p=0;p<k;p++)s._setValueInternal(y,ft+p,ht.getValue(y,p),d,!1)}}if(o<0){var nt=2,ct=e,et=h;if(b=l,k=f(r.getColumnCount(nt),s.getColumnCount(nt)),e<0&&(ct=0,b=r.getRowCount()),h<0&&(et=0),st)for(y=0;y<b;y++)for(p=0;p<k;p++)w=r._sheetModelManager.getDataModel(nt).getValue(ct+y,p),typeof w===u||w===i?s._setValueInternal(et+y,p,i,nt,!1):s._setValueInternal(et+y,p,n.cloneObject(w),nt,!1);else{for(lt=new t._GcSheetModel(b,k,i),y=0;y<b;y++)for(p=0;p<k;p++)w=r._sheetModelManager.getDataModel(nt).getValue(ct+y,p),typeof w!==u&&w!==i&&lt.setValue(y,p,n.cloneObject(w));for(y=0;y<b;y++)for(p=0;p<k;p++)s._setValueInternal(et+y,p,lt.getValue(y,p),nt,!1)}}var it=3,at=e,vt=o,tt=h,ot=c,rt=l,ut=a;if(e<0&&(at=0,rt=f(r.getRowCount(),s.getRowCount())),o<0&&(vt=0,ut=f(r.getColumnCount(),s.getColumnCount())),h<0&&(tt=0),c<0&&(ot=0),st){for(y=0;y<rt;y++)if(!v||!s.isRowFilterOut(tt+y))for(p=0;p<ut;p++)w=r.getValue(at+y,vt+p,it),typeof w===u||w===i?s._setValueInternal(tt+y,ot+p,i,it,!1):s._setValueInternal(tt+y,ot+p,n.cloneObject(w),it,!1)}else{for(yt=new t._GcSheetModel(rt,ut,i),y=0;y<rt;y++)for(p=0;p<ut;p++)w=r.getValue(at+y,vt+p,it),typeof w!==u&&w!==i&&yt.setValue(y,p,n.cloneObject(w));for(y=0;y<rt;y++)if(!v||!s.isRowFilterOut(tt+y))for(p=0;p<ut;p++)s._setValueInternal(tt+y,ot+p,yt.getValue(y,p),it,!1)}},n._copyMoveBindingPath=function(n,r,u,e,o,s,h,c,l,a){var p=r,w=u,g=o,tt=s,k=h,d=c,nt,rt,it,b,v,y;if(r<0&&(p=0,k=f(n.getRowCount(),e.getRowCount())),u<0&&(w=0,d=f(n.getColumnCount(),e.getColumnCount())),o<0&&(g=0),s<0&&(tt=0),nt=[],rt=!(n===e&&n._name===e._name),rt)for(v=0;v<k;v++)for(y=0;y<d;y++)b=n.getBindingPath(p+v,w+y),e.setBindingPath(g+v,tt+y,b),b&&nt.push({row:v,col:y,value:n.getValue(p+v,w+y)}),l&&n.setBindingPath(p+v,w+y,i);else{for(it=new t._GcSheetModel(k,d,i),v=0;v<k;v++)for(y=0;y<d;y++)b=n.getBindingPath(p+v,w+y),it.setBindingPath(v,y,b),b&&nt.push({row:v,col:y,value:n.getValue(p+v,w+y)}),l&&n.setBindingPath(p+v,w+y,i);for(v=0;v<k;v++)if(!a||!e.isRowFilterOut(g+v))for(y=0;y<d;y++)e.setBindingPath(g+v,tt+y,it.getBindingPath(v,y))}return nt},n.copyBindingPath=function(t,i,r,u,f,e,o,s,h){return n._copyMoveBindingPath(t,i,r,u,f,e,o,s,!1,h)},n.cloneObject=function(t){var r,i;if(typeof t===h||typeof t===c||typeof t===y||typeof t===u)return t;else if(t instanceof Date)return new Date(t);else r=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(i in t)t.hasOwnProperty(i)&&r[i]!==t[i]&&(r[i]=typeof this[i]=="object"?n.cloneObject(t[i]):t[i]);return r.toString=t.toString,r.valueOf=t.valueOf,r},n.clearFormula=function(n,t,r,u,f,e){var o,s;for(t<0&&(t=0,u=n.getRowCount()),r<0&&(r=0,f=n.getColumnCount()),o=0;o<u;o++)if(!e||!n.isRowFilterOut(o+t))for(s=0;s<f;s++)n.setFormula(o+t,s+r,i)},n.copyStyle=function(n,r,u,e,o,s,h,c,l){var ut=!(n===e&&n._name===e._name),p,w,a,v,y,tt,k,ft,it,d,et,ht;if(r<0)if(tt=u,k=s,p=f(n.getRowCount(1),e.getRowCount(1)),w=c,u<0&&(tt=0,w=n.getColumnCount()),s<0&&(k=0),ut)for(a=0;a<p;a++)for(v=0;v<w;v++)y=n.getCompositeStyle(a,tt+v,1),y?e.setStyleWithoutLocked(a,k+v,y.clone(),1):e.setStyleWithoutLocked(a,k+v,i,1);else{for(ft=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n.getCompositeStyle(a,tt+v,1),y&&ft.setValue(a,v,y.clone());for(a=0;a<p;a++)for(v=0;v<w;v++)e.setStyleWithoutLocked(a,k+v,ft.getValue(a,v),1)}if(u<0)if(it=r,d=o,p=h,w=f(n.getColumnCount(2),e.getColumnCount(2)),r<0&&(it=0,p=n.getRowCount()),o<0&&(d=0),ut)for(a=0;a<p;a++)for(v=0;v<w;v++)y=n.getCompositeStyle(it+a,v,2),y?e.setStyleWithoutLocked(d+a,v,y.clone(),2):e.setStyleWithoutLocked(d+a,v,i,2);else{for(et=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n.getCompositeStyle(it+a,v,2),y&&et.setValue(a,v,y.clone());for(a=0;a<p;a++)for(v=0;v<w;v++)e.setStyleWithoutLocked(d+a,v,et.getValue(a,v),2)}var ot=r,st=u,b=o,rt=s,g=h,nt=c;if(r<0&&(ot=0,g=f(n.getRowCount(),e.getRowCount())),u<0&&(st=0,nt=f(n.getColumnCount(),e.getColumnCount())),o<0&&(b=0),s<0&&(rt=0),ut){for(a=0;a<g;a++)if(!l||!e.isRowFilterOut(b+a))for(v=0;v<nt;v++)y=n.getCompositeStyle(ot+a,st+v,3),y?e.setStyleWithoutLocked(b+a,rt+v,y.clone(),3):e.setStyleWithoutLocked(b+a,rt+v,i,3)}else{for(ht=new t._GcSheetModel(g,nt,i),a=0;a<g;a++)for(v=0;v<nt;v++)y=n.getCompositeStyle(ot+a,st+v,3),y&&ht.setValue(a,v,y.clone());for(a=0;a<g;a++)if(!l||!e.isRowFilterOut(b+a))for(v=0;v<nt;v++)e.setStyleWithoutLocked(b+a,rt+v,ht.getValue(a,v),3)}},n.copyConditionalFormatRules=function(n,i,r,u,f,e,o,s){var it=[],g=n._conditionalFormats,c,l,nt,w,v,tt,b,a;if(g){for(c=0;c<o;c++)for(l=0;l<s;l++)for(nt=g.getRules(i+c,r+l),w=0;w<nt.length;w++){for(v=nt[w],tt=[],b=0;b<v.ranges.length;b++){var h=v.ranges[b],y=h.row,p=h.col,k=h.rowCount,d=h.colCount;if(y===-1&&(y=0,k=n.getRowCount()),p===-1&&(p=0,d=n.getColumnCount()),t.ArrayHelper.indexOf(it,h)>-1||!h.contains(i+c,r+l))continue;else it.push(h);a=new t.Range(-1,-1,-1,-1);a.row=f+c;a.col=e+l;a.rowCount=y+k>=o+i?o-c:i<y?k:y+k-i;a.colCount=p+d>=s+r?s-l:r<p?d:p+d-r;h.containsRange(a)||tt.push(a)}v.ranges=v.ranges.concat(tt)}g._resetCache()}},n.copyComment=function(n,t,i,r,u,e,o,s,h){var b=t,k=i,w=u,d=e,g=o,nt=s,y,a,v,l,p,tt,c;for(t<0&&(b=0,g=f(n.getRowCount(),r.getRowCount())),i<0&&(k=0,nt=f(n.getColumnCount(),r.getColumnCount())),u<0&&(w=0),e<0&&(d=0),y=[],a=0;a<g;a++)if(!h||!r.isRowFilterOut(w+a))for(v=0;v<nt;v++)c=n.getComment(b+a,k+v),c&&(l=c.clone(),l._sheet=r,l._rowIndex=w+a,l._colIndex=d+v,l._location=l._defaultLocation,y.push(l));for(p=0,tt=y.length;p<tt;p++)c=y[p],r.setComment(c._rowIndex,c._colIndex,c)},n.copyTag=function(r,e,o,s,h,c,l,a,v){var st=!(r===s&&r._name===s._name),b,k,y,p,w,vt,ht,yt,lt,ct,d,bt,kt;if(e<0){var g=1,ut=o,nt=c;if(b=f(r.getRowCount(g),s.getRowCount(g)),k=a,o<0&&(ut=0,k=r.getColumnCount()),c<0&&(nt=0),st){for(y=0;y<b;y++)for(p=0;p<k;p++)w=r.getTag(y,ut+p,g),typeof w===u||w===i?s.setTag(y,nt+p,i,g):s.setTag(y,nt+p,n.cloneObject(w),g);for(p=0;p<k;p++)w=r.getTag(-1,ut+p),typeof w===u||w===i?s.setTag(-1,nt+p,i):s.setTag(-1,nt+p,n.cloneObject(w))}else{for(vt=new t._GcSheetModel(b,k,i),y=0;y<b;y++)for(p=0;p<k;p++)w=r.getTag(y,ut+p,g),typeof w!==u&&w!==i&&vt.setTag(y,p,n.cloneObject(w));for(y=0;y<b;y++)for(p=0;p<k;p++)s.setTag(y,nt+p,vt.getTag(y,p),g);for(ht={},p=0;p<k;p++)w=r.getTag(-1,ut+p),typeof w!==u&&w!==i&&(ht[p]=n.cloneObject(w));for(ct in ht)d=parseInt(ct),isNaN(d)||s.setTag(-1,nt+d,ht[d])}}if(o<0){var tt=2,ft=e,it=h;if(b=l,k=f(r.getColumnCount(tt),s.getColumnCount(tt)),e<0&&(ft=0,b=r.getRowCount()),h<0&&(it=0),st){for(y=0;y<b;y++)for(p=0;p<k;p++)w=r.getTag(ft+y,p,tt),typeof w===u||w===i?s.setTag(it+y,p,i,tt):s.setTag(it+y,p,n.cloneObject(w),tt);for(y=0;y<b;y++)w=r.getTag(ft+y,-1),typeof w===u||w===i?s.setTag(it+y,-1,i):s.setTag(it+y,-1,n.cloneObject(w))}else{for(yt=new t._GcSheetModel(b,k,i),y=0;y<b;y++)for(p=0;p<k;p++)w=r.getTag(ft+y,p,tt),typeof w!==u&&w!==i&&yt.setTag(y,p,n.cloneObject(w));for(y=0;y<b;y++)for(p=0;p<k;p++)s.setTag(it+y,p,yt.getTag(y,p),tt);for(lt={},y=0;y<b;y++)w=r.getTag(ft+y,-1),typeof w!==u&&w!==i&&(lt[y]=n.cloneObject(w));for(ct in lt)d=parseInt(ct),isNaN(d)||s.setTag(it+d,-1,lt[d])}}var pt=e,wt=o,rt=h,at=c,et=l,ot=a;if(e<0&&(pt=0,et=f(r.getRowCount(),s.getRowCount())),o<0&&(wt=0,ot=f(r.getColumnCount(),s.getColumnCount())),h<0&&(rt=0),c<0&&(at=0),st){for(y=0;y<et;y++)if(!v||!s.isRowFilterOut(rt+y))for(p=0;p<ot;p++)w=r.getTag(pt+y,wt+p),typeof w===u||w===i?s.setTag(rt+y,at+p,i):s.setTag(rt+y,at+p,n.cloneObject(w))}else{for(bt=new t._GcSheetModel(et,ot,i),y=0;y<et;y++)for(p=0;p<ot;p++)w=r.getTag(pt+y,wt+p),typeof w!==u&&w!==i&&bt.setTag(y,p,n.cloneObject(w));for(y=0;y<et;y++)if(!v||!s.isRowFilterOut(rt+y))for(p=0;p<ot;p++)s.setTag(rt+y,at+p,bt.getTag(y,p))}if(e<0&&o<0){if(!st)return;kt=n.cloneObject(r.tag());s.tag(kt)}},n.copyColumnRangeGroup=function(t,i,r,u,e){var o=i,s=u,h=e,l,c;o<0&&(o=0,h=f(t.getColumnCount(),r.getColumnCount()));u<0&&(s=0);l=!(t===r&&t._name===r._name);l?t.colRangeGroup&&r.colRangeGroup&&n.crossSheetCopyRangeGroup(t.colRangeGroup,o,r.colRangeGroup,s,h):(c=t.colRangeGroup,c&&c._copy(o,s,h))},n.crossSheetCopyRangeGroup=function(n,i,r,u,f){var o,e,s,h;if(i<0&&(i=0),u<0&&(u=0),o=[],n)for(e=t.ArrayHelper.nextNonEmptyIndex(n.items,i-1);e>=0&&e<i+f;)o[e-i]=new t.RangeGroupItemInfo(n.items[e]),e=t.ArrayHelper.nextNonEmptyIndex(n.items,e);if(r&&(t.ArrayHelper.clear(r.items,u,f),o.length>0))for(s in o)o.hasOwnProperty(s)&&(h=o[s],r.items[u+s]=h)},n.copySparkline=function(n,t,i,r,u,e,o,s,h){var l=t,a=i,v=u,y=e,p=o,w=s,b,c;t<0&&(l=0,p=f(n.getRowCount(),r.getRowCount()));i<0&&(a=0,w=f(n.getColumnCount(),r.getColumnCount()));u<0&&(v=0);e<0&&(y=0);b=!(n===r&&n._name===r._name);b?(c=r._sparklineGroupManager,c&&c._exCopy(n,l,a,v,y,p,w,h)):(c=n._sparklineGroupManager,c&&c._copy(l,a,v,y,p,w,h))},n.copyRowRangeGroup=function(t,i,r,u,e){var o=i,s=u,h=e,l,c;i<0&&(o=0,h=f(t.getRowCount(),r.getRowCount()));u<0&&(s=0);l=!(t===r&&t._name===r._name);l?t.rowRangeGroup&&r.rowRangeGroup&&n.crossSheetCopyRangeGroup(t.rowRangeGroup,o,r.rowRangeGroup,s,h):(c=t.rowRangeGroup,c&&c._copy(o,s,h))},n.copySpan=function(t,i,r,u,e,o,s,h){var l=i,c=r,a=e,v=o,y=s,p=h,w,b,k,d;i<0&&(l=0,y=f(t.getRowCount(),u.getRowCount()));c<0&&(c=0,p=f(t.getColumnCount(),u.getColumnCount()));e<0&&(a=0);o<0&&(v=0);w=!(t===u&&t._name===u._name);i<0&&(w?n.crossSheetCopySpans(t._getSpanModel(1),-1,c,u._getSpanModel(1),-1,v,-1,p):(b=t._getSpanModel(1),b&&b.copy(-1,c,-1,v,-1,p)));r<0&&(w?n.crossSheetCopySpans(t._getSpanModel(2),l,-1,u._getSpanModel(2),a,-1,y,-1):(k=t._getSpanModel(2),k&&k.copy(l,-1,a,-1,y,-1)));w?n.crossSheetCopySpans(t._getSpanModel(),l,c,u._getSpanModel(),a,v,y,p):(d=t._getSpanModel(3),d&&d.copy(l,c,a,v,y,p))},n.crossSheetCopySpans=function(i,r,u,f,e,o,s,h){var v=n.getSpans(i),y=n.getSpans(f),w=[],l,a,c,p,b;if(r===-1){if(v&&v.length>0)for(l=0;l<v.length;l++)c=v[l],c.col>=u&&c.col+c.colCount<=u+h&&w.push(new t.Range(c.row,o+c.col-u,c.rowCount,c.colCount));if(y&&y.length>0)for(l=0;l<y.length;l++)if(c=y[l],c.col>=o&&c.col<o+h)for(a=0;a<f.length;a++)if(p=f[a],p.row===c.row&&p.col===c.col){f.splice(a,1);break}}else if(u===-1){if(v&&v.length>0)for(l=0;l<v.length;l++)c=v[l],r<=c.row&&c.row+c.rowCount<=r+s&&w.push(new t.Range(e+c.row-r,c.col,c.rowCount,c.colCount));if(y&&y.length>0)for(l=0;l<y.length;l++)if(c=y[l],c.row>=e&&c.row<e+s)for(a=0;a<f.length;a++)if(p=f[a],p.row===c.row&&p.col===c.col){f.splice(a,1);break}}else{if(v&&v.length>0)for(l=0;l<v.length;l++)c=v[l],r<=c.row&&c.row<r+s&&u<=c.col&&c.col<u+h&&w.push(new t.Range(e+c.row-r,o+c.col-u,c.rowCount,c.colCount));if(y&&y.length>0)for(l=0;l<y.length;l++)if(c=y[l],c.row>=e&&c.row<e+s&&c.col>=o&&c.col<o+h)for(a=0;a<f.length;a++)if(p=f[a],p.row===c.row&&p.col===c.col){f.splice(a,1);break}}if(w.length>0&&f)for(l=0;l<w.length;l++)b=w[l],f.push(b)},n.getSpans=function(n){return n&&n.length>0?n.slice(0):i},n.copyColumnAxis=function(n,t,u,e,o,s){var v=t,l=e,k=o,c,h,p,w,a,d,y,b;for(t<0&&(v=0,k=f(n.getColumnCount(),u.getColumnCount())),e<0&&(l=0),c=1,h=0;h<k;h++)p=n._getActualColumnWidth(h+v),p!==r&&p!==i&&u.setColumnWidth(h+l,p),w=n.getColumnVisible(h+v),w!==r&&w!==i&&u.setColumnVisible(h+l,w),(s&64)>0&&(a=n.getActualStyle(-1,h+v),a?u.setStyleWithoutLocked(-1,h+l,a.clone()):u.setStyleWithoutLocked(-1,h+l,i),a=n.getActualStyle(-1,h+v,c),a?u.setStyleWithoutLocked(-1,h+l,a.clone(),c):u.setStyleWithoutLocked(-1,h+l,i,c));for(d=f(n.getRowCount(c),u.getRowCount(c)),y=0;y<d;y++)b=n._getActualRowHeight(y,c),b!==r&&b!==i&&u.setRowHeight(y,b,c)},n.cloneAxisInfo=function(n,t,r){for(var u,s,f,e=[],o=0;o<r;o++)if(u=n[t+o],u){s={};for(f in u)u.hasOwnProperty(f)&&(s[f]=u[f]);e.push(s)}else e.push(i);return e},n.getAxisInfo=function(n,t,i){for(var u=[],r=0;r<i;r++)u.push(n[t+r]);return u},n.setAxisInfo=function(n,t,i){if(t)for(var r=0;r<n.length;r++)t[i+r]=n[r]},n.copyRowAxis=function(n,t,u,e,o,s,h){var y=t,l=e,d=o,a,c,w,b,v,g,p,k;for(t<0&&(y=0,d=f(n.getRowCount(),u.getRowCount())),e<0&&(l=0),a=2,c=0;c<d;c++)h&&u.isRowFilterOut(c+l)||(w=n._getActualRowHeight(c+y),w!==r&&w!==i&&u.setRowHeight(c+l,w),b=n.getRowVisible(c+y),b!==r&&b!==i&&u.setRowVisible(c+l,b),(s&64)>0&&(v=n.getActualStyle(c+y,-1),v?u.setStyleWithoutLocked(c+l,-1,v.clone()):u.setStyleWithoutLocked(c+l,-1,i),v=n.getActualStyle(c+y,-1,a),v?u.setStyleWithoutLocked(c+l,-1,v.clone(),a):u.setStyleWithoutLocked(c+l,-1,i,a)));for(g=f(n.getColumnCount(a),u.getColumnCount(a)),p=0;p<g;p++)k=n._getActualColumnWidth(p,a),k!==r&&k!==i&&u.setColumnWidth(p,k,a)},n.copySheetInfo=function(n,t,i){if(!(n===t&&n._name===t._name)){if((i&64)>0){var r=1,u=2;t.setDefaultStyle(n.getDefaultStyle().clone());t.setDefaultStyle(n.getDefaultStyle(r).clone(),r);t.setDefaultStyle(n.getDefaultStyle(u).clone(),u)}t.defaults.colWidth=n.defaults.colWidth;t.defaults.rowHeight=n.defaults.rowHeight;t.defaults.rowHeaderColWidth=n.defaults.rowHeaderColWidth}},n.moveTo=function(r,u,e,o,s,h,c,l,a){var v=n,rt=t.util.hasCalc()&&t.Calc.CalcOperatorAdjustor,g,p,w,b,k,d,y;v.checkArguments(r,u,e,o,s,h,c,l);(a&64)>0&&v.moveStyle(r,u,e,o,s,h,c,l);(a&1)>0&&(a&2)>0&&(g=v.saveTable(r,u,e,o,s,h,c,l));r.suspendCalcService();o.suspendCalcService();p=i;(a&256)>0&&(p=v.moveBindingPath(r,u,e,o,s,h,c,l));try{if((a&1)>0&&(v.moveValue(r,u,e,o,s,h,c,l),(a&2)==0&&v.clearFormula(o,s,h,c,l),(a&256)>0)){var nt=p.length,tt=s<0?0:s,it=h<0?0:h;for(w=0;w<nt;w++)b=p[w],o.setValue(tt+b.row,it+b.col,b.value)}v.adjustCustomNameOnMove(r,u,e,o,s,h,c,l);(a&2)>0&&v.moveFormula(r,u,e,o,s,h,c,l)}finally{(a&1)>0&&(a&2)>0&&v.restoreTableForMoveTo(g,r,u,e,o,s,h,c,l);r.resumeCalcService(!1);o.resumeCalcService(!1)}if((a&512)>0&&v.moveConditionalFormatRules(r,u,e,o,s,h,c,l),(a&4)>0&&v.moveComment(r,u,e,o,s,h,c,l),(a&128)>0&&v.moveTag(r,u,e,o,s,h,c,l),(a&16)>0&&v.moveSparkline(r,u,e,o,s,h,c,l),(a&8)>0&&(u<0&&v.moveColumnRangeGroup(r,e,o,h,l),e<0&&v.moveRowRangeGroup(r,u,o,s,c)),(a&32)>0&&v.moveSpan(r,u,e,o,s,h,c,l),u<0&&v.moveColumnAxis(r,e,o,h,l,a),e<0&&v.moveRowAxis(r,u,o,s,c,a),u<0&&s<0&&e<0&&h<0&&v.moveSheetInfo(r,o,a),u<0)for(k=e,d=l,e<0&&(k=0,d=f(r.getColumnCount(),o.getColumnCount())),y=0;y<d;y++)r.isColumnBound(k+y)&&r._sheetModelManager.getColInfos().reset(k+y)},n.moveFormula=function(n,u,e,o,s,h,c,l){var w=n._getCalcModel(),b=o._getCalcModel(),et,ut,a,v,ot,st,rt,ft,tt;if(w&&b){var it=w.getCalcService().getOperatorAdjustor(),k=u,d=e,y=s,p=h,g=c,nt=l;for(u<0&&(k=0,g=f(n.getRowCount(),o.getRowCount())),e<0&&(d=0,nt=f(n.getColumnCount(),o.getColumnCount())),s<0&&(y=0),h<0&&(p=0),et=!(n===o&&n._name===o._name),w.unlinkCellExpression(k,d,g,nt),it._addDependentsToAdjust(w,k,d,g,nt),b.unlinkCellExpression(y,p,g,nt),it._addDependentsToAdjust(b,y,p,g,nt),ut=[],a=0;a<g;a++)for(v=0;v<nt;v++){var ft=w._getExpr(a+k,v+d),tt=w.getArrayInfo(a+k,v+d),ht=w._getWorkingExpr(a+k,v+d);ft?(ut.push({expr:ft,arrayInfo:tt,workingExpr:ht}),w._clearAllExpr(a+k,v+d)):ut.push(i)}for(ot=o.getCalcService(),a=0;a<g;a++)for(v=0;v<nt;v++)rt=ut.shift(),rt?(ft=rt.expr,tt=rt.arrayInfo,ot&&tt&&tt.row===k+a&&tt.col===d+v&&(st=new t.Range(a+y,v+p,tt.rowCount,tt.colCount)),tt&&(tt.row=a+y,tt.col=v+p),b._setExpr(a+y,v+p,ft),b._setArrayInfo(a+y,v+p,tt?st:r),b._setWorkingExpr(a+y,v+p,rt.workingExpr)):(b._setExpr(a+y,v+p,r),b._setArrayInfo(a+y,v+p,r));it._addCellsToAdjust(w,k,d,g,nt);it._addCellsToAdjust(b,y,p,g,nt);it.adjustFormulasOnMoveSwap(w.getSource(),k,d,b.getSource(),y,p,g,nt,!0);et===!0&&it.adjustFormulasOnMoveSwap(w.getSource(),k,d,b.getSource(),y,p,g,nt,!0)}},n.moveValue=function(n,r,e,o,s,h,c,l){var ht=!(n===o&&n._name===o._name),p,w,a,v,y,ct,b,g,it,lt,at;if(r<0){var k=1,d=e,et=h;if(p=f(n.getRowCount(k),o.getRowCount(k)),w=l,e<0&&(d=0,w=n.getColumnCount()),h<0&&(et=0),ht)for(a=0;a<p;a++)for(v=0;v<w;v++)y=n._sheetModelManager.getDataModel(k).getValue(a,d+v),(typeof y===u||y===i)&&n.isColumnBound(d+v)&&(a===n.colHeaderAutoTextIndex||a===p-1&&n.colHeaderAutoTextIndex===-1)&&(y=n.getDataColumnName(d+v)),typeof y===u||y===i?o._setValueInternal(a,et+v,i,k,!1):(o._setValueInternal(a,et+v,y,k,!1),n._setValueInternal(a,d+v,i,k,!1));else{for(ct=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n._sheetModelManager.getDataModel(k).getValue(a,d+v),(typeof y===u||y===i)&&n.isColumnBound(d+v)&&(a===n.colHeaderAutoTextIndex||a===p-1&&n.colHeaderAutoTextIndex===-1)&&(y=n.getDataColumnName(d+v)),typeof y!==u&&y!==i&&ct.setValue(a,v,y),n._setValueInternal(a,d+v,i,k,!1);for(a=0;a<p;a++)for(v=0;v<w;v++)o._setValueInternal(a,et+v,ct.getValue(a,v),k,!1)}}if(b=2,e<0)if(g=r,it=s,p=c,w=f(n.getColumnCount(b),o.getColumnCount(b)),r<0&&(g=0,p=n.getRowCount()),s<0&&(it=0),ht)for(a=0;a<p;a++)for(v=0;v<w;v++)y=n.getValue(g+a,v,b),typeof y===u||y===i?o._setValueInternal(it+a,v,i,b,!1):(o._setValueInternal(it+a,v,y,b,!1),n._setValueInternal(g+a,v,i,b,!1));else{for(lt=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n._getModel(b).getValue(g+a,v),typeof y!==u&&y!==i&&lt.setValue(a,v,y),n._setValueInternal(g+a,v,i,b,!1);for(a=0;a<p;a++)for(v=0;v<w;v++)o._setValueInternal(it+a,v,lt.getValue(a,v),b,!1)}var rt=3,ut=r,ft=e,ot=s,st=h,nt=c,tt=l;if(r<0&&(ut=0,nt=f(n.getRowCount(),o.getRowCount())),e<0&&(ft=0,tt=f(n.getColumnCount(),o.getColumnCount())),s<0&&(ot=0),h<0&&(st=0),ht)for(a=0;a<nt;a++)for(v=0;v<tt;v++)y=n.getValue(ut+a,ft+v),typeof y===u||y===i?o._setValueInternal(ot+a,st+v,i,rt,!1):(o._setValueInternal(ot+a,st+v,y,rt,!1),n._setValueInternal(ut+a,ft+v,i,rt,!1));else{for(at=new t._GcSheetModel(nt,tt,i),a=0;a<nt;a++)for(v=0;v<tt;v++)y=n.getValue(ut+a,ft+v),typeof y!==u&&y!==i&&at.setValue(a,v,y);for(a=0;a<nt;a++)for(v=0;v<tt;v++)n._setValueInternal(ut+a,ft+v,i,rt,!1);for(a=0;a<nt;a++)for(v=0;v<tt;v++)o._setValueInternal(ot+a,st+v,at.getValue(a,v),rt,!1)}},n.adjustCustomNameOnMove=function(t,i,r,u,f,e,o,s){var w=n,c,p,v,l,a,y,h;if(!t.parent||!t.parent.sheets){if(c=t.getCustomNames(),c&&c.length>0)for(h=0;h<c.length;h++)l=c[h].getExpression(),a=w.adjustCustomNameExpOnMove(t,t,i,r,u,f,e,o,s,l),a!==l&&c[h].setExpression(a);return}if(p=t.parent.sheets,v=t.parent.getCustomNames(),v&&v.length>0)for(h=0;h<v.length;h++)l=v[h].getExpression(),a=w.adjustCustomNameExpOnMove(null,t,i,r,u,f,e,o,s,l),a!==l&&v[h].setExpression(a);for(y=0;y<p.length;y++)if(c=p[y].getCustomNames(),c&&c.length>0)for(h=0;h<c.length;h++)l=c[h].getExpression(),a=w.adjustCustomNameExpOnMove(p[y],t,i,r,u,f,e,o,s,l),a!==l&&c[h].setExpression(a)},n.adjustCustomNameExpOnMove=function(i,r,u,f,e,o,s,h,c,l){var g=n,w=o-u,b=s-f,ot=r._getSheetSource(),nt=e._getSheetSource(),tt,et,y,p;if(l.t===10){var it=l,st=it.left,ht=it.right,ct=g.adjustCustomNameExpOnMove(i,r,u,f,e,o,s,h,c,st),lt=g.adjustCustomNameExpOnMove(i,r,u,f,e,o,s,h,c,ht);if(st!==ct||ht!==lt)return new t.Calc.Expressions.BinaryOperatorExpression(it.operator,ct,lt)}else if(l.t===11){var at=l,vt=at.operand,yt=g.adjustCustomNameExpOnMove(i,r,u,f,e,o,s,h,c,vt);if(vt!==yt)return new t.Calc.Expressions.UnaryOperatorExpression(at.operator,yt)}else if(l.t===7){var rt=l,ut=!1,pt=[],ft;for(tt=0;tt<rt.args.length;tt++)ft=rt.args[tt],et=g.adjustCustomNameExpOnMove(i,r,u,f,e,o,s,h,c,ft),ut=ut||ft!==et,pt.push(et);if(ut)return new t.Calc.Expressions.FunctionExpression(rt.fn,pt)}else if(l.t===1){if(y=l,y.source===ot&&!y.rowRelative&&y.row>=u&&y.row<u+h&&!y.columnRelative&&y.column>=f&&y.column<f+c)return new t.Calc.Expressions.ExternalCellExpression(nt,y.row+w,y.column+b)}else if(l.t!==22)if(l.t===0){if(p=l,i===r&&!p.rowRelative&&p.row>=u&&p.row<u+h&&!p.columnRelative&&p.column>=f&&p.column<f+c)return new t.Calc.Expressions.ExternalCellExpression(nt,p.row+w,p.column+b)}else if(l.t===3){var a=l,k=!a.startRowRelative&&!a.startColumnRelative,d=!a.endRowRelative&&!a.endColumnRelative;if(a.source===ot&&(k&&a.startRow>=u&&a.startColumn>=f||d&&a.endColumn<f+c&&a.endRow<u+h))return new t.Calc.Expressions.ExternalRangeExpression(nt,a.startRow+(k?w:0),a.startColumn+(k?b:0),a.endRow+(d?w:0),a.endColumn+(d?b:0),a.startRowRelative,a.startColumnRelative,a.endRowRelative,a.endColumnRelative)}else if(l.t!==23)if(l.t===2){var v=l,k=!v.startRowRelative&&!v.startColumnRelative,d=!v.endRowRelative&&!v.endColumnRelative;if(i===r&&(k&&v.startRow>=u&&v.startColumn>=f||d&&v.endColumn<f+c&&v.endRow<u+h))return new t.Calc.Expressions.ExternalRangeExpression(nt,v.startRow+(k?w:0),v.startColumn+(k?b:0),v.endRow+(d?w:0),v.endColumn+(d?b:0),v.startRowRelative,v.startColumnRelative,v.endRowRelative,v.endColumnRelative)}else if(l.t===14){var kt=l,wt=kt.argument,bt=g.adjustCustomNameExpOnMove(i,r,u,f,e,o,s,h,c,wt);if(wt!==bt)return new t.Calc.Expressions.ParenthesesExpression(bt)}return l},n.adjustCustomNameOnInsertRemove=function(t,i,r,u,f){var v=n,o,a,c,s,h,l,e;if(!t.parent||!t.parent.sheets){if(o=t.getCustomNames(),o&&o.length>0)for(e=0;e<o.length;e++)s=o[e].getExpression(),h=v.adjustCustomNameExpOnInsertRemove(t,t,i,r,u,f,s),h!==s&&o[e].setExpression(h);return}if(a=t.parent.sheets,c=t.parent.getCustomNames(),c&&c.length>0)for(e=0;e<c.length;e++)s=c[e].getExpression(),h=v.adjustCustomNameExpOnInsertRemove(null,t,i,r,u,f,s),h!==s&&c[e].setExpression(h);for(l=0;l<a.length;l++)if(o=a[l].getCustomNames(),o&&o.length>0)for(e=0;e<o.length;e++)s=o[e].getExpression(),h=v.adjustCustomNameExpOnInsertRemove(a[l],t,i,r,u,f,s),h!==s&&o[e].setExpression(h)},n.adjustCustomNameExpOnInsertRemove=function(i,r,u,f,e,o,s){var b=n,p=r._getSheetSource(),w=new t.Calc.Expressions.ExternalErrorExpression(p,t.Calc.Errors.Reference),d,rt,c,k;if(s.t===10){var g=s,ut=g.left,ft=g.right,et=b.adjustCustomNameExpOnInsertRemove(i,r,u,f,e,o,ut),ot=b.adjustCustomNameExpOnInsertRemove(i,r,u,f,e,o,ft);if(ut!==et||ft!==ot)return new t.Calc.Expressions.BinaryOperatorExpression(g.operator,et,ot)}else if(s.t===11){var st=s,ht=st.operand,ct=b.adjustCustomNameExpOnInsertRemove(i,r,u,f,e,o,ht);if(ht!==ct)return new t.Calc.Expressions.UnaryOperatorExpression(st.operator,ct)}else if(s.t===7){var nt=s,tt=!1,lt=[],it;for(d=0;d<nt.args.length;d++)it=nt.args[d],rt=b.adjustCustomNameExpOnInsertRemove(i,r,u,f,e,o,it),tt=tt||it!==rt,lt.push(rt);if(tt)return new t.Calc.Expressions.FunctionExpression(nt.fn,lt)}else if(s.t!==22)if(s.t===1||s.t===0){if(c=s,k=s.source||i&&i._getSheetSource(),k&&k===p&&(o&&!c.rowRelative||!o&&!c.columnRelative))if(o&&e){if(c.row>=u)return new t.Calc.Expressions.ExternalCellExpression(p,c.row+f,c.column,c.rowRelative,c.columnRelative)}else if(!o&&e){if(c.column>=u)return new t.Calc.Expressions.ExternalCellExpression(p,c.row,c.column+f,c.rowRelative,c.columnRelative)}else if(o&&!e){if(c.row>=u+f)return new t.Calc.Expressions.ExternalCellExpression(p,c.row-f,c.column,c.rowRelative,c.columnRelative);else if(c.row>=u)return w}else if(c.column>=u+f)return new t.Calc.Expressions.ExternalCellExpression(p,c.row,c.column-f,c.rowRelative,c.columnRelative);else if(c.column>=u)return w}else if(s.t!==23)if(s.t===3||s.t===2){var h=s,k=s.source||i&&i._getSheetSource(),l=h.startRow,a=h.startColumn,v=h.endRow,y=h.endColumn;if(k&&k===p)if(o&&e){if(!h.startRowRelative&&l>=u&&(l+=f),!h.endRowRelative&&v>=u&&(v+=f),l!==h.startRow||v!==h.endRow)return new t.Calc.Expressions.ExternalRangeExpression(p,l,a,v,y,h.startRowRelative,h.startColumnRelative,h.endRowRelative,h.endColumnRelative)}else if(!o&&e){if(!h.startColumnRelative&&a>=u&&(a+=f),!h.endColumnRelative&&y>=u&&(y+=f),a!==h.startColumn||y!==h.endColumn)return new t.Calc.Expressions.ExternalRangeExpression(p,l,a,v,y,h.startRowRelative,h.startColumnRelative,h.endRowRelative,h.endColumnRelative)}else if(o&&!e){if(!h.startRowRelative&&l>=u&&!h.endRowRelative&&v<u+f)return w;else if(h.startRowRelative&&h.endRowRelative||v<u)return s;if(!h.startRowRelative)if(l>=u+f)l-=f;else if(!(l<u))if(h.endRowRelative)return w;else l>u&&(l=u);if(!h.endRowRelative)if(v>=u+f)v-=f;else if(h.startRowRelative)return w;else v<u+f&&(v=u-1);if(l!==h.startRow||v!==h.endRow)return new t.Calc.Expressions.ExternalRangeExpression(p,l,a,v,y,h.startRowRelative,h.startColumnRelative,h.endRowRelative,h.endColumnRelative)}else{if(!h.startColumnRelative&&a>=u&&!h.endColumnRelative&&y<u+f)return w;else if(h.startColumnRelative&&h.endColumnRelative||y<u)return s;if(!h.startColumnRelative)if(a>=u+f)a-=f;else if(!(a<u))if(h.endColumnRelative)return w;else a>u&&(a=u);if(!h.endColumnRelative)if(y>=u+f)y-=f;else if(h.startColumnRelative)return w;else y<u+f&&(y=u-1);if(a!==h.startColumn||y!==h.endColumn)return new t.Calc.Expressions.ExternalRangeExpression(p,l,a,v,y,h.startRowRelative,h.startColumnRelative,h.endRowRelative,h.endColumnRelative)}}else if(s.t===14){var yt=s,at=yt.argument,vt=b.adjustCustomNameExpOnInsertRemove(i,r,u,f,e,o,at);if(at!==vt)return new t.Calc.Expressions.ParenthesesExpression(vt)}return s},n.moveStyle=function(n,r,u,e,o,s,h,c){var ot=!(n===e&&n._name===e._name),b=1,y,p,l,a,v,k,g,st,w,d,nt,ht,ct;if(r<0)if(k=u,g=s,y=f(n.getRowCount(b),e.getRowCount(b)),p=c,u<0&&(k=0,p=n.getColumnCount()),s<0&&(g=0),ot)for(l=0;l<y;l++)for(a=0;a<p;a++)v=n.getCompositeStyle(l,k+a,b),v?(e.setStyleWithoutLocked(l,g+a,v.clone(),b),n.setStyleWithoutLocked(l,k+a,i,b)):e.setStyleWithoutLocked(l,g+a,i,b);else{for(st=new t._GcSheetModel(y,p,i),l=0;l<y;l++)for(a=0;a<p;a++)v=n.getCompositeStyle(l,k+a,b),v&&st.setValue(l,a,v.clone()),n.setStyleWithoutLocked(l,k+a,i,b);for(l=0;l<y;l++)for(a=0;a<p;a++)e.setStyleWithoutLocked(l,g+a,st.getValue(l,a),b)}if(w=2,u<0)if(d=r,nt=o,y=h,p=f(n.getColumnCount(w),e.getColumnCount(w)),r<0&&(d=0,y=n.getRowCount()),o<0&&(nt=0),ot)for(l=0;l<y;l++)for(a=0;a<p;a++)v=n.getCompositeStyle(d+l,a,w),v?(e.setStyleWithoutLocked(nt+l,a,v.clone(),w),n.setStyleWithoutLocked(d+l,a,i,w)):e.setStyleWithoutLocked(nt+l,a,i,w);else{for(ht=new t._GcSheetModel(y,p,i),l=0;l<y;l++)for(a=0;a<p;a++)v=n.getCompositeStyle(d+l,a,w),v&&ht.setValue(l,a,v.clone()),n.setStyleWithoutLocked(d+l,a,i,w);for(l=0;l<y;l++)for(a=0;a<p;a++)e.setStyleWithoutLocked(nt+l,a,ht.getValue(l,a),w)}var tt=r,it=u,ft=o,et=s,rt=h,ut=c;if(r<0&&(tt=0,rt=f(n.getRowCount(),e.getRowCount())),u<0&&(it=0,ut=f(n.getColumnCount(),e.getColumnCount())),o<0&&(ft=0),s<0&&(et=0),ot)for(l=0;l<rt;l++)for(a=0;a<ut;a++)v=n.getCompositeStyle(tt+l,it+a),v?(e.setStyleWithoutLocked(ft+l,et+a,v.clone()),n.setStyleWithoutLocked(tt+l,it+a,i)):e.setStyleWithoutLocked(ft+l,et+a,i);else{for(ct=new t._GcSheetModel(rt,ut,i),l=0;l<rt;l++)for(a=0;a<ut;a++)v=n.getCompositeStyle(tt+l,it+a),v&&ct.setValue(l,a,v.clone()),n.setStyleWithoutLocked(tt+l,it+a,i);for(l=0;l<rt;l++)for(a=0;a<ut;a++)e.setStyleWithoutLocked(ft+l,et+a,ct.getValue(l,a))}},n.moveTag=function(n,r,e,o,s,h,c,l){var ot=!(n===o&&n._name===o._name),p,w,a,v,y,vt,st,yt,ct,ht,nt,pt,wt;if(r<0){var b=1,k=e,tt=h;if(p=f(n.getRowCount(b),o.getRowCount(b)),w=l,e<0&&(k=0,w=n.getColumnCount()),h<0&&(tt=0),ot){for(a=0;a<p;a++)for(v=0;v<w;v++)y=n.getTag(a,k+v,b),typeof y===u||y===i?o.setTag(a,tt+v,i,b):(o.setTag(a,tt+v,y,b),n.setTag(a,k+v,i,b));for(v=0;v<w;v++)y=n.getTag(-1,k+v),typeof y===u||y===i?o.setTag(-1,tt+v,i):(o.setTag(-1,tt+v,y),n.setTag(-1,k+v,i))}else{for(vt=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n.getTag(a,k+v,b),typeof y!==u&&y!==i&&vt.setTag(a,v,y),n.setTag(a,k+v,i,b);for(a=0;a<p;a++)for(v=0;v<w;v++)o.setTag(a,tt+v,vt.getTag(a,v),b);for(st={},v=0;v<w;v++)y=n.getTag(-1,k+v),typeof y!==u&&y!==i&&(st[v]=y),n.setTag(-1,k+v,i);for(ht in st)nt=parseInt(ht),isNaN(nt)||o.setTag(-1,tt+nt,st[nt])}}if(e<0){var d=2,g=r,it=s;if(p=c,w=f(n.getColumnCount(d),o.getColumnCount(d)),r<0&&(g=0,p=n.getRowCount()),s<0&&(it=0),ot){for(a=0;a<p;a++)for(v=0;v<w;v++)y=n.getTag(g+a,v,d),typeof y===u||y===i?o.setTag(it+a,v,i,d):(o.setTag(it+a,v,y,d),n.setTag(g+a,v,i,d));for(a=0;a<p;a++)y=n.getTag(g+a,-1),typeof y===u||y===i?o.setTag(it+a,-1,i):(o.setTag(it+a,-1,y),n.setTag(g+a,-1,i))}else{for(yt=new t._GcSheetModel(p,w,i),a=0;a<p;a++)for(v=0;v<w;v++)y=n.getTag(g+a,v,d),typeof y!==u&&y!==i&&yt.setTag(a,v,y),n.setTag(g+a,v,i,d);for(a=0;a<p;a++)for(v=0;v<w;v++)o.setTag(it+a,v,yt.getTag(a,v),d);for(ct={},a=0;a<p;a++)y=n.getTag(g+a,-1),typeof y!==u&&y!==i&&(ct[a]=y),n.setTag(g+a,-1,i);for(ht in ct)nt=parseInt(ht),isNaN(nt)||o.setTag(it+nt,-1,ct[nt])}}var rt=r,ut=e,lt=s,at=h,ft=c,et=l;if(r<0&&(rt=0,ft=f(n.getRowCount(),o.getRowCount())),e<0&&(ut=0,et=f(n.getColumnCount(),o.getColumnCount())),s<0&&(lt=0),h<0&&(at=0),ot)for(a=0;a<ft;a++)for(v=0;v<et;v++)y=n.getTag(rt+a,ut+v),typeof y===u||y===i?o.setTag(lt+a,at+v,i):(o.setTag(lt+a,at+v,y),n.setTag(rt+a,ut+v,i));else{for(pt=new t._GcSheetModel(ft,et,i),a=0;a<ft;a++)for(v=0;v<et;v++)y=n.getTag(rt+a,ut+v),typeof y!==u&&y!==i&&pt.setTag(a,v,y),n.setTag(rt+a,ut+v,i);for(a=0;a<ft;a++)for(v=0;v<et;v++)o.setTag(lt+a,at+v,pt.getTag(a,v))}if(r<0&&e<0){if(!ot)return;wt=n.tag();n.tag(i);o.tag(wt)}},n.moveConditionalFormatRules=function(n,t,i,r,u,f,e,o){this.copyConditionalFormatRules(n,t,i,r,u,f,e,o);this._deleteConditionalFormatRange(n,t,i,r,u,f,e,o)},n._deleteConditionalFormatRange=function(n,i,r,u,o,s,h,c){var rt=[],ot=n._conditionalFormats,g,nt,st,ut,w,b,ft,k,y,p,d,et;if(ot){for(g=0;g<h;g++)for(nt=0;nt<c;nt++)for(st=ot.getRules(i+g,r+nt),ut=0;ut<st.length;ut++){for(w=st[ut],b=[],ft=0;ft<w.ranges.length;ft++){var v=w.ranges[ft],l=v.row,a=v.col,tt=v.rowCount,it=v.colCount;if(l===-1&&(l=0,tt=n.getRowCount()),a===-1&&(a=0,it=n.getColumnCount()),t.ArrayHelper.indexOf(rt,v)>-1||!v.contains(i+g,r+nt))continue;else rt.push(v);i>l&&(k=new t.Range(-1,-1,-1,-1),k.row=l,k.col=a,k.rowCount=i-l,k.colCount=it,b.push(k));r>a&&(y=new t.Range(-1,-1,-1,-1),y.row=e(i,l),y.col=a,y.rowCount=f(i+h,l+tt)-y.row,y.colCount=r-a,b.push(y));r+c<a+it&&(p=new t.Range(-1,-1,-1,-1),p.row=e(i,l),p.col=r+c,p.rowCount=f(i+h,l+tt)-p.row,p.colCount=a+it-(r+c),b.push(p));i+h<l+tt&&(d=new t.Range(-1,-1,-1,-1),d.row=i+h,d.col=a,d.rowCount=l+tt-(i+h),d.colCount=it,b.push(d))}for(et=0;et<rt.length;et++)t.ArrayHelper.remove(w.ranges,rt[et]);w.ranges=w.ranges.concat(b)}ot._resetCache()}},n.moveComment=function(n,t,r,u,e,o,s,h){var w=t,b=r,k=e,d=o,g=s,nt=h,y,l,a,v,p,tt,c;for(t<0&&(w=0,g=f(n.getRowCount(),u.getRowCount())),r<0&&(b=0,nt=f(n.getColumnCount(),u.getColumnCount())),e<0&&(k=0),o<0&&(d=0),y=[],l=0;l<g;l++)for(a=0;a<nt;a++)c=n.getComment(w+l,b+a),c&&(v=c.clone(),v._sheet=u,v._rowIndex=k+l,v._colIndex=d+a,y.push(v),n.setComment(w+l,b+a,i));for(p=0,tt=y.length;p<tt;p++)c=y[p],u.setComment(c._rowIndex,c._colIndex,c)},n.moveSparkline=function(n,t,i,r,u,e,o,s){var c=t,l=i,a=u,v=e,y=o,p=s,w,h;t<0&&(c=0,y=f(n.getRowCount(),r.getRowCount()));i<0&&(l=0,p=f(n.getColumnCount(),r.getColumnCount()));u<0&&(a=0);e<0&&(v=0);w=!(n===r&&n._name===r._name);w?(h=r._sparklineGroupManager,h&&h._exMove(n,c,l,a,v,y,p)):(h=n._sparklineGroupManager,h&&h._move(c,l,a,v,y,p))},n.moveColumnRangeGroup=function(i,r,u,e,o){var s=r,c=e,h=o,a,l;s<0&&(s=0,h=f(i.getColumnCount(),u.getColumnCount()));e<0&&(c=0);a=!(i===u&&i._name===u._name);a?i.colRangeGroup&&u.colRangeGroup&&(n.crossSheetCopyRangeGroup(i.colRangeGroup,s,u.colRangeGroup,c,h),t.ArrayHelper.clear(i.colRangeGroup.items,s,h)):(l=i.colRangeGroup,l&&l._move(s,c,h))},n.moveRowRangeGroup=function(i,r,u,e,o){var s=r,c=e,h=o,a,l;r<0&&(s=0,h=f(i.getRowCount(),u.getRowCount()));e<0&&(c=0);a=!(i===u&&i._name===u._name);a?i.rowRangeGroup&&u.rowRangeGroup&&(n.crossSheetCopyRangeGroup(i.rowRangeGroup,s,u.rowRangeGroup,c,h),t.ArrayHelper.clear(i.rowRangeGroup.items,s,h)):(l=i.rowRangeGroup,l&&l._move(s,c,h))},n.moveSpan=function(t,i,r,u,e,o,s,h){var l=i,c=r,y=e,p=o,a=s,v=h,w,b,k,d;i<0&&(l=0,a=f(t.getRowCount(),u.getRowCount()));c<0&&(c=0,v=f(t.getColumnCount(),u.getColumnCount()));e<0&&(y=0);o<0&&(p=0);w=!(t===u&&t._name===u._name);i<0&&(w?(n.crossSheetCopySpans(t._getSpanModel(1),-1,c,u._getSpanModel(1),-1,p,-1,v),t._getSpanModel(1)&&t._getSpanModel(1).clear(-1,c,-1,v)):(b=t._getSpanModel(1),b&&b.move(-1,c,-1,p,-1,v)));r<0&&(w?(n.crossSheetCopySpans(t._getSpanModel(2),l,-1,u._getSpanModel(2),y,-1,a,-1),t._getSpanModel(2)&&t._getSpanModel(2).clear(l,-1,a,-1)):(k=t._getSpanModel(2),k&&k.move(l,-1,y,-1,a,-1)));w?(n.crossSheetCopySpans(t._getSpanModel(),l,c,u._getSpanModel(),y,p,a,v),t._getSpanModel()&&t._getSpanModel().clear(l,c,a,v)):(d=t._getSpanModel(),d&&d.move(l,c,y,p,a,v))},n.moveColumnAxis=function(n,t,u,e,o,s){var l=t,a=e,k=o,c,h,p,w,v,d,y,b;for(t<0&&(l=0,k=f(n.getColumnCount(),u.getColumnCount())),e<0&&(a=0),c=1,h=0;h<k;h++)p=n._getActualColumnWidth(h+l),p!==r&&p!==i&&(n.setColumnWidth(h+l,n.defaults.colWidth),u.setColumnWidth(h+a,p)),w=n.getColumnVisible(h+l),w!==r&&w!==i&&(n.setColumnVisible(h+l,!0),u.setColumnVisible(h+a,w)),(s&64)>0&&(v=n.getActualStyle(-1,h+l),v?(u.setStyleWithoutLocked(-1,h+a,v.clone()),n.setStyleWithoutLocked(-1,h+l,i)):u.setStyleWithoutLocked(-1,h+a,i),v=n.getActualStyle(-1,h+l,c),v?(u.setStyleWithoutLocked(-1,h+a,v.clone(),c),n.setStyleWithoutLocked(-1,h+l,i,c)):u.setStyleWithoutLocked(-1,h+a,i,c));for(d=f(n.getRowCount(c),u.getRowCount(c)),y=0;y<d;y++)b=n._getActualRowHeight(y,c),b!==r&&b!==i&&(n.setRowHeight(y,n.defaults.colHeaderRowHeight,c),u.setRowHeight(y,b,c))},n.moveRowAxis=function(n,t,u,e,o,s){var l=t,a=e,k=o,c,h,p,w,v,d,y,b;for(t<0&&(l=0,k=f(n.getRowCount(),u.getRowCount())),e<0&&(a=0),c=2,h=0;h<k;h++)p=n._getActualRowHeight(h+l),p!==r&&p!==i&&(n.setRowHeight(h+l,n.defaults.rowHeight),u.setRowHeight(h+a,p)),w=n.getRowVisible(h+l),w!==r&&w!==i&&(n.setRowVisible(h+l,!0),u.setRowVisible(h+a,w)),(s&64)>0&&(v=n.getActualStyle(h+l,-1),v?(u.setStyleWithoutLocked(h+a,-1,v.clone()),n.setStyleWithoutLocked(h+l,-1,i)):u.setStyleWithoutLocked(h+a,-1,i),v=n.getActualStyle(h+l,-1,c),v?(u.setStyleWithoutLocked(h+a,-1,v.clone(),c),n.setStyleWithoutLocked(h+l,-1,i,c)):u.setStyleWithoutLocked(h+a,-1,i,c));for(d=f(n.getColumnCount(c),u.getColumnCount(c)),y=0;y<d;y++)b=n._getActualColumnWidth(y,c),b!==r&&b!==i&&(n.setColumnWidth(y,n.defaults.rowHeaderColWidth,c),u.setColumnWidth(y,b,c))},n.moveSheetInfo=function(n,t,r){if(n!==t||n._name!==t._name){if((r&64)>0){var u=1,f=2;t.setDefaultStyle(n.getDefaultStyle());t.setDefaultStyle(n.getDefaultStyle(u),u);t.setDefaultStyle(n.getDefaultStyle(f),f);n.setDefaultStyle(i);n.setDefaultStyle(i,u);n.setDefaultStyle(i,f)}t.defaults.colWidth=n.defaults.colWidth;t.defaults.rowHeight=n.defaults.rowHeight;t.defaults.rowHeaderColWidth=n.defaults.rowHeaderColWidth;n.defaults.colWidth=62;n.defaults.rowHeight=20;n.defaults.rowHeaderColWidth=40}},n.moveBindingPath=function(t,i,r,u,f,e,o,s){return n._copyMoveBindingPath(t,i,r,u,f,e,o,s,!0)},n.setRangeText=function(u,f,e,o,s,h,c,a){if(!u)throw new Error(t.SR.Exp_SheetIsNull);if((f<-1||f>=u.getRowCount())&&l("row",f,"-1",u.getRowCount()-1),(e<-1||e>=u.getColumnCount())&&l("column",e,"-1",u.getColumnCount()-1),o!==r&&o!==i&&o!==""){f===-1&&(f=0);e===-1&&(e=0);var v=n.parseText(o,s,h,c);v&&v.length>0&&n.setSheetData(u,f,e,v,a)}},n.getRangeText=function(n,u,f,e,o,s,h,c,a,v){var w,b,p,k,nt,d,y,g;if(!n)throw new Error(t.SR.Exp_SheetIsNull);for((u<-1||u>=n.getRowCount())&&l("row",u,"-1",n.getRowCount()-1),(f<-1||u+f>n.getRowCount())&&l("rowCount",u,"-1",n.getRowCount()-u),(e<-1||e>=n.getColumnCount())&&l("column",e,"-1",n.getColumnCount()-1),(o<-1||e+o>n.getColumnCount())&&l("columnCount",e,"-1",n.getColumnCount()-e),w=-1,b=-1,u===-1&&e===-1&&f===-1&&o===-1?(u=0,e=0,w=n.getRowCount()-1,b=n.getColumnCount()-1):(u===-1&&(u=0),e===-1&&(e=0),f===-1&&(f=n.getRowCount()-u),o===-1&&(o=n.getColumnCount()-e),w=u+f-1,b=e+o-1),(s===r||s===i||s==="")&&(s="\r\n"),(h===r||h===i||h==="")&&(h="\t"),(c===r||c===i||c==="")&&(c='"'),p="",k=u;k<=w;k++){for(nt=!0,d=e;d<=b;d++)nt||(p+=h),nt=!1,y="",g=n.getText(k,d),g!==r&&g!==i&&(y=g,y=y.replace(new RegExp(c,"g"),c+c)),p+=a||y.indexOf(c)!==-1||y.indexOf(h)!==-1||y.indexOf(s)!==-1||y.indexOf("\n")!==-1?c+y+c:y;p+=s}return p.toString()},n.parseText=function(n,u,f,e){var d,c,g,w,v,b;if(n===r||n===i||n==="")return i;(u===r||u===i||u==="")&&(u="\r\n");d="\n";(f===r||f===i||f==="")&&(f="\t");(e===r||e===i||e==="")&&(e='"');t.StringHelper.EndsWith(n,u)||(n+=u);var s=[],h=[],o="",l=!1,a=e.length,y=u.length,k=d.length,p=f.length;for(c=0;c<n.length;c++)o+=n[c],o.length>=a&&e===o.substr(o.length-a,a)?l&&n.length>=c+1+a&&e===n.substr(c+1,a)?c+=a:l?(o=o.substr(0,o.length-a),l=!1):(g=o,g.indexOf(e)===0&&(o=o.substr(0,o.length-a),l=!0)):!l&&o.length>=p&&f===o.substr(o.length-p,p)?(o=o.substr(0,o.length-p),h.push(o.toString()),o=""):!l&&o.length>=y&&u===o.substr(o.length-y,y)?(o=o.substr(0,o.length-y),h.push(o.toString()),s.push(h),h=[],o=""):!l&&o.length>=k&&d===o.substr(o.length-k,k)?(o=o.substr(0,o.length-k),h.push(o.toString()),s.push(h),h=[],o=""):l&&n.length>=c+1+p&&f===n.substr(c+1,p)&&f!=","&&(c+=a);if(l){if(h.length>0){for(w=0;w<s.length;w++)if(s[w]===h)break;w>=s.length&&s.push(h)}v=o.toString();v&&(v=v.replace(new RegExp(f,"g"),""),t.StringHelper.EndsWith(v,u)&&(v=v.substr(0,v.length-y)),s.length==0&&s.push([v]))}return s.length==0&&n&&(b=n,t.StringHelper.EndsWith(n,u)&&(b=b.substr(0,b.length-y)),s.push([b])),s},n.setSheetData=function(t,i,r,u,f){var e=u.length,s=n.getMaxLength(u),o,c,h,l;if(e!==0&&s!==0){o=new ht(f);o.fixOptions(t);var v=o.rowHeader?t.getColumnCount(2):0,a=o.columnHeader?t.getRowCount(1):0,y=0;for(s-=v,s<=0&&(s=0),e-=a,e<=0&&(y=0),e-=y,e<=0&&(e=0),o.expandRows&&i+e>t.getRowCount()&&t.setRowCount(i+e),o.expandColumns&&r+s>t.getColumnCount()&&t.setColumnCount(r+s),c=0,h=0;c<u.length;c++,h++)(l=u[c],l.length<=0)||(a>0&&c<a?n.setRowData(t,l,h,r,s,1,o):e>0&&h<t.getRowCount()&&(c===a&&(h=i),n.setRowData(t,l,h,0,v,2,o),l.splice(0,v),n.setRowData(t,l,h,r,s,3,o)))}},n.setRowData=function(t,i,r,u,f,e,o){for(var s=0,h=u;s<i.length;s++,h++)f>0&&h<t.getColumnCount(e)&&n.setCellData(t,e,r,h,i[s],o)},n.setCellData=function(n,u,f,e,o,s){var h=o,a=i,l,c,v;if(s.unFormatted===!1&&t.features.formatter&&(l={value:o},a=(new t.GeneralFormatter).GetPreferredDisplayFormatter(o,l),h=l.value),h===r||h===i)n.setValue(f,e,h,u);else if(o!=="")if(s.formula&&o[0]==="=")try{n.setFormula(f,e,o.substr(1))}catch(y){n.setText(f,e,o,u)}else c=n.getActualStyle(f,e,u),c&&(s.unFormatted===!1&&t.features.formatter?c.formatter?c.formatter.toString()==="@"&&(h=o.toString()):(v=new t.AutoFormatter(a),n.getCell(f,e,u)._setStyleProperty("_autoFormatter",v)):c.formatter&&n.getCell(f,e,u).formatter(i)),n.setValue(f,e,h,u);else n.setValue(f,e,i,u)},n.getMaxLength=function(n){var t,u,f;if(n===r||n===i)return 0;for(t=0,u=0;u<n.length;u++)f=n[u],t=e(f.length,t);return t},n.parseCsv=function(t,r,u,f){var c=i,s=n.parseText(t,r,u,f),e,o;if(s){var l=s.length,a=n.getMaxLength(s),h=[];for(e=0;e<l;e++)for(h[e]=[],o=0;o<a;o++)h[e][o]=o<s[e].length?s[e][o]:i;c=h}return c},n.tryConvertDateToOADate=function(n){return typeof n!==u&&n!==i&&n.constructor===Date&&(n="/OADate("+new t._DateTimeHelper(n).toOADate()+")/"),n},n.tryConvertOADateToDate=function(n){if(typeof n===c&&n.charAt(0)==="/"){var i;dt.test(n)?(i=n.match(dt),n=t._DateTimeHelper.fromOADate(parseFloat(i[1]))):kt.test(n)&&(i=n.match(kt),n=new Date(parseFloat(i[1])))}return n},n.adjustModelFormulasAfterSetSheetName=function(n){var s,r,p,h,c,u,l,i,a,v,f,e,y,o;if(t.util.hasCalc()&&(s=n.getCalcService(),r=s.getSourceModel(n._getSheetSource()),r))for(h=function(n){var u=n.sourceModel.getSource(),f,t,i,e;n.name?(e=n.name,f=n.sourceModel.getNodeByName(e)):(t=n.row,i=n.column,t=t===undefined?-1:t,i=i===undefined?-1:i,f=n.sourceModel.getNode(t,i));var h=f.expr,r=f.arrayInfo,o=s.unparseWithoutCulture(u,h,t<0?0:t,i<0?0:i);r?u.setArrayFormula(r.row,r.col,r.rowCount,r.colCount,o):e?u.setFormulaByName(e,o):u.setFormula(t,i,o)},c=r.getAllNodes(),u=0;u<c.length;u++)if(l=c[u],i=l.calc,i)for(l.expr&&h(i),a=i._listeners,f=0;f<a.length;f++)if(e=i[a[f]],e)for(y=e.length,o=0;o<y;o++)v=e[o],v.sourceModel!==r&&h(v)},n.getDataValidatorsBeforeSetSheetName=function(n){var u,v,s,i,y,p,h,r,b,f,c,k;if(t.util.hasCalc()){var w=n.getCalcService(),e=n._getSheetSource(),l=0,a=0,o=[[],[]];if(t.features.dataValidator)for(u=t._DataValidatorCache.getAllValidators(),r=0;r<u.length;r++)if(v=u[r].validator,p=u[r].sheet,b=p._getSheetSource(),s=v.condition,i=s.getFormulas(),h=[],i&&i.length>0){for(f=0;f<i.length;f++)y=i[f],c=w.parse(e,y,l,a),h.push(c),k=e.getCalcService().unparse(e,c,l,a);o[0].push(s);o[1].push(h)}return o}},n.adjustValidatorsAfterSetSheetName=function(n,i){var r,u,o;if(t.util.hasCalc()){var s=i[0].length,h=n.getCalcService(),c=n._getSheetSource(),l=0,a=0;for(r=0;r<s;r++){var v=i[0][r],f=i[1][r],e=[];for(u=0;u<f.length;u++)o=h.unparse(c,f[u],l,a),e.push(o);v.setFormulas(e)}}},n.adjustNamesOnRemoveTables=function(t,i){var r=t.parent,e,f=function(i,r){for(var f,e,u=0;u<i.length;u++)f=i[u].getExpression(),e=n.adjustNameOnRemoveTable(f,r),e!==f&&(i[u].setExpression(e),t.getCalcService().getOperatorAdjustor().invalidName(t._getSheetSource(),i[u].getName()))},u;if(r)for(f(r.getCustomNames(),i),u=0;u<r.sheets.length;u++)t=r.sheets[u],f(t.getCustomNames(),i);else f(t.getCustomNames(),i);t.getCalcService().getOperatorAdjustor().onAfterRemoveTable()},n.adjustNameOnRemoveTable=function(i,r){var u=n.adjustNameOnRemoveTable,f,l,tt,e;if(i.t===10){var o=i,a=o.left,v=o.right,y=u(a,r),p=u(v,r);if(a!==y||v!==p)return new t.Calc.Expressions.BinaryOperatorExpression(o.operator,y,p)}else if(i.t===11){var w=i,b=w.operand,k=u(b,r);if(b!==k)return new t.Calc.Expressions.UnaryOperatorExpression(w.operator,k)}else if(i.t===7){var s=i,h=!1,d=[],c;for(f=0;f<s.args.length;f++)c=s.args[f],l=u(c,r),h=h||c!==l,d.push(l);if(h)return new t.Calc.Expressions.FunctionExpression(s.fn,d)}else if(i.t===14){var it=i,g=it.argument,nt=u(g,r);if(g!==nt)return new t.Calc.Expressions.ParenthesesExpression(nt)}else if(i.t===17)for(tt=i,e=0;e<r.length;e++)if(tt.baseTable()===r[e])return new t.Calc.Expressions.ErrorExpression(t.Calc.Errors.Reference);return i},n}(),b=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],ct=new RegExp("{113E2532-EAF5-444c-A5CB-3D7446971C4D}","g"),lt=new RegExp("{E21523B3-0F1F-458f-B547-23D25713D0EC}","g");var a=".gcSheet",d=".gcSheetInternal",g="mousedown"+a,nt="mousemove"+a,tt="mouseup"+a,it="mouseout"+a,rt="dblclick"+a,ut="mousewheel"+a,ft="DOMMouseScroll"+a,ni="resize"+a,vt="value",k="tag",ti="left",ii="top",yt="width",pt="height",wt="hidden",bt="visibility",ri="POST",ui="json",fi="application/json;charset=UTF-8",kt=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),dt=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$")})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){var yi,pi;t.feature("core.spread",["core.common","core.theme","core.sheet_event","core.sheet_action","core.sheet","core.spreadpanelex","core.stringResource","core.imageLoader"]);var i=null,u=undefined,ut=Math.round,h=Math.max,g=Math.min,yt=Math.pow,wi=Math.sqrt,nt="string",p="boolean",w="number",r="undefined",f=window.document,rr="refresh",pt="scroll",wt="resize",ur="horizontal",fr="vertical",bt="input",b="div",e="px",o="0",er="3000",or="hidden",sr="visible",kt="top",dt="none",a=".gcSpread",ft=".gcSpreadInternal",hr="_data",v=".gcScrollbar",tt="scroll-handle",it="scroll-bar",gt="mousedown",ni="mouseup",bi=function(){function s(n,t){var r,f,e,o;this._isResizing=!1;r=this;r._host=i;r._allowUndo=!0;r._paintSuspended=!1;r._availableSheetIndex=-1;r._useTouchLayout=!1;r.touchScrollOnRails(!0);r.sheets=i;r.name=i;r._tabStripRatio=.5;r._tabStripRatioUserSet=.5;r._activeSheetIndex=0;r._allowUserZoom=!0;r._allowUserResize=!0;r._allowSheetReorder=!0;r._tabStripVisible=!0;r._tabEditable=!0;r._newTabVisible=!0;r._firstTabUserSet=0;r._canUserEditFormula=!0;r._enableFormulaTextbox=!0;r._highlightInvalidData=!1;r._autoFitType=0;r._allowDragDrop=!0;r._allowDragFill=!0;r._showDragFillSmartTag=!0;r._defaultDragFillType=5;r._showScrollTip=0;r._showResizeTip=0;r._showDragDropTip=!0;r._showDragFillTip=!0;r._tooltip=i;r._showVerticalScrollbar=!0;r._showHorizontalScrollbar=!0;r._scrollIgnoreHidden=!1;r._backColor="white";r._backgroundImage=i;r._backgroundImageLayout=0;r._imageLoader=i;r._suspendSetFocus=!1;r._cutCopyIndicatorVisible=!0;r._cutCopyIndicatorBorderColor="#217346";r._defaultSheetCount=1;r._defaultActiveSheetIndex=0;r._windowResizeTimer=i;r._scrollbarMaxAlign=!1;r._scrollbarShowMax=!0;r._hideSelection=!1;r._resizeZeroIndicator=1;r._tabNavigationVisible=!0;(typeof t===w||t===i||t===u)&&(f={},typeof arguments[0]===nt&&(f.name=arguments[0]),typeof arguments[1]===w&&(f.sheetCount=arguments[1]),t=f);(typeof n===nt||n===i||n===u)&&(n=i,typeof arguments[2]=="object"&&(n=arguments[2]));e=1;o=[];t&&(typeof t.sheetCount===w&&(e=t.sheetCount),typeof t.name===nt&&t.name.length>0&&(r.name=t.name),typeof t.font===nt&&t.font.length>0&&(r._font=t.font),typeof t.allowUserZoom===p&&(r._allowUserZoom=t.allowUserZoom),typeof t.allowUserResize===p&&(r._allowUserResize=t.allowUserResize),typeof t.tabStripVisible===p&&(r._tabStripVisible=t.tabStripVisible),typeof t.tabEditable===p&&(r._tabEditable=t.tabEditable),typeof t.newTabVisible===p&&(r._newTabVisible=t.newTabVisible),typeof t.tabStripRatio===w&&(r._tabStripRatio=t.tabStripRatio),typeof t.activeSheetIndex===w&&(r._activeSheetIndex=t.activeSheetIndex),t.sheets&&t.sheets.length>0&&(o=t.sheets));r._init(e,o,n)}return s.prototype._init=function(n,r,u){var e=this,o,c,l,a,h,s,v;for(e._initCalcService(),e._userEvents=[],e._userEventsElem=f.createElement(bt),e._eventSuspended=0,e._undoManager=new t._UndoManager(e,-1,e.allowUndo()),e._clipboardHelper={fromSheet:i,range:i,isCutting:!1},e._floatingObjectClipboardHelper={fromSheet:i,isCutting:!1},e._containerDiv=i,t.features.touch&&(e._touchEventProvider=new t.TouchEventProvider),e.sheets=[],e._namedStyles={},t.features.sparklineEx&&(e._sparklineExs={},e.addSparklineEx(new t.PieSparkline),e.addSparklineEx(new t.AreaSparkline),e.addSparklineEx(new t.ScatterSparkline),e.addSparklineEx(new t.LineSparkline),e.addSparklineEx(new t.ColumnSparkline),e.addSparklineEx(new t.WinlossSparkline),e.addSparklineEx(new t.BulletSparkline),e.addSparklineEx(new t.SpreadSparkline),e.addSparklineEx(new t.StackedSparkline),e.addSparklineEx(new t.HBarSparkline),e.addSparklineEx(new t.VBarSparkline),e.addSparklineEx(new t.BoxPlotSparkline),e.addSparklineEx(new t.VariSparkline),e.addSparklineEx(new t.CascadeSparkline),e.addSparklineEx(new t.ParetoSparkline)),o=0;o<n;o++){c=e._createSheet(e._getDefaultSheetName(o));e.sheets.push(c);c.onAttached(e)}if(l=t.util._isStandardCanvas(),a=t.util._isSilverlightCanvas(),l&&e._suspendInvalidate(),u&&e._setHost(u),r&&r.length>0){if(e.getSheetCount()<r.length)for(s=e.getSheetCount();s<r.length;)h=e._createSheet(e._getDefaultSheetName(s)),e._addSheetImp(s,0,h),s=e.getSheetCount();for(o=0;o<r.length;o++)h=e.getSheet(o),h.applyOptions(r[o])}l?(v=e._resumeInvalidate(),v||(e.invalidateLayout(),e.repaint())):a&&window.slcanvas&&window.slcanvas.autoLoad&&window.slcanvas.autoLoad();t.features.touch&&!e.touchToolStrip&&(e.touchToolStrip=new t.TouchToolStrip(e,e._getContainerDiv()))},s.prototype._getContainerDiv=function(){var n=this;return!n._containerDiv&&n._host&&(n._containerDiv=f.createElement("div"),t.GC$(n._containerDiv).css({position:"relative",left:0,top:0,height:0}),t.GC$(n._host).prepend(n._containerDiv)),n._containerDiv},s.prototype._getDefaultSheetName=function(n){var t=this,r,e,o,f,s;t._availableSheetIndex<t.getSheetCount()?t._availableSheetIndex=t.getSheetCount():t._availableSheetIndex++;(n===u||n===i||n<t._availableSheetIndex)&&(n=t._availableSheetIndex);r=!1;do if(e="Sheet"+(n+1),o=t.sheets.length,o>0)for(f=0;f<o;f++)if(f in t.sheets)if(s=t.sheets[f],s._name===e){n++;r=!0;break}else r&&(r=!1);while(r);return e},s.prototype._initCalcService=function(){var n=this;t.util.hasCalc()&&(n.calcService=new t.Calc.CalcService,n._spreadSource=new t.Calc.SpreadSource(n),n._spreadSourceModel=n.calcService.getGlobalSourceModel(n._spreadSource))},s.prototype._createSheet=function(n){return new t.Sheet(n)},s.prototype._slSetHost=function(n){var r=this,i;t.GC$(n).data("spread",r);i=f.createElement("canvas");i.setAttribute("width",""+n.clientWidth);i.setAttribute("height",""+n.clientHeight);n.appendChild(i);r.canvas=i;i.setAttribute("renderMethod","auto");i.setAttribute("gcSpreadsheet","true");i.setAttribute("onload","GcSpread.Sheets.util.initPaint('"+n.id+"')");this._resizeHandler=t.util.createEventHandler(r,r._doResize);t.GC$(window).bind("resize.gcSpread",this._resizeHandler)},s.prototype._setHost=function(n){var r=this,g,nt,l,u,y,tt,p,s,h,w,c,k,d;if(n){if(g=t.util._isStandardCanvas(),nt=t.util._isSilverlightCanvas(),!g&&nt){r._slSetHost(n);return}for(r._host=n,l=window.jQuery,l&&l(n).data("spread",r),t.GC$(n).data("spread",r),n.setAttribute("gcUIElement","gcSpread"),t.Global.prototype._createDummyObjects(),u=f.createElement("table"),u.cellSpacing="0px",u.cellPadding="0px",u.style.border="0px",s=0;s<2;s++){for(y=f.createElement("tr"),h=0;h<2;h++)tt=f.createElement("td"),y.appendChild(tt);u.appendChild(y)}for(n.appendChild(u),t.GC$(n).bind(t.Events.CultureChanged,r,r._onCultureChanged),t.GC$(n).addClass("no-user-select"),r._vp=f.createElement(b),r._vp.id=n.id+"vp",u.rows[0].cells[0].insertBefore(r._vp,i),p="100%",u.style.width=p,u.style.height=p,u.style.border=o,u.style.margin=o,s=0;s<u.rows.length;s++)for(h=0;h<u.rows[s].cells.length;h++)u.rows[s].cells[h].style.padding=o,u.rows[s].cells[h].style.border=o;for(r._scrollbarV=new t.Scrollbar(!1),w=r._scrollbarV.getScrollbar(),r._scrollbarVContainer=f.createElement(b),t.GC$(r._scrollbarVContainer).append(w),u.rows[0].cells[1].insertBefore(r._scrollbarVContainer,i),t.GC$(w).bind(pt+v,function(n,t){var f=r.getActiveSheet(),i=t.scrollEventType,u=t.scrollOrientation;if(n.data=r,u===1)switch(i){case 0:case 1:case 2:case 3:case 5:r._vscrollDelegate(n,t);break;case 4:r._vScrollStop(n);break;default:break}}).bind(gt+v,function(n,t){n.data=r;r._vScrollMouseDown(n)}).bind(ni+v,function(n,t){n.data=r;r._scrollMouseUp(n)}),u.rows[1].cells[0].innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td><\/td><td><\/td><\/tr><\/table>",r._footerCornerContainer=f.createElement(b),t.GC$(u.rows[1].cells[1]).append(r._footerCornerContainer),c=u.rows[1].cells[0].firstChild,c.style.border=o,c.style.margin=o,t.GC$(c).css("user-select","none"),s=0;s<c.rows.length;s++)for(h=0;h<c.rows[s].cells.length;h++)c.rows[s].cells[h].style.padding=o,c.rows[s].cells[h].style.border=o;r._tabs=f.createElement(b);r._tabs.style.width=""+r._getActualTabStripRatio()*t.GC$(r._host).width()+e;r._tabs.style.height=""+r._getTabStripHeight()+e;r._tabs.style.fontSize="10pt";r._tabs.style.fontFamily="Arial";c.rows[0].cells[0].insertBefore(r._tabs,i);r._scrollbarH=new t.Scrollbar(!0);k=r._scrollbarH.getScrollbar();r._scrollbarHContainer=f.createElement(b);t.GC$(r._scrollbarHContainer).append(k);c.rows[0].cells[1].insertBefore(r._scrollbarHContainer,i);t.GC$(k).bind(pt+v,function(n,t){var f=r.getActiveSheet(),i=t.scrollEventType,u=t.scrollOrientation;if(n.data=r,u===0)switch(i){case 0:case 1:case 2:case 3:case 5:r._hscrollDelegate(n,t);break;case 4:r._hScrollStop(n);break;default:break}}).bind(gt+v,function(n,t){n.data=r;r._hScrollMouseDown(n)}).bind(ni+v,function(n,t){n.data=r;r._scrollMouseUp(n)});this._resizeHandler=t.util.createEventHandler(r,r._doWindowResize);t.GC$(window).bind(wt+a,this._resizeHandler);t.features.comment&&(r._commentRender=new t.CommentRender(r._getContainerDiv()));d=r.getActiveSheet();d&&(d._setHost(r._vp),t.GC$(window).unbind("resize.gcSheet"));r._refreshScrollbarAndTabStrip();r._doResize();r._createFocusElementForTab(n)}},s.prototype._createFocusElementForTab=function(n){var r=this,e=parseInt(t.GC$(n).attr("tabindex"),10)||0,u=f.createElement("div");t.GC$(u).css("position","absolute").css("overflow","hidden").attr("gcUIElement","gcSheetFocusElementForTab").attr("tabindex",e).bind("focus",function(){if(!r._ignoreFocusEvent){var n=r.getActiveSheet();n.setFocus()}r._ignoreFocusEvent=!1});n.insertBefore(u,i);r._tabFocusElement=u},s.prototype.focusTabFocusElement=function(){var n=this,t=n._tabFocusElement;t&&(n._ignoreFocusEvent=!0,t.focus())},s.prototype._onCultureChanged=function(n,t){var r=n.data,e,c,u,f,s,h;for(r.invalidateLayout(),r.touchToolStrip&&r.touchToolStrip._updateResource(),e=0,c=r.sheets.length;e<c;e++){var o=r.sheets[e],l=o.getRowCount(),a=o.getColumnCount();for(u=0;u<l;u++)for(f=0;f<a;f++)(s=o.getValue(u,f),s!==i)&&(h=o.getStyle(u,f),h&&h._setActualAutoFormatter(s))}r.repaint()},s.prototype._hscrollDelegate=function(n,t){var s=n.data,f=s.getActiveSheet(),r,e,h,o;f&&t&&(r=parseInt(t.newValue,10),r=f._getOriginalColIndex(r),(t.oldValue===u||t.oldValue===i)&&(t.oldValue=0),t.oldValue=parseInt(t.oldValue,10),f._needSyncHScrollbarSize=!1,t.scrollEventType===2||t.scrollEventType===0?(t.scrollEventType===2&&(r=f._getPrevPageLeftColumn()),e=f._getScrollableColumn(r,!0),e!=-1&&e!=r&&(r=e),s._scrollbarShowMax||(f._needSyncHScrollbarSize=!0,t.ignoreUpdatePosition=!0)):(t.scrollEventType===3||t.scrollEventType===1)&&(t.scrollEventType===3&&(r=f._getPageRightColumn()),s._scrollbarShowMax||(f._needSyncHScrollbarSize=!0,t.scrollEventType===1&&t.newValue===t.oldValue&&r++),e=f._getScrollableColumn(r),e!=-1&&e!=r&&(r=e)),h=f._getFirstPageLeftColumn(),r<h&&(r=h),r>f._getLastVisualScrollColumn()&&(r=f._getLastVisualScrollColumn()),o=f._getVisibleColIndex(r),t.newValue!==o&&(t.newValue=o),t.oldValue!==o&&f._eventHandler.doHScroll(r))},s.prototype._hScrollStop=function(n){var i=n.data,t=i.getActiveSheet(),r,u;t&&(r=i._scrollbarH,u=r.value(),u<t._getFirstPageLeftColumn()?r.value(t._getVisibleColIndex(t._getFirstPageLeftColumn())):u>t._getLastVisualScrollColumn()&&r.value(t._getVisibleColIndex(t._getLastVisualScrollColumn())),t._eventHandler._removeTooltip(),i._scrollbarShowMax||(t._eventHandler.scrolling?t._needSyncHScrollbarSize=!0:i._resizeHScrollBar()),t._formulaTextBox&&t._formulaTextBox.focus())},s.prototype._hScrollMouseDown=function(n){var f=n.data,u,e,i,r,o;f&&(u=f.getActiveSheet(),u&&u.setFocus(),e=f.showScrollTip(),(e===1||e===3)&&(i=t.GC$(n.srcElement||n.target),r=i.parent(),(i&&i.hasClass(tt)||r&&r.hasClass(tt)||i&&i.hasClass(it)||r&&r.hasClass(it))&&(i||r)&&(o=u&&u._eventHandler,o&&o._showScrollTooltip(!1,n))))},s.prototype._vscrollDelegate=function(n,t){var s=n.data,f=s.getActiveSheet(),r,e,h,o;f&&t&&(r=parseInt(t.newValue,10),r=f._getOriginalRowIndex(r),(t.oldValue===u||t.oldValue===i)&&(t.oldValue=0),t.oldValue=parseInt(t.oldValue,10),f._needSyncVScrollbarSize=!1,t.scrollEventType===2||t.scrollEventType===0?(t.scrollEventType===2&&(r=f._getPrevPageTopRow()),e=f._getScrollableRow(r,!0),e!=-1&&e!=r&&(r=e),s._scrollbarShowMax||(f._needSyncVScrollbarSize=!0,t.ignoreUpdatePosition=!0)):(t.scrollEventType===3||t.scrollEventType===1)&&(t.scrollEventType===3&&(r=f._getPageBottomRow()),s._scrollbarShowMax||(f._needSyncVScrollbarSize=!0,t.scrollEventType===1&&t.newValue===t.oldValue&&r++),e=f._getScrollableRow(r),e!=-1&&e!=r&&(r=e)),h=f._getFirstPageTopRow(),r<h&&(r=h),r>f._getLastVisualScrollRow()&&(r=f._getLastVisualScrollRow()),o=f._getVisibleRowIndex(r),t.newValue!==o&&(t.newValue=o),t.oldValue!==o&&f._eventHandler.doVScroll(r))},s.prototype._initPaint=function(){var u=t.util._isStandardCanvas(),n,r,i;u||(n=this,r=n.getActiveSheet(),r)&&(i=r._getCanvas(),i&&i.firstChild&&i.firstChild.loaded?(n.invalidateLayout(),n.repaint()):window.setTimeout(function(){n._initPaint.call(n)},10))},s.prototype._vScrollStop=function(n){var i=n.data,t=i.getActiveSheet(),r,u;t&&(r=i._scrollbarV,u=r.value(),u<t._getFirstPageTopRow()?r.value(t._getVisibleRowIndex(t._getFirstPageTopRow())):u>t._getLastVisualScrollRow()&&r.value(t._getVisibleRowIndex(t._getLastVisualScrollRow())),t._eventHandler._removeTooltip(),i._scrollbarShowMax||(t._eventHandler.scrolling?t._needSyncVScrollbarSize=!0:i._resizeVScrollBar()),t._formulaTextBox&&t._formulaTextBox.focus())},s.prototype._vScrollMouseDown=function(n){var f=n.data,i,e,r,u,o;f&&(i=f.getActiveSheet(),i&&i.setFocus(),e=f.showScrollTip(),(e===2||e===3)&&(r=t.GC$(n.srcElement||n.target),r&&(u=r.parent(),(r.hasClass(tt)||u&&u.hasClass(tt)||r.hasClass(it)||u&&u.hasClass(it))&&(o=i&&i._eventHandler,o&&o._showScrollTooltip(!0,n)))))},s.prototype._scrollMouseUp=function(n){var r=n.data,t,i;r&&(t=r.getActiveSheet(),i=t&&t._eventHandler,i&&i._removeTooltip())},s.prototype._dispose=function(){var n=this,u,r,f;t.DPIHelper.disposeSpread(n);t.GC$(window).unbind(wt+a,this._resizeHandler);n._scrollbarH&&n._scrollbarH.dispose();n._scrollbarV&&n._scrollbarV.dispose();n._touchEventProvider&&n._touchEventProvider.dispose();n._disposeUserEvents();t._DataValidatorCache.clear();u=n.getActiveSheet();u&&u._dispose();n._host&&(n._host.innerHTML="",n._host.removeAttribute("gcUIElement"),r=t.GC$(n._host),r.unbind(t.Events.CultureChanged),r.removeClass("no-user-select"),r.attr("class")||r.removeAttr("class"),r.attr("unselectable")||r.removeAttr("unselectable"));n.touchToolStrip&&(n.touchToolStrip._dispose(),n.touchToolStrip=i);n._commentRender&&(n._commentRender=i);f=n._printer;f&&f.dispose();n._scrollbarHContainer=n._scrollbarVContainer=i;n._undoManager=i;n._tab&&n._tab.dispose();n.calcService=i;n._spreadSource=i;n._spreadSourceModel=i},s.prototype._disposeUserEvents=function(){var n,i;for(t.GC$(this._userEventsElem).unbind(a),n=0;n<this.sheets.length;n++)i=this.sheets[n],i._disposeUserEvents()},s.prototype._getCalcContexts=function(){for(var r,n,i=[],t=0;t<this.sheets.length;t++)if(r=this.sheets[t],n=r._getCalcContexts(),n)while(n.length>0)i.push(n.pop());return i},s.prototype._refreshScrollbarAndTabStrip=function(){var n=this,e=t.ThemeStyleHelper.getCssClassThemeStyle(""),i=parseInt(e.zIndex),u=i!==n._themeVersion,r,f;u&&(n._themeVersion=i);var o=n._getTabStripHeight(),s=n._getScrollbarSize(),h=n._getVScrollbarContainerWidth();n._tab&&!u?n._tab.repaint():(r=n._host,n._tab&&n._tab.dispose(),n._tab=i>2007?new pi(r.getAttribute("id")+"_tabStrip"):new yi(r.getAttribute("id")+"_tabStrip"),n._tab.setOwner(n),n._tab.setHost(n._tabs));f=0;i>2007&&(f=1);n._refreshVScrollContainer();n._refreshHScrollContainer();n._refreshFooterCorner()},s.prototype._refreshVScrollContainer=function(){var u=this,f=t.ThemeStyleHelper.getCssClassThemeStyle("gc-vertical-scrollbar ui-widget-header ui-state-default btn btn-default"),s=parseInt(f.zIndex),i=u._getScrollbarSize(),e=u._getVScrollbarContainerWidth(),n,o,r=0;s>2007&&(r=1);(e-i)%2==0?(n=(e-i)/2,o=n-r):(n=(e-i-r)/2,o=n);t.GC$(u._scrollbarVContainer).css({"box-sizing":"content-box",border:"none","border-color":"none","border-left-style":"solid","border-left-width":r+"px","border-left-color":f.borderLeftColor,"background-color":f.backgroundColor,width:i,padding:"0px "+n+"px 0px "+o+"px",margin:"0"})},s.prototype._refreshHScrollContainer=function(){var u=this,f=t.ThemeStyleHelper.getCssClassThemeStyle("gc-horizontal-scrollbar ui-widget-header ui-state-default btn btn-default"),s=parseInt(f.zIndex),e=u._getTabStripHeight(),i=u._getScrollbarSize(),n,o,r=0;s>2007&&(r=1);(e-i)%2==0?(n=(e-i)/2,o=n-r):(n=(e-i-r)/2,o=n);t.GC$(u._scrollbarHContainer).css({"box-sizing":"content-box",border:"none","border-color":"none","border-top-style":"solid","border-top-width":r+"px","border-top-color":f.borderTopColor,"background-color":f.backgroundColor,height:i,padding:o+"px 0px "+n+"px 0px",margin:"0"})},s.prototype._refreshFooterCorner=function(){var i=t.ThemeStyleHelper.getCssClassThemeStyle("gc-footer-corner ui-widget-header ui-state-default btn btn-default"),n=this,r=n._getVScrollbarContainerWidth(),u=n._getTabStripHeight();t.GC$(this._footerCornerContainer).css({border:"none",padding:"0",margin:"0",width:r+"px",height:u+"px","background-color":i.backgroundColor})},s.prototype._doWindowResize=function(){var n=this;n._windowResizeTimer&&window.clearTimeout(n._windowResizeTimer);n._windowResizeTimer=window.setTimeout(function(){t.DPIHelper.updateDPI();n._doResize();n._windowResizeTimer=i},100)},s.prototype._doResize=function(){var n=this;n._isResizing||(n._isResizing=!0,n._doResizeImp(),n._isResizing=!1)},s.prototype._doResizeImp=function(){var n=this,f,l,s,u,p,i,d;if(t.util.browser.msie&&parseInt(t.util.browser.version,10)<9&&(f=n.canvas,f)){var h=f.parentElement,r=h.parentElement,c=f.firstChild;c&&r&&(l=function(n){return n===""||n==="auto"||/%$/ig.test(n)},l(h.style.width)&&r.offsetWidth>12&&(c.width=r.offsetWidth-12),l(h.style.height&&r.offsetHeight>10)&&(c.height=r.offsetHeight-10))}var a=n._getTabStripHeight(),w=n._getScrollbarSize(),v=n._getVScrollbarContainerWidth(),y=n._host;if(y){var b=t.GC$(y),o=b.width(),k=t.GC$(y).height();n.showVerticalScrollbar()?(n._vp.style.width=""+(o-v)+e,t.GC$(n._scrollbarVContainer).css("display","block"),t.GC$(n._footerCornerContainer).css("width",v+e)):(n._vp.style.width=""+o+e,t.GC$(n._scrollbarVContainer).css("display","none"),t.GC$(n._footerCornerContainer).css("width","0"+e));n.showHorizontalScrollbar()||n._tabStripVisible?(n._vp.style.height=""+(k-a)+e,t.GC$(n._scrollbarHContainer).css("display","block"),t.GC$(n._footerCornerContainer).css("height",a+e)):(n._vp.style.height=""+k+e,t.GC$(n._scrollbarHContainer).css("display","none"),t.GC$(n._footerCornerContainer).css("height","0"+e));n.showHorizontalScrollbar()?(t.GC$(n._scrollbarH.getScrollbar()).show(),n.setTabStripRatio(n.getTabStripRatio())):(t.GC$(n._scrollbarH.getScrollbar()).hide(),n._setActualTabStripRatio(1));s=t.GC$(n._vp).width();u=ut(n._getActualTabStripRatio()*s);u===s&&(u=s-1);n._tabs.style.width=""+u+e;n._tabs.style.height=""+a+e;n._scrollbarV.width(w);n._scrollbarV.height(t.GC$(n._vp).height());p=o-(n._tabStripVisible?u:0)-(n.showVerticalScrollbar()?v:0);n._scrollbarH.width(p>0?p:1);n._scrollbarH.height(w);i=n.getActiveSheet();i&&(i._scrollTopRow===0&&(i._scrollTopRow=i._getFirstPageTopRow()),i._scrollLeftCol===0&&(i._scrollLeftCol=i._getFirstPageLeftColumn()));i&&i._eventHandler.doResize();n._resizeHScrollBar();n._resizeVScrollBar();n._tabStripVisible===!0?t.GC$(n._tabs).show():t.GC$(n._tabs).hide();n._tab&&n._tab.doResize();d=b.width();o===d||n._haveLayoutFixing||(n._haveLayoutFixing=!0,setTimeout(function(){delete n._haveLayoutFixing;n._doResizeImp()},1))}},s.prototype._resizeHScrollBar=function(){var f=this,n=f.getActiveSheet(),s,i;if(n){var c=n.getColumnCount()-n._frozenTrailingColCount-n.frozenColCount,u=n.frozenColCount,h=n._getSheetLayout(),l=u+c-1,t=l,e=n._scrollLeftCol,o=1,a=n._getLeftColWhenLastColShowComplete(h.viewportWidth,u,t);if(f._scrollbarMaxAlign&&(t=a),!f._scrollbarShowMax){var v=n._getLastNonNullRowAndCol(),y=v.lastNonNullCol,r=n._getLeftColWhenLastColShowComplete(h.viewportWidth,u,y);r===u&&(r++,r>t&&(r=t));t=e>r?e<t?e:t:r}e>t&&(n._scrollLeftCol=t);s=n._getScrollableColumn(n._scrollLeftCol);s!==-1&&s!==n._scrollLeftCol&&(n._scrollLeftCol=s);o=n._getPageValueH();o<1&&(o=1);i=f._scrollbarH;i&&(i.minimum(n._getVisibleColIndex(u)),i.maximum(n._getVisibleColIndex(t)),i.pageValue(o),i.refreshLayout(),i.value(n._getVisibleColIndex(n._scrollLeftCol)))}},s.prototype._resizeVScrollBar=function(){var f=this,n=f.getActiveSheet(),s,i;if(n){var c=n.getRowCount()-n._frozenTrailingRowCount-n.frozenRowCount,u=n.frozenRowCount,h=n._getSheetLayout(),l=u+c-1,t=l,e=n._scrollTopRow,o=1,a=n._getTopRowWhenLastRowShowComplete(h.viewportHeight,u,t);if(f._scrollbarMaxAlign&&(t=a),!f._scrollbarShowMax){var v=n._getLastNonNullRowAndCol(),y=v.lastNonNullRow,r=n._getTopRowWhenLastRowShowComplete(h.viewportHeight,u,y);r===u&&(r++,r>t&&(r=t));t=e>r?e<t?e:t:r}e>t&&(n._scrollTopRow=t);s=n._getScrollableRow(n._scrollTopRow);s!==-1&&s!==n._scrollTopRow&&(n._scrollTopRow=s);o=n._getPageValueV();o<1&&(o=1);i=f._scrollbarV;i&&(i.minimum(n._getVisibleRowIndex(u)),i.maximum(n._getVisibleRowIndex(t)),i.pageValue(o),i.refreshLayout(),i.value(n._getVisibleRowIndex(n._scrollTopRow)))}},s.prototype._doTabHSResize=function(){var n=this,s=n._getScrollbarSize(),h=n._getTabStripHeight(),c=n._getVScrollbarContainerWidth(),o=n._host,f,i;if(o){var l=t.GC$(o),a=l.width(),u=t.GC$(n._vp).width(),r=ut(n._getActualTabStripRatio()*u);r===u&&(r=u-1);n._tabs.style.width=""+r+e;n._tabs.style.height=""+h+e;f=a-(n._tabStripVisible?r:0)-(n.showVerticalScrollbar()?c:0);n._scrollbarH.width(f>0?f:1);n._scrollbarH.height(s);n._scrollbarH.refreshLayout();i=n.getActiveSheet();i&&(i._scrollLeftCol===0&&(i._scrollLeftCol=i._getFirstPageLeftColumn()),n._scrollbarH.value(i._scrollLeftCol));n._tabStripVisible===!0?t.GC$(n._tabs).show():t.GC$(n._tabs).hide();n._tab&&n._tab.doResize()}},s.prototype._copyUserEvents=function(n){var t,i;for(n._eventHandler._eventSuspended=this._eventSuspended,t=0;t<this._userEvents.length;t++)i=this._userEvents[t],n.bind(i.type,i.data,i.fn)},s.prototype._suspendInvalidate=function(){var n=this.getActiveSheet();n&&n._suspendInvalidate()},s.prototype._resumeInvalidate=function(){var n=this.getActiveSheet();return n?n._resumeInvalidate():!1},s.prototype._paintSpreadBackgroundImage=function(){var n=this,r=n.getActiveSheet(),e,f;if(r){if(!n._backgroundImage)return;if(e=t.GC$(r._getCanvas()),e.css("background-image","url('"+n._backgroundImage+"')").css("background-repeat","no-repeat"),n._backgroundImageLayout===i||n._backgroundImageLayout===u)return;f=n._backgroundImage;n._imageLoader||(n._imageLoader=new t._GcImageLoader(function(){n._paintSpreadBackgroundImage()}));try{if(n._imageLoader.getState(f)){var o=n._imageLoader.getImage(f),s=r.getBounds(),h=s.width,c=s.height;t.util._applyBackgroundImageLayout(r._getCanvas(),h,c,o.width,o.height,n._backgroundImageLayout)}else n._imageLoader.addImage(f)}catch(l){}}},s.prototype.touchScrollOnRails=function(n){var i=this;return arguments.length===0?i._touchScrollOnRails:(i._touchScrollOnRails=n,t.features.touch&&t.TouchHelper.TouchScrollOnRails(n),i)},s.prototype._changeSheetForFormulaAcrossSheet=function(n,t){typeof t=="undefined"&&(t=!0);var i=this;i._tab._doSheetTabClickChange(i.getSheetIndex(n.getName()),t)},s.prototype.scrollIgnoreHidden=function(n){var t=this,i;return arguments.length===0?t._scrollIgnoreHidden:(t._scrollIgnoreHidden!==n&&(t._scrollIgnoreHidden=n,i=t.getActiveSheet(),i&&(i._needSyncHScrollbarSize=!0,i._needSyncVScrollbarSize=!0,i.invalidate())),t)},s.prototype.scrollbarMaxAlign=function(n){var t=this,i;return arguments.length===0?t._scrollbarMaxAlign:(t._scrollbarMaxAlign!==n&&(t._scrollbarMaxAlign=n,i=t.getActiveSheet(),i&&(i._needSyncHScrollbarSize=!0,i._needSyncVScrollbarSize=!0,i.invalidate())),t)},s.prototype.scrollbarShowMax=function(n){var t=this,i;return arguments.length===0?t._scrollbarShowMax:(t._scrollbarShowMax!==n&&(t._scrollbarShowMax=n,i=t.getActiveSheet(),i&&(i._needSyncHScrollbarSize=!0,i._needSyncVScrollbarSize=!0,i.invalidate())),t)},s.prototype.showVerticalScrollbar=function(n){var t=this;return arguments.length===0?t._showVerticalScrollbar:(t._showVerticalScrollbar!==n&&(t._showVerticalScrollbar=n,t._doResize()),t)},s.prototype.showHorizontalScrollbar=function(n){var t=this;return arguments.length===0?t._showHorizontalScrollbar:(t._showHorizontalScrollbar!==n&&(t._showHorizontalScrollbar=n,t._doResize()),t)},s.prototype.allowUserZoom=function(n){return arguments.length===0?this._allowUserZoom:(this._allowUserZoom=n,this)},s.prototype.allowSheetReorder=function(n){return arguments.length===0?this._allowSheetReorder:(this._allowSheetReorder=n,this)},s.prototype.allowUserResize=function(n){return arguments.length===0?this._allowUserResize:(this._allowUserResize=n,this)},s.prototype.tabStripVisible=function(n){var t=this;return arguments.length===0?t._tabStripVisible:(t._tabStripVisible!==n&&(t._tabStripVisible=n,t._doResize()),t)},s.prototype.tabNavigationVisible=function(n){var t=this;return arguments.length===0?t._tabNavigationVisible:(t._tabNavigationVisible!==n&&(t._tabNavigationVisible=n,t._tab&&t._tab.repaint()),t)},s.prototype.tabEditable=function(n){return arguments.length===0?this._tabEditable:(this._tabEditable=n,this)},s.prototype.newTabVisible=function(n){var t=this;return arguments.length===0?t._newTabVisible:(t._newTabVisible!==n&&(t._newTabVisible=n,t._tab&&t._tab.repaint()),t)},s.prototype.cutCopyIndicatorVisible=function(n){var t=this,i;return arguments.length===0?t._cutCopyIndicatorVisible:t._cutCopyIndicatorVisible===n?t:(i=t.getActiveSheet(),i?i._bindToAutoRefresh(function(n){return t._cutCopyIndicatorVisible=n,t})(n):(t._cutCopyIndicatorVisible=n,t))},s.prototype.cutCopyIndicatorBorderColor=function(n){var t=this,i;return arguments.length===0?t._cutCopyIndicatorBorderColor:t._cutCopyIndicatorBorderColor===n?t:(i=t.getActiveSheet(),i?i._bindToAutoRefresh(function(n){return t._cutCopyIndicatorBorderColor=n,t})(n):(t._cutCopyIndicatorBorderColor=n,t))},s.prototype.canUserEditFormula=function(n){return arguments.length===0?t.util.hasCalc()&&this._canUserEditFormula:(this._canUserEditFormula=n,this)},s.prototype.enableFormulaTextbox=function(n){var t=this,i;if(arguments.length===0)return t._enableFormulaTextbox;for(i=0;i<t.sheets.length;i++)t.sheets[i].enableFormulaTextbox(n);return t._enableFormulaTextbox=n,t},s.prototype.autoFitType=function(n){return arguments.length===0?this._autoFitType:(this._autoFitType=n,this)},s.prototype.startSheetIndex=function(n){var t=this,i;return arguments.length===0?t._tab?t._firstTabUserSet:0:(t._tab&&0<=n&&n<t.getSheetCount()&&(t._firstTabUserSet=n,t.sheets[n].visible()?t._tab._firstTab=n:(i=t._tab._getNextVisibleIndex(n),i!==-1&&(t._tab._firstTab=i))),t._doTabHSResize(),t)},s.prototype.highlightInvalidData=function(n){if(arguments.length===0)return this._highlightInvalidData;var t=this,i=this.getActiveSheet();if(i)return i._bindToAutoRefresh(function(n){return t._highlightInvalidData=n,t})(n);else t._highlightInvalidData=n},s.prototype.isPaintSuspended=function(n){var t=this,i;if(arguments.length===0)return t._paintSuspended;else{if(t._paintSuspended!==n){for(t._paintSuspended=n,i=0;i<t.sheets.length;i++)t.sheets[i].isPaintSuspended(n);t._tab&&t._tab.isPaintSuspended(n)}return t}},s.prototype.destroy=function(){t.GC$(window).unbind("resize.gcSpread",this._resizeHandler);this._dispose()},s.prototype.repaint=function(){var n=this,t;n._tab&&n._tab.repaint();t=n.getActiveSheet();t&&t.repaint()},s.prototype.refresh=function(){var n=this,i;if(n._host){for(t.ThemeStyleHelper.clearCache(),i=0;i<this.sheets.length;i++)this.sheets[i].resetCurrentTheme();n._refreshScrollbarAndTabStrip();n._doResize();n.repaint()}},s.prototype.getHost=function(){return this._host},s.prototype.invalidateLayout=function(){var n=this.getActiveSheet();n&&n.invalidateLayout()},s.prototype.getActiveSheet=function(){return this.sheets.length>0?this.sheets[this._activeSheetIndex]:i},s.prototype.setActiveSheet=function(n){this._setActiveSheetInternal(n,2)},s.prototype._setActiveSheetInternal=function(n,t){for(var r=this.sheets,i=0;i<r.length;i++)r[i].getName()===n&&this._setActiveSheetIndexImp(i,t)},s.prototype.getActiveSheetIndex=function(){return this._activeSheetIndex},s.prototype.setActiveSheetIndex=function(n){this._setActiveSheetIndexImp(n,2)},s.prototype._setActiveSheetIndexImp=function(n,i){var r,u,f,s,e,o;typeof n=="number"&&(r=this,n!==r._activeSheetIndex)&&(u=r.sheets[n],u&&u.visible())&&((f=t.util.device(),(f.ipad||f.iphone)&&(e=r,o=(new Date).valueOf(),e.lastSetActiveSheetTime&&o-e.lastSetActiveSheetTime<300))||(s=r.getActiveSheet(),r._activeSheetIndex=n,u!==s&&(s&&s._dispose(!1),r._setActiveSheetImp(u,i,!1)),r._doResize(),(f.ipad||f.iphone)&&(e=r,o=(new Date).valueOf(),e.lastSetActiveSheetTime=o)))},s.prototype.addNamedStyle=function(n){this._addNamedStyleImp(n,!0)},s.prototype._addNamedStyleImp=function(n,r){var e=this,o,f;if(n!==i&&n!==u){if(n.name===i||n.name===u||n.name==="")throw new Error(t.SR.Exp_EmptyNamedStyle);r?(f=n.name.toUpperCase(),o=e.getActiveSheet(),o?o._bindToAutoRefresh(function(n){e._namedStyles[f]=n})(n):e._namedStyles[f]=n):(f=n.name.toUpperCase(),e._namedStyles[f]=n)}},s.prototype.getNamedStyle=function(n){return this.getNamedStyleImp(n,!0)},s.prototype.getNamedStyleImp=function(n,t){var u=this._namedStyles,r;return u&&n?(n=n.toUpperCase(),r=u[n]||i,r&&t&&this.clearStyleCache(),r):i},s.prototype.removeNamedStyle=function(n){var t=this._namedStyles,i;t&&n&&(n=n.toUpperCase(),t.hasOwnProperty(n)&&(delete t[n],i=this.getActiveSheet(),i&&i.invalidate()))},s.prototype.getNamedStyles=function(){var n=[],i=this._namedStyles;return i&&t.GC$.each(i,function(t,i){n.push(i)}),this.clearStyleCache(),n},s.prototype.clearStyleCache=function(){for(var n=0;n<this.sheets.length;n++)this.sheets[n].clearStyleCache()},s.prototype._setActiveSheetImp=function(n,r,u){u||n._setHost(this._vp);var f=!0;switch(r){case 1:f=!0;break;case 0:f=!1;break;case 2:f=t.FocusHelper.isActiveElement(n);break}t.FocusHelper.setActiveElement(i);!this._suspendSetFocus&&f&&n.setFocus();n._syncHScollbarPosition();n._syncVScrollbarPosition()},s.prototype.addSheet=function(n,t){this._addSheetImp(n,2,t)},s.prototype._addSheetImp=function(n,i,r){var u=this,f,h,e;if(r||(r=u._createSheet(u._getDefaultSheetName(n))),h=u.sheets.length,r._name){for(f=0;f<h;f++)if(u.sheets[f]._name===r._name)throw t.SR.Exp_NotSupport;}else r._name=u._getDefaultSheetName(n);u._copyUserEvents(r);var o=u.getActiveSheet(),c=u._activeSheetIndex,l=u.sheets.length-n,s=[];for(f=0;f<l&&u.sheets.length>0;f++)s.push(u.sheets.pop());u.sheets.push(r);r.onAttached(u);while(s.length>0)u.sheets.push(s.pop());u.sheets.length===1?(u._vp&&r._setHost(u._vp),u._activeSheetIndex=0):u._activeSheetIndex=c<0?0:c;e=u.getActiveSheet();e!==o&&(o&&o._dispose(!1),e&&u._setActiveSheetImp(e,i,u.sheets.length===1),u._doResize());u._tab&&u._tab.repaint()},s.prototype.removeSheet=function(n){this._removeSheetImp(n,2)},s.prototype._removeSheetImp=function(n,i){var r=this,l,e,s,h,u,f,o,c;if(isNaN(n)||n<0||n>=r.sheets.length)throw new Error(t.SR.Exp_IndexOutOfRange);if(l=n<=r._activeSheetIndex||n===r.sheets.length-1,e=r.getActiveSheet(),n<r._activeSheetIndex&&r._activeSheetIndex--,s=r.sheets[n],s._disposeUserEvents(),r.sheets.splice(n,1),h=r.sheets,u=h.length,u===0)r._activeSheetIndex=-1;else if(r._activeSheetIndex>=u)r._activeSheetIndex=r._tab._getPreVisibleIndex(u);else{for(f=r._activeSheetIndex;f<u;f++)if(h[f]._visible){r._activeSheetIndex=f;break}f>=u&&(r._activeSheetIndex=-1)}l&&(o=r.sheets[r._activeSheetIndex],e!==o&&(e&&e._dispose(!1),o&&r._setActiveSheetImp(o,i,!1)));r.calcService&&r.calcService.removeSource(s._getSheetSource());r._tab&&(c=r.sheets.length,r._tab._firstTab>=c?r.startSheetIndex(r._tab._getPreVisibleIndex(c)):r._tab._firstTab<0?r.startSheetIndex(0):r._doResize())},s.prototype.clearSheets=function(){for(var n=this,i=n.sheets,u=n.getActiveSheet(),r=0;r<i.length;r++)i[r]._disposeUserEvents(),i[r]._dispose();i.splice(0,i.length);n.calcService&&n.calcService.clearSource();n._activeSheetIndex=-1;n._tab&&(n._tab._firstTab=0,n._tab.repaint());t._DataValidatorCache.clear()},s.prototype.getSheet=function(n){return n>=0&&n<this.sheets.length?this.sheets[n]:i},s.prototype.getSheetFromName=function(n){for(var r=this.sheets,t=0;t<r.length;t++)if(r[t].getName()===n)return r[t];return i},s.prototype.getSheetIndex=function(n){for(var r=this.sheets,t=0;t<r.length;t++)if(r[t].getName()===n)return t;return i},s.prototype.getSheetCount=function(){return this.sheets.length},s.prototype.setSheetCount=function(n){this._setSheetCountImp(n,2)},s.prototype._setSheetCountImp=function(n,i){var e=this,f,r;if(n<0)throw t.SR.Exp_ArgumentOutOfRange;else n===0&&e.clearSheets();if(f=e.sheets.length,n<f)for(r=f-1;r>=n;r--)e._removeSheetImp(r,i);else if(n>f)for(r=f;r<n;r++)e._addSheetImp(r,i,u)},s.prototype.search=function(n){var r,e,u,o,f;if(!n||!t.features.search)return i;if(r=this,e=0,!n.searchString||n.searchTarget===e||r.getSheetCount()<=0)return new t.SearchResult;if(n.startSheetIndex===-1&&(n.startSheetIndex=0),n.endSheetIndex===-1&&(n.endSheetIndex=r.getSheetCount()-1),n.endSheetIndex>=n.startSheetIndex&&0<=n.startSheetIndex&&n.startSheetIndex<r.getSheetCount()&&0<=n.endSheetIndex&&n.endSheetIndex<r.getSheetCount())for(u=n.startSheetIndex;u<=n.endSheetIndex;u++)if(o=r.getSheet(u),f=o.search(n),f&&f.searchFoundFlag!==e)return f.foundSheetIndex=u,f;return new t.SearchResult},s.prototype.showCell=function(n,t,i,r){var u=this.getActiveSheet();u&&u.showCell(n,t,i,r)},s.prototype.showColumn=function(n,t){var i=this.getActiveSheet();i&&i.showColumn(n,t)},s.prototype.showRow=function(n,t){var i=this.getActiveSheet();i&&i.showRow(n,t)},s.prototype.showActiveCell=function(n,t){var i=this.getActiveSheet();i&&i.showCell(i._activeRowIndex,i._activeColIndex,n,t)},s.prototype.getCustomName=function(n){return this._names?this._names[n.toUpperCase()]:i},s.prototype.getCustomNames=function(){var n=[];return this._names&&t.GC$.each(this._names,function(t,i){n.push(i)}),n},s.prototype.addCustomName=function(n,t,i,r){this._addCustomNameCore(n,t,i,r,!1)},s.prototype._addCustomNameCore=function(n,r,f,e,o){var s,c,l,a,v,h;if(n===u||n===i||n===""||r===u||r===i||r==="")throw new Error(t.SR.Exp_InvalidCustomName);if(s=this,s._names||(s._names={}),s.calcService){if(c=this.getActiveSheet(),l=c?c._getSheetSource():i,o)try{a=s.calcService.parse(l,r,f,e,!1,!0)}catch(y){}else a=s.calcService.parse(l,r,f,e);v=n.toUpperCase();s._names[v]=new t.NameInfo(n,a,f,e);h=s._spreadSourceModel._getNameCalc(v,!0);h&&(h.updateListening(!0,!0),h.addToDirty());s._recalcAll()}},s.prototype.removeCustomName=function(n){var t=this,r,e,f;t._names&&n!==u&&n!==i&&n!==""&&(r=n.toUpperCase(),t._names[r]&&(delete t._names[r],e=t._spreadSourceModel,e&&(f=e._getNameCalc(r),f&&(f.updateListening(!0,!1),f.addToDirty())),t._recalcAll()))},s.prototype.clearCustomNames=function(){var i,t,r,n;if(this._names){if(i=this._names,delete this._names,t=this._spreadSourceModel,t)for(r in i)n=t._getNameCalc(r),n&&(n.updateListening(!0,!1),n.addToDirty());this._recalcAll()}},s.prototype._findCustomName=function(n){if(n===u||n===i||n==="")return i;return this.getCustomName(n)},s.prototype.addCustomFunction=function(n){this._addCustomFunctionCore(n);this._recalcAll()},s.prototype._addCustomFunctionCore=function(n){if(t.util.hasCalc()){if(n===u||n===i||!(n instanceof t.Calc.Functions.Function))throw new Error(t.SR.Exp_InvalidCustomFunction);var r=this,f=n.name.toUpperCase();r._functions||(r._functions={});r._functions[f]=n}},s.prototype.getCustomFunction=function(n){return this._functions&&n!==u&&n!==i&&n!==""?this._functions[n.toUpperCase()]:i},s.prototype.removeCustomFunction=function(n){var t=this;t._functions&&n!==u&&n!==i&&n!==""&&(n=n.toUpperCase(),t._functions.hasOwnProperty(n)&&(delete t._functions[n],t._recalcAll()))},s.prototype.clearCustomFunctions=function(){this._functions&&(this._functions=i,this._recalcAll())},s.prototype._recalcAll=function(){var n,t;this.calcService&&!this.calcService.IsSuspended()&&(n=this.getActiveSheet(),n&&(t=n.isPaintSuspended(),n.isPaintSuspended(!0),this.calcService.recalculateAll(),n.isPaintSuspended(t)))},s.prototype.getCalcService=function(){return this.calcService},s.prototype.addCustomFunctionDescription=function(n){if(n&&n.name&&!this.getCustomFunctionDescription(n.name)){var t=this._functionDescriptions;t||(t=this._functionDescriptions=[]);t.push(n)}},s.prototype.getCustomFunctionDescription=function(n){var u=this._functionDescriptions,f,t,r;if(u&&n)for(n=n.toUpperCase(),f=u.length,r=0;r<f;r++)if(t=u[r],t.name&&t.name.toUpperCase()===n)return t;return i},s.prototype.removeCustomFunctionDescription=function(n){var i=this._functionDescriptions,u,r,t;if(i&&n)for(n=n.toUpperCase(),u=i.length,t=0;t<u;t++)if(r=i[t],r.name&&r.name.toUpperCase()===n){i.splice(t,1);break}},s.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=i)},s.prototype.referenceStyle=function(n){var t=this,i=1,r=0;return arguments.length===0?t.calcService?t.calcService.useR1C1?i:r:r:(t.calcService&&(t.calcService.useR1C1=n===i),t)},s.prototype.bind=function(n,i,r){var u=this,f,e;for(u._userEvents.push({type:n,data:i,fn:r}),t.GC$(u._userEventsElem).bind(n+a,i,r),f=0;f<u.sheets.length;f++)e=u.sheets[f],e.bind(n,i,r)},s.prototype.unbind=function(n,i){for(var e,f,o,r=this,u=0;u<r._userEvents.length;u++)e=r._userEvents[u],e.type===n&&r._userEvents.splice(u,1);for(t.GC$(r._userEventsElem).unbind(n+a,i),f=0;f<r.sheets.length;f++)o=r.sheets[f],o.unbind(n,i)},s.prototype.unbindAll=function(){var n=this,i,r;for(n._userEvents.length=0,t.GC$(n._userEventsElem).unbind(a),i=0;i<n.sheets.length;i++)r=n.sheets[i],r.unbindAll()},s.prototype._bind=function(n,i,r){var u=this,f,e;for(u._userEvents.push({type:n,data:i,fn:r}),t.GC$(u._userEventsElem).bind(n+ft,i,r),f=0;f<u.sheets.length;f++)e=u.sheets[f],e._bind(n,i,r)},s.prototype._unbind=function(n,i){for(var e,f,o,r=this,u=0;u<r._userEvents.length;u++)e=r._userEvents[u],e.type===n&&r._userEvents.splice(u,1);for(t.GC$(r._userEventsElem).unbind(n+ft,i),f=0;f<r.sheets.length;f++)o=r.sheets[f],o._unbind(n,i)},s.prototype._unbindAll=function(){var n=this,i,r;for(n._userEvents.length=0,t.GC$(n._userEventsElem).unbind(ft),i=0;i<n.sheets.length;i++)r=n.sheets[i],r._unbindAll()},s.prototype.suspendEvent=function(){var n,t;for(this._eventSuspended++,n=0;n<this.sheets.length;n++)t=this.sheets[n],t.suspendEvent()},s.prototype.resumeEvent=function(){var n=this,t,i;for(n._eventSuspended--,n._eventSuspended<0&&(n._eventSuspended=0),t=0;t<n.sheets.length;t++)i=n.sheets[t],i.resumeEvent()},s.prototype.doCommand=function(n){this._undoManager.doAction(n)},s.prototype.allowUndo=function(n){var t=this;return arguments.length===0?t._allowUndo:(t._allowUndo=n,t._undoManager&&(t._undoManager._allowUndo=n),t)},s.prototype.undoManager=function(){var n=this;return n._undoManager||(n._undoManager=new t._UndoManager(n,-1,n.allowUndo())),n._undoManager},s.prototype.canUserDragDrop=function(n){return arguments.length===0?this._allowDragDrop:(this._allowDragDrop=n,this)},s.prototype.canUserDragFill=function(n){var u=this,r;return arguments.length===0?t.features.fill?u._allowDragFill:!1:(u._allowDragFill!==n&&(u._allowDragFill=n,r=u.getActiveSheet(),r&&(r._dragFillIndicatorRect=i,r.getSelections().length!==1||r._paintSuspended||r._render.repaintSelection(r.getSelections()[0]))),u)},s.prototype.showDragFillSmartTag=function(n){var t=this;return arguments.length===0?t._showDragFillSmartTag:(typeof n=="boolean"&&t._showDragFillSmartTag!==n&&(t._showDragFillSmartTag=n),t)},s.prototype.defaultDragFillType=function(n){var i=this;return arguments.length===0?i._defaultDragFillType:(t.AutoFillType[n]!==u&&n!==4&&n!==i._defaultDragFillType&&(i._defaultDragFillType=n),i)},s.prototype.toJSON=function(n){var r=this,b=r.getSheetCount(),k={activeSheetIndex:r.getActiveSheetIndex(),sheetCount:b,tabStripRatio:r.getTabStripRatio(),tabStripVisible:r._tabStripVisible,tabEditable:r._tabEditable,newTabVisible:r._newTabVisible,referenceStyle:r.referenceStyle(),canUserEditFormula:r._canUserEditFormula,startSheetIndex:r.startSheetIndex(),allowUndo:r._allowUndo,allowUserZoom:r._allowUserZoom,allowUserResize:r._allowUserResize,allowDragDrop:r._allowDragDrop,allowDragFill:r._allowDragFill,showDragFillSmartTag:r._showDragFillSmartTag,defaultDragFillType:r._defaultDragFillType,allowSheetReorder:r._allowSheetReorder,highlightInvalidData:r._highlightInvalidData,autoFitType:r._autoFitType,showScrollTip:r._showScrollTip,showResizeTip:r._showResizeTip,showDragDropTip:r._showDragDropTip,showDragFillTip:r._showDragFillTip,scrollIgnoreHidden:r._scrollIgnoreHidden,showHorizontalScrollbar:r._showHorizontalScrollbar,showVerticalScrollbar:r._showVerticalScrollbar,scrollbarMaxAlign:r._scrollbarMaxAlign,scrollbarShowMax:r._scrollbarShowMax,backColor:r._backColor,backgroundImage:r._backgroundImage,backgroundImageLayout:r._backgroundImageLayout,grayAreaBackColor:r._grayAreaBackColor,cutCopyIndicatorVisible:r._cutCopyIndicatorVisible,cutCopyIndicatorBorderColor:r._cutCopyIndicatorBorderColor,useTouchLayout:r._useTouchLayout,hideSelection:r._hideSelection,customFunctions:r._functions,resizeZeroIndicator:r._resizeZeroIndicator,tabNavigationVisible:r._tabNavigationVisible},u={version:t.productInfo.productVersion},y,e,o,s,h,f,c,p,a,w,nt,v;for(f in k)y=k[f],r._isDefaultValue(f,y)||(u[f]=y);for(e={},o=0;o<b;o++)s=r.getSheet(o),e[s._name]=s.toJSON(n),e[s._name].index=o;if(t.GC$.isEmptyObject(e)||(u.sheets=e),h=[],r._namedStyles)for(f in r._namedStyles)h.push(r._namedStyles[f]);if(h.length>0&&(u.namedStyles=h),c=[],r._names&&r.calcService)for(p in r._names)if(r._names.hasOwnProperty(p)){var l=r._names[p],w=l.getName(),d=l.getRow(),g=l.getColumn(),tt=l.getExpression(),it=r.calcService.unparseWithoutCulture(i,tt,d,g,!0);c.push({name:w,formula:it,row:d,col:g})}c.length>0&&(u.names=c);a=[];for(w in r._sparklineExs)nt=r._sparklineExs[w],v=nt.toJSON(),v&&v.typeName&&a.push(v);return a.length>0&&(u.sparklineExs=a),u},s.prototype._isDefaultValue=function(n,t){switch(n){case"activeSheetIndex":return t===this._defaultActiveSheetIndex;case"sheetCount":return t===this._defaultSheetCount;case"tabStripRatio":return t===.5;case"tabStripVisible":return t===!0;case"tabEditable":return t===!0;case"newTabVisible":return t===!0;case"referenceStyle":return t===0;case"canUserEditFormula":return t===!0;case"startSheetIndex":return t===0;case"allowUndo":return t===!0;case"allowUserZoom":return t===!0;case"allowUserResize":return t===!0;case"allowDragDrop":return t===!0;case"allowDragFill":return t===!0;case"showDragFillSmartTag":return t===!0;case"defaultDragFillType":return t===5;case"allowSheetReorder":return t===!0;case"highlightInvalidData":return t===!1;case"autoFitType":return t===0;case"showScrollTip":return t===0;case"showResizeTip":return t===0;case"showDragDropTip":return t===!0;case"showDragFillTip":return t===!0;case"scrollIgnoreHidden":return t===!1;case"showHorizontalScrollbar":return t===!0;case"showVerticalScrollbar":return t===!0;case"scrollbarMaxAlign":return t===!1;case"scrollbarShowMax":return t===!0;case"backColor":return t==="white";case"backgroundImage":return t===i;case"backgroundImageLayout":return t===0;case"cutCopyIndicatorVisible":return t===!0;case"cutCopyIndicatorBorderColor":return t==="#217346";case"useTouchLayout":return t===!1;case"hideSelection":return t===!1;case"resizeZeroIndicator":return t===1;case"tabNavigationVisible":return t===!0;default:return!1}},s.prototype.fromJSON=function(f){var e,a,ct,lt,w,b,k,it,d,l,g,s,o,p,nt,at,rt,ut,ft,et,c,ot,st,ht,v,h,y,tt;if(f){e=this;a=e._getJsonDataVersion(f)<3;e._suspendSetFocus=!0;ct=e.isPaintSuspended();e.isPaintSuspended(!0);e.suspendEvent();lt=n.Sheets.Culture();n.Sheets.switchCulture("");try{if(e._initCalcService(),e._availableSheetIndex=-1,e.clearSheets(),w=f.sheetCount,typeof w===r&&(w=e._defaultSheetCount),e._setSheetCountImp(w,0),f.referenceStyle!==i&&f.referenceStyle!==u&&e.referenceStyle(f.referenceStyle),e._names={},e._namedStyles={},f.namedStyles)for(o=0;o<f.namedStyles.length;o++)b=f.namedStyles[o],k=new t.Style,k.fromJSON(b,a),typeof b.validator!==r&&(t.features.dataValidator&&(it=new n.Sheets.DefaultDataValidator,it.fromJSON(b.validator,a)),k.validator=it),e._addNamedStyleImp(k,!1);if(o=0,l=f.sheets,l)for(v in l)typeof v=="string"&&(h=l[v],y=h.index!==u?h.index:h._index,d=y!=u?e.sheets[y]:e.sheets[o],d.fromJSON(h,!1,a),o++);if(g=f.activeSheetIndex,typeof g===r&&(g=e._defaultActiveSheetIndex),e._setActiveSheetIndexImp(g,0),typeof f.tabStripRatio!==r&&e.setTabStripRatio(f.tabStripRatio),typeof f.tabStripVisible!==r&&(e._tabStripVisible=f.tabStripVisible),typeof f.tabEditable!==r&&(e._tabEditable=f.tabEditable),typeof f.newTabVisible!==r&&(e._newTabVisible=f.newTabVisible),e.gcSpreadsheet=f.gcSpreadsheet,typeof f.canUserEditFormula!==r&&(e._canUserEditFormula=f.canUserEditFormula),typeof f.startSheetIndex!==r&&e.startSheetIndex(f.startSheetIndex),typeof f.allowUndo!==r&&e.allowUndo(f.allowUndo),typeof f.allowUserZoom!==r&&(e._allowUserZoom=f.allowUserZoom),typeof f.allowUserResize!==r&&(e._allowUserResize=f.allowUserResize),s=e.sheets,typeof f.allowDragDrop!==r&&(e._allowDragDrop=f.allowDragDrop,s&&s.length>0))for(o=0;o<s.length;o++)s[o]._allowDragDrop=e._allowDragDrop;if(typeof f.allowDragFill!==r&&(e._allowDragFill=f.allowDragFill,s&&s.length>0))for(o=0;o<s.length;o++)s[o]._allowDragFill=e._allowDragFill;if(typeof f.showDragFillSmartTag!==r&&(e._showDragFillSmartTag=f.showDragFillSmartTag,s&&s.length>0))for(o=0;o<s.length;o++)s[o]._showDragFillSmartTag=e._showDragFillSmartTag;if(typeof f.defaultDragFillType!==r&&(e._defaultDragFillType=f.defaultDragFillType,s&&s.length>0))for(o=0;o<s.length;o++)s[o]._defaultDragFillType=e._defaultDragFillType;if(typeof f.allowSheetReorder!==r&&(e._allowSheetReorder=f.allowSheetReorder),typeof f.highlightInvalidData!==r&&(e._highlightInvalidData=f.highlightInvalidData),typeof f.autoFitType!==r&&e.autoFitType(f.autoFitType),typeof f.showResizeTip!==r&&(e._showResizeTip=f.showResizeTip),typeof f.showScrollTip!==r&&(e._showScrollTip=f.showScrollTip),typeof f.showDragDropTip!==r&&(e._showDragDropTip=f.showDragDropTip),typeof f.showDragFillTip!==r&&(e._showDragFillTip=f.showDragFillTip),typeof f.scrollIgnoreHidden!==r&&(e._scrollIgnoreHidden=f.scrollIgnoreHidden),typeof f.showHorizontalScrollbar!==r&&(e._showHorizontalScrollbar=f.showHorizontalScrollbar),typeof f.showVerticalScrollbar!==r&&(e._showVerticalScrollbar=f.showVerticalScrollbar),typeof f.scrollbarMaxAlign!==r&&(e._scrollbarMaxAlign=f.scrollbarMaxAlign),typeof f.scrollbarShowMax!==r&&(e._scrollbarShowMax=f.scrollbarShowMax),typeof f.backColor!==r&&(e._backColor=f.backColor),typeof f.backgroundImage!==r&&e.backgroundImage(f.backgroundImage),typeof f.backgroundImageLayout!==r&&e.backgroundImageLayout(f.backgroundImageLayout),typeof f.grayAreaBackColor!==r&&(e._grayAreaBackColor=f.grayAreaBackColor),typeof f.cutCopyIndicatorVisible!==r&&(e._cutCopyIndicatorVisible=f.cutCopyIndicatorVisible),typeof f.cutCopyIndicatorBorderColor!==r&&(e._cutCopyIndicatorBorderColor=f.cutCopyIndicatorBorderColor),typeof f.useTouchLayout!==r&&(e._useTouchLayout=f.useTouchLayout),typeof f.hideSelection!==r&&e.hideSelection(f.hideSelection),typeof f.resizeZeroIndicator!==r&&(e._resizeZeroIndicator=f.resizeZeroIndicator),typeof f.tabNavigationVisible!==r&&(e._tabNavigationVisible=f.tabNavigationVisible),e.calcService&&e.calcService.suspend(),e.clearCustomNames(),f.names)for(c=0;c<f.names.length;c++)p=f.names[c],e._addCustomNameCore(p.name,p.formula,p.row,p.col,!0);if(e.clearCustomFunctions(),nt=f.customFunctions,nt)for(at in nt)rt=nt[at],ut=t.getTypeFromString(rt.typeName),ut&&(ft=new ut,ft.fromJSON(rt,a),e._addCustomFunctionCore(ft));if(et=f.sparklineExs,et)for(c=0;c<et.length;c++)ot=f.sparklineExs[c],st=t.getTypeFromString(ot.typeName),st&&(ht=new st,ht.fromJSON(ot),e.addSparklineEx(ht));if(l){o=0;for(v in l)typeof v=="string"&&(h=l[v],y=h.index!==u?h.index:h._index,d=y!=u?e.sheets[y]:e.sheets[o],d.formulaFromJSON(h,a),o++)}e.calcService&&(f.noRecalc?e.calcService.resumeWithoutCalc():e.calcService.resume(!0))}finally{n.Sheets.switchCulture(lt);e._suspendSetFocus=!1;tt=e.getActiveSheet();tt&&t.FocusHelper.isActiveElement(tt)&&tt.setFocus();e.resumeEvent();e._doResize();e.isPaintSuspended(ct)}}},s.prototype._getJsonDataVersion=function(n){var r=n.version,t,i,u;if(!r||!(typeof r=="string")||(t=r.split("."),!t||t.length===0))return 1;if(t.length>3)return 3;if(i=parseFloat(t[0]),t.length<=2)return isNaN(i)?1:i;else{if(u=parseFloat(t[1]),i>=3)if(u>=20143)return 3;else if(u>=20142)return 2;return 1}},s.prototype.setTabStripRatio=function(n,i){var r,o;if(isNaN(r=n))throw t.SR.Exp_InvalidArgument;var u=this,f=0,e=u._vp;e&&(o=t.GC$(e).width(),f=u._tab._resizeBarWidth/o);u._tabStripRatio=r<f?f:r>1?1:r;u._tabStripRatioUserSet=r<0?0:r>1?1:r;u._doTabHSResize()},s.prototype.getTabStripRatio=function(){return this._tabStripRatioUserSet},s.prototype._getActualTabStripRatio=function(){return this.showHorizontalScrollbar()?this._tabStripRatio:1},s.prototype._setActualTabStripRatio=function(n){this._tabStripRatio=n},s.prototype.showScrollTip=function(n){return arguments.length===0?this._showScrollTip:(this._showScrollTip=n,this)},s.prototype.showResizeTip=function(n){return arguments.length===0?this._showResizeTip:(this._showResizeTip=n,this)},s.prototype.showDragDropTip=function(n){return arguments.length===0?t.util.hasCalc()?this._showDragDropTip:!1:(this._showDragDropTip=n,this)},s.prototype.showDragFillTip=function(n){return arguments.length===0?t.features.fill?this._showDragFillTip:!1:(this._showDragFillTip=n,this)},s.prototype.grayAreaBackColor=function(n){var u,i,r;if(arguments.length===0)return this._grayAreaBackColor?this._grayAreaBackColor:(u=t.ThemeStyleHelper.getContentThemeStyle("gc-grayArea"),u.backgroundColor);if(i=this,r=this.getActiveSheet(),r)return r._bindToAutoRefresh(function(n){return i._grayAreaBackColor=n,i})(n);else i._grayAreaBackColor=n},s.prototype.backColor=function(n){if(arguments.length===0)return this._backColor;var t=this,i=this.getActiveSheet();if(i)return i._bindToAutoRefresh(function(n){return t._backColor=n,t})(n);else t._backColor=n},s.prototype.backgroundImage=function(n){var t=this,i;return arguments.length===0?t._backgroundImage:(i=t.getActiveSheet(),i?i._bindToAutoRefresh(function(n){return t._backgroundImage=n,t._paintSpreadBackgroundImage(),t})(n):(t._backgroundImage=n,t))},s.prototype.backgroundImageLayout=function(n){var t=this;return arguments.length===0?t._backgroundImageLayout:(t._backgroundImageLayout=n,t._paintSpreadBackgroundImage(),t)},s.prototype._findTable=function(n){var r,f,t,e,u;if(!this.sheets||this.sheets.length===0)return i;for(r=this.sheets,f=r.length,t=0;t<f;t++)if(e=r[t],u=e.findTableByName(n),u)return u;return i},s.prototype.addSparklineEx=function(n){var t=this._sparklineExs;n&&t&&(t[n.name()]=n)},s.prototype.getSparklineEx=function(n){var t=this._sparklineExs;return t&&t[n]},s.prototype.removeSparklineEx=function(n){var t=this._sparklineExs;t&&(t[n]=u)},s.prototype.useTouchLayout=function(n){var t=this;return arguments.length===0?t._useTouchLayout:(t._useTouchLayout=n,t._doResize(),t)},s.prototype.focus=function(n){if(n===!1)t.FocusHelper.setActiveElement(i);else{var r=this.getActiveSheet();r&&r.setFocus()}},s.prototype.hideSelection=function(n){var i=this,r;return arguments.length===0?i._hideSelection:(i._hideSelection=n,r=i.getActiveSheet(),n?t.FocusHelper.hideSelection(r):t.FocusHelper.showSelection(r),i)},s.prototype.nextControl=function(n){var t=this;return arguments.length===0?t._nextControl:(t._nextControl=n,t)},s.prototype.previousControl=function(n){var t=this;return arguments.length===0?t._previousControl:(t._previousControl=n,t)},s.prototype.resizeZeroIndicator=function(n){var t=this,i;return arguments.length===0?t._resizeZeroIndicator:(t._resizeZeroIndicator!==n&&(t._resizeZeroIndicator=n,i=t.getActiveSheet(),i&&i.invalidate()),t)},s.prototype._getScrollbarSize=function(){return this._themeVersion>2007?15:18},s.prototype._getVScrollbarContainerWidth=function(){return this._themeVersion>2007?22:this._getScrollbarSize()},s.prototype._getTabStripHeight=function(){return this._themeVersion>2007?28:this._getScrollbarSize()},s.prototype.suspendCalcService=function(n){this.calcService&&this.calcService.suspend(n)},s.prototype.resumeCalcService=function(n){this.calcService&&this.calcService.resume(n)},s.prototype.print=function(n){var t=this._getPrinter();t&&t.print(this,n)},s.prototype._getPrinter=function(){return!this._printer&&t.features.print&&(this._printer=new t.SpreadPrinter),this._printer},s.prototype._trigger=function(n,i){this._eventSuspended===0&&t.GC$(this._userEventsElem).trigger(n,i)},s.prototype.triggerSheetTabClick=function(n){this._trigger(t.Events.SheetTabClick,n)},s.prototype.triggerSheetTabDoubleClick=function(n){this._trigger(t.Events.SheetTabDoubleClick,n)},s.prototype.triggerActiveSheetChanging=function(n){this._trigger(t.Events.ActiveSheetChanging,n)},s.prototype.triggerActiveSheetChanged=function(n){this._trigger(t.Events.ActiveSheetChanged,n)},s.prototype.triggerButtonClicked=function(n){this._trigger(t.Events.ButtonClicked,n)},s}();t.Spread=bi;var k=".gcTab",et=".tabNameEditor",ti=".spliter",y="mouse",ki="down",ii="move",ri="up",di="out",gi="focusin",nr="focusout",tr="keydown",ui=y+ii+ti,fi=y+ri+ti,ei=tr+et,oi=gi+et,si=nr+et,ot=y+ki+k,st=y+ii+k,ht=y+ri+k,ct=y+di+k,lt="dblclick"+k,hi="canvas",at="2d",rt="resizeBar",c="navButton",s="tab",d="newTab",ci="#FFFFFF",cr="#D8E7FA",lr="#D5E5F9",ar="#B6D2F5",vr="#D9E7F9",yr="#688CAF",li="#92A5C7",ai="black",vi="white",l=4,ir="tab-tip-span",vt=function(){function n(n){this._reorderMaxDistance=10;var t=this;t._spread=i;t._activeIndex=0;t._firstTab=0;t._activePos=70;t._hoverNavButton=-1;t._hoverTab=-1;t._font="";t._tabSizes=[];t._targetTabIndex=-1;t._sourceTabIndex=-1;t._reorderSpeedTimeout=i;t._paintSuspended=!1;t._init(n)}return n.prototype._init=function(n){this.setBounds(new t.Rect(0,0,200,28));this.name=n},n.prototype.setHost=function(n){var i=this,r=f.createElement(hi);t.DPIHelper.adjustDevicePixel(r,i._spread);r.setAttribute("id",i.name);i._tabIndicator=i._getTabIndicator();n.appendChild(i._tabIndicator.getElement(0));n.appendChild(r);r.gcObject=!0;i.canvas&&(t.GC$(i.canvas).unbind(ot).unbind(st).unbind(ht).unbind(ct).unbind(lt),i._unbindTouchEvents(),i.canvas.parentNode.removeChild(i.canvas));i.canvas=r;!t.util._isStandardCanvas()&&t.util._isSilverlightCanvas()&&(r.setAttribute("renderMethod","auto"),r.setAttribute("onload",i._test(i)));t.GC$(r).bind(ot,t.util.createEventHandler(i,i.doMouseDown)).bind(st,t.util.createEventHandler(i,i.doMouseMove)).bind(ht,t.util.createEventHandler(i,i.doMouseUp)).bind(ct,t.util.createEventHandler(i,i.doMouseOut)).bind(lt,t.util.createEventHandler(i,i.doMouseDbClick));i._bindTouchEvents();i.doResize()},n.prototype.dispose=function(){this._dispose()},n.prototype.setOwner=function(t){this._spread=t;t&&t._font&&t._font.length>0&&t._font!==n.defaultFont&&(this._font=t._font)},n.prototype.getBounds=function(){var n=this._bounds;return new t.Rect(n.x,n.y,n.width,n.height)},n.prototype.setBounds=function(n){var i=this._bounds=new t.Rect(0,0,0,0);i.x=n.x;i.y=n.y;i.width=n.width;i.height=n.height},n.prototype.getNewTabSize=function(){return this._newTabSize},n.prototype.getTabEndPosition=function(){var n=this.getBounds();return n.x+n.width-this._resizeBarWidth},n.prototype.getTabStartPosition=function(){return 0},n.prototype.doResize=function(){var f=this,n=f._getCanvas(),u,i,r,e;n&&n.parentNode&&(u=t.GC$(n.parentNode),u.width()!==0&&u.height()!==0)&&(i=h(u.width(),0),r=h(u.height(),0),n.style.display=dt,n.width=i,n.height=r,n.style.display="",n.style.width=i+"px",n.style.height=r+"px",i=n.clientWidth||n.width,r=n.clientHeight||n.height,e=f.getBounds(),f.setBounds(new t.Rect(e.x,e.y,i,r)),t.DPIHelper.setSize(n,i,r),f.repaint())},n.prototype.isCoverSheetTab=function(){return!1},n.prototype.getCoverPosition=function(){return 0},n.prototype.getInputTopPosition=function(){return 0},n.prototype.getTabIndicatorEdgeElement=function(){return""},n.prototype.getBasicWidth=function(){return 0},n.prototype._test=function(n){return n._spread.initPaint(n._spread)},n.prototype._getTabIndicator=function(){return t.GC$(f.createElement("div")).css({position:"absolute","border-style":"solid","border-color":ai,"border-width":l,display:"none",width:"0","border-bottom":"0","border-left-color":"transparent","border-right-color":"transparent"})},n.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.unbindTouchEvents()},n.prototype._bindTouchEvents=function(){if(t.features.touch){var n=this,i=new t.TabStripTouchManager(n.canvas,n,n._spread._touchEventProvider);i.bindTouchEvents();n._touchManager=i}},n.prototype._dispose=function(){var n=this,r=n.canvas;r&&(t.GC$(r).unbind(ot).unbind(st).unbind(ht).unbind(lt).unbind(ct),r.parentNode&&r.parentNode.removeChild(r));n._touchManager&&(n._touchManager.unbindTouchEvents(),n._touchManager=i);t.GC$(n._tabIndicator).remove()},n.prototype.hitTest=function(n,t){return{element:""}},n.prototype.doMouseDown=function(n){var o=t.util.device(),l=o.ipad||o.iphone,r,u,y,e;if(!l){if(r=this,r._touchManager&&r._touchManager.preProcessMouseDown(n))return t.util.cancelDefault(n),!1;var h=t.GC$(r._getCanvas()).offset(),a=n.pageX-h.left,v=n.pageY-h.top,f=r._spread.getActiveSheet(),p;if(r._tabNameEditor&&r.endSheetTabEditing(f,!1),u=r.hitTest(a,v),y=t.Events,n.button===0&&(u.element===rt?(r.resizeTab=!0,r.activeX=n.pageX,r.handleDocumentMouseMove()):u.element===c?r.doNavButtonClick(u.index):u.element===s?(r.doSheetTabClick(u.index,u.position),r._initTabReorder(n,u)):u.element===d&&r.doNewTabClick(u.position),f=r._spread.getActiveSheet(),e=f&&f._eventHandler,e&&!f.isEditing()))try{e._tabStripHitTestResult={left:n.pageX,top:n.pageY};f.setFocus()}finally{e._tabStripHitTestResult=i}return r._isMouseDownInTab=!0,!1}},n.prototype.doMouseMove=function(n){var a=t.util.device(),p=a.ipad||a.iphone,i,f,e,v,h,l;if(!p){if(i=this,i._touchManager&&i._touchManager.preProcessMouseMove(n))return t.util.cancelDefault(n),!1;if(f="default",e="w-resize",i._tabStartPos&&!i._reorderSheet&&(v=wi(yt(i._tabStartPos.x-n.pageX,2)+yt(i._tabStartPos.y-n.pageY,2)),v>i._reorderMaxDistance&&(i._reorderSheet=!0)),i.resizeTab){i.canvas.style.cursor=e;var w=n.pageX-i.activeX,o=i._spread._vp.clientWidth,u=i._spread;u.setTabStripRatio(u._getActualTabStripRatio()+w/o,!0);h=i._resizeBarWidth/o;l=1;u._getActualTabStripRatio()<h?(u.setTabStripRatio(h,!0),i.activeX=i._resizeBarWidth):u._getActualTabStripRatio()>=l?(u.setTabStripRatio(l,!0),i.activeX=o):i.activeX=n.pageX}else if(i._reorderSheet)i._showTabTip(n.pageX,n.pageY),i._setTabIndicator(n);else{i._hoverNavButton=-1;i._hoverTab=-1;var y=t.GC$(i._getCanvas()).offset(),b=n.pageX-y.left,k=n.pageY-y.top,r=i.hitTest(b,k);if(r.element==="")return i.canvas.style.cursor=f,i.repaint(),!1;else r.element===rt?i.canvas.style.cursor=e:(i.canvas.style.cursor=f,r.element===c?i._hoverNavButton=r.index:r.element===s?i._hoverTab=r.index:r.element===d&&(i._hoverTab=-2));i.repaint()}return!1}},n.prototype.doMouseUp=function(n){var r=t.util.device(),u=r.ipad||r.iphone,i;if(!u)return(i=this,i._touchManager&&i._touchManager.preProcessMouseUp(n))?(t.util.cancelDefault(n),!1):(i.resizeTab&&(i.resizeTab=!1,i._spread._doTabHSResize()),i._clearSpeedTimeout(),i._reorderSheet&&(i._reorderSheet=!1,i._tabTip.remove(),i._reorderTab(),i._tabIndicator.hide()),i._tabStartPos=null,i._clearRepeatDown(),i.unhandleDocumentMouseMove(),i._isMouseDownInTab?(i._isMouseDownInTab=!1,!1):!0)},n.prototype.doMouseOut=function(n){var r=t.util.device(),e=r.ipad||r.iphone,i,u,f;if(!e)return i=this,i._clearRepeatDown(),u=i._hoverNavButton,i._hoverNavButton=-1,f=i._hoverTab,i._hoverTab=-1,(i._hoverNavButton!==u||i._hoverTab!==f)&&i.repaint(),!1},n.prototype.handleDocumentMouseMove=function(){var n=this,i;n._isCapture||(t.GC$(f).bind(ui,function(t){n.doMouseMove(t)}).bind(fi,function(t){n.doMouseUp(t)}),i=n._spread.getActiveSheet(),i&&(i._continueMouseUpBubble=!0),n._isCapture=!0)},n.prototype.unhandleDocumentMouseMove=function(){if(this._isCapture){this._isCapture=!1;t.GC$(f).unbind(ui).unbind(fi);var n=this._spread.getActiveSheet();n&&delete n._continueMouseUpBubble}},n.prototype.doNavButtonClick=function(n,t){var i=this,r,u;if(i._clearRepeatDown(),r=i._getVisibleTabs(),!(r.length<=0)){u=200;n=n%4;switch(n){case 0:i._navigateToFirst(r);break;case 1:t||(i._repeatDown=window.setTimeout(function(){i.doNavButtonClick(1)},u));i._navigateToPrevious(r);break;case 2:t||(i._repeatDown=window.setTimeout(function(){i.doNavButtonClick(2)},u));i._navigateToNext(r);break;case 3:i._navigateToLast(r);break;default:return}}},n.prototype.doSheetTabClick=function(n,i){var r=this,o=t.Events,f,e,u;(r._activeIndex=n,r._activePos=i,f=r._spread.isPaintSuspended(),r._spread.isPaintSuspended(!0),e=r._spread.getActiveSheet(),u=r._spread.getSheet(n),u&&u.isEditing()&&u!==e&&!u.endEdit())||(r._spread.triggerSheetTabClick({sheet:u,sheetName:u._name,sheetTabIndex:n}),r._doSheetTabClickChange(n),r._spread.isPaintSuspended(f),r.repaint())},n.prototype.doNewTabClick=function(n){var r=this,h=t.Events,u=r._spread,f=u.getActiveSheet(),e,o,s;if((!f||!f._formulaTextBox||!f._formulaTextBox.canAppendRange())&&(u.triggerSheetTabClick({sheet:i,sheetName:i,sheetTabIndex:-1}),e=u.sheets.length,o=u._createSheet(u._getDefaultSheetName(e)),u._addSheetImp(e,1,o),r._activeIndex=e,r._activePos=n,s={oldSheet:f,newSheet:o,cancel:!1},u.triggerActiveSheetChanging(s),s&&s.cancel===!1)){for(u._setActiveSheetIndexImp(e,1),u.triggerActiveSheetChanged({oldSheet:f,newSheet:o});r._activeIndex>r._firstTab&&r.isCoverSheetTab();)u.sheets[r._firstTab].visible()&&(r._activePos-=r._tabSizes[r._firstTab]),r._firstTab++;r.repaint()}},n.prototype._doSheetTabClickChange=function(n,i){var u,f;typeof i=="undefined"&&(i=!0);var r=this,s=t.Events,e=r._spread.getSheet(n),o=r._spread.getActiveSheet();n!==r._spread._activeSheetIndex&&(u={oldSheet:o,newSheet:e,cancel:!1},r._spread.triggerActiveSheetChanging(u),u&&u.cancel===!1&&(r._spread._setActiveSheetIndexImp(n,1),this._spread.triggerActiveSheetChanged({oldSheet:o,newSheet:e}),f=r._getNextVisibleIndex(r._firstTab),r._activeIndex>r._firstTab&&r._activePos+r._tabSizes[r._activeIndex]>r.getCoverPosition()&&f!=-1&&(r._firstTab=f)));r._activeIndex<r._firstTab&&(r._firstTab=r._getPreVisibleIndex(r._firstTab))},n.prototype._doMouseDbClickImp=function(n,r){var u=this,p=u.hitTest(n,r),a,l,v;if(p.element===s){if(a=u._activeIndex,l=u._spread.sheets[a],u._spread.triggerSheetTabDoubleClick({sheet:l,sheetName:l._name,sheetTabIndex:a}),!u._spread._tabEditable)return!1;if(v=t.FocusHelper.getActiveElement(),v&&v.endEdit&&!v.endEdit())return;t.FocusHelper.setActiveElement(i);var w=u._tabSizes[a],y=t.GC$(u._getCanvas()).offset(),h=f.createElement(bt),c=h.style;h.type="text";h.value=l._name;h.setAttribute("contentEditable","true");h.setAttribute("autocomplete","off");c.position="absolute";c.margin=o;c.padding=o;c.margin=o;c.left=y.left+u._activePos+u._tabLeftPadding+e;c.top=y.top+u.getInputTopPosition()+e;c.width=w-u._tabLeftPadding-u._tabRightPadding+2+e;c.backgroundColor=vi;c.borderWidth="0px";c.outline=dt;f.body.insertBefore(h,i);u._tabNameEditor=h;t.GC$(h).addClass("sheetTabEditor").bind(ei,function(n){if(n.keyCode===13)return u.endSheetTabEditing(l,!1),!1;else if(n.keyCode===27)return u.endSheetTabEditing(l,!0),!1}).bind(oi,function(n){h.selectionStart=0;h.selectionEnd=h.value.length}).bind(si,function(n){u.endSheetTabEditing(l,!1)});h.focus()}return!1},n.prototype.doMouseDbClick=function(n){var f=t.util.device(),u=f.ipad||f.iphone,i,r;if(!u&&(i=this._spread.getActiveSheet(),!i._isTouchMode)){if(u=i._formulaTextBox&&i._formulaTextBox.canAppendRange(),r=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,u)return;else r&&r.dom&&r.clear();var e=t.GC$(this._getCanvas()).offset(),o=n.pageX-e.left,s=n.pageY-e.top;return this._doMouseDbClickImp(o,s)}},n.prototype.endSheetTabEditing=function(n,r){var e=this,f,o,s,h,c;e._tabNameEditor&&(t.GC$(e._tabNameEditor).unbind(ei).unbind(oi).unbind(si),f=e._tabNameEditor.value,r===!1&&(o=n.getName(),f!==o&&(f!==u&&f!==i&&f!==""&&e._isValidSheetName(f)?(s={sheet:n,oldValue:o,newValue:f,cancel:!1},n.triggerSheetNameChanging(s),s&&s.cancel===!1&&(h=new t.UndoRedo.SheetRenameUndoAction(n,f),n._doCommand(h),c={sheet:n,oldValue:o,newValue:f},n.triggerSheetNameChanged(c))):n.triggerInvalidOperation({sheet:n,sheetName:n.getName(),invalidType:5,message:t.SR.Exp_SheetNameInvalid}))),e._tabNameEditor.parentNode.removeChild(e._tabNameEditor),delete e._tabNameEditor)},n.prototype._isValidSheetName=function(n){var t,f,r,e;if(n===u||n===i||n==="")return!1;for(r=0;r<n.length;r++)if(t=n.charAt(r),t==="*"||t===":"||t==="["||t==="]"||t==="?"||t==="\\"||t==="/")return!1;for(f=this._spread.sheets.length,r=0;r<f;r++)if(e=this._spread.sheets[r],n===e._name)return!1;return!0},n.prototype._initTabReorder=function(n,i){var r=this,u=r._spread,f=u&&u.getActiveSheet(),o=f&&f._formulaTextBox,e=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,s=t.features.formulatextbox&&e&&e.text;!this._spread._allowSheetReorder||s||o?r._reorderSheet=!1:(r._sourceTabIndex=i.index,r._tabTip=r._getTabTip(r._sourceTabIndex),r._tabStartPos=new t.Point(n.pageX,n.pageY),r.handleDocumentMouseMove())},n.prototype._getTabTip=function(n){var u=this._spread.sheets,e=u.length,i,r;if(!(n>=e)&&!(n<0))return i=u[n]._name,i||(i="sheet"),r=t.GC$(f.createElement("span")).text(i).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"}),r.addClass("ui-widget-header tab-tip-span btn-primary"),r},n.prototype._clearRepeatDown=function(){this._repeatDown&&(window.clearTimeout(this._repeatDown),this._repeatDown=i)},n.prototype._showTabTip=function(n,i){var r=this,u,e;r._tabTip&&t.GC$("."+ir).length()===0&&(r._tabTip.appendTo(f.body),r._tabTip.hide());u=r._tabTip.width();e=r._tabTip.height();r._tabTip.css({left:n-u/2,top:i-e/2});r._tabTip.show()},n.prototype._setTabIndicator=function(n){var u=this,h=t.GC$(u._getCanvas()),f=h.position(),c=h.offset(),o=n.pageX-c.left,p=n.pageY-c.top,e=u.hitTest(o,p),w=u.getBounds(),a=u.getTabStartPosition(),v=u._spread.sheets.length,y=100,b=w.x+u.getCoverPosition();o>b?u._reorderSpeedTimeout===i&&u._targetTabIndex<v&&(u._reorderSpeedTimeout=setInterval(function(){u._navigateToNext(u._getVisibleTabs());u._targetTabIndex===v?(u._clearSpeedTimeout(),u._tabIndicator.css({left:f.left+u._getLastTabPos()-l,top:f.top-l}),u._tabIndicator.show()):(u._targetTabIndex++,u._tabIndicator.hide())},y)):o<a?u._reorderSpeedTimeout===i&&u._targetTabIndex>0&&(u._reorderSpeedTimeout=setInterval(function(){u._navigateToPrevious(u._getVisibleTabs());u._targetTabIndex===0?(u._clearSpeedTimeout(),u._tabIndicator.css({left:f.left+a-l,top:f.top-l}),u._tabIndicator.show()):(u._targetTabIndex--,u._tabIndicator.hide())},y)):(u._clearSpeedTimeout(),(e.element===s||e.element===u.getTabIndicatorEdgeElement())&&(u._targetTabIndex=e.element===s&&typeof e.index!==r?e.index:u._spread.sheets.length,u._tabIndicator.css({left:f.left+e.position-l,top:f.top-l}),u._tabIndicator.show()))},n.prototype._getLastTabPos=function(){for(var f,n=this,e=n._tabSizes,t=n._getVisibleTabs(),o=n._getVisibleTabIndex(n._firstTab,t),u=0,s=n.getBounds().height,i=n.getTabStartPosition()+n._firstTabSpace,r=o;r<t.length;r++)u=t[r],f=e[u],i+=f,i+=n._tabSpace;return i},n.prototype._clearSpeedTimeout=function(){this._reorderSpeedTimeout!==i&&(window.clearInterval(this._reorderSpeedTimeout),this._reorderSpeedTimeout=i)},n.prototype._reorderTab=function(){var u=this,n=u._targetTabIndex,i=u._sourceTabIndex,f=-1,r,e,t;if(n!==-1&&i!==-1&&i!==n&&i!==n-1&&u._tabIndicator.isVisible()){if(r=u._spread.sheets,e=r[i],i>n){for(t=i;t>n;t--)r[t]=r[t-1];r[n]=e;f=n}else if(i<n-1){for(t=i;t<n-1;t++)r[t]=r[t+1];r[n-1]=e;f=n-1}u._spread._activeSheetIndex=f;u.doResize()}},n.prototype._getVisibleTabs=function(){for(var t=[],n=0;n<this._spread.sheets.length;n++)this._tabVisible(n)&&t.push(n);return t},n.prototype._navigateToFirst=function(n){n.length<=0||this._firstTab!=n[0]&&this._spread.startSheetIndex(n[0])},n.prototype._navigateToPrevious=function(n){var t,i;n.length<=0||(t=this,t._firstTab>n[0]&&(i=t._getPreVisibleIndex(t._firstTab),i!==-1&&t._spread.startSheetIndex(i)))},n.prototype._navigateToNext=function(n){var t,i;n.length<=0||(t=this,t._firstTab<n[n.length-1]&&(i=t._reCalculateFirstTabIndex(n),i!==-1&&t._spread.startSheetIndex(t._getNextVisibleIndex(t._firstTab))))},n.prototype._navigateToLast=function(n){if(!(n.length<=0)&&this._firstTab<n[n.length-1]){var t=this._reCalculateFirstTabIndex(n);t!==-1&&this._spread.startSheetIndex(t)}},n.prototype._reCalculateFirstTabIndex=function(n){var s,f,e;if(n.length<=0)return-1;var t=this,h=t.getBounds(),c=t.getCoverPosition(),r=0,l=t._tabSizes,i,o,v=h.height,a=t.getBasicWidth(),u=t._getVisibleTabIndex(t._firstTab,n);for(u===-1&&(u=0),i=n.length-1;i>=u;i--)if(o=n[i],s=l[o],r+=s,i!==n.length-1&&(r+=t._tabSpace),f=a+r,i!==0&&(f+=t._firstTabSpace),f>c)return e=i+1<n.length?n[i+1]:n[n.length-1],t._firstTab<e?e:-1;return-1},n.prototype._getPreVisibleIndex=function(n){for(var i=this._spread.sheets.length,t=n-1;t>=0;t--)if(this._tabVisible(t))return t;return-1},n.prototype._getNextVisibleIndex=function(n){for(var i=this._spread.sheets.length,t=n+1;t<i;t++)if(this._tabVisible(t))return t;return-1},n.prototype._getVisibleTabIndex=function(n,t){for(var i=0;i<=t.length-1;i++)if(n===t[i])return i;return-1},n.prototype._tabVisible=function(n){return this._spread.sheets[n].visible()},n.prototype.isPaintSuspended=function(n){var t=this;return arguments.length===0?t._paintSuspended:(t._paintSuspended!==n&&(t._paintSuspended=n,n||t.repaint()),t)},n.prototype.repaint=function(n){var i=this._getCanvas();if(i){if(!i.getContext&&t.util._isSilverlightCanvas()&&!i.getContext)return;i.getContext||typeof window.FlashCanvas===r||window.FlashCanvas.initElement(i);i.getContext&&this.paint(i.getContext(at),n)}},n.prototype.paint=function(n,u){var s=this,e,c,v,k,o,it;if(!s._paintSuspended){if(e=s.getBounds(),c=s.canvas,u){if(u.x>=e.x+e.width)return;if(u.y>=e.y+e.height)return;if(u.x+u.width>e.width&&(u.width=e.width-u.x,u.width<=0))return;if(u.y+u.height>e.height&&(u.height=e.height-u.y,u.height<=0))return;if(u.width<=0||u.height<=0)return}if(k=t.util._useDoubleBuffer(),k&&(o=s.buffer,o&&(!o||o.width===c.width&&o.height===c.height)&&(o||o.width===e.width&&o.height===e.height)||(o&&t.DPIHelper.disposeCanvasForSpread(s._spread,o),s.buffer=o=f.createElement(hi),t.DPIHelper.adjustDevicePixel(o,s._spread),t.DPIHelper.setSize(o,e.width,e.height)),!o.getContext))if(t.util._isSilverlightCanvas()){if(!o.getContext)return}else if(typeof window.FlashCanvas!==r&&(it=s._getCanvas(),window.FlashCanvas.initElement(it),!o.getContext))return;if(!(e.width<=0)&&!(e.height<=0)&&(!u||!(u.width<=0||u.height<=0))&&(v=k?s.buffer.getContext(at):n,v.clearRect(0,0,e.width,e.height),v.translate(-e.x,-e.y),s.paintTabs(v,u),v.translate(e.x,e.y),k)){var d=e.x>=0?0:-e.x,nt=e.y>=0?0:-e.y,l=d,a=nt,y,p;u&&(l=e.x+u.x,a=e.y+u.y,e=new t.Rect(l,a,u.width,u.height));d=e.x>=0?e.x:0;nt=e.y>=0?e.y:0;var tt=i,w=t.DPIHelper.getScaleX(c),b=t.DPIHelper.getScaleY(c);c&&w!==1&&(l*=w,a*=b,e.x*=w,e.y*=b,e.width*=w,e.height*=b);try{c?u?(y=h(e.width-l,0),p=h(e.height-a,0)):(y=g(e.width-l,h(c.width-e.x,3)),p=g(e.height-a,h(c.height-e.y,3))):(l=u.x,a=u.y,y=u.width,p=u.height);c?(n.scale(1/w,1/b),n.drawImage(s.buffer,l,a,y,p,d,nt,y,p),n.scale(w,b)):(v=s.buffer.getContext(at),tt=v.getImageData(l,a,y,p))}catch(rt){return}!c&&tt&&e.width>0&&e.height>0&&n.putImageData(tt,d,nt)}}},n.prototype.paintTabs=function(n,i){var r=this,v=r._spread,u,f,e,l,o,a;if(n&&v){u=r.getBounds();n.save();n.font=r._font;i?n.rect(i.x,i.y,i.width,i.height):n.rect(u.x,u.y,u.width,u.height);n.clip();n.beginPath();var s=60,c=r.getTabStartPosition(),h=c;for(n.save(),n.font=t.StyleHelper.setStringFont(n.font,{fontWeight:"bold"}),r._tabSizes=[],e=v.sheets,f=0;f<e.length;f++)s=ut(n.measureText(e[f]._name).width)+r._tabRightPadding+r._tabLeftPadding,r._tabSizes.push(s);if(n.restore(),l=[],o=r._firstTab,o>0&&r._getPreVisibleIndex(o)>=0&&(h+=r._firstTabSpace),o>=0)for(f=o;f<e.length;f++){if(a=e[f].visible(),s=r._tabSizes[f],h>u.x+u.width)break;l.push({i:f,x:h,w:s,t:e[f]._name,visible:a});a&&(h+=s+r._tabSpace)}r.paintBackground(n,u);r.paintNewSheetTab(n,u,h,c);r.paintTab(n,u,l,o,c);r._spread&&r._spread.tabNavigationVisible()&&r.paintNavigationButtons(n,u,c);r.paintResizeBar(n,u);n.beginPath();n.restore()}},n.prototype.paintBackground=function(n,t){},n.prototype.paintNewSheetTab=function(n,t,i,r){},n.prototype.paintTab=function(n,t,i,r,u){var f=this,c=f._spread,l=c.sheets,v=f._hoverTab,s,a,h,e,o;if(f._activeIndex=c.getActiveSheetIndex(),s=f._activeIndex,l.length>0){for(n.save(),n.beginPath(),a=t.x+f.getCoverPosition(),n.rect(u,0,a-u,t.height),n.clip(),h=i.length-1;h>=0;h--)e=i[h],e.i!==s&&e.visible&&f.drawTab(n,e.x,0,e.w,t.height,5,!1,e.i===v,e.t);o=i[s-r];s>=r&&s<l.length&&o&&o.visible&&f.drawTab(n,o.x,0,o.w,t.height,5,!0,!1,o.t);n.restore();n.save();n.beginPath();r>0&&f._getPreVisibleIndex(r)>=0&&f.paintTabBeforeFirstTab(n,t,r,u);n.restore()}},n.prototype.paintTabBeforeFirstTab=function(n,t,i,r){},n.prototype.paintNavigationButtons=function(n,t,i){},n.prototype.paintResizeBar=function(n,t){},n.prototype.drawNavButton=function(n,t,i,r,u,f,e,o,s,h){},n.prototype.drawTab=function(n,t,i,r,u,f,e,o,s){},n.prototype._getCanvas=function(){var n=this.canvas;return n&&!n.getContext&&n.firstChild&&(n.getContext=n.firstChild.getContext),n},n.prototype._getTabStripBackColor=function(n,i){var r=n.createLinearGradient(i.x,i.y,i.width,i.height),u=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground"),e=u&&u.backgroundImage,h=u&&u.backgroundColor,o,f,c,s;if(e&&e.indexOf("linear-gradient")!==-1)for(o=t.util.getLinearGradientColors(e),f=0,c=o.length;f<c;f++)s=o[f],r.addColorStop(s.point,s.color);else h&&(r.addColorStop(0,"#DDDDDD"),r.addColorStop(1,h));return r},n.prototype._getTabBackColor=function(n,i,r,u){var o=this,s=o.getBounds(),f=n.createLinearGradient(s.x+.7*s.height,s.y+0,.7*s.height,s.height),h=o._spread.getSheetFromName(r),a,c,v,y,l,p,e;if(r===""&&o._firstTab>0&&(h=o._spread.getSheet(o._firstTab-1)),h&&h._sheetTabColor)a="rgba(0, 0, 0, 0)",n.fillStyle=a,n.fillStyle=t._ThemeContext.getColor(h,h._sheetTabColor),e=n.fillStyle,e!==a&&(i?(f.addColorStop(0,ci),f.addColorStop(.45,"#F1F6FD"),f.addColorStop(.9,e),f.addColorStop(1,ci)):f=e);else if(u)if(c=u&&u.backgroundImage,v=u&&u.backgroundColor,c&&c.indexOf("linear-gradient")!==-1)for(y=t.util.getLinearGradientColors(c),l=0,p=y.length;l<p;l++)e=y[l],f.addColorStop(e.point,e.color);else v&&f.addColorStop(0,v);return f},n.prototype._getTabForeColor=function(n,i){var r=ai,u;return n&&(r=n.color),i&&(u=t._Color.parse(i),u&&u.getBrightness()<255/2&&(r=vi)),r},n.defaultFont="10pt Arial",n}();t._GcTabBase=vt;yi=function(n){function r(t){n.call(this,t);var i=this;i._tabLeftPadding=12;i._tabRightPadding=8;i._tabSpace=3;i._resizeBarWidth=12;i._newTabSize=48;i._firstTabSpace=5;i._font="10pt Arial"}return __extends(r,n),r.prototype._getNavigationButtonWidth=function(){var n=this._spread,t;return!n||!n.tabNavigationVisible()?0:(t=0,n.useTouchLayout()?n._getScrollbarSize()*2:n._getScrollbarSize())},r.prototype._getNavigationButtonHeight=function(){var n=this._spread;return!n||!n.tabNavigationVisible()?0:n._getScrollbarSize()},r.prototype.getTabStartPosition=function(){return this._getNavigationButtonWidth()*4+this._getTabMarginLeft()},r.prototype._getTabMarginLeft=function(){var t=this,n=t._spread;return!n||!n.tabNavigationVisible()?0:2},r.prototype.hitTest=function(n,t){var i=this,f=i.getBounds(),o,e;if(f.x+f.width-i._resizeBarWidth<n&&n<f.x+f.width&&i._spread.showHorizontalScrollbar())return{element:rt};var h=-1,r=0,u,l=i._getNavigationButtonWidth(),a,v;for(a=0,v=4,u=a;u<v;u++){if(r<n&&n<r+l){h=u;break}r+=l}if(h!==-1)return{element:c,index:u};if(r=i.getTabStartPosition(),o=i._getPreVisibleIndex(i._firstTab),o!==-1){if(r<n&&n<r+i._firstTabSpace+i._tabSpace)return{element:s,index:o,position:r};r+=i._firstTabSpace}if(e=0,i._firstTab>-1)for(u=i._firstTab;u<i._spread.sheets.length&&u<i._tabSizes.length;u++)if(i._spread.sheets[u].visible()){if(e=i._tabSizes[u],r<n&&n<r+e+i._tabSpace)return{element:s,index:u,position:r};r+=e+i._tabSpace}return i._spread._newTabVisible&&n>r&&n<r+i.getNewTabSize()?{element:d,position:r}:{element:""}},r.prototype.isCoverSheetTab=function(){var n=this;return n._activePos+n._tabSizes[n._activeIndex]+n.getNewTabSize()>n.getCoverPosition()},r.prototype.getCoverPosition=function(){return this.getBounds().width-this._resizeBarWidth},r.prototype.getInputTopPosition=function(){return 1},r.prototype.getTabIndicatorEdgeElement=function(){return d},r.prototype.getBasicWidth=function(){var n=this,i=n.getBounds().height,t=n.getTabStartPosition()+i;return n._spread._newTabVisible&&(t+=n.getNewTabSize(),t+=n._tabSpace),t},r.prototype.paintBackground=function(n,i){var o,f,c,s;n.save();n.beginPath();var r=n.createLinearGradient(i.x,i.y,i.width,i.height),u=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground"),e=u&&u.backgroundImage,h=u&&u.backgroundColor;if(e&&e.indexOf("linear-gradient")!==-1)for(o=t.util.getLinearGradientColors(e),f=0,c=o.length;f<c;f++)s=o[f],r.addColorStop(s.point,s.color);else h&&(r.addColorStop(0,"#DDDDDD"),r.addColorStop(1,h));n.fillStyle=r;n.fillRect(i.x,i.y,i.width,i.height);n.restore()},r.prototype.paintNewSheetTab=function(n,i,r,u){var f=this,e=f._spread;e._newTabVisible&&(f._newTabSize=n.measureText(t.SR.NewTab).width+f._tabLeftPadding,f.drawTab(n,r,0,f.getNewTabSize(),i.height,5,!1,f._hoverTab===-2,t.SR.NewTab))},r.prototype.paintTabBeforeFirstTab=function(n,t,i,r){var u=this,f=i-1,e=u._tabSizes[f];u.drawTab(n,r+u._firstTabSpace-e-u._tabSpace,0,e,t.height,5,u._activeIndex===f,u._hoverTab===f,"")},r.prototype.paintNavigationButtons=function(n,t,r){var o=this;n.fillStyle=li;n.fillRect(t.x,t.y,r-1,t.height);var u=5,s=o._getNavigationButtonWidth(),c=o._getNavigationButtonHeight(),f=s/2,e=c/2,h=o._hoverNavButton;o.drawNavButton(n,f,e,f+u,e+u,f+u,e-u,!0,f-u,h===0);f+=s;o.drawNavButton(n,f,e,f+u,e+u,f+u,e-u,!0,i,h===1);f+=s;o.drawNavButton(n,f,e,f-u,e+u,f-u,e-u,!1,i,h===2);f+=s;o.drawNavButton(n,f,e,f-u,e+u,f-u,e-u,!1,f+4,h===3)},r.prototype.paintResizeBar=function(n,i){var f=this,s=f._spread,r,c,u=f._resizeBarWidth,e=t.ThemeStyleHelper.getVisualStateThemeStyle,o=e(4,"gc-tabStripResizeBarInner"),h=e(0,"gc-tabStripResizeBarOuter");s.showHorizontalScrollbar()&&(r=i.x+i.width-u,n.fillStyle=h.backgroundColor,n.fillRect(r,i.y,u,i.height),n.fillStyle=o.backgroundColor,n.fillRect(r+1,i.y+1,u-2,i.height-2),n.fillStyle=o.color,n.fillRect(r+u/2-1,i.y+4,2,i.height-8))},r.prototype.drawTab=function(n,i,r,u,f,e,o,s,h){var c,l,v,a,y,p;n.save();n.beginPath();n.moveTo(i,r);n.lineTo(i,r+f-e);n.arcTo(i,r+f,i+u,r+f,e);n.lineTo(i+u,r+f);n.lineTo(i+u+f,r);o||n.lineTo(i,r);c=this;l=0;(o||s)&&(l=4);v=t.ThemeStyleHelper.getVisualStateThemeStyle(l,"gc-tab-"+t.VisualState[l].toLowerCase());a=c._getTabBackColor(n,o||s,h,v);n.fillStyle=a;n.fill();n.strokeStyle=li;n.stroke();n.textBaseline=kt;typeof a=="string"&&(y=a);n.fillStyle=c._getTabForeColor(v,y);p=c._tabLeftPadding;n.textBaseline="middle";n.fillText(h,i+p,r+f/2);n.restore()},r.prototype.drawNavButton=function(n,r,f,e,o,s,c,l,a,v){var b,d,nt,k,et,tt;n.save();var it=this,y=it.getBounds(),w=it._getNavigationButtonWidth(),rt=t.ThemeStyleHelper.getVisualStateThemeStyle,ut=rt(4,"gc-navButton-hover"),p=rt(0,"gc-navButton-normal"),ft=p&&p.backgroundColor;if(v)n.fillStyle=ut.backgroundColor,n.fillRect(r-w/2+2,y.y+2,w-4,y.height-4);else{if(b=p&&p.backgroundImage,b&&b.indexOf("linear-gradient")!==-1){for(d=n.createLinearGradient(y.x+.7*y.height,y.y+0,.7*y.height,y.height),nt=t.util.getLinearGradientColors(b),k=0,et=nt.length;k<et;k++)tt=nt[k],d.addColorStop(tt.point,tt.color);n.fillStyle=d}else ft&&(n.fillStyle=ft);n.fillRect(r-w/2,y.y+1,w,y.height-2)}n.fillStyle=v?ut.color:p.color;a!==u&&a!==i&&n.fillRect(a,g(o,c),1,h(o,c)-g(o,c));l?(r-=2,e-=2,s-=2):(r+=2,e+=2,s+=2);n.beginPath();n.moveTo(r,f);n.lineTo(e,o);n.lineTo(s,c);n.lineTo(r,f);n.fill();n.restore()},r}(vt);pi=function(n){function r(t){n.call(this,t);var i=this;i._tabLeftPadding=13;i._tabRightPadding=12;i._tabSpace=0;i._resizeBarWidth=30;i._itemWidth=28;i._moreTabWidth=28;i._newTabSize=28;i._firstTabSpace=0;i._font="10pt Segoe UI"}return __extends(r,n),r.prototype._getNavigationButtonWidth=function(){var n=this._spread;return!n||!n.tabNavigationVisible()?0:this._itemWidth},r.prototype._getNavigationButtonHeight=function(){var n=this._spread;return!n||!n.tabNavigationVisible()?0:n._getTabStripHeight()},r.prototype._getFirstMoreTabWidth=function(){return this._moreTabWidth},r.prototype._getSecondMoreTabWidth=function(){return this._hideNewTabSecondMoreTab?0:this._moreTabWidth},r.prototype.getNewTabSize=function(){return this._hideNewTabSecondMoreTab?0:this._newTabSize},r.prototype.getTabEndPosition=function(){for(var n=this,r=n._spread.sheets,t=n.getTabStartPosition(),e=n._tabSizes,u=n.getBounds(),f=u.x+u.width-n._resizeBarWidth-n.getNewTabSize()-n._getSecondMoreTabWidth(),i=n._firstTab,o=r.length;i<o;i++)if(r[i].visible()&&(t+=e[i]),t>f){t=f;break}return t},r.prototype.getTabStartPosition=function(){var n=this;return n._getNavigationButtonWidth()*2+n._getFirstMoreTabWidth()+n._getNavigationMarginLeft()},r.prototype._getNavigationMarginLeft=function(){var n=this,t=n._spread;return!t||!t.tabNavigationVisible()?0:n._resizeBarWidth/2},r.prototype.hitTest=function(n,t){var i=this,p=i._getFirstMoreTabWidth(),h=i._getSecondMoreTabWidth(),f=i.getBounds(),e,o;if(f.x+f.width-i._resizeBarWidth<n&&n<f.x+f.width&&i._spread.showHorizontalScrollbar())return{element:rt};var l=-1,r=i._resizeBarWidth/2,u,a=i._getNavigationButtonWidth(),v,y;for(v=1,y=3,u=v;u<y;u++){if(r<n&&n<r+a){l=u;break}r+=a}if(l!==-1)return{element:c,index:u};if(r=i.getTabStartPosition(),r-p<=n&&n<r)return{element:c,index:5,position:r};if(e=0,o=f.x+f.width-i._resizeBarWidth-i.getNewTabSize()-h,i._firstTab>-1)for(u=i._firstTab;u<i._spread.sheets.length&&u<i._tabSizes.length;u++)if(i._spread.sheets[u].visible()){if(e=i._tabSizes[u],n<o&&r<n&&n<r+e+i._tabSpace)return{element:s,index:u,position:r};r+=e+i._tabSpace}return(r>o&&(r=o),r<n&&n<r+h)?{element:c,index:6,position:r}:(r+=h,i._spread._newTabVisible&&r<n&&n<r+i.getNewTabSize())?{element:d,position:r}:{element:""}},r.prototype.isCoverSheetTab=function(){var n=this;return n._activePos+n._tabSizes[n._activeIndex]>n.getCoverPosition()},r.prototype.getCoverPosition=function(){var n=this;return n.getBounds().width-n._resizeBarWidth-n.getNewTabSize()-n._getSecondMoreTabWidth()},r.prototype.getInputTopPosition=function(){return 6},r.prototype.getTabIndicatorEdgeElement=function(){return c},r.prototype.getBasicWidth=function(){return this.getTabStartPosition()},r.prototype.paintBackground=function(n,i){n.save();n.beginPath();var r=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground");this._backgroundColor=t._Color.parse(r.backgroundColor);n.fillStyle=r.backgroundColor;n.fillRect(i.x,i.y,i.width,i.height);n.beginPath();n.strokeStyle=r.borderTopColor;n.moveTo(i.x,i.y+.5);n.lineTo(i.x+i.width,i.y+.5);n.stroke();n.restore()},r.prototype.paintNewSheetTab=function(n,t,i,r){var u=this,h=u._spread,o=u._itemWidth,s=u._getSecondMoreTabWidth(),e,f;i+=s;u._newTabSize=h._newTabVisible?o:0;e=t.x+t.width-u._resizeBarWidth-u.getNewTabSize();i>e&&(i=e,f=e-s,f<r&&(f=r,i=f+o),u.drawMoreTab(n,f,0,s,t.height));h._newTabVisible&&u.drawNewSheetTab(n,i,0,o,t.height,u._hoverTab===-2)},r.prototype.paintTabBeforeFirstTab=function(n,t,i,r){var u=this._getFirstMoreTabWidth();this.drawMoreTab(n,r-u,0,u,t.height)},r.prototype.paintNavigationButtons=function(n,t,r){var e=this,u=5,s=e._getNavigationButtonWidth(),c=e._getNavigationButtonHeight(),f=e._resizeBarWidth/2+s/2,o=c/2,h=e._hoverNavButton;e.drawNavButton(n,f,o,f+u,o+u,f+u,o-u,!0,i,h===1);f+=s;e.drawNavButton(n,f,o,f-u,o+u,f-u,o-u,!1,i,h===2)},r.prototype.paintResizeBar=function(n,i){var r=this,o=r._spread,u,f,e=r._resizeBarWidth,s=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripResizeBarInner");o.showHorizontalScrollbar()&&(n.beginPath(),n.rect(i.x+i.width-e,0,e,i.height),n.clip(),r.paintBackground(n,r.getBounds()),u=i.x+i.width-e/2,f=i.y+i.height/2,n.fillStyle=s.color,n.fillRect(u,f,2,2),n.fillRect(u,f-4,2,2),n.fillRect(u,f+4,2,2))},r.prototype.drawTab=function(n,i,r,u,f,e,o,s,h){var p=this,v=0,l,w,c,a,y,b,k;s&&(v=4);o&&(v=3);l=t.ThemeStyleHelper.getVisualStateThemeStyle(v,"gc-tab-"+t.VisualState[v].toLowerCase());w=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tab-"+t.VisualState[0].toLowerCase());n.save();c=4;a=3;o&&(n.fillStyle="white",n.fillRect(i,r,u,f-c));y=p._getTabBackColor(n,o,h,l);n.fillStyle=y;n.fillRect(i+a,r+a,u-a*2+1,f-a*2);n.beginPath();n.lineWidth=1;n.strokeStyle=w&&w.borderLeftColor;o?(n.moveTo(i+.5,r),n.lineTo(i+.5,r+f-c),n.moveTo(i+u+.5,r),n.lineTo(i+u+.5,r+f-c)):(n.moveTo(i+.5,r+c),n.lineTo(i+.5,r+f-c),n.moveTo(i+u+.5,r+c),n.lineTo(i+u+.5,r+f-c));n.stroke();o&&(n.beginPath(),n.strokeStyle=l&&l.borderBottomColor,n.lineWidth=2,n.moveTo(i,r+f-c),n.lineTo(i+u+1,r+f-c),n.stroke());n.textBaseline=kt;typeof y=="string"&&(b=y);n.fillStyle=p._getTabForeColor(l,b);(s||o)&&(n.font=t.StyleHelper.setStringFont(n.font,{fontWeight:"bold"}));k=p._tabLeftPadding;n.textBaseline="middle";n.fillText(h,i+k,r+f/2-1);n.restore()},r.prototype.drawNavButton=function(n,i,r,u,f,e,o,s,h,c){var v,a,y,p,w,l;n.save();v=this;a=1;c&&(a=4);s?(i-=2,u-=2,e-=2,y=v._getPreVisibleIndex(v._firstTab),y===-1&&(a=0)):(i+=2,u+=2,e+=2,p=v._reCalculateFirstTabIndex(v._getVisibleTabs()),p===-1&&(a=0));w=t.ThemeStyleHelper.getVisualStateThemeStyle(a,"gc-navButton-"+t.VisualState[a].toLowerCase());n.strokeStyle=this.getVisibleForeColor(w.borderTopColor);n.beginPath();l=1;i>u&&(l=-1);n.moveTo(i-.5,r);n.lineTo(i-.5,r+1);n.moveTo(i+l*1-.5,r-1);n.lineTo(i+l*1-.5,r+2);n.moveTo(i+l*2-.5,r-2);n.lineTo(i+l*2-.5,r+3);n.moveTo(i+l*3-.5,r-3);n.lineTo(i+l*3-.5,r+4);n.stroke();n.restore()},r.prototype.drawNewSheetTab=function(n,i,r,u,f,e){var s,o,h;n.save();n.beginPath();s=(f-14)/2;o=1;e&&(o=4);h=t.ThemeStyleHelper.getVisualStateThemeStyle(o,"gc-tabStripNewTab-"+t.VisualState[o].toLowerCase());n.lineWidth=1.5;n.strokeStyle=this.getVisibleForeColor(h.borderTopColor);n.arc(i+u/2,r+f/2,s,0,2*Math.PI);n.stroke();n.beginPath();n.lineWidth=2;n.moveTo(i+u/2-4,r+f/2);n.lineTo(i+u/2+4,r+f/2);n.moveTo(i+u/2,r+f/2-4);n.lineTo(i+u/2,r+f/2+4);n.stroke();n.restore()},r.prototype.drawMoreTab=function(n,i,r,u,f){var e,o;n.save();n.beginPath();e=1;(this._hoverNavButton===5||this._hoverNavButton===6)&&(e=4);o=t.ThemeStyleHelper.getVisualStateThemeStyle(e,"gc-navMoreButton-"+t.VisualState[e].toLowerCase());n.fillStyle=this.getVisibleForeColor(o.borderTopColor);n.fillRect(i+u/2,r+f/2,2,2);n.fillRect(i+u/2-4,r+f/2,2,2);n.fillRect(i+u/2+4,r+f/2,2,2);n.restore()},r.prototype.getVisibleForeColor=function(n){var i=t._Color.parse(n),r=this._backgroundColor;if(i.a<=.01)return t._Color.invertColor(r);else if(t._Color.isTwoColorSimilar(r,i))return t._Color.invertColor(i);return n},r}(vt)})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={})),function(n){(function(t){var e,u,o,f,r,i;t.feature("core.spread_ui",["core.common","core.spread"]);e="undefined";u=function(){function n(){var n=this;n.sheetCount=1;n.name="";n.font=t._GcTabBase.defaultFont;n.allowUserZoom=!0;n.allowUserResize=!0;n.tabStripVisible=!0;n.tabEditable=!0;n.newTabVisible=!0;n.tabStripRatio=.5;n.activeSheetIndex=0;n.sheets=[]}return n}();t.GcSpreadSheetsOptions=u;o=new u;t.WijspreadOptions=u;f={init:function(n){n=t.GC$.extend(!0,o,n);var i=this.get(0);new t.Spread(i,n)},spread:function(){return this.data("spread")},destroy:function(){var n=this.data("spread");n&&n.destroy()},refresh:function(){var n=this.data("spread");n&&n.refresh()},repaint:function(){var n=this.data("spread");n&&n.repaint()}};r=window.jQuery;r&&(r.fn.wijspread=function(n){if(f[n])return f[n].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof n=="object"||!n)return f.init.apply(this,arguments)},typeof r.wijmo===e&&(r.wijmo={wijspread:undefined}),r.wijmo.wijspread=n.Sheets);typeof window.wijmo===e&&(window.wijmo={spread:undefined});window.wijmo.spread=n.Sheets;i=window.ko;i&&(i.GcSpread=i.GcSpread||{},i.GcSpread.gcspreadsheetsBinding={init:function(n,i,r,u){new t.Spread(t.GC$("#"+n.id).getElement(0),i())},update:function(n,t,i,r){}},i.bindingHandlers["gcspread-sheets"]=i.GcSpread.gcspreadsheetsBinding,i.wijmo=i.GcSpread,i.bindingHandlers.wijspread=i.GcSpread.gcspreadsheetsBinding)})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}))
