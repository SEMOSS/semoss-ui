/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends,GcSpread;(function(n){(function(n){n.feature("basedialog",["core.common"]);var t=function(){function t(n,t){var i=this;i.host=n;i._wijpopupClass="wijspread-popup";i._overlayClass="wijspread-overlay";t=t||0;i.defaultOverlayCSS={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"};i.defaultContainerCSS={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"};i._init()}return t.prototype._init=function(){var t=this;t._hasTargetContainer(t._name)?t.container=n.GC$("#"+t._name):(t._name=t._generateName(),t.container=n.GC$(document.createElement("div")).addClass(t._wijpopupClass+" ui-widget").attr({id:t._name,tabIndex:-1}).css(t.defaultContainerCSS))},t.prototype._generateName=function(){for(var n=0,t="dialog";this._hasTargetContainer(t+n);)n++;return t+n},t.prototype.getContainer=function(){if(this.container)return this.container},t.prototype.getHost=function(){return this.host?this.host:document.body},t.prototype.show=function(t){var i=this,u=arguments.length,r=i.container;i._hasOverlay()||i._createOverlay();window.gcGlobal.suspendEvent();i._hasTargetContainer(i._name)||(n.GC$(i.getHost()).append(r),i.resetDialogPosition(),r.css("display","none"));r.show(t)},t.prototype.close=function(){var t=this;t._hasTargetContainer(t._name)&&t.container.remove();n.GC$("."+t._wijpopupClass).isVisible()||t.closeOverlay();window.gcGlobal.resumeEvent()},t.prototype.closeOverlay=function(){n.GC$("."+this._overlayClass).remove()},t.prototype.resetDialogPosition=function(){var t=this.container,a=this.getHost();if(t.length()!==0){var u=n.GC$(a).offset(),i=parseInt(t.css("left"))+u.left,r=parseInt(t.css("top"))+u.top,e=t.width(),o=t.height();if(!isNaN(i)&&!isNaN(r)&&!isNaN(e)&&!isNaN(o)){var s=0,h=0,c=document.documentElement.clientWidth,l=document.documentElement.clientHeight,f=t.getElement(0).getBoundingClientRect();f.left+e>c&&(h=f.left+e-c);f.top+o>l&&(s=f.top+o-l);(i<0||r<0||s>0||h>0)&&(i-=h,r-=s,i<0&&(i=0),r<0&&(r=0),t.css({left:i-u.left+"px",top:r-u.top+"px"}))}}},t.prototype._hasTargetContainer=function(t){return n.GC$("#"+t).length()>0?!0:!1},t.prototype._createOverlay=function(){var t=this,u=n.GC$(document.createElement("div")).addClass(t._overlayClass),i,r,f;u.css(t.defaultOverlayCSS);n.GC$(t.host).append(u);i=n.util.browser&&n.util.browser.mozilla;r=n.util.browser&&n.util.browser.qtMode;(i||r)&&(f=(new Date).valueOf());u.bind("mousedown",function(u){if(i||r){var e=(new Date).valueOf();if(e-f<100)return}t.close();(i||r)&&t._delayCloseTimeout&&window.clearTimeout(t._delayCloseTimeout);n.util.cancelDefault(u)});"touchstart MSPointerDown pointerdown".split(" ").forEach(function(f,e){u.bind(f,function(u){i||r?t._delayCloseTimeout=setTimeout(function(){t.close()},100):t.close();n.util.cancelDefault(u)})})},t.prototype._hasOverlay=function(){return n.GC$("."+this._overlayClass).length()>0?!0:!1},t}();n.BaseDialog=t})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={})),function(n){(function(n){function i(t,i,r,u){return new n.Range(t,i,r,u)}function o(t){return new n._DateTimeHelper(t)}function e(t){return typeof t=="string"?!1:n.FormatConverter.IsNumber(t)}function s(t){return n._DateTimeHelper.fromOADate(t)}var a,v;n.feature("fill",["core.common","core.globalize","core.stringResource"]);var t=null,r=undefined,l=Math.abs,c=Math.min,u=Math.floor;(function(n){n[n.Direction=0]="Direction";n[n.Linear=1]="Linear";n[n.Growth=2]="Growth";n[n.Date=3]="Date";n[n.Auto=4]="Auto"})(n.FillType||(n.FillType={}));a=n.FillType,function(n){n[n.Day=0]="Day";n[n.Weekday=1]="Weekday";n[n.Month=2]="Month";n[n.Year=3]="Year"}(n.FillDateUnit||(n.FillDateUnit={}));v=n.FillDateUnit;var y=function(){function n(n){this._sheet=n}return n}(),h=function(){function i(n){this._indexes=[];this._innerValues=[];this._type=t;this._startIndex=n===r||n===t?-1:n}return i.prototype.dataCount=function(){return this._innerValues.length},i.prototype.values=function(){var n=this,i,t,r,u;if(n._innerValues.length>0){for(i=[],t=0;t<n._innerValues.length;t++)r=n._innerValues[t],u=n._type==="object"?n.toDateTime(r):r,i.push(u);return i}return[]},i.prototype.indexes2=function(){var r=this,u=r._indexes.length,f,e,i;if(u>0&&n.util.hasCalc()){for(f=r._startIndex,f===-1&&(f=r._indexes[0]),e=new Array(1),e[0]=new Array(u),i=0;i<u;i++)e[0][i]=r._indexes[i]-f+1;return new n.Calc._ConcreteArray(e,u)}return t},i.prototype.values2=function(){var i=this._innerValues.length,r;return i>0&&n.util.hasCalc()?(r=[this._innerValues],new n.Calc._ConcreteArray(r,i)):t},i.prototype.insert=function(i,u,f){if(!e(f))throw new Error(n.SR.Exp_NumberOnly);var o=this;(o._type===r||o._type===t)&&(o._type=f instanceof Date?"date":"number");n.ArrayHelper.insert(o._indexes,i,u);n.ArrayHelper.insert(o._innerValues,i,o.toDouble(f))},i.prototype.add=function(n,i){var u=this;(u._type===r||u._type===t)&&(u._type=i instanceof Date?"date":"number");u._indexes.push(n);u._innerValues.push(u.toDouble(i))},i.prototype.toActualValue=function(n){return this._type==="date"?this.toDateTime(n):n},i.prototype.toDouble=function(t){return n.FormatConverter.ToDouble(t)},i.prototype.toDateTime=function(i){var r=t;if(i instanceof Date)r=i;else if(n.util.hasCalc())try{r=n.Calc.Convert.DT(i)}catch(u){r=i}return r},i}(),f=function(){function i(){}return i.bindStandardFunction=function(i,r,u,f,e,o){return function(i,u,f,e){if(!n.util.hasCalc())return t;var s=n.Calc.Functions.findGlobalFunction(r),h=s.evaluate([u,f,e]),o=h.getValue(0,0);return typeof o=="number"&&o.toString().length>=14?+o.toPrecision(14):o}(u,f,e,o)},i.TREND=function(n,t,r,u){return i.bindStandardFunction(this,"Trend",n,t,r,u)},i.GROWTH=function(n,t,r,u){return i.bindStandardFunction(this,"Growth",n,t,r,u)},i}(),p=function(){function a(n){this._worksheet=n;this._fillCache=new y(n)}return a.prototype.fillLinear=function(n,i,u,f){(u===r||u===t)&&(f===r||f===t)?this.seriesTrendFillRange(n,i,1):this.seriesFillRange(n,i,1,u,f,t)},a.prototype.fillGrowth=function(n,i,u,f){(u===r||u===t)&&(f===r||f===t)?this.seriesTrendFillRange(n,i,2):this.seriesFillRange(n,i,2,u,f,t)},a.prototype.fillDate=function(n,t,i,r,u){this.seriesFillRange(n,t,3,r,u,i)},a.prototype.seriesTrendFillRange=function(t,i,r,u){var s=this,v=s.fixRange(t),l=v.row,a=v.col,y=v.rowCount,p=v.colCount,f,e,o,h,c;if(s._worksheet._getSpanModel().hasSpans(l,a,y,p))throw new Error(n.SR.Exp_RangeContainsMergedCell);if(i===1){for(h=l;h<l+y;h++)if(f=s.getSeriesSource(h,a,1,p,i),f&&f.dataCount()>0&&(e=s.calcSeriesTrendData(f,p,r),e&&e.length>0))for(o=0;o<e.length;o++)if(u)return f.toActualValue(e[o]);else s.copyCell(s._worksheet,h,f._indexes[0],h,a+o,f.toActualValue(e[o]),r)}else if(i===0)for(c=a;c<a+p;c++)if(f=s.getSeriesSource(l,c,y,1,i),f&&f.dataCount()>0&&(e=s.calcSeriesTrendData(f,y,r),e&&e.length>0))for(o=0;o<e.length;o++)if(u)return f.toActualValue(e[o]);else s.copyCell(s._worksheet,f._indexes[0],c,l+o,c,f.toActualValue(e[o]),r)},a.prototype.getSeriesSource=function(n,i,r,u,f){var o=t,s,c,l;if(f===1)for(c=i+u-1;c>=i;)s=this._worksheet.getValue(n,c),e(s)&&(o||(o=new h(i)),o.insert(0,c,s)),c--;else if(f===0)for(l=n+r-1;l>=n;)s=this._worksheet.getValue(l,i),e(s)&&(o||(o=new h(n)),o.insert(0,l,s)),l--;return o},a.prototype.calcSeriesTrendData=function(i,r,u){var o,e;if(i&&i.dataCount()>0&&n.util.hasCalc()&&(u===1||u===2)){for(o=[],i.dataCount()===1&&(u===1?i.add(i._indexes[0]+1,i.toActualValue(i._innerValues[0]+1)):u===2&&i.add(i._indexes[0]+1,i.values()[0])),e=0;e<r;e++)u===1?o.push(f.TREND(this._worksheet,i.values2(),i.indexes2(),e+1)):u===2&&o.push(f.GROWTH(this._worksheet,i.values2(),i.indexes2(),e+1));return o}return t},a.prototype.fillAuto=function(t,i,r){var f=this,a=f._worksheet,e=f.fixRange(t),s=e.row,h=e.col,c=e.rowCount,l=e.colCount,u=f.fixRange(a._eventHandler._dragFillStartRange),o;if(u){if(f._worksheet._getSpanModel().hasPartSpans(u.row,u.col,u.rowCount,u.colCount)||f._worksheet._getSpanModel().hasPartSpans(s,h,c,l))throw new Error(n.SR.Exp_ChangeMergedCell);return o=!0,(s<u.row||h<u.col)&&(o=!1),f.autoFillRange(u,c,l,i,r,o)}},a.prototype.fixRange=function(n){var t=n.row,r=n.col,u=n.rowCount,f=n.colCount;return t===-1&&(t=0,u=this._worksheet.getRowCount()),r===-1&&(r=0,f=this._worksheet.getColumnCount()),i(t,r,u,f)},a.prototype.autoFillRange=function(n,r,f,e,o,s){var v=this,h,c,l,a,y=s?1:-1;if(e===1){if(h=u(f/n.colCount),c=f%n.colCount,h>1&&!o)for(a=1;a<h;a++)l=i(n.row,n.col+a*y*n.colCount,n.rowCount,n.colCount),v.copyRange(n,l,e,4,o);if(o&&h>1&&c===0&&(h=h-1,c=n.colCount),h>0&&c>0)return l=s?i(n.row,n.col+h*n.colCount,n.rowCount,c):i(n.row,n.col-h*n.colCount+n.colCount-c,n.rowCount,c),v.copyRange(n,l,e,4,o,s,t,s?0:n.colCount-c)}else if(e===0){if(h=u(r/n.rowCount),c=r%n.rowCount,h>1&&!o)for(a=1;a<h;a++)l=i(n.row+a*y*n.rowCount,n.col,n.rowCount,n.colCount),v.copyRange(n,l,e,4,o,t,t,t,!0);if(o&&h>1&&c===0&&(h=h-1,c=n.rowCount),h>0&&c>0)return l=s?i(n.row+h*n.rowCount,n.col,c,n.colCount):i(n.row-h*n.rowCount+n.rowCount-c,n.col,c,n.colCount),v.copyRange(n,l,e,4,o,s,s?0:n.rowCount-c,t,!0)}},a.prototype.copyRange=function(n,i,r,u,f,o,s,c,l){var it=this,k=it._worksheet,d,g,p,w,y,b,a,ft,rt,ut,v=t,tt=t,nt;if(r===1)for(d=0;d<n.rowCount;d++){for(v=t,tt=t,w=n.row+d,y=i.row+d,c=c?c:0,g=0;g<n.colCount;){if(p=n.col+g,b=i.col+g-c,a=t,ft=k.getFormula(w,p),ft&&ft!==""||(a=k.getValue(w,p)),u===4&&e(a)&&(v||(v=new h),rt=t,rt=a instanceof Date?"date":"number",tt||(tt=rt),tt===rt)){v.add(p,a);g++;continue}if(a&&v&&v.dataCount()>0){if(nt=it.autoFillRowTrendValues(n,i,w,y,v,f,o,c),f&&nt!==t)return nt;v=t;tt=t;continue}if(ut=k._getSpanModel().find(w,p),ut){if(ut.row===w)if(f){if(b===i.col+i.colCount-1)return a}else b<i.col+i.colCount&&b>=i.col&&it.copyCell(k,w,p,y,b,a,u);g+=ut.colCount}else{if(f){if(o&&b===i.col+i.colCount-1)return a;else if(!o&&b===i.col)return a}else b<i.col+i.colCount&&b>=i.col&&it.copyCell(k,w,p,y,b,a,u);g++}}if(v&&v.dataCount()>0&&(nt=it.autoFillRowTrendValues(n,i,w,y,v,f,o,c),f&&nt!==t))return nt}else if(r===0)for(g=0;g<n.colCount;g++){for(v=t,tt=t,p=n.col+g,b=i.col+g,s=s?s:0,d=0;d<n.rowCount;){if(w=n.row+d,y=i.row+d-s,a=t,ft=k.getFormula(w,p),ft&&ft!==""||(a=k.getValue(w,p)),u===4&&e(a)&&(v||(v=new h),rt=t,rt=a instanceof Date?"date":"number",tt||(tt=rt),tt===rt)){v.add(w,a);d++;continue}if(a&&v&&v.dataCount()>0){if(nt=it.autoFillColumnTrendValues(n,i,p,b,v,f,o,s,l),f&&nt!==t)return nt;v=t;tt=t;continue}if(ut=k._getSpanModel().find(w,p),ut){if(ut.col===p)if(f){if(y===i.row+i.rowCount-1)return a}else y<i.row+i.rowCount&&y>=i.row&&(l&&k.isRowFilterOut(y)||it.copyCell(k,w,p,y,b,a,u));d+=ut.rowCount}else{if(f){if(o&&y===i.row+i.rowCount-1)return a;else if(!o&&y===i.row)return a}else y<i.row+i.rowCount&&y>=i.row&&(l&&k.isRowFilterOut(y)||it.copyCell(k,w,p,y,b,a,u));d++}}if(v&&v.dataCount()>0&&(nt=it.autoFillColumnTrendValues(n,i,p,b,v,f,o,s,l),f&&nt!==t))return nt}return t},a.prototype.autoFillRowTrendValues=function(i,r,u,e,o,s,h,c){var b=this,k=b._worksheet,v,l,y,p,a,w,nt,d,tt,g;if(o&&o.dataCount()>0&&n.util.hasCalc())if(w=(r.col-i.col)/i.colCount,b.isArithmeticProgression(o._indexes,o._innerValues)){for(nt=o.values2(),d=new Array(1),v=o.dataCount(),d[0]=new Array(v),l=0;l<v;l++)d[0][l]=l+1;for(tt=new n.Calc._ConcreteArray(d,v),l=0;l<v;l++)if(y=f.TREND(k,nt,tt,v*w+l+1),p=o._indexes[l],a=p+w*i.colCount,s){if(h&&a===r.col+r.colCount-1)return o.toActualValue(y);else if(!h&&a===r.col)return o.toActualValue(y)}else a<r.col+r.colCount&&a>=r.col&&b.copyCell(k,u,p,e,a,o.toActualValue(y),4)}else for(g=o._indexes[0],v=o._indexes[o.dataCount()-1]-g+1,o.dataCount()===1&&o.add(o._indexes[0]+1,o.toActualValue(o._innerValues[0]+1)),l=0;l<v;l++)if(y=f.TREND(k,o.values2(),o.indexes2(),v*w+l+1),p=g+l,a=p+w*i.colCount,s){if(a===r.col+r.colCount-1)return o.toActualValue(y)}else a<r.col+r.colCount&&a>=r.col&&b.copyCell(k,u,p,e,a,o.toActualValue(y),4);return t},a.prototype.copyCell=function(i,r,u,f,e,o,s){var a,c,l,h;(i.hasFormula(r,u)||i.hasFormula(f,e))&&(i.setFormula(f,e,t),(s===0||s===4)&&(a=i.getFormula(r,u),a&&i._copyFormula(r,u,f,e,1,1)));i.setValue(f,e,o);c=i.getCompositeStyle(r,u);c?(l=new n.Style,l.copyFrom(c),i.setStyleWithoutLocked(f,e,l,3)):i.setStyleWithoutLocked(f,e,t,3);i._getSpanModel().isEmpty()||(i.removeSpan(f,e,3),h=i._getSpanModel().find(r,u),h&&i._addSpanImp(f,e,h.rowCount,h.colCount,3))},a.prototype.autoFillColumnTrendValues=function(i,r,u,e,o,s,h,c,l){var d=this,p=d._worksheet,y,a,w,b,v,k,tt,g,it,nt;if(o&&o.dataCount()>0&&n.util.hasCalc())if(k=(r.row-i.row-c)/i.rowCount,d.isArithmeticProgression(o._indexes,o._innerValues)){for(tt=o.values2(),g=new Array(1),y=o.dataCount(),g[0]=new Array(y),a=0;a<y;a++)g[0][a]=a+1;for(it=new n.Calc._ConcreteArray(g,y),a=0;a<y;a++)if(w=f.TREND(p,tt,it,y*k+a+1),b=o._indexes[a],v=b+k*i.rowCount,s){if(h&&v===r.row+r.rowCount-1||!h&&v===r.row)return o.toActualValue(w)}else v<r.row+r.rowCount&&v>=r.row&&(l&&p.isRowFilterOut(v)||d.copyCell(p,b,u,v,e,o.toActualValue(w),4))}else for(nt=o._indexes[0],y=o._indexes[o.dataCount()-1]-nt+1,o.dataCount()===1&&o.add(o._indexes[0]+1,o.toActualValue(o._innerValues[0]+1)),a=0;a<y;a++)if(w=f.TREND(p,o.values2(),o.indexes2(),y*k+a+1),b=nt+a,v=b+k*i.rowCount,s){if(v+c===r.row+r.rowCount-1)return o.toActualValue(w)}else v<r.row+r.rowCount&&v>=r.row&&(l&&p.isRowFilterOut(v)||d.copyCell(p,nt,u,v,e,o.toActualValue(w),4));return t},a.prototype.isArithmeticProgression=function(n,t){var r,u,f,i;if(n.length!==t.length)return!1;if(r=t.length,r<=1)return!1;else if(r===2)return!0;else{for(u=n[1]-n[0],f=t[1]-t[0],i=2;i<r;i++)if(n[i]-n[i-1]!==u||t[i]-t[i-1]!==f)return!1;return!0}},a.prototype.fillAutobyDirection=function(n,t){var i=this.fixRange(n),r=i.row,u=i.col,f=i.rowCount,e=i.colCount,o=this.getDirectionFillSourceRange(r,u,f,e,t);o&&this.directionFillRange(o,r,u,f,e,t)},a.prototype.directionFillRange=function(t,r,f,e,o,s){var l=this,y=n.SR.Exp_TargetContainsMergedCells,p=n.SR.Exp_MergedCellsIdentical,c,a,v,h;if(s===0){if(l._worksheet._getSpanModel().hasSpans(r,f,e,o-t.colCount))throw new Error(y);if(c=u(o/t.colCount),a=o%t.colCount,a!==0)throw new Error(p);if(c>1)for(h=1;h<c;h++)v=i(t.row,t.col-h*t.colCount,t.rowCount,t.colCount),l.copyRange(t,v,1,0)}else if(s===1){if(l._worksheet._getSpanModel().hasSpans(r,f+t.colCount,e,o-t.colCount))throw new Error(y);if(c=u(o/t.colCount),a=o%t.colCount,a!==0)throw new Error(p);if(c>1)for(h=1;h<c;h++)v=i(t.row,t.col+h*t.colCount,t.rowCount,t.colCount),l.copyRange(t,v,1,0)}else if(s===2){if(l._worksheet._getSpanModel().hasSpans(r,f,e-t.rowCount,o))throw new Error(y);if(c=u(e/t.rowCount),a=e%t.rowCount,a!==0)throw new Error(p);if(c>1)for(h=1;h<c;h++)v=i(t.row-h*t.rowCount,t.col,t.rowCount,t.colCount),l.copyRange(t,v,0,0)}else if(s===3){if(l._worksheet._getSpanModel().hasSpans(r+t.rowCount,f,e-t.rowCount,o))throw new Error(y);if(c=u(e/t.rowCount),a=e%t.rowCount,a!==0)throw new Error(p);if(c>1)for(h=1;h<c;h++)v=i(t.row+h*t.rowCount,t.col,t.rowCount,t.colCount),l.copyRange(t,v,0,0)}},a.prototype.getDirectionFillSourceRange=function(n,r,u,f,e){var o=t;return e===0?o=i(n,r+f-1,u,1):e===1?o=i(n,r,u,1):e===2?o=i(n+u-1,r,1,f):e===3&&(o=i(n,r,1,f)),this.inflateCellRange(o)},a.prototype.inflateCellRange=function(n){var t=this._worksheet.getSpans();return t&&n&&(n=this._worksheet._cellRangeInflate(t,n)),n},a.prototype.seriesFillRange=function(t,i,r,u,f,e){var s=this,p=s.fixRange(t),v=p.row,y=p.col,w=p.rowCount,b=p.colCount,o,h,c,l,a;if(s._worksheet._getSpanModel().hasSpans(v,y,w,b))throw new Error(n.SR.Exp_RangeContainsMergedCell);if(i===1){for(l=v;l<v+w;l++)if(o=s.getSeriesSource(l,y,1,1,i),o&&o.dataCount()>0&&(h=s.calcSeriesData(o,b,r,u,f,e),h&&h.length>0))for(c=0;c<h.length;c++)s.copyCell(s._worksheet,l,o._indexes[0],l,y+c,o.toActualValue(h[c]),r)}else if(i===0)for(a=y;a<y+b;a++)if(o=s.getSeriesSource(v,a,1,1,i),o&&o.dataCount()>0&&(h=s.calcSeriesData(o,w,r,u,f,e),h&&h.length>0))for(c=0;c<h.length;c++)s.copyCell(s._worksheet,o._indexes[0],a,v+c,a,o.toActualValue(h[c]),r)},a.prototype.calcSeriesData=function(n,i,u,f,e,o){var h;if(n&&n.dataCount()>0){var c=[],l=n._innerValues[0],s=l;for(h=0;h<i;h++)(e===r||e===t||s<=e)&&(c.push(s),u===1?s+=f:u===2?s*=f:u===3&&o!==r&&o!==t&&(s=this.getNextDateValue(o,l,s,f,h+1)));return c}return t},a.prototype.getNextDateValue=function(n,t,i,r,f){var h=i,e,a;if(n===0)e=s(i),h=o(e.setDate(e.getDate()+r)).toOADate();else if(n===1){for(e=s(i),a=l(r);a>0;)r>0?e.setDate(e.getDate()+c(1,a)):e.setDate(e.getDate()-c(1,a)),e.getDay()!==6&&e.getDay()!==0&&(a-=1);h=o(e).toOADate()}else n===2?(e=s(t),h=o(e.setMonth(e.getMonth()+u(f*r))).toOADate()):n===3&&(e=s(t),h=o(e.setFullYear(e.getFullYear()+u(f*r))).toOADate());return h},a}();n.FillImp=p})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(n){var r,t,i;n.feature("fill_ui",["core.common","core.sheet_action","core.stringResource"]),function(n){n[n.Tag=0]="Tag";n[n.Down=1]="Down"}(n._FillSmartTag||(n._FillSmartTag={}));r=n._FillSmartTag;t=function(t){function r(i,r,u){t.call(this,i,n.util.getPreferredZIndex(r&&r.parent&&r.parent._host));var f=this;f.eventNameSpace=".ui-fill";f.fillKeyDown="keydown"+f.eventNameSpace;f.sheet=r;f.fillInfo=u;f._initTagDialog()}return __extends(r,t),r.prototype._initTagDialog=function(){var t=this;t.tagContainer=t.getContainer().addClass("smart-tag-default tag-container no-user-select ui-widget-header btn btn-default");t.smartTag=n.GC$(document.createElement("img")).attr("src",r.getImageSrc(0)).css("float","left").appendTo(t.tagContainer);t.smartTagDown=n.GC$(document.createElement("img")).attr("src",r.getImageSrc(1)).css("float","left").css("display","none").appendTo(t.tagContainer)},r.prototype._registerEvent=function(){var t=this,r=n.util.device(),i=n.util.browser.safari&&(r.ipad||r.iphone),u;t.tagContainer.bind("mouseover",function(){var f="ui-state-hover smart-tag-hover",r=t.sheet._isTouchMode,e=r?"38px":"32px",o=r?"24px":"18px",u;t.menuDialog&&(u=t.menuDialog.isOpen(),u)||(n.GC$(this).addClass(f),n.GC$(this).css({width:e,height:o}),i||t.smartTagDown.show())}).bind("mouseout",function(){var f="ui-state-hover smart-tag-hover",r=t.sheet._isTouchMode,e=r?"24px":"18px",o=r?"24px":"18px",u;t.menuDialog&&(u=t.menuDialog.isOpen(),u)||(n.GC$(this).removeClass(f),n.GC$(this).css({width:e,height:o}),i||t.smartTagDown.hide())});u=function(){var r="ui-state-active smart-tag-active",u=t.menuDialog&&t.menuDialog.isOpen();u?(i&&t.smartTagDown.hide(),n.GC$(this).removeClass(r),t._closeMenu()):(i&&t.smartTagDown.show(),n.GC$(this).addClass(r),t._openMenu(),t._initData())};t.tagContainer.bind("click",u);n.GC$(document).bind(t.fillKeyDown,function(i){i.keyCode===27&&(t.menuDialog&&t.menuDialog.isOpen()?t._closeMenu():t.close(),n.util.cancelDefault(i))})},r.prototype.open=function(){var n=this,t=n.sheet,i,r,o;if(n.tagContainer){i=n.fillInfo.x;r=n.fillInfo.y;n.tagContainer.css({left:i,top:r});n.show();n._registerEvent();var u=t._isTouchMode,f=u?"3px":"0px",e=u?"24px":"18px";n.smartTag.css("margin",f);n.smartTagDown.css("height",e);n._reset();o=t.parent}},r.prototype._initData=function(){var i=this.fillInfo.fillType,t;this.menuContainer&&(t=this.menuContainer.find("input[type=radio]").getElement(i),t&&t.checked===!1&&(t.checked=!0,n.GC$(t).trigger("change")))},r.prototype._openMenu=function(){var n=this;n.menuDialog||(n.menuDialog=new i(n.sheet.parent._getContainerDiv(),n.sheet),n.menuContainer=n.menuDialog.getContainer());n.menuDialog.fillType=this.fillInfo.fillType;var t=n.tagContainer,f=t.css("left"),r=t.css("top"),u=parseFloat(r);isNaN(u)||(r=u+t.height()+2);n.menuContainer.css({left:f,top:r});n.menuDialog.show();n.menuDialog._attachEvent();n.menuDialog.smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,i){n.fillInfo.fillType=i})},r.prototype._closeMenu=function(){this.menuDialog&&(this.menuDialog._dettachEvent(),this.menuDialog.close())},r.prototype._reset=function(){var n=this,t;n.menuDialog&&(t=n.menuDialog.isOpen(),t&&n.tagContainer.trigger("click"),n.tagContainer.trigger("mouseout"))},r.prototype.close=function(){var i=this;i._reset();n.GC$(document).unbind(i.fillKeyDown);t.prototype.close.call(this);i.sheet&&i.sheet.setFocus()},r.getImageSrc=function(n){if(n===0)return"data:image/png;base64,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";else if(n===1)return"data:image/png;base64,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";return""},r}(n.BaseDialog);n._GcFillDialog=t;i=function(t){function i(i,r){t.call(this,i,n.util.getPreferredZIndex(r&&r.parent&&r.parent._host));this.sheet=r;this.init()}return __extends(i,t),i.prototype.init=function(){var t=this;t.itemClass="fill-type-item";t.menuClass="wijspread-fill-menu-container";t.smartTagContainer=n.GC$(".tag-container");t._initMenuDialog()},i.prototype.show=function(){t.prototype.show.call(this)},i.prototype._initMenuDialog=function(){var t=this;t.menuContainer=t.getContainer();t.menuContainer.addClass(t.menuClass);t.copyCells=t._createMenuItem("smartMenuCopyCells",t.itemClass,n.SR.CopyCells,"0",!0).appendTo(t.menuContainer);t.fillSeries=t._createMenuItem("smartMenuFillSeries",t.itemClass,n.SR.FillSeries,"1").appendTo(t.menuContainer);t.fillFormattingOnly=t._createMenuItem("smartMenuFillFormattingOnly",t.itemClass,n.SR.FillFormattingOnly,"2").appendTo(t.menuContainer);t.fillWithoutFormatting=t._createMenuItem("smartMenuFillWithoutFormatting",t.itemClass,n.SR.FillWithoutFormatting,"3").appendTo(t.menuContainer)},i.prototype._createMenuItem=function(t,i,r,u,f){var o=this.sheet._isTouchMode,c=o?"160px":"150px",l=o?"25px":"20px",e=n.GC$(document.createElement("div")).css({display:"block",width:c,height:l,padding:0,margin:0}).addClass("smartMenu-item-default "+i+" ui-state-default btn btn-default"),s=n.GC$(document.createElement("div")).addClass("menu-item-input").appendTo(e),a=n.GC$(document.createElement("div")).addClass("menu-item-text").appendTo(e),h=n.GC$(document.createElement("input")).attr({id:t,value:u,type:"radio",name:"fill-group",style:"display:none"}).appendTo(s),v=n.GC$(document.createElement("span")).text(r).appendTo(a);return f?(s.addClass("check-image ui-icon ui-icon-check"),h.prop("checked","checked")):h.prop("checked",""),e},i.prototype._attachEvent=function(){var t=this,r=n.GC$("."+t.itemClass),i;r.bind("mouseover",function(){var t="ui-state-hover smartMenu-item-hover";n.GC$(this).addClass(t)}).bind("mouseout",function(){var t="ui-state-hover smartMenu-item-hover";n.GC$(this).removeClass(t)}).bind("click",function(){var f="ui-state-hover smartMenu-item-hover",i=n.GC$(this).find("input[type=radio]"),r=i.getElement(0),u;r.checked=!0;i.trigger("change");t.smartTagContainer.trigger("click");t.smartTagContainer.trigger("mouseout");n.GC$(this).removeClass(f);u=parseInt(r.getAttribute("value"),10);t._changeFill(u)});i=t.menuContainer.find("input[type=radio]");i.bind("change",function(){var t="ui-icon ui-icon-check check-image";n.GC$(".menu-item-input").removeClass(t);n.GC$(this).parent().addClass(t)})},i.prototype._dettachEvent=function(){var t=this,r=n.GC$("."+t.itemClass),i;r.unbind("mouseover").unbind("mouseout").unbind("click");i=t.menuContainer.find("input[type=radio]");i.unbind("change")},i.prototype._changeFill=function(t){var i,r;if(this.fillType!==t){this.fillType=t;i=this.sheet;i._skipCloseDragFillSmartTag=!0;i.suspendEvent();try{n.SpreadActions.undo.call(i)}finally{i.resumeEvent()}i._skipCloseDragFillSmartTag=!1;r=new n.UndoRedo.FillUndoAction(i,t,i._eventHandler._currentFillRange);i._doCommand(r);this.smartTagContainer.trigger("fillTypeChanged",t)}},i.prototype.isOpen=function(){return n.GC$("."+this.menuClass).length()>0?!0:!1},i}(n.BaseDialog)})(n.Sheets||(n.Sheets={}));var t=n.Sheets}(GcSpread||(GcSpread={}))
