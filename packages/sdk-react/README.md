# @semoss\sdk

@semoss\sdk-react is a small react package that accelerates the process of building an deploying an app.

## Getting Started:

First, install the sdk using a package manager:

```sh
npm install @semoss/sdk-react
```

Second, install dependencies using a package manager:

```sh
npm install @semoss/sdk
```

Next, import the `InsightProvider`. This provider will wrap your components and provide an Insight to all of it's children. Insights are temporal workspaces that allow end users to script and interact with a model, storage engine, or database.

```jsx
import { InsightProvider } from '@semoss/sdk-react';

const App = (props) => {
    const { children } = props;

    return <InsightProvider>{children}</InsightProvider>;
};
```

Once the application is wrapped, You can access the insight through the `useInsight` hook;

```jsx
import { useInsight } from '@semoss/sdk-react';

const Child = (props) => {
    const { children } = props;

    const {
        /** Track if it is initialized **/
        isInitialized,
        /** Track if the user is authorized **/ isAuthorized,
        /** Any Insight Errors **/
        error,
        /** System information **/
        system,
        /** Actions to update **/
        actions,
    } = useInsight();

    return <InsightProvider>{children}</InsightProvider>;
};
```

Now you are ready to go. You can do things like

-   Login or Logout

```js
const login = (username, password) => {
    const success = await insight.actions.login({
        type: 'native',
        username: username,
        password: password,
    });

    console.log(success);
};

const logout = (username, password) => {
    const success = await insight.actions.logout();

    console.log(success);
};
```

-   Query a LLM and return a result

```js
const ask = (question) => {
    const { pixelReturn } = await insight.actions.run(
        `LLM(engine=["${ENGINE}"], command=["<encode>${question}</encode>"]);`,
    );

    // get the message
    const message = pixelReturn[0].output.response;
    console.log(message);
};
```

-   Run a database query

```js
const getMovies = () => {
    const { pixelReturn } = await insight.actions.query(
        `Database(engine=["${ENGINE}"]) | Query("select * from movie") | Collect(10)`,
    );

    // get the data
    const data = pixelReturn[0].output;

    console.log(data);
};
```

-   Run Python

```js
const sum = (num1, num2) => {
    const { pixelReturn } = await insight.actions.runPy(`${num1} + ${num2}`);

    // get the data
    const data = pixelReturn[0].output;

    console.log(data);
};
```

## Tips and Tricks

Here are a few tips and tricks that can help streamline the development process.

### Development Environment

> Note: We recommend manually setting the environment only in `development` mode.

You can setup a development environment and use access keys to authenticate with the app server. Generate the keys on the server and then update the `Env` module. See:

```js
// import the module
import { Env } from '@semoss/sdk';

// update the environment
if (process.env.NODE_ENV !== 'production') {
    Env.update({
        // url pointing to the app server
        MODULE: '',
        // access key generated on the app server
        ACCESS_KEY: '',
        // secret key generated on the app server
        SECRET_KEY: '',
    });
}
```

> Note: Please **do not** commit your keys. Instead externalize your keys to a `.env` and load them in as environment variables during development

### Development Environment

> Note: We recommend manually setting the environment only in `development` mode.

You can setup a development environment and use access keys to authenticate with the app server. Generate the keys on the server and then update the `Env` module. See:

```js
// import the module
import { Env } from '@semoss/sdk';

// update the environment
Env.update({
    /**
     * Url pointing to the app server
     **/
    MODULE: '',
    /**
     * Access key generated by the app server
     **/
    ACCESS_KEY: '',
    /**
     * Secret key generated by the app server
     **/
    SECRET_KEY: '',
    /**
     * Optional field. This will load app specific reactors into the insight. Your app has to be hosted and running on the app server.
     **/
    APP: '',
});
```

> Note: Please **do not** commit your keys. Instead externalize your keys to a `.env` and load them in as environment variables during development

### Python

The app server allows you to write custom `python` to power your app. You can initialize your `python` environment by:

1. Loading via a file

The sdk will load `python` via an external file.

```py
# ./hello.py
def sayHello(name):
    print(f'Hello {name}')
```

Set the option on initialize:

```js
// import the module
import { Env } from '@semoss/sdk';

// update the environment
insight.initialize({
    python: {
        /**
         *  Load the python via an external file
         **/
        type: 'file',
        /**
         *  Path to the file
         **/
        path: './hello.py',
        /**
         *  Alias for the file
         **/
        alias: 'smss',
    },
});
```

2. Loading via `js`

The sdk will load `python` via an external file.

```py
# ./hello.py

```

Set the option on initialize:

```js
// import the module
import { Env } from '@semoss/sdk';

// define it int he js
const py = `
def sayHello(name):
    print(f'Hello {name}')
`;

// update the environment
insight.initialize({
    python: {
        /**
         *  Load the python via js
         **/
        type: 'script',
        /**
         *  Path to the file
         **/
        script: py,
        /**
         *  Alias for the file
         **/
        alias: 'smss',
    },
});
```

Next you can the preloaded `python` methods by calling the `runPy` action. See

```js
const hello = (name) => {
    const { pixelReturn } = await insight.actions.runPy(
        `smss.sayHello(${name})`,
    );

    // get the data
    const data = pixelReturn[0].output;

    console.log(data);
};
```
