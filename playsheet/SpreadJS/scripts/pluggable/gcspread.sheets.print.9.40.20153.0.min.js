/*
 *
 * SpreadJS Library 9.40.20153.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var GcSpread;(function(n){(function(n){var a,v,y,p,w,s,c;n.feature("print",["core.common","core.sheet_action","core.imageLoader","core.sheet_render"]);var t="undefined",i=null,e=Math.min,f=Math.max,o=Math.floor;(function(n){n[n.Inherit=0]="Inherit";n[n.Hide=1]="Hide";n[n.Show=2]="Show";n[n.ShowOnce=3]="ShowOnce"})(n.PrintVisibilityType||(n.PrintVisibilityType={}));a=n.PrintVisibilityType,function(n){n[n.None=0]="None";n[n.Horizontal=1]="Horizontal";n[n.Vertical=2]="Vertical";n[n.Both=3]="Both"}(n.PrintCentering||(n.PrintCentering={}));v=n.PrintCentering,function(n){n[n.Portrait=1]="Portrait";n[n.Landscape=2]="Landscape"}(n.PrintPageOrientation||(n.PrintPageOrientation={}));y=n.PrintPageOrientation,function(n){n[n.Auto=0]="Auto";n[n.DownThenOver=1]="DownThenOver";n[n.OverThenDown=2]="OverThenDown"}(n.PrintPageOrder||(n.PrintPageOrder={}));p=n.PrintPageOrder,function(n){n[n.A2=66]="A2";n[n.A3=8]="A3";n[n.A3Extra=63]="A3Extra";n[n.A3ExtraTransverse=68]="A3ExtraTransverse";n[n.A3Rotated=76]="A3Rotated";n[n.A3Transverse=67]="A3Transverse";n[n.A4=9]="A4";n[n.A4Extra=53]="A4Extra";n[n.A4Plus=60]="A4Plus";n[n.A4Rotated=77]="A4Rotated";n[n.A4Small=10]="A4Small";n[n.A4Transverse=55]="A4Transverse";n[n.A5=11]="A5";n[n.A5Extra=64]="A5Extra";n[n.A5Rotated=78]="A5Rotated";n[n.A5Transverse=61]="A5Transverse";n[n.A6=70]="A6";n[n.A6Rotated=83]="A6Rotated";n[n.APlus=57]="APlus";n[n.B4=12]="B4";n[n.B4Envelope=33]="B4Envelope";n[n.B4JisRotated=79]="B4JisRotated";n[n.B5=13]="B5";n[n.B5Envelope=34]="B5Envelope";n[n.B5Extra=65]="B5Extra";n[n.B5JisRotated=80]="B5JisRotated";n[n.B5Transverse=62]="B5Transverse";n[n.B6Envelope=35]="B6Envelope";n[n.B6Jis=88]="B6Jis";n[n.B6JisRotated=89]="B6JisRotated";n[n.BPlus=58]="BPlus";n[n.C3Envelope=29]="C3Envelope";n[n.C4Envelope=30]="C4Envelope";n[n.C5Envelope=28]="C5Envelope";n[n.C65Envelope=32]="C65Envelope";n[n.C6Envelope=31]="C6Envelope";n[n.CSheet=24]="CSheet";n[n.Custom=0]="Custom";n[n.DLEnvelope=27]="DLEnvelope";n[n.DSheet=25]="DSheet";n[n.ESheet=26]="ESheet";n[n.Executive=7]="Executive";n[n.Folio=14]="Folio";n[n.GermanLegalFanfold=41]="GermanLegalFanfold";n[n.GermanStandardFanfold=40]="GermanStandardFanfold";n[n.InviteEnvelope=47]="InviteEnvelope";n[n.IsoB4=42]="IsoB4";n[n.ItalyEnvelope=36]="ItalyEnvelope";n[n.JapaneseDoublePostcard=69]="JapaneseDoublePostcard";n[n.JapaneseDoublePostcardRotated=82]="JapaneseDoublePostcardRotated";n[n.JapaneseEnvelopeChouNumber3=73]="JapaneseEnvelopeChouNumber3";n[n.JapaneseEnvelopeChouNumber3Rotated=86]="JapaneseEnvelopeChouNumber3Rotated";n[n.JapaneseEnvelopeChouNumber4=74]="JapaneseEnvelopeChouNumber4";n[n.JapaneseEnvelopeChouNumber4Rotated=87]="JapaneseEnvelopeChouNumber4Rotated";n[n.JapaneseEnvelopeKakuNumber2=71]="JapaneseEnvelopeKakuNumber2";n[n.JapaneseEnvelopeKakuNumber2Rotated=84]="JapaneseEnvelopeKakuNumber2Rotated";n[n.JapaneseEnvelopeKakuNumber3=72]="JapaneseEnvelopeKakuNumber3";n[n.JapaneseEnvelopeKakuNumber3Rotated=85]="JapaneseEnvelopeKakuNumber3Rotated";n[n.JapaneseEnvelopeYouNumber4=91]="JapaneseEnvelopeYouNumber4";n[n.JapaneseEnvelopeYouNumber4Rotated=92]="JapaneseEnvelopeYouNumber4Rotated";n[n.JapanesePostcard=43]="JapanesePostcard";n[n.JapanesePostcardRotated=81]="JapanesePostcardRotated";n[n.Ledger=4]="Ledger";n[n.Legal=5]="Legal";n[n.LegalExtra=51]="LegalExtra";n[n.Letter=1]="Letter";n[n.LetterExtra=50]="LetterExtra";n[n.LetterExtraTransverse=56]="LetterExtraTransverse";n[n.LetterPlus=59]="LetterPlus";n[n.LetterRotated=75]="LetterRotated";n[n.LetterSmall=2]="LetterSmall";n[n.LetterTransverse=54]="LetterTransverse";n[n.MonarchEnvelope=37]="MonarchEnvelope";n[n.Note=18]="Note";n[n.Number10Envelope=20]="Number10Envelope";n[n.Number11Envelope=21]="Number11Envelope";n[n.Number12Envelope=22]="Number12Envelope";n[n.Number14Envelope=23]="Number14Envelope";n[n.Number9Envelope=19]="Number9Envelope";n[n.PersonalEnvelope=38]="PersonalEnvelope";n[n.Prc16K=93]="Prc16K";n[n.Prc16KRotated=106]="Prc16KRotated";n[n.Prc32K=94]="Prc32K";n[n.Prc32KBig=95]="Prc32KBig";n[n.Prc32KBigRotated=108]="Prc32KBigRotated";n[n.Prc32KRotated=107]="Prc32KRotated";n[n.PrcEnvelopeNumber1=96]="PrcEnvelopeNumber1";n[n.PrcEnvelopeNumber10=105]="PrcEnvelopeNumber10";n[n.PrcEnvelopeNumber10Rotated=118]="PrcEnvelopeNumber10Rotated";n[n.PrcEnvelopeNumber1Rotated=109]="PrcEnvelopeNumber1Rotated";n[n.PrcEnvelopeNumber2=97]="PrcEnvelopeNumber2";n[n.PrcEnvelopeNumber2Rotated=110]="PrcEnvelopeNumber2Rotated";n[n.PrcEnvelopeNumber3=98]="PrcEnvelopeNumber3";n[n.PrcEnvelopeNumber3Rotated=111]="PrcEnvelopeNumber3Rotated";n[n.PrcEnvelopeNumber4=99]="PrcEnvelopeNumber4";n[n.PrcEnvelopeNumber4Rotated=112]="PrcEnvelopeNumber4Rotated";n[n.PrcEnvelopeNumber5=100]="PrcEnvelopeNumber5";n[n.PrcEnvelopeNumber5Rotated=113]="PrcEnvelopeNumber5Rotated";n[n.PrcEnvelopeNumber6=101]="PrcEnvelopeNumber6";n[n.PrcEnvelopeNumber6Rotated=114]="PrcEnvelopeNumber6Rotated";n[n.PrcEnvelopeNumber7=102]="PrcEnvelopeNumber7";n[n.PrcEnvelopeNumber7Rotated=115]="PrcEnvelopeNumber7Rotated";n[n.PrcEnvelopeNumber8=103]="PrcEnvelopeNumber8";n[n.PrcEnvelopeNumber8Rotated=116]="PrcEnvelopeNumber8Rotated";n[n.PrcEnvelopeNumber9=104]="PrcEnvelopeNumber9";n[n.PrcEnvelopeNumber9Rotated=117]="PrcEnvelopeNumber9Rotated";n[n.Quarto=15]="Quarto";n[n.Standard10x11=45]="Standard10x11";n[n.Standard10x14=16]="Standard10x14";n[n.Standard11x17=17]="Standard11x17";n[n.Standard12x11=90]="Standard12x11";n[n.Standard15x11=46]="Standard15x11";n[n.Standard9x11=44]="Standard9x11";n[n.Statement=6]="Statement";n[n.Tabloid=3]="Tabloid";n[n.TabloidExtra=52]="TabloidExtra";n[n.USStandardFanfold=39]="USStandardFanfold"}(n.PaperKind||(n.PaperKind={}));w=n.PaperKind;s=function(){function n(n,t){var i=this,r=arguments.length;r===1?i.kind(n):r===2?(i._width=n,i._height=t,i._kind=0):i.kind(1)}return n.prototype.height=function(n){var t=this;return arguments.length===0?t._height:(t._height!=n&&(t._kind=0),t._height=n,t)},n.prototype.width=function(n){var t=this;return arguments.length===0?t._width:(t._width!=n&&(t._kind=0),t._width=n,t)},n.prototype.kind=function(n){var t=this,i;return arguments.length===0?t._kind:(t._kind=n,i=t.getPageSize(n),t._width=i.width,t._height=i.height,t)},n.prototype.getPageSize=function(n){var t=this;switch(n){case 0:return{width:0,height:0};case 1:return t._fromInch(8.5,11);case 5:return t._fromInch(8.5,14);case 9:return t._fromMM(210,297);case 24:return t._fromInch(17,22);case 25:return t._fromInch(22,34);case 26:return t._fromInch(34,44);case 2:return t._fromInch(8.5,11);case 3:return t._fromInch(11,17);case 4:return t._fromInch(17,11);case 6:return t._fromInch(5.5,8.5);case 7:return t._fromInch(7.25,10.5);case 8:return t._fromMM(297,420);case 10:return t._fromMM(210,297);case 11:return t._fromMM(148,210);case 12:return t._fromMM(250,353);case 13:return t._fromMM(176,250);case 14:return t._fromInch(8.5,13);case 15:return t._fromMM(215,275);case 16:return t._fromInch(10,14);case 17:return t._fromInch(11,17);case 18:return t._fromInch(8.5,11);case 19:return t._fromInch(3.875,8.875);case 20:return t._fromInch(4.125,9.5);case 21:return t._fromInch(4.5,10.375);case 22:return t._fromInch(4.75,11);case 23:return t._fromInch(5,11.5);case 27:return t._fromMM(110,220);case 28:return t._fromMM(162,229);case 29:return t._fromMM(324,458);case 30:return t._fromMM(229,324);case 31:return t._fromMM(114,162);case 32:return t._fromMM(114,229);case 33:return t._fromMM(250,353);case 34:return t._fromMM(176,250);case 35:return t._fromMM(176,125);case 36:return t._fromMM(110,230);case 37:return t._fromInch(3.875,7.5);case 38:return t._fromInch(3.625,6.5);case 39:return t._fromInch(14.875,11);case 40:return t._fromInch(8.5,12);case 41:return t._fromInch(8.5,13);case 42:return t._fromMM(250,353);case 43:return t._fromMM(100,148);case 44:return t._fromInch(9,11);case 45:return t._fromInch(10,11);case 46:return t._fromInch(15,11);case 47:return t._fromMM(220,220);case 50:return t._fromInch(9.275,12);case 51:return t._fromInch(9.275,15);case 52:return t._fromInch(11.69,18);case 53:return t._fromMM(236,322);case 54:return t._fromInch(8.275,11);case 55:return t._fromMM(210,297);case 56:return t._fromInch(9.275,12);case 57:return t._fromMM(227,356);case 58:return t._fromMM(305,487);case 59:return t._fromInch(8.5,12.69);case 60:return t._fromMM(210,330);case 61:return t._fromMM(148,210);case 62:return t._fromMM(182,257);case 63:return t._fromMM(322,445);case 64:return t._fromMM(174,235);case 65:return t._fromMM(201,276);case 66:return t._fromMM(420,594);case 67:return t._fromMM(297,420);case 68:return t._fromMM(322,445);case 69:return t._fromMM(200,148);case 70:return t._fromMM(105,148);case 71:return t._fromMM(240,332);case 72:return t._fromMM(216,277);case 73:return t._fromMM(120,235);case 74:return t._fromMM(90,205);case 75:return t._fromInch(11,8.5);case 76:return t._fromMM(420,297);case 77:return t._fromMM(297,210);case 78:return t._fromMM(210,148);case 79:return t._fromMM(364,257);case 80:return t._fromMM(257,182);case 81:return t._fromMM(148,100);case 82:return t._fromMM(148,200);case 83:return t._fromMM(148,105);case 84:return t._fromMM(332,240);case 85:return t._fromMM(277,216);case 86:return t._fromMM(235,120);case 87:return t._fromMM(205,90);case 88:return t._fromMM(128,182);case 89:return t._fromMM(182,128);case 90:return t._fromInch(12,11);case 91:return t._fromMM(235,105);case 92:return t._fromMM(105,235);case 93:return t._fromMM(146,215);case 94:return t._fromMM(97,151);case 95:return t._fromMM(97,151);case 96:return t._fromMM(102,165);case 97:return t._fromMM(102,176);case 98:return t._fromMM(125,176);case 99:return t._fromMM(110,208);case 100:return t._fromMM(110,220);case 101:return t._fromMM(120,230);case 102:return t._fromMM(160,230);case 103:return t._fromMM(120,309);case 104:return t._fromMM(229,324);case 105:return t._fromMM(324,458);case 106:return t._fromMM(146,215);case 107:return t._fromMM(97,151);case 108:return t._fromMM(97,151);case 109:return t._fromMM(165,102);case 110:return t._fromMM(176,102);case 111:return t._fromMM(176,125);case 112:return t._fromMM(208,110);case 113:return t._fromMM(220,110);case 114:return t._fromMM(230,120);case 115:return t._fromMM(230,160);case 116:return t._fromMM(309,120);case 117:return t._fromMM(324,229);case 118:return t._fromMM(458,324);default:return{width:0,height:0}}},n.prototype._toHundredthsOfInch=function(n,t){return t?n*100:n/25.4*100},n.prototype._fromInch=function(n,t){return{width:this._toHundredthsOfInch(n,!0),height:this._toHundredthsOfInch(t,!0)}},n.prototype._fromMM=function(n,t){return{width:this._toHundredthsOfInch(n,!1),height:this._toHundredthsOfInch(t,!1)}},n.prototype.toJSON=function(){return{width:this._width,height:this._height,kind:this._kind}},n.prototype.fromJSON=function(n){typeof n.width!==t&&(this._width=n.width);typeof n.height!==t&&(this._height=n.height);typeof n.kind!==t&&(this._kind=n.kind)},n}();n.PaperSize=s;c=function(){function n(){var n=this;n._bestFitRows=!1;n._bestFitColumns=!1;n._columnStart=-1;n._columnEnd=-1;n._rowStart=-1;n._rowEnd=-1;n._repeatColumnStart=-1;n._repeatColumnEnd=-1;n._repeatRowStart=-1;n._repeatRowEnd=-1;n._showBorder=!0;n._showGridLine=!0;n._showColumnHeader=0;n._showRowHeader=0;n._useMax=!0;n._centering=0;n._firstPageNumber=1;n._headerLeft="";n._headerCenter="";n._headerRight="";n._footerLeft="";n._footerCenter="";n._footerRight="";n._headerLeftImage="";n._headerCenterImage="";n._headerRightImage="";n._footerLeftImage="";n._footerCenterImage="";n._footerRightImage="";n._margin={top:75,bottom:75,left:70,right:70,header:30,footer:30};n._orientation=1;n._pageRange="";n._pageOrder=0;n._blackAndWhite=!1;n._zoomFactor=1;n._fitPagesTall=-1;n._fitPagesWide=-1;n._paperSize=new s}return n.prototype.bestFitRows=function(n){return arguments.length===0?this._bestFitRows:(this._bestFitRows=n,this)},n.prototype.bestFitColumns=function(n){return arguments.length===0?this._bestFitColumns:(this._bestFitColumns=n,this)},n.prototype.columnStart=function(n){return arguments.length===0?this._columnStart:(this._columnStart=n,this)},n.prototype.columnEnd=function(n){return arguments.length===0?this._columnEnd:(this._columnEnd=n,this)},n.prototype.rowStart=function(n){return arguments.length===0?this._rowStart:(this._rowStart=n,this)},n.prototype.rowEnd=function(n){return arguments.length===0?this._rowEnd:(this._rowEnd=n,this)},n.prototype.repeatColumnStart=function(n){return arguments.length===0?this._repeatColumnStart:(this._repeatColumnStart=n,this)},n.prototype.repeatColumnEnd=function(n){return arguments.length===0?this._repeatColumnEnd:(this._repeatColumnEnd=n,this)},n.prototype.repeatRowStart=function(n){return arguments.length===0?this._repeatRowStart:(this._repeatRowStart=n,this)},n.prototype.repeatRowEnd=function(n){return arguments.length===0?this._repeatRowEnd:(this._repeatRowEnd=n,this)},n.prototype.showBorder=function(n){return arguments.length===0?this._showBorder:(this._showBorder=n,this)},n.prototype.showGridLine=function(n){return arguments.length===0?this._showGridLine:(this._showGridLine=n,this)},n.prototype.showColumnHeader=function(n){return arguments.length===0?this._showColumnHeader:(this._showColumnHeader=n,this)},n.prototype.showRowHeader=function(n){return arguments.length===0?this._showRowHeader:(this._showRowHeader=n,this)},n.prototype.useMax=function(n){return arguments.length===0?this._useMax:(this._useMax=n,this)},n.prototype.centering=function(n){return arguments.length===0?this._centering:(this._centering=n,this)},n.prototype.firstPageNumber=function(n){return arguments.length===0?this._firstPageNumber:(this._firstPageNumber=n,this)},n.prototype.headerLeft=function(n){return arguments.length===0?this._headerLeft:(this._headerLeft=n,this)},n.prototype.headerCenter=function(n){return arguments.length===0?this._headerCenter:(this._headerCenter=n,this)},n.prototype.headerRight=function(n){return arguments.length===0?this._headerRight:(this._headerRight=n,this)},n.prototype.footerLeft=function(n){return arguments.length===0?this._footerLeft:(this._footerLeft=n,this)},n.prototype.footerCenter=function(n){return arguments.length===0?this._footerCenter:(this._footerCenter=n,this)},n.prototype.footerRight=function(n){return arguments.length===0?this._footerRight:(this._footerRight=n,this)},n.prototype.headerLeftImage=function(n){return arguments.length===0?this._headerLeftImage:(this._headerLeftImage=n,this)},n.prototype.headerCenterImage=function(n){return arguments.length===0?this._headerCenterImage:(this._headerCenterImage=n,this)},n.prototype.headerRightImage=function(n){return arguments.length===0?this._headerRightImage:(this._headerRightImage=n,this)},n.prototype.footerLeftImage=function(n){return arguments.length===0?this._footerLeftImage:(this._footerLeftImage=n,this)},n.prototype.footerCenterImage=function(n){return arguments.length===0?this._footerCenterImage:(this._footerCenterImage=n,this)},n.prototype.footerRightImage=function(n){return arguments.length===0?this._footerRightImage:(this._footerRightImage=n,this)},n.prototype.margin=function(n){return arguments.length===0?this._margin:(this._margin=n,this)},n.prototype.orientation=function(n){return arguments.length===0?this._orientation:(this._orientation=n,this)},n.prototype.pageRange=function(n){return arguments.length===0?this._pageRange:(this._pageRange=n,this)},n.prototype.pageOrder=function(n){return arguments.length===0?this._pageOrder:(this._pageOrder=n,this)},n.prototype.blackAndWhite=function(n){return arguments.length===0?this._blackAndWhite:(this._blackAndWhite=n,this)},n.prototype.zoomFactor=function(n){return arguments.length===0?this._zoomFactor:(n<.1?n=.1:n>4&&(n=4),this._zoomFactor=n,this)},n.prototype.fitPagesTall=function(n){return arguments.length===0?this._fitPagesTall:(this._fitPagesTall=n,this)},n.prototype.fitPagesWide=function(n){return arguments.length===0?this._fitPagesWide:(this._fitPagesWide=n,this)},n.prototype.paperSize=function(n){return arguments.length===0?this._paperSize:(this._paperSize=n,this)},n.prototype._isDefaultValue=function(n,t){var i=this;switch(n){case"bestFitRows":return t===!1;case"bestFitColumns":return t===!1;case"columnStart":return t===-1;case"columnEnd":return t===-1;case"rowStart":return t===-1;case"rowEnd":return t===-1;case"repeatColumnStart":return t===-1;case"repeatColumnEnd":return t===-1;case"repeatRowStart":return t===-1;case"repeatRowEnd":return t===-1;case"showBorder":return t===!0;case"showGridLine":return t===!0;case"showColumnHeader":return t===0;case"showRowHeader":return t===0;case"useMax":return t===!0;case"centering":return t===0;case"firstPageNumber":return t===-1;case"headerLeft":return t==="";case"headerCenter":return t==="";case"headerRight":return t==="";case"footerLeft":return t==="";case"footerCenter":return t==="";case"footerRight":return t==="";case"headerLeftImage":return t==="";case"headerCenterImage":return t==="";case"headerRightImage":return t==="";case"footerLeftImage":return t==="";case"footerCenterImage":return t==="";case"footerRightImage":return t==="";case"margin":return t.top===75&&t.bottom===75&&t.left===70&&t.right===70&&t.header===30&&t.footer===30;case"orientation":return t===1;case"pageRange":return t==="";case"pageOrder":return t===0;case"blackAndWhite":return t===!1;case"zoomFactor":return t===1;case"fitPagesTall":return t===-1;case"fitPagesWide":return t===-1;case"paperSize":return t.width===850&&t.height===1100&&t.kind===0;default:return!1}},n.prototype.toJSON=function(){var n=this,r={bestFitRows:n._bestFitRows,bestFitColumns:n._bestFitColumns,columnStart:n._columnStart,columnEnd:n._columnEnd,rowStart:n._rowStart,rowEnd:n._rowEnd,repeatColumnStart:n._repeatColumnStart,repeatColumnEnd:n._repeatColumnEnd,repeatRowStart:n._repeatRowStart,repeatRowEnd:n._repeatRowEnd,showBorder:n._showBorder,showGridLine:n._showGridLine,showColumnHeader:n._showColumnHeader,showRowHeader:n._showRowHeader,useMax:n._useMax,centering:n._centering,firstPageNumber:n._firstPageNumber,headerLeft:n._headerLeft,headerCenter:n._headerCenter,headerRight:n._headerRight,footerLeft:n._footerLeft,footerCenter:n._footerCenter,footerRight:n._footerRight,headerLeftImage:n._headerLeftImage,headerCenterImage:n._headerCenterImage,headerRightImage:n._headerRightImage,footerLeftImage:n._footerLeftImage,footerCenterImage:n._footerCenterImage,footerRightImage:n._footerRightImage,margin:n._margin,orientation:n._orientation,pageRange:n._pageRange,pageOrder:n._pageOrder,blackAndWhite:n._blackAndWhite,zoomFactor:n._zoomFactor,fitPagesTall:n._fitPagesTall,fitPagesWide:n._fitPagesWide,paperSize:n._paperSize.toJSON()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},n.prototype.fromJSON=function(n){var i=this;typeof n.bestFitRows!==t&&(i._bestFitRows=n.bestFitRows);typeof n.bestFitColumns!==t&&(i._bestFitColumns=n.bestFitColumns);typeof n.columnStart!==t&&(i._columnStart=n.columnStart);typeof n.columnEnd!==t&&(i._columnEnd=n.columnEnd);typeof n.rowStart!==t&&(i._rowStart=n.rowStart);typeof n.rowEnd!==t&&(i._rowEnd=n.rowEnd);typeof n.repeatColumnStart!==t&&(i._repeatColumnStart=n.repeatColumnStart);typeof n.repeatColumnEnd!==t&&(i._repeatColumnEnd=n.repeatColumnEnd);typeof n.repeatRowStart!==t&&(i._repeatRowStart=n.repeatRowStart);typeof n.repeatRowEnd!==t&&(i._repeatRowEnd=n.repeatRowEnd);typeof n.showBorder!==t&&(i._showBorder=n.showBorder);typeof n.showGridLine!==t&&(i._showGridLine=n.showGridLine);typeof n.showColumnHeader!==t&&(i._showColumnHeader=n.showColumnHeader);typeof n.showRowHeader!==t&&(i._showRowHeader=n.showRowHeader);typeof n.useMax!==t&&(i._useMax=n.useMax);typeof n.centering!==t&&(i._centering=n.centering);typeof n.firstPageNumber!==t&&(i._firstPageNumber=n.firstPageNumber);typeof n.headerLeft!==t&&(i._headerLeft=n.headerLeft);typeof n.headerCenter!==t&&(i._headerCenter=n.headerCenter);typeof n.headerRight!==t&&(i._headerRight=n.headerRight);typeof n.footerLeft!==t&&(i._footerLeft=n.footerLeft);typeof n.footerCenter!==t&&(i._footerCenter=n.footerCenter);typeof n.footerRight!==t&&(i._footerRight=n.footerRight);typeof n.headerLeftImage!==t&&(i._headerLeftImage=n.headerLeftImage);typeof n.headerCenterImage!==t&&(i._headerCenterImage=n.headerCenterImage);typeof n.headerRightImage!==t&&(i._headerRightImage=n.headerRightImage);typeof n.footerLeftImage!==t&&(i._footerLeftImage=n.footerLeftImage);typeof n.footerCenterImage!==t&&(i._footerCenterImage=n.footerCenterImage);typeof n.footerRightImage!==t&&(i._footerRightImage=n.footerRightImage);typeof n.margin!==t&&(i._margin=n.margin);typeof n.orientation!==t&&(i._orientation=n.orientation);typeof n.pageRange!==t&&(i._pageRange=n.pageRange);typeof n.pageOrder!==t&&(i._pageOrder=n.pageOrder);typeof n.blackAndWhite!==t&&(i._blackAndWhite=n.blackAndWhite);typeof n.zoomFactor!==t&&(i._zoomFactor=n.zoomFactor);typeof n.fitPagesTall!==t&&(i._fitPagesTall=n.fitPagesTall);typeof n.fitPagesWide!==t&&(i._fitPagesWide=n.fitPagesWide);typeof n.paperSize!==t&&i._paperSize&&i._paperSize.fromJSON(n.paperSize)},n}();n.PrintInfo=c;var r=function(){function r(){}return r.initPrintingSize=function(t,i){var f=r.getPaperSize(t.paperSize(),t.orientation()),e=f.width,o=f.height,u=r.getMargin(t.margin()),s=u.left,h=u.top,c=u.right,l=u.bottom;i.paperSize={width:e,height:o};i.pageImageableArea=new n.Rect(s,h,e-s-c,o-h-l)},r.getPaperSize=function(n,t){var r=.96,i={width:0,height:0},u=n.width()*r,f=n.height()*r;return i.width=u,i.height=f,i},r.getMargin=function(n){var i=.96,t={top:0,bottom:0,left:0,right:0,header:0,footer:0};return t.left=n.left*i,t.top=n.top*i,t.right=n.right*i,t.bottom=n.bottom*i,t.header=n.header*i,t.footer=n.footer*i,t},r.getPageRange=function(n){var i=[],e,r,s,t,u,f;if(!n)return i;for(e=n.split(","),r=0,s=e.length;r<s;r++)if(t=e[r].trim(),t)if(u=t.indexOf("-"),u>=0){var h=parseInt(t.substr(0,u),10),o=parseInt(t.substr(u+1),10),c=o>=h?1:-1;for(f=h;f!==o;f+=c)i.push(f);i.push(o)}else i.push(parseInt(t,10));return i},r.modifyPageIndexs=function(n,t){var r,i,f,u;for(n.sort(),r=[],i=0,f=n.length;i<f;i++)n[i]-=1,(n[i]>=t||n[i]<0)&&r.push(i);for(u=r.length-1;u>=0;u--)n.splice(r[u],1)},r.getLastNonEmptyColumn=function(n){for(var s,i,h,u,f,e=n._getModel(),c=e._lastNonNullColumn,l=e._lastNonNullRow,o=n.getTables(),t=c;t>=0;t--){if(s=n.getStyleImp(-1,t),r.isValidatingStyleForPrinting(s))return t;for(i=0,h=o.length;i<h;i++)if(u=o[i].range(),t>=u.col&&t<=u.col+u.colCount-1)return t;for(f=0;f<=l;f++)if(r.isCellNonEmpty(n,f,t))return t}return-1},r.getLastNonEmptyRow=function(n){for(var s,i,h,u,f,e=n._getModel(),c=e._lastNonNullColumn,l=e._lastNonNullRow,o=n.getTables(),t=l;t>=0;t--){if(s=n.getStyleImp(t,-1),r.isValidatingStyleForPrinting(s))return t;for(i=0,h=o.length;i<h;i++)if(u=o[i].range(),t>=u.row&&t<=u.row+u.rowCount-1)return t;for(f=0;f<=c;f++)if(r.isCellNonEmpty(n,t,f))return t}return-1},r.isCellNonEmpty=function(n,u,f){var e=n.getValue(u,f),o,s;return e!==i&&typeof e!==t?!0:(o=n.getSparkline(u,f),o)?!0:(s=n.getStyleImp(u,f),r.isValidatingStyleForPrinting(s))?!0:!1},r.isValidatingStyleForPrinting=function(n){return n?!!(n.backColor||n.backgroundImage||n.borderBottom||n.borderLeft||n.borderRight||n.borderTop):!1},r.getLastFloatingObjectDirtyColumn=function(n){for(var t,i=-1,u=n.getPictures(),r=0,e=u.length;r<e;r++)t=u[r],t.isVisible()&&t.canPrint()&&(i=f(i,t.endColumn()));return i},r.getLastFloatingObjectDirtyRow=function(n){for(var t,i=-1,u=n.getPictures(),r=0,e=u.length;r<e;r++)t=u[r],t.isVisible()&&t.canPrint()&&(i=f(i,t.endRow()));return i},r._getOverflowMaxEndColumn=function(t,i){for(var l,w,u,e,o,b,a,s,h,v=t._cachePool,y=r.getLastNonEmptyRow(t)+1,p=0,c=0,k=t.getColumnCount();c<k;c++)p+=v.getZoomColWidth(c);for(l=0,u=0;u<y;u++)l+=v.getZoomRowHeight(u);w=new n.Rect(0,0,p,l);t.setBounds(w);t.invalidateLayout();var d=1,g=1,nt=new n._CellOverflowLayoutBuilder(t,d,g),f=-1;for(u=0;u<y;u++){for(e=nt.getCellOverflowLayoutModel(u),o=0,b=e.length;o<b;o++)a=e[o],a.endColumn>f&&(f=a.endColumn);s=e.headingOverflowlayout;s&&s.endColumn>f&&(f=s.endColumn);h=e.trailingOverflowLayout;h&&h.endColumn>f&&(f=h.endColumn)}return f},r.getLastPrintingColumn=function(n,t){var u,o,i,s,h;return t.columnEnd()!=-1?u=t.columnEnd():(t.useMax()?(i=r.getLastNonEmptyColumn(n),n._allowCellOverflow&&(s=r._getOverflowMaxEndColumn(n,i),i=f(i,s)),h=r.getLastFloatingObjectDirtyColumn(n),o=f(i,h)):o=n.getColumnCount()-1,u=o),e(u,n.getColumnCount()-1)},r.getLastPrintingRow=function(n,t){var i,u,o,s;return t.rowEnd()!=-1?i=t.rowEnd():(t.useMax()?(o=r.getLastNonEmptyRow(n),s=r.getLastFloatingObjectDirtyRow(n),u=f(o,s)):u=n.getRowCount()-1,i=u),e(i,n.getRowCount()-1)},r.COMMAND_PREFIX="&",r.CURRENT_PAGE_PREFIX="P",r.PAGE_COUNT_PREFIX="N",r.DATE_PREFIX="D",r.TIME_PREFIX="T",r.PICTURE_PREFIX="G",r.STRIKETHROUGH_PREFIX="S",r.UNDERLINE_PREFIX="U",r.BOLD_PREFIX="B",r.ITALIC_PREFIX="I",r.FONT_PREFIX='"',r.COLOR_PREFIX="K",r.WORKBOOK_NAME_CMD_PREFIX="F",r.WORKSHEET_NAME_CMD_PREFIX="A",r}(),u=function(){function n(){var n=this;n._headerSize=0;n._contentSize=0;n._contentOffset=0;n._itemStart=-1;n._itemEnd=-1;n._repeatItemStart=-1;n._repeatItemEnd=-1}return n.prototype.headerSize=function(n){return arguments.length===0?this._headerSize:(this._headerSize=n,this)},n.prototype.contentSize=function(n){return arguments.length===0?this._contentSize:(this._contentSize=n,this)},n.prototype.contentOffset=function(n){return arguments.length===0?this._contentOffset:(this._contentOffset=n,this)},n.prototype.itemStart=function(n){return arguments.length===0?this._itemStart:(this._itemStart=n,this)},n.prototype.itemEnd=function(n){return arguments.length===0?this._itemEnd:(this._itemEnd=n,this)},n.prototype.repeatItemStart=function(n){return arguments.length===0?this._repeatItemStart:(this._repeatItemStart=n,this)},n.prototype.repeatItemEnd=function(n){return arguments.length===0?this._repeatItemEnd:(this._repeatItemEnd=n,this)},n}(),b=function(){function t(){var t=this;t._sheetIndex=-1;t._pageNumber=-1;t._columnPageIndex=-1;t._rowPageIndex=-1;t._pageNumberInSheet=-1;t._columnPageIndexInSheet=-1;t._rowPageIndexInSheet=-1;t._columnPage=new u;t._rowPage=new u;t._paperSize={width:0,height:0};t._pageImageableArea=new n.Rect(0,0,0,0);t._workbookName="";t._worksheetName=""}return t.prototype.sheetIndex=function(n){return arguments.length===0?this._sheetIndex:(this._sheetIndex=n,this)},t.prototype.pageNumber=function(n){return arguments.length===0?this._pageNumber:(this._pageNumber=n,this)},t.prototype.columnPageIndex=function(n){return arguments.length===0?this._columnPageIndex:(this._columnPageIndex=n,this)},t.prototype.rowPageIndex=function(n){return arguments.length===0?this._rowPageIndex:(this._rowPageIndex=n,this)},t.prototype.pageNumberInSheet=function(n){return arguments.length===0?this._pageNumberInSheet:(this._pageNumberInSheet=n,this)},t.prototype.columnPageIndexInSheet=function(n){return arguments.length===0?this._columnPageIndexInSheet:(this._columnPageIndexInSheet=n,this)},t.prototype.rowPageIndexInSheet=function(n){return arguments.length===0?this._rowPageIndexInSheet:(this._rowPageIndexInSheet=n,this)},t.prototype.columnPage=function(n){return arguments.length===0?this._columnPage:(this._columnPage=n,this)},t.prototype.rowPage=function(n){return arguments.length===0?this._rowPage:(this._rowPage=n,this)},t.prototype.paperSize=function(n){return arguments.length===0?this._paperSize:(this._paperSize=n,this)},t.prototype.pageImageableArea=function(n){return arguments.length===0?this._pageImageableArea:(this._pageImageableArea=n,this)},t.prototype.workbookName=function(n){return arguments.length===0?this._workbookName:(this._workbookName=n,this)},t.prototype.worksheetName=function(n){return arguments.length===0?this._worksheetName:(this._worksheetName=n,this)},t.prototype.getPageSize=function(){var n=this.columnPage(),t=this.rowPage();return{width:n.contentSize()+n.headerSize(),height:t.contentSize()+t.headerSize()}},t}(),h=function(){function f(n,t,i,r){var u=this;u._spread=n;u._sheet=n.getSheet(t);u._sheetIndex=t;u._printSettings=u._sheet.printInfo();u._paperSize=i;u._pageImageableArea=r;u._pageSize={width:r.width,height:r.height};u._pageCount=0;u._columnPages=[];u._rowPages=[];u._horizontalZoomFactor=1;u._verticalZoomFactor=1}return f.prototype.paginate=function(){var n=this,o,s,h,r,f,u,c,l;if(!n._sheet.visible()||n._contentWidth()<=0||n._contentHeight()<=0){n._pageCount=0;return}var e=n._printSettings,t=e.fitPagesTall(),i=e.fitPagesWide();if(t==-1&&i==-1&&(o=e.zoomFactor(),n.horizontalZoomFactor(o),n.verticalZoomFactor(o)),n._rowHeightCache={},n._colWidthCache={},n._paginateCore(),t>=1||i>=1){for(s=0,h=0,r=0,u=n.horizontalPageCount();r<u;r++)s+=n._columnPages[r].contentSize();for(f=0,u=n.verticalPageCount();f<u;f++)h+=n._rowPages[f].contentSize();c=n.verticalPageCount();t<c&&t>=1&&n._verticalFitPaginate(h,c);l=n.horizontalPageCount();i<l&&i>=1&&n._horizontalFitPaginate(s,l);n._pageCount=n.verticalPageCount()*n.horizontalPageCount()}n._rowHeightCache={};n._colWidthCache={}},f.prototype.pageCount=function(){return this._pageCount},f.prototype.getPage=function(n){var i=this,r=0,u=0,s=i._printSettings.pageOrder(),f=i.verticalPageCount(),e=i.horizontalPageCount(),t;return s==1||s==0&&f>=e?(r=n%f,u=o(n/f)):(u=n%e,r=o(n/e)),t=new b,t.sheetIndex(i._sheetIndex),t.pageNumberInSheet(n),t.rowPageIndexInSheet(r),t.columnPageIndexInSheet(u),t.pageNumber(n),t.rowPageIndex(r),t.columnPageIndex(u),t.rowPage(i._rowPages[r]),t.columnPage(i._columnPages[u]),t.paperSize(i._paperSize),t.pageImageableArea(i._pageImageableArea),t.workbookName(i._sheet.parent.name),t.worksheetName(i._sheet.getName()),t},f.prototype.verticalZoomFactor=function(n){return arguments.length===0?this._verticalZoomFactor:(this._verticalZoomFactor=n,this._rowHeightCache={},this)},f.prototype.horizontalZoomFactor=function(n){return arguments.length===0?this._horizontalZoomFactor:(this._horizontalZoomFactor=n,this._colWidthCache={},this)},f.prototype.horizontalPageCount=function(){return this._columnPages.length},f.prototype.verticalPageCount=function(){return this._rowPages.length},f.prototype.sheetIndex=function(){return this._sheetIndex},f.prototype._contentWidth=function(){return this._pageSize.width},f.prototype._contentHeight=function(){return this._pageSize.height},f.prototype._paginateCore=function(){var n=this;n._verticalPaginate();n._horizontalPaginate();n._pageCount=n.verticalPageCount()*n.horizontalPageCount()},f.prototype._horizontalFitPaginate=function(n,t){var i=this,r=i._printSettings.fitPagesWide(),f=1,u;r<t&&(f=r/t);var e=r*i._contentWidth()/n,o=e,s=15,h=(e-f)/s;for(u=0;u<=s;u++){if(i.horizontalZoomFactor(o),i._horizontalPaginate(),i.horizontalPageCount()==r)break;o-=h}},f.prototype._verticalFitPaginate=function(n,t){var i=this,r=i._printSettings.fitPagesTall(),f=1,u;r<t&&(f=r/t);var e=r*i._contentHeight()/n,o=e,s=15,h=(e-f)/s;for(u=0;u<=s;u++){if(i.verticalZoomFactor(o),i._verticalPaginate(),i.verticalPageCount()==r)break;o-=h}},f.prototype._horizontalPaginate=function(){var n=this,r=n._printSettings,w=r.columnStart()!=-1?r.columnStart():0,v=n._getLastPrintingColumn(),u,c,f,d,a,g,i;if(v!=-1){var e=n._getRowHeaderWidth(),o=n._contentWidth(),s=r.repeatColumnStart(),h=r.repeatColumnEnd(),y=r.showRowHeader(),b=n._sheet,k=[];for(u=w;u<=v;u++)b.getColumnPageBreak(u)&&k.push(u);for(n._columnPages=[],c=n._splitByPageBreak(w,v,k),f=0,d=c.length;f<d-1;f+=2){var p=c[f],l=c[f+1],t=[];if(y==2||y==0&&b.getRowHeaderVisible())for(t=n._horizontalPaginateCore(p,l,s,h,3,o-e),a=0,g=t.length;a<g;a++)t[a].headerSize(e);else y==3?(i=n._horizontalPaginateCore(p,l,s,h,3,o-e),i.length>0&&(i[0].headerSize(e),t.push(i[0]),i.length>1&&(i=n._horizontalPaginateCore(i[1].itemStart(),l,s,h,3,o),t=t.concat(i)))):t=n._horizontalPaginateCore(p,l,s,h,3,o);n._columnPages=n._columnPages.concat(t)}}},f.prototype._verticalPaginate=function(){var n=this,r=n._printSettings,w=r.rowStart()!=-1?r.rowStart():0,v=n._getLastPrintingRow(),u,c,f,d,a,g,i;if(v!=-1){var e=n._getColumnHeaderHeight(),o=n._contentHeight(),s=r.repeatRowStart(),h=r.repeatRowEnd(),y=r.showColumnHeader(),b=n._sheet,k=[];for(u=w;u<=v;u++)b.getRowPageBreak(u)&&k.push(u);for(n._rowPages=[],c=n._splitByPageBreak(w,v,k),f=0,d=c.length;f<d-1;f+=2){var p=c[f],l=c[f+1],t=[];if(y==2||y==0&&b.getColumnHeaderVisible())for(t=n._verticalPaginateCore(p,l,s,h,3,o-e),a=0,g=t.length;a<g;a++)t[a].headerSize(e);else y==3?(i=n._verticalPaginateCore(p,l,s,h,3,o-e),i.length>0&&(i[0].headerSize(e),t.push(i[0]),i.length>1&&(i=n._verticalPaginateCore(i[1].itemStart(),l,s,h,3,o),t=t.concat(i)))):t=n._verticalPaginateCore(p,l,s,h,3,o);n._rowPages=n._rowPages.concat(t)}}},f.prototype._getLastPrintingColumn=function(){return r.getLastPrintingColumn(this._sheet,this._printSettings)},f.prototype._getLastPrintingRow=function(){return r.getLastPrintingRow(this._sheet,this._printSettings)},f.prototype._getRowHeaderWidth=function(){for(var n=this,i=n._horizontalPaginateCore(0,n._sheet.getColumnCount(2)-1,-1,-1,2,n._contentWidth()),r=0,t=0;t<i.length;t++)r+=i[t].contentSize();return r},f.prototype._getColumnHeaderHeight=function(){for(var n=this,i=n._verticalPaginateCore(0,n._sheet.getRowCount(1)-1,-1,-1,1,n._contentHeight()),r=0,t=0;t<i.length;t++)r+=i[t].contentSize();return r},f.prototype._horizontalPaginateCore=function(n,t,r,f,e,o){var it=this,b=r<n,v=0,c=0,y=0,p=0,a=o,nt=r,k=f,l=-1,rt=!1,s=i,d=[],ut,h,g,ft,w,tt;for(n>t&&(ut=n,n=t,t=ut),h=n;h<=t;h++){if(b&&e==3&&(nt=r,k=f,nt!=-1&&nt<=l)){for(k!=-1&&k>l&&(k=l-1),s==i&&(s=new u),s.repeatItemStart(r),s.repeatItemEnd(f),g=nt;g<=k;g++)ft=it._getColumnWidth(g,e),g<=l&&(p+=ft);a-=p;b=!1}if(v=it._getColumnWidth(h,e),v>a&&(rt||h==n)){for(rt=!1,w=0;v-w>=a;)s==i&&(s=new u),s.repeatItemStart(r),s.repeatItemEnd(f),s.itemStart(h),s.itemEnd(h),s.contentSize(o),s.contentOffset(w),d.push(s),w+=a,s=i,c=0,y=0,b=!0;if(tt=v-w,tt==0){l=h;continue}else l=h-1;if(h==t){s==i&&(s=new u);s.repeatItemStart(r);s.repeatItemEnd(f);s.itemStart(h);s.itemEnd(h);s.contentSize(tt+p);s.contentOffset(w);d.push(s);break}else if(h++,h<=t)s==i&&(s=new u),s.repeatItemStart(r),s.repeatItemEnd(f),c=tt,s.contentOffset(w),v=it._getColumnWidth(h,e);else break}c+=v;c>a||c==a?(c>a?(y=c-v+p,h-=1):y=c+p,s==i&&(s=new u),l==-1?s.itemStart(n):s.itemStart(l+1),s.itemEnd(h),s.contentSize(y),d.push(s),s=i,c=0,y=0,p=0,a=o,b=!0,l=h,v>a&&(rt=!0)):h==t&&(s==i&&(s=new u),y=c+p,l==-1?s.itemStart(n):s.itemStart(l+1),s.itemEnd(h),s.contentSize(y),d.push(s),s=i,c=0,y=0,p=0,a=o,b=!0)}return d},f.prototype._verticalPaginateCore=function(n,t,r,f,e,o){var it=this,k=r<n,v=0,c=0,y=0,p=0,a=o,d=r,w=f,l=-1,rt=!1,s=i,g=[],ut,h,nt,ft,b,tt;for(n>t&&(ut=n,n=t,t=ut),h=n;h<=t;h++){if(k&&e==3&&(d=r,w=f,d!=-1&&d<=l)){for(w!=-1&&w>l&&(w=l-1),s==i&&(s=new u),s.repeatItemStart(d),s.repeatItemEnd(w),nt=d;nt<=w;nt++)ft=it._getRowHeight(nt,e),nt<=l&&(p+=ft);a-=p;k=!1}if(v=it._getRowHeight(h,e),v>a&&(rt||h==n)){for(rt=!1,b=0;v-b>=a;)s==i&&(s=new u),s.repeatItemStart(r),s.repeatItemEnd(w),s.itemStart(h),s.itemEnd(h),s.contentSize(o),s.contentOffset(b),g.push(s),b+=a,s=i,c=0,y=0,k=!0;if(tt=v-b,tt==0){l=h;continue}else l=h-1;if(h==t){s==i&&(s=new u);s.repeatItemStart(r);s.repeatItemEnd(f);s.itemStart(h);s.itemEnd(h);s.contentSize(tt+p);s.contentOffset(b);g.push(s);break}else if(h++,h<=t)s==i&&(s=new u),s.repeatItemStart(r),s.repeatItemEnd(w),c=tt,s.contentOffset(b),v=it._getRowHeight(h,e);else break}c+=v;c>a||c==a?(c>a?(y=c-v+p,h-=1):y=c+p,s==i&&(s=new u),l==-1?s.itemStart(n):s.itemStart(l+1),s.itemEnd(h),s.contentSize(y),g.push(s),s=i,c=0,y=0,p=0,a=o,k=!0,l=h,v>a&&(rt=!0)):h==t&&(s==i&&(s=new u),y=c+p,l==-1?s.itemStart(n):s.itemStart(l+1),s.itemEnd(h),s.contentSize(y),g.push(s),s=i,c=0,y=0,p=0,a=o,k=!0)}return g},f.prototype._getColumnWidthCore=function(n,t){var r=this,i=r._sheet,o=i.defaults,u=i.getColumnVisible(n,t),s,f,e;return(t==3&&n<i.getColumnCount()&&(u=u&&!i.colRangeGroup.isCollapsed(n)),u)?(s=i.getColumnWidth(n,t),r._printSettings.bestFitColumns()?(f=t==2?!0:!1,e=r._getColumnAutoFitValue(n,f),e<=0?f?o.rowHeaderColWidth:o.colWidth:e):s):0},f.prototype._getColumnWidth=function(n,i){var r=this,u=r._colWidthCache[i],f;return u||(u=r._colWidthCache[i]={}),f=u[n],typeof f===t&&(f=u[n]=r._getColumnWidthCore(n,i)*r._horizontalZoomFactor),f},f.prototype._getRowHeightCore=function(n,t){var e=this,i=e._sheet,r=i.defaults,o=i.getRowVisible(n,t),h,f,s,u;return(t==3&&n<i.getRowCount()&&(o=o&&!i.isRowFilterOut(n)&&!i.rowRangeGroup.isCollapsed(n)),o)?(h=i.getRowHeight(n,t),e._printSettings.bestFitRows()?(f=t==1?!0:!1,s=e._getRowAutoFitValue(n,f),s<=0?f?r.colHeaderRowHeight:r.rowHeight:(u=s,f?u<r.colHeaderRowHeight&&(u=r.colHeaderRowHeight):u<r.rowHeight&&(u=r.rowHeight),u)):h):0},f.prototype._getRowHeight=function(n,i){var r=this,u=r._rowHeightCache[i],f;return u||(u=r._rowHeightCache[i]={}),f=u[n],typeof f===t&&(f=u[n]=r._getRowHeightCore(n,i)*r._verticalZoomFactor),f},f.prototype._getColumnAutoFitValue=function(t,i){return n.util.getColumnAutoFitValue(t,this._sheet,i?2:3,1)},f.prototype._getRowAutoFitValue=function(t,i){return n.util.getRowAutoFitValue(t,this._sheet,i?1:3,1)},f.prototype._splitByPageBreak=function(n,t,i){var r=[],u,e,f;for(r.push(n),u=0,e=i.length;u<e;u++)f=i[u],f-1>=n&&(r.push(f-1),r.push(f));return r.push(t),r},f}(),l=function(){function t(t){var f,i,o,e,u;for(this._spread=t,this._pageCount=0,f=[],i=0,o=t.getSheetCount();i<o;i++)e=t.getSheet(i),e.visible()&&(u={paperSize:{width:0,height:0},pageImageableArea:new n.Rect(0,0,0,0)},r.initPrintingSize(e.printInfo(),u),f.push(new h(t,i,u.paperSize,u.pageImageableArea)));this._sheetPaginators=f}return t.prototype.paginate=function(){for(var t,i=this._sheetPaginators,n=0,r=i.length;n<r;n++)t=i[n],t.paginate(),this._pageCount+=t.pageCount()},t.prototype.pageCount=function(){return this._pageCount},t.prototype.getPage=function(n){var e={pageNumberInSheet:-1},o=this.getSheetPaginator(n,e),h=e.pageNumberInSheet,t,f,r,s,u;if(o){if(t=o.getPage(h),t.sheetIndex()>0)for(t.pageNumber(n),f=this._sheetPaginators,r=0,s=f.length;r<s;r++)u=f[r],t.sheetIndex()<u.sheetIndex()&&(t.rowPageIndex(t.rowPageIndexInSheet()+u.verticalPageCount()),t.columnPageIndex(t.columnPageIndexInSheet()+u.horizontalPageCount()));return t}return i},t.prototype.getSheetPaginator=function(n,t){for(var u,e=0,r=-1,o=this._sheetPaginators,f=0,s=o.length;f<s;f++){if(u=o[f],r=n-e,r>=0&&r<u.pageCount())return t.pageNumberInSheet=r,u;e+=u.pageCount()}return i},t}(),k=function(){function t(n,t){this._cache={};this._spread=n;this._paginator=t}return t.prototype.build=function(){var t=this,kt=t._spread,k=t._paginator,u=t._getIframeDocument(),a,v,o,s,i,d,g,yt,wt,ut,w,bt,b,ft;for(t._prepareIframeDocument(u),a=k.pageCount(),v=0;v<a;v++)if(o=k.getPage(v),s=kt.getSheet(o.sheetIndex()),t._prepareSheet(s,o),i=s.printInfo(),d=i.pageRange(),!d||(g=r.getPageRange(d),r.modifyPageIndexs(g,a),!(g.indexOf(o.pageNumberInSheet())<0))){var dt=i.showBorder(),h=r.getMargin(i.margin()),et=h.left,gt=h.right,nt=h.top,ot=h.bottom,tt=h.header,st=h.footer,ni=i.centering(),ht=r.getPaperSize(i.paperSize(),i.orientation()),ct=ht.width,lt=ht.height,c=ct-et-gt,at=lt-e(tt,nt)-e(st,ot),y=f(0,nt-tt),p=f(0,ot-st),vt=o.getPageSize(),ti=vt.width,ii=vt.height,it=t._createContainer(u,ct,lt,"printPage"),rt=t._createContentContainer(u,it,c,at,et,e(tt,nt));y>0&&(yt=t._addHeader(u,rt,c,y),t._paintHeader(yt.getContext("2d"),c,y,i,o,a));var ri=t._createBodyContainer(u,rt,c,at-y-p),pt=t._getSheetPaginator(k,v),l=t._addBody(u,ri,ti,ii,dt,ni,pt.horizontalZoomFactor(),pt.verticalZoomFactor());if(t._paintBody(s,l.getContext("2d"),new n.Rect(0,0,l.width,l.height)),t._paintPictures(s,l.getContext("2d"),new n.Rect(0,0,l.width,l.height)),p>0&&(wt=t._addFooter(u,rt,c,p),t._paintFooter(wt.getContext("2d"),c,p,i,o,a)),i.blackAndWhite())if(n.util.browser.mozilla)it.classList.add("grayscale");else for(ut=n.GC$("canvas",it),w=0,bt=ut.length();w<bt;w++)b=ut.getElement(w),t._applyBlackAndWhite(b.getContext("2d"),new n.Rect(0,0,b.width,b.height));s._dispose(!1)}ft=u.body.lastChild;ft&&n.GC$(ft).removeClass("printPage");t._getImageLoader().isAllImagesLoaded()&&t.onBuildCompleted()},t.prototype.print=function(){var i,t;n.util.browser.msie?(i=this._getIframeDocument(),i.execCommand("print")):(t=this._getIframeWindow(),t.focus(),t.print());window.focus()},t.prototype.dispose=function(){var n=this,t=n._iframe,r;t&&t.parentElement&&(t.parentElement.removeChild(t),n._iframe=i);n._imageLoader=i;r=n._spread;r&&(r.destroy(),n._spread=i);n._paginator=i;n._cache={}},t.prototype._getIframe=function(){if(!this._iframe){var n=document.createElement("IFRAME");n.style.position="absolute";n.style.left="-10px";n.style.width="0px";n.style.height="0px";document.body.insertBefore(n,i);this._iframe=n}return this._iframe},t.prototype._getIframeWindow=function(){var n=this._getIframe();return n.contentWindow},t.prototype._getIframeDocument=function(){var t=this._getIframe(),n=t.contentDocument;return n.head||n.write("<head><\/head>"),n.body||n.write("<body><\/body>"),n},t.prototype._prepareIframeDocument=function(n){n.open();n.write("<head><style>.printPage{page-break-after: always} .grayscale{filter: grayscale(100%)}<\/style><\/head><body><\/body>");n.close()},t.prototype._prepareSheet=function(t,i){var f,k,o,c,l,ut,d,ft,a,et,v,st,g,ht,y,ct,nt,lt,tt,p,w,it,b,s,h,u,e;if(t.isPaintSuspended(!0),t.suspendEvent(),t.suspendCalcService(),t.showRowRangeGroup(!1),t.showColumnRangeGroup(!1),t.zoom(1),f=t.printInfo(),k=f.showGridLine(),t.setGridlineOptions({showHorizontalGridline:k,showVerticalGridline:k}),o=this,!o._cache[t.getName()]){if(c=!1,f.bestFitColumns()){var at=f.columnStart()!=-1?f.columnStart():0,vt=r.getLastPrintingColumn(t,f),rt=[];for(l=at;l<=vt;l++)rt.push({col:l});for(ut=new n.UndoRedo.ColumnAutoFitUndoAction(t,rt,!1,1),ut.execute(t),d=[],ft=t.getColumnCount(2),a=0;a<ft;a++)d.push({col:a});et=new n.UndoRedo.ColumnAutoFitUndoAction(t,d,!0,1);et.execute(t);c=!0}if(f.bestFitRows()){var yt=f.rowStart()!=-1?f.rowStart():0,pt=r.getLastPrintingRow(t,f),ot=[];for(v=yt;v<=pt;v++)ot.push({row:v});for(st=new n.UndoRedo.RowAutoFitUndoAction(t,ot,!1,1),st.execute(t),g=[],ht=t.getRowCount(1),y=0;y<ht;y++)g.push({row:y});ct=new n.UndoRedo.RowAutoFitUndoAction(t,g,!0,1);ct.execute(t);c=!0}if(c)for(nt=t.getPictures(),u=0,lt=nt.length;u<lt;u++)tt=nt[u],tt._updateFloatingObjectLocation(),tt._updateFloatingObjectSize();o._cache[t.getName()]=!0}if(p=f.showRowHeader(),p===0||(p===2||p===3&&i.columnPageIndexInSheet()===0?t.setRowHeaderVisible(!0):t.setRowHeaderVisible(!1)),w=f.showColumnHeader(),w===0||(w===2||w===3&&i.rowPageIndexInSheet()===0?t.setColumnHeaderVisible(!0):t.setColumnHeaderVisible(!1)),t.setFrozenRowCount(0),t.setFrozenColumnCount(0),t.setFrozenTrailingRowCount(0),t.setFrozenTrailingColumnCount(0),it=t.rowFilter(),it&&it.filterButtonVisible(!1),b=t.getTables(),b)for(u=0,e=b.length;u<e;u++)b[u].filterButtonVisible(!1);if(s=i.columnPage(),s.repeatItemStart()!==-1&&s.repeatItemEnd()!==-1)for(t.setFrozenColumnCount(s.repeatItemEnd()+1),u=0,e=s.repeatItemStart();u<e;u++)t.setColumnVisible(u,!1),o._adjustStartColumnOffsetAfterHideColumn(t,u);if(h=i.rowPage(),h.repeatItemStart()!==-1&&h.repeatItemEnd()!==-1)for(t.setFrozenRowCount(h.repeatItemEnd()+1),u=0,e=h.repeatItemStart();u<e;u++)t.setRowVisible(u,!1),o._adjustStartRowOffsetAfterHideRow(t,u);t.showCell(i.rowPage().itemStart(),i.columnPage().itemStart(),0,0)},t.prototype._getSheetPaginator=function(n,t){var i,r;return n instanceof h?i=n:n instanceof l&&(r={pageNumberInSheet:0},i=n.getSheetPaginator(t,r)),i},t.prototype._createContainer=function(n,t,i,r){var u=n.createElement("div");return u.style.border="1px transparent solid",u.style.boxSizing="border-box",u.style.width=t+"px",u.style.height=i+"px",u.className=r,n.body.appendChild(u),u},t.prototype._createContentContainer=function(n,t,i,r,u,f){var e=n.createElement("div");return e.style.marginLeft=u+"px",e.style.width=i+"px",e.style.marginTop=f+"px",e.style.height=r+"px",t.appendChild(e),e},t.prototype._addHeader=function(t,i,r,u){var f=t.createElement("canvas"),e,o;return f.style.height=u+"px",f.style.width=r+"px",i.appendChild(f),e=n.GC$(f),f.width=e.width()*2,f.height=e.height()*2,o=f.getContext("2d"),o.scale(2,2),f},t.prototype._addFooter=function(t,i,r,u){var f=t.createElement("canvas"),e,o;return f.style.height=u+"px",f.style.width=r+"px",i.appendChild(f),e=n.GC$(f),f.width=e.width()*2,f.height=e.height()*2,o=f.getContext("2d"),o.scale(2,2),f},t.prototype._createBodyContainer=function(n,t,i,r){var u=n.createElement("div");return u.style.width=i+"px",u.style.height=r+"px",t.appendChild(u),u},t.prototype._addBody=function(t,i,r,u,f,e,o,s){var c=0,l,h,y;f&&(c=1);(e===1||e===3)&&(i.style.boxSizing="border-box",i.style.paddingLeft=(n.GC$(i).width()-r-c*2)/2+"px");(e===2||e===3)&&(i.style.boxSizing="border-box",i.style.paddingTop=(n.GC$(i).height()-u-c*2)/2+"px");l=t.createElement("div");l.style.width=r+"px";l.style.height=u+"px";l.style.border=c+"px black solid";h=t.createElement("canvas");h.style.margin=c+"px";h.width=1/o*(r-2*c);h.height=1/s*(u-2*c);h.style.width=r-2*c+"px";h.style.height=u-2*c+"px";var p=h.getContext("2d"),v=2,a=2;if(n.util.browser.chrome)for(y=h.width*v*h.height*a;y<65792;)y*=2,a*=2;return h.width*=v,h.height*=a,p.scale(v,a),l.appendChild(h),i.appendChild(l),h},t.prototype._paintHeader=function(n,t,i,r,u,f){var e=this,o=r.firstPageNumber(),c=e._generateHeaderFooterContents(o,r.headerLeft(),r.headerLeftImage(),u,f),s,h;e._renderHeaderFooterContents(n,c,0,0,t/3,i,0,0);s=e._generateHeaderFooterContents(o,r.headerCenter(),r.headerCenterImage(),u,f);e._renderHeaderFooterContents(n,s,t/3,0,t/3,i,1,0);h=e._generateHeaderFooterContents(o,r.headerRight(),r.headerRightImage(),u,f);e._renderHeaderFooterContents(n,h,t/3*2,0,t/3,i,2,0)},t.prototype._paintFooter=function(n,t,i,r,u,f){var e=this,o=r.firstPageNumber(),c=e._generateHeaderFooterContents(o,r.footerLeft(),r.footerLeftImage(),u,f),s,h;e._renderHeaderFooterContents(n,c,0,0,t/3,i,0,2);s=e._generateHeaderFooterContents(o,r.footerCenter(),r.footerCenterImage(),u,f);e._renderHeaderFooterContents(n,s,t/3,0,t/3,i,1,2);h=e._generateHeaderFooterContents(o,r.footerRight(),r.footerRightImage(),u,f);e._renderHeaderFooterContents(n,h,t/3*2,0,t/3,i,2,2)},t.prototype._paintBody=function(n,t,i){n.imageLoader=this._getImageLoader();n.setBounds(i);n.invalidateLayout();n._render.paintSheetForPrint(t,i)},t.prototype._generateHeaderFooterContents=function(n,t,i,u,f){var y=[],w,c,l,v;if(!t)return y;for(var s=r.COMMAND_PREFIX,ni=r.COLOR_PREFIX,ot=r.STRIKETHROUGH_PREFIX,st=r.UNDERLINE_PREFIX,ti=r.FONT_PREFIX,ht=r.BOLD_PREFIX,ct=r.ITALIC_PREFIX,lt=r.DATE_PREFIX,at=r.TIME_PREFIX,vt=r.CURRENT_PAGE_PREFIX,yt=r.PAGE_COUNT_PREFIX,pt=r.PICTURE_PREFIX,wt=r.WORKBOOK_NAME_CMD_PREFIX,bt=r.WORKSHEET_NAME_CMD_PREFIX,ii=/&[0-9]+/,ri=/&K[0-9ABCDEFabcdef][0-9ABCDEFabcdef][0-9ABCDEFabcdef][0-9ABCDEFabcdef][0-9ABCDEFabcdef][0-9ABCDEFabcdef]/,ui=/&".+"/,b="",k=!1,p=0,d=!1,g=!1,nt=!1,tt="black",a="";t;){var kt=b,it=k,dt=p,rt=nt,ut=d,ft=g,gt=tt,e=t.indexOf(s);e<0&&(e=t.length);a+=t.substr(0,e);w=e+1<t.length?t.substr(e+1,1):"";w=w.toUpperCase();var o=-1,h=!1,et=!1;switch(w){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":c=ii.exec(t.substr(e));c&&c.length>0?(l=c[0],dt=parseFloat(l.substr(1)),h=!0,o=e+l.length):o=e+s.length;break;case ni:c=ri.exec(t.substr(e));c&&c.length>0?(l=c[0],gt="#"+l.substr(2,2)+l.substr(4,2)+l.substr(6,2),h=!0,o=e+l.length):o=e+s.length;break;case ot:it=!it;h=!0;o=e+s.length+ot.length;break;case st:rt=!rt;h=!0;o=e+s.length+st.length;break;case ti:c=ui.exec(t.substr(e));c&&c.length>0?(l=c[0],kt=l.substr(2,l.length-3),h=!0,o=e+l.length):o=e+s.length;break;case ht:ut=!ut;h=!0;o=e+s.length+ht.length;break;case ct:ft=!ft;h=!0;o=e+s.length+ct.length;break;case s:a+=s;h=!0;o=e+s.length+s.length;break;case lt:v=new Date;a+=v.getFullYear()+"/"+(v.getMonth()+1)+"/"+v.getDate();h=!0;o=e+s.length+lt.length;break;case at:v=new Date;a+=v.getHours()+":"+v.getMinutes()+":"+v.getSeconds();h=!0;o=e+s.length+at.length;break;case vt:a+=u.pageNumber()+n;h=!0;o=e+s.length+vt.length;break;case yt:a+=f;h=!0;o=e+s.length+yt.length;break;case pt:i&&(h=!0,et=!0);o=e+s.length+pt.length;break;case wt:a+=u.workbookName()||"";h=!0;o=e+s.length+wt.length;break;case bt:a+=u.worksheetName()||"";h=!0;o=e+s.length+bt.length;break;default:o=e+s.length;break}o>=t.length?t="":(o<0&&(o=e+s.length),t=t.substr(o));a&&(h||!t)&&(y.push({text:a,underline:nt,strikethrough:k,fontFamily:b,fontSize:p>0?p+"px":"",fontWeight:d?"bold":"",fontStyle:g?"italic":"",color:tt}),a="");et&&i&&(y.push({image:i}),et=!1);b=kt;k=it;p=dt;nt=rt;d=ut;g=ft;tt=gt}return y},t.prototype._renderHeaderFooterContents=function(n,t,i,r,u,f,o,s){var it=this,rt=[],ut=[],ft=[],y=e(u,f)-2,h=i,w,tt,a,g,c,k,nt,p,v;for(o===1?h=i+u/2:o===2&&(h=i+u),w=y,c=0,k=t.length;c<k;c++){var l=t[c],b=l.image,ot=l.fontFamily,et=l.fontSize,st=l.fontWeight,ht=l.fontStyle,d=l.text;b?o===1?h-=y/2:o===2&&(h-=y):d&&(tt=it._buildFontString(ot,et,st,ht),rt[c]=tt,n.font=tt,p=parseFloat(et||"13.3px"),w<p&&(w=p),ut[c]=p,v=n.measureText(d).width,ft[c]=v,o===1?h-=v/2:o===2&&(h-=v))}for(a=r+w/2,s===1?a=r+f/2:s===2&&(a=r+f-w/2),n.save(),n.textAlign="left",n.textBaseline="middle",g=it._getImageLoader(),c=0,k=t.length;c<k;c++){var l=t[c],b=l.image,ct=l.underline,lt=l.strikethrough,at=l.color,d=l.text;if(b){if(g.getState(b)){nt=g.getImage(b);try{n.drawImage(nt,0,0,nt.width,nt.height,h,a-y/2,y,y)}catch(vt){}}else g.addImage(b);h+=y}else d&&(n.beginPath(),n.font=rt[c],n.fillStyle=at,n.fillText(d,h,a),p=ut[c],v=ft[c],ct&&(n.beginPath(),n.moveTo(h,a+p/2),n.lineTo(h+v,a+p/2),n.stroke()),lt&&(n.beginPath(),n.moveTo(h,a),n.lineTo(h+v,a),n.stroke()),h+=v)}n.restore()},t.prototype._buildFontString=function(n,t,i,r){n||(n="Arial");t||(t="13.3px");var u="",f="normal",e="400";return r!==f&&(u=r),i!==f&&i!==e&&(u+=(u?" ":"")+i),u+=(u?" ":"")+t,u+(" "+n)},t.prototype._getImageLoader=function(){var t=this;return t._imageLoader||(t._imageLoader=new n._GcImageLoader(function(){t.build()})),t._imageLoader},t.prototype._applyBlackAndWhite=function(n,t){for(var u,f=n.getImageData(t.x,t.y,t.width,t.height),r=f.data,i=0;i<r.length-4;i+=4)u=o((r[i]*30+r[i+1]*59+r[i+2]*11+50)/100),r[i]=u,r[i+1]=u,r[i+2]=u;n.putImageData(f,t.x,t.y)},t.prototype._paintPictures=function(n,t,i){for(var r,f,e=n._getSheetLayout(),u=0;u<=2;u++)for(r=0;r<=2;r++)f=i.getIntersectRect(e.viewportRect(u,r)),f&&this._paintPicturesImp(n,t,f,u,r)},t.prototype._paintPicturesImp=function(n,t,i,r,u){for(var f,p,w,s,rt,b,k,h,d,st=this,c=n._cachePool,l=n._zoomFactor,a=n._getViewportColumnLayout(u),v=n._getViewportRowLayout(r),g=a[0],ut=a[a.length-1],nt=v[0],ft=v[v.length-1],tt=st._getImageLoader(),et=n.getPictures(),it=0;it<et.length;it++)if(f=et[it],f.isVisible()&&f.canPrint()){var e=0,o=0,ht=f.width()*l,ct=f.height()*l,y=f.startColumn(),ot=a.findCol(y);if(ot)e=ot.x;else if(y<g.col)for(e=g.x,p=g.col-1;p>=y;p--)e-=c.getZoomColWidth(p);else for(e=ut.x,w=ut.col+1;w<=y;w++)e+=c.getZoomColWidth(w);if(e+=f.startColumnOffset()*l,s=f.startRow(),rt=v.findRow(s),rt)o=rt.y;else if(s<nt.row)for(o=nt.y,b=nt.row-1;b>=s;b--)o-=c.getZoomRowHeight(b);else for(o=ft.y,k=ft.row+1;k<=s;k++)o+=c.getZoomRowHeight(k);if(o+=f.startRowOffset()*l,t.save(),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath(),h=f.src(),h)if(tt.getState(h)){d=tt.getImage(h);try{t.drawImage(d,0,0,d.width,d.height,e,o,ht,ct)}catch(lt){}}else tt.addImage(h);t.restore()}},t.prototype._adjustStartColumnOffsetAfterHideColumn=function(n,t){for(var i,u=n.getPictures(),r=0,f=u.length;r<f;r++)i=u[r],i.startColumn()<=t&&t<=i.endColumn()&&i.startColumnOffset(i.startColumnOffset()-n._getActualColumnWidth(t))},t.prototype._adjustStartRowOffsetAfterHideRow=function(n,t){for(var i,u=n.getPictures(),r=0,f=u.length;r<f;r++)i=u[r],i.startRow()<=t&&t<=i.endRow()&&i.startRowOffset(i.startRowOffset()-n._getActualRowHeight(t))},t}(),d=function(){function u(){}return u.prototype.print=function(t,i){var f=this,r,e,u;f.dispose();r=new n.Spread;r.isPaintSuspended(!0);r.suspendEvent();r.suspendCalcService();r.fromJSON(JSON.parse(JSON.stringify(t.toJSON({includeBindingSource:!0}))));e=f._getPaginator(r,i);e.paginate();u=new k(r,e);f._presenter=u;u.onBuildCompleted=function(){u.print()};u.build()},u.prototype.dispose=function(){var n=this,t=n._presenter;t&&t.dispose();n._presenter=i},u.prototype._getPaginator=function(i,u){if(typeof u==t)return new l(i);else{var f={paperSize:{width:0,height:0},pageImageableArea:new n.Rect(0,0,0,0)};return r.initPrintingSize(i.getSheet(u).printInfo(),f),new h(i,u,f.paperSize,f.pageImageableArea)}},u}();n.SpreadPrinter=d})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
